define("qtype_formulas/answervalidation",["exports","core/notification","core/pending","core/ajax","qtype_formulas/latexify"],(function(_exports,Notification,_pending,_ajax,_latexify){var obj;function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=_exports.default=void 0,Notification=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}
/**
   * On-the-fly validation for student input to Formulas questions.
   *
   * @module     qtype_formulas/answervalidation
   * @copyright  2025 Philipp Imhof
   * @author     Philipp Imhof
   * @license    https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */(Notification),_pending=(obj=_pending)&&obj.__esModule?obj:{default:obj};var timers=[];const init=()=>{let inputs=document.getElementsByTagName("input");for(let input of inputs)"text"===input.type&&input.className.match("formulas_")&&"unit"!=input.dataset.answertype&&input.addEventListener("input",setDebounceTimer)};_exports.init=init;const validateStudentAnswer=async id=>{let field=document.getElementById(id),symbol=document.getElementById("warning-".concat(id));if(""===field.value)return void(symbol.style.visibility="hidden");let pendingPromise=new _pending.default("qtype_formulas/validatestudentanswer");try{let validationResult=await(0,_ajax.call)([{methodname:"qtype_formulas_validate_student_answer",args:{answer:field.value,answertype:field.dataset.answertype,withunit:field.dataset.withunit}}])[0];if(symbol.style.visibility=validationResult?"hidden":"visible",validationResult){let texcode=await(0,_latexify.latexify)(field.value);showMathJax(id,texcode)}}catch(err){Notification.exception(err)}pendingPromise.resolve()},showMathJax=(id,texcode)=>{let field=document.getElementById(id),div=document.createElement("div");if(div.className="formulas_input_info",field.parentNode.insertBefore(div,field),div.innerHTML="\\( ".concat(texcode," \\)"),void 0===window.MathJax)return void window.console.log("no mathjax");let version=window.MathJax.version;"2"!=version[0]?"3"==version[0]&&window.MathJax.typesetPromise([div]):window.MathJax.Hub.Queue(["Typeset",window.MathJax.Hub,div])},setDebounceTimer=evt=>{"number"==typeof timers[evt.target.id]&&clearTimeout(timers[evt.target.id]),timers[evt.target.id]=setTimeout(validateStudentAnswer,200,evt.target.id)};var _default={init:init};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=answervalidation.min.js.map