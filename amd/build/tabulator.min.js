define("qtype_formulas/tabulator",["exports"],(function(_exports){function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e3){didErr=!0,err=_e3},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(self)}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.ValidateModule=_exports.TooltipModule=_exports.TabulatorFull=_exports.Tabulator=_exports.SortModule=_exports.SelectRowModule=_exports.RowComponent=_exports.ResponsiveLayoutModule=_exports.ResizeTableModule=_exports.ResizeRowsModule=_exports.ResizeColumnsModule=_exports.Renderer=_exports.ReactiveDataModule=_exports.PseudoRow=_exports.PrintModule=_exports.PopupModule=_exports.PersistenceModule=_exports.PageModule=_exports.MutatorModule=_exports.MoveRowsModule=_exports.MoveColumnsModule=_exports.Module=_exports.MenuModule=_exports.KeybindingsModule=_exports.InteractionModule=_exports.ImportModule=_exports.HtmlTableImportModule=_exports.HistoryModule=_exports.GroupRowsModule=_exports.GroupComponent=_exports.FrozenRowsModule=_exports.FrozenColumnsModule=_exports.FormatModule=_exports.FilterModule=_exports.ExportModule=_exports.EditModule=_exports.DownloadModule=_exports.DataTreeModule=_exports.ColumnComponent=_exports.ColumnCalcsModule=_exports.ClipboardModule=_exports.CellComponent=_exports.CalcComponent=_exports.AjaxModule=_exports.AccessorModule=void 0;var CoreFeature=function(){function CoreFeature(table){_classCallCheck(this,CoreFeature),this.table=table}return _createClass(CoreFeature,[{key:"reloadData",value:function(data,silent,columnsChanged){return this.table.dataLoader.load(data,void 0,void 0,void 0,silent,columnsChanged)}},{key:"langText",value:function(){var _this$table$modules$l;return(_this$table$modules$l=this.table.modules.localize).getText.apply(_this$table$modules$l,arguments)}},{key:"langBind",value:function(){var _this$table$modules$l2;return(_this$table$modules$l2=this.table.modules.localize).bind.apply(_this$table$modules$l2,arguments)}},{key:"langLocale",value:function(){var _this$table$modules$l3;return(_this$table$modules$l3=this.table.modules.localize).getLocale.apply(_this$table$modules$l3,arguments)}},{key:"commsConnections",value:function(){var _this$table$modules$c;return(_this$table$modules$c=this.table.modules.comms).getConnections.apply(_this$table$modules$c,arguments)}},{key:"commsSend",value:function(){var _this$table$modules$c2;return(_this$table$modules$c2=this.table.modules.comms).send.apply(_this$table$modules$c2,arguments)}},{key:"layoutMode",value:function(){return this.table.modules.layout.getMode()}},{key:"layoutRefresh",value:function(force){return this.table.modules.layout.layout(force)}},{key:"subscribe",value:function(){var _this$table$eventBus;return(_this$table$eventBus=this.table.eventBus).subscribe.apply(_this$table$eventBus,arguments)}},{key:"unsubscribe",value:function(){var _this$table$eventBus2;return(_this$table$eventBus2=this.table.eventBus).unsubscribe.apply(_this$table$eventBus2,arguments)}},{key:"subscribed",value:function(key){return this.table.eventBus.subscribed(key)}},{key:"subscriptionChange",value:function(){var _this$table$eventBus3;return(_this$table$eventBus3=this.table.eventBus).subscriptionChange.apply(_this$table$eventBus3,arguments)}},{key:"dispatch",value:function(){var _this$table$eventBus4;return(_this$table$eventBus4=this.table.eventBus).dispatch.apply(_this$table$eventBus4,arguments)}},{key:"chain",value:function(){var _this$table$eventBus5;return(_this$table$eventBus5=this.table.eventBus).chain.apply(_this$table$eventBus5,arguments)}},{key:"confirm",value:function(){var _this$table$eventBus6;return(_this$table$eventBus6=this.table.eventBus).confirm.apply(_this$table$eventBus6,arguments)}},{key:"dispatchExternal",value:function(){var _this$table$externalE;return(_this$table$externalE=this.table.externalEvents).dispatch.apply(_this$table$externalE,arguments)}},{key:"subscribedExternal",value:function(key){return this.table.externalEvents.subscribed(key)}},{key:"subscriptionChangeExternal",value:function(){var _this$table$externalE2;return(_this$table$externalE2=this.table.externalEvents).subscriptionChange.apply(_this$table$externalE2,arguments)}},{key:"options",value:function(key){return this.table.options[key]}},{key:"setOption",value:function(key,value){return void 0!==value&&(this.table.options[key]=value),this.table.options[key]}},{key:"deprecationCheck",value:function(oldOption,newOption){return this.table.deprecationAdvisor.check(oldOption,newOption)}},{key:"deprecationCheckMsg",value:function(oldOption,msg){return this.table.deprecationAdvisor.checkMsg(oldOption,msg)}},{key:"deprecationMsg",value:function(msg){return this.table.deprecationAdvisor.msg(msg)}},{key:"module",value:function(key){return this.table.module(key)}}]),CoreFeature}(),Helpers=function(){function Helpers(){_classCallCheck(this,Helpers)}return _createClass(Helpers,null,[{key:"elVisible",value:function(el){return!(el.offsetWidth<=0&&el.offsetHeight<=0)}},{key:"elOffset",value:function(el){var box=el.getBoundingClientRect();return{top:box.top+window.pageYOffset-document.documentElement.clientTop,left:box.left+window.pageXOffset-document.documentElement.clientLeft}}},{key:"deepClone",value:function(obj,clone){var _this=this,list=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],objectProto={}.__proto__,arrayProto=[].__proto__;clone||(clone=Object.assign(Array.isArray(obj)?[]:{},obj));var _loop=function(){var subject=obj[i],match=void 0,copy=void 0;null==subject||"object"!==_typeof(subject)||subject.__proto__!==objectProto&&subject.__proto__!==arrayProto||((match=list.findIndex((function(item){return item.subject===subject})))>-1?clone[i]=list[match].copy:(copy=Object.assign(Array.isArray(subject)?[]:{},subject),list.unshift({subject:subject,copy:copy}),clone[i]=_this.deepClone(subject,copy,list)))};for(var i in obj)_loop();return clone}}]),Helpers}(),Popup=function(_CoreFeature){_inherits(Popup,_CoreFeature);var _super=_createSuper(Popup);function Popup(table,element,parent){var _this2;return _classCallCheck(this,Popup),(_this2=_super.call(this,table)).element=element,_this2.container=_this2._lookupContainer(),_this2.parent=parent,_this2.reversedX=!1,_this2.childPopup=null,_this2.blurable=!1,_this2.blurCallback=null,_this2.blurEventsBound=!1,_this2.renderedCallback=null,_this2.visible=!1,_this2.hideable=!0,_this2.element.classList.add("tabulator-popup-container"),_this2.blurEvent=_this2.hide.bind(_assertThisInitialized(_this2),!1),_this2.escEvent=_this2._escapeCheck.bind(_assertThisInitialized(_this2)),_this2.destroyBinding=_this2.tableDestroyed,_this2.destroyed=!1,_this2}return _createClass(Popup,[{key:"tableDestroyed",value:function(){this.destroyed=!0,this.hide(!0)}},{key:"_lookupContainer",value:function(){var container=this.table.options.popupContainer;return"string"==typeof container?(container=document.querySelector(container))||console.warn("Menu Error - no container element found matching selector:",this.table.options.popupContainer,"(defaulting to document body)"):!0===container&&(container=this.table.element),container&&!this._checkContainerIsParent(container)&&(container=!1,console.warn("Menu Error - container element does not contain this table:",this.table.options.popupContainer,"(defaulting to document body)")),container||(container=document.body),container}},{key:"_checkContainerIsParent",value:function(container){var element=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.table.element;return container===element||!!element.parentNode&&this._checkContainerIsParent(container,element.parentNode)}},{key:"renderCallback",value:function(callback){this.renderedCallback=callback}},{key:"containerEventCoords",value:function(e){var touch=!(e instanceof MouseEvent),x=touch?e.touches[0].pageX:e.pageX,y=touch?e.touches[0].pageY:e.pageY;if(this.container!==document.body){var parentOffset=Helpers.elOffset(this.container);x-=parentOffset.left,y-=parentOffset.top}return{x:x,y:y}}},{key:"elementPositionCoords",value:function(element){var containerOffset,x,y,position=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right",offset=Helpers.elOffset(element);switch(this.container!==document.body&&(containerOffset=Helpers.elOffset(this.container),offset.left-=containerOffset.left,offset.top-=containerOffset.top),position){case"right":x=offset.left+element.offsetWidth,y=offset.top-1;break;case"bottom":x=offset.left,y=offset.top+element.offsetHeight;break;case"left":x=offset.left,y=offset.top-1;break;case"top":x=offset.left,y=offset.top;break;case"center":x=offset.left+element.offsetWidth/2,y=offset.top+element.offsetHeight/2}return{x:x,y:y,offset:offset}}},{key:"show",value:function(origin,position){var x,y,parentEl,parentOffset,coords;return this.destroyed||this.table.destroyed||(origin instanceof HTMLElement?(parentEl=origin,parentOffset=(coords=this.elementPositionCoords(origin,position)).offset,x=coords.x,y=coords.y):"number"==typeof origin?(parentOffset={top:0,left:0},x=origin,y=position):(x=(coords=this.containerEventCoords(origin)).x,y=coords.y,this.reversedX=!1),this.element.style.top=y+"px",this.element.style.left=x+"px",this.container.appendChild(this.element),"function"==typeof this.renderedCallback&&this.renderedCallback(),this._fitToScreen(x,y,parentEl,parentOffset,position),this.visible=!0,this.subscribe("table-destroy",this.destroyBinding),this.element.addEventListener("mousedown",(function(e){e.stopPropagation()}))),this}},{key:"_fitToScreen",value:function(x,y,parentEl,parentOffset,position){var scrollTop=this.container===document.body?document.documentElement.scrollTop:this.container.scrollTop;if((x+this.element.offsetWidth>=this.container.offsetWidth||this.reversedX)&&(this.element.style.left="",this.element.style.right=parentEl?this.container.offsetWidth-parentOffset.left+"px":this.container.offsetWidth-x+"px",this.reversedX=!0),y+this.element.offsetHeight>Math.max(this.container.offsetHeight,scrollTop?this.container.scrollHeight:0))if(parentEl)if("bottom"===position)this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight-parentEl.offsetHeight-1+"px";else this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight+parentEl.offsetHeight+1+"px";else this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight+"px"}},{key:"isVisible",value:function(){return this.visible}},{key:"hideOnBlur",value:function(callback){var _this3=this;return this.blurable=!0,this.visible&&(setTimeout((function(){_this3.visible&&(_this3.table.rowManager.element.addEventListener("scroll",_this3.blurEvent),_this3.subscribe("cell-editing",_this3.blurEvent),document.body.addEventListener("click",_this3.blurEvent),document.body.addEventListener("contextmenu",_this3.blurEvent),document.body.addEventListener("mousedown",_this3.blurEvent),window.addEventListener("resize",_this3.blurEvent),document.body.addEventListener("keydown",_this3.escEvent),_this3.blurEventsBound=!0)}),100),this.blurCallback=callback),this}},{key:"_escapeCheck",value:function(e){27==e.keyCode&&this.hide()}},{key:"blockHide",value:function(){this.hideable=!1}},{key:"restoreHide",value:function(){this.hideable=!0}},{key:"hide",value:function(){var silent=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.visible&&this.hideable&&(this.blurable&&this.blurEventsBound&&(document.body.removeEventListener("keydown",this.escEvent),document.body.removeEventListener("click",this.blurEvent),document.body.removeEventListener("contextmenu",this.blurEvent),document.body.removeEventListener("mousedown",this.blurEvent),window.removeEventListener("resize",this.blurEvent),this.table.rowManager.element.removeEventListener("scroll",this.blurEvent),this.unsubscribe("cell-editing",this.blurEvent),this.blurEventsBound=!1),this.childPopup&&this.childPopup.hide(),this.parent&&(this.parent.childPopup=null),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.visible=!1,this.blurCallback&&!silent&&this.blurCallback(),this.unsubscribe("table-destroy",this.destroyBinding)),this}},{key:"child",value:function(element){return this.childPopup&&this.childPopup.hide(),this.childPopup=new Popup(this.table,element,this),this.childPopup}}]),Popup}(CoreFeature),Module=function(_CoreFeature2){_inherits(Module,_CoreFeature2);var _super2=_createSuper(Module);function Module(table,name){var _this4;return _classCallCheck(this,Module),(_this4=_super2.call(this,table))._handler=null,_this4}return _createClass(Module,[{key:"initialize",value:function(){}},{key:"registerTableOption",value:function(key,value){this.table.optionsList.register(key,value)}},{key:"registerColumnOption",value:function(key,value){this.table.columnManager.optionsList.register(key,value)}},{key:"registerTableFunction",value:function(name,func){var _this5=this;void 0===this.table[name]?this.table[name]=function(){return _this5.table.initGuard(name),func.apply(void 0,arguments)}:console.warn("Unable to bind table function, name already in use",name)}},{key:"registerComponentFunction",value:function(component,func,handler){return this.table.componentFunctionBinder.bind(component,func,handler)}},{key:"registerDataHandler",value:function(handler,priority){this.table.rowManager.registerDataPipelineHandler(handler,priority),this._handler=handler}},{key:"registerDisplayHandler",value:function(handler,priority){this.table.rowManager.registerDisplayPipelineHandler(handler,priority),this._handler=handler}},{key:"displayRows",value:function(adjust){var lookupIndex,_this6=this,index=this.table.rowManager.displayRows.length-1;if(this._handler&&(lookupIndex=this.table.rowManager.displayPipeline.findIndex((function(item){return item.handler===_this6._handler})))>-1&&(index=lookupIndex),adjust&&(index+=adjust),this._handler)return index>-1?this.table.rowManager.getDisplayRows(index):this.activeRows()}},{key:"activeRows",value:function(){return this.table.rowManager.activeRows}},{key:"refreshData",value:function(renderInPosition,handler){handler||(handler=this._handler),handler&&this.table.rowManager.refreshActiveData(handler,!1,renderInPosition)}},{key:"footerAppend",value:function(element){return this.table.footerManager.append(element)}},{key:"footerPrepend",value:function(element){return this.table.footerManager.prepend(element)}},{key:"footerRemove",value:function(element){return this.table.footerManager.remove(element)}},{key:"popup",value:function(menuEl,menuContainer){return new Popup(this.table,menuEl,menuContainer)}},{key:"alert",value:function(content,type){return this.table.alertManager.alert(content,type)}},{key:"clearAlert",value:function(){return this.table.alertManager.clear()}}]),Module}(CoreFeature);_exports.Module=Module;var Accessor=function(_Module){_inherits(Accessor,_Module);var _super3=_createSuper(Accessor);function Accessor(table){var _this7;return _classCallCheck(this,Accessor),(_this7=_super3.call(this,table)).allowedTypes=["","data","download","clipboard","print","htmlOutput"],_this7.registerColumnOption("accessor"),_this7.registerColumnOption("accessorParams"),_this7.registerColumnOption("accessorData"),_this7.registerColumnOption("accessorDataParams"),_this7.registerColumnOption("accessorDownload"),_this7.registerColumnOption("accessorDownloadParams"),_this7.registerColumnOption("accessorClipboard"),_this7.registerColumnOption("accessorClipboardParams"),_this7.registerColumnOption("accessorPrint"),_this7.registerColumnOption("accessorPrintParams"),_this7.registerColumnOption("accessorHtmlOutput"),_this7.registerColumnOption("accessorHtmlOutputParams"),_this7}return _createClass(Accessor,[{key:"initialize",value:function(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-retrieve",this.transformRow.bind(this))}},{key:"initializeColumn",value:function(column){var _this8=this,match=!1,config={};this.allowedTypes.forEach((function(type){var accessor,key="accessor"+(type.charAt(0).toUpperCase()+type.slice(1));column.definition[key]&&(accessor=_this8.lookupAccessor(column.definition[key]))&&(match=!0,config[key]={accessor:accessor,params:column.definition[key+"Params"]||{}})})),match&&(column.modules.accessor=config)}},{key:"lookupAccessor",value:function(value){var accessor=!1;switch(_typeof(value)){case"string":Accessor.accessors[value]?accessor=Accessor.accessors[value]:console.warn("Accessor Error - No such accessor found, ignoring: ",value);break;case"function":accessor=value}return accessor}},{key:"transformRow",value:function(row,type){var key="accessor"+(type.charAt(0).toUpperCase()+type.slice(1)),rowComponent=row.getComponent(),data=Helpers.deepClone(row.data||{});return this.table.columnManager.traverse((function(column){var value,accessor,params,colComponent;column.modules.accessor&&(accessor=column.modules.accessor[key]||column.modules.accessor.accessor||!1)&&"undefined"!=(value=column.getFieldValue(data))&&(colComponent=column.getComponent(),params="function"==typeof accessor.params?accessor.params(value,data,type,colComponent,rowComponent):accessor.params,column.setFieldValue(data,accessor.accessor(value,data,type,params,colComponent,rowComponent)))})),data}}]),Accessor}(Module);_exports.AccessorModule=Accessor,Accessor.moduleName="accessor",Accessor.accessors={};function generateParamsList(data,prefix){var output=[];if(prefix=prefix||"",Array.isArray(data))data.forEach((function(item,i){output=output.concat(generateParamsList(item,prefix?prefix+"["+i+"]":i))}));else if("object"===_typeof(data))for(var key in data)output=output.concat(generateParamsList(data[key],prefix?prefix+"["+key+"]":key));else output.push({key:prefix,value:data});return output}function serializeParams(params){var output=generateParamsList(params),encoded=[];return output.forEach((function(item){encoded.push(encodeURIComponent(item.key)+"="+encodeURIComponent(item.value))})),encoded.join("&")}function urlBuilder(url,config,params){return url&&params&&Object.keys(params).length&&(config.method&&"get"!=config.method.toLowerCase()||(config.method="get",url+=(url.includes("?")?"&":"?")+serializeParams(params))),url}function generateParamsList$1(data,prefix){var output=[];if(prefix=prefix||"",Array.isArray(data))data.forEach((function(item,i){output=output.concat(generateParamsList$1(item,prefix?prefix+"["+i+"]":i))}));else if("object"===_typeof(data))for(var key in data)output=output.concat(generateParamsList$1(data[key],prefix?prefix+"["+key+"]":key));else output.push({key:prefix,value:data});return output}var defaultContentTypeFormatters={json:{headers:{"Content-Type":"application/json"},body:function(url,config,params){return JSON.stringify(params)}},form:{headers:{},body:function(url,config,params){var output=generateParamsList$1(params),form=new FormData;return output.forEach((function(item){form.append(item.key,item.value)})),form}}},Ajax=function(_Module2){_inherits(Ajax,_Module2);var _super4=_createSuper(Ajax);function Ajax(table){var _this10;return _classCallCheck(this,Ajax),(_this10=_super4.call(this,table)).config={},_this10.url="",_this10.urlGenerator=!1,_this10.params=!1,_this10.loaderPromise=!1,_this10.registerTableOption("ajaxURL",!1),_this10.registerTableOption("ajaxURLGenerator",!1),_this10.registerTableOption("ajaxParams",{}),_this10.registerTableOption("ajaxConfig","get"),_this10.registerTableOption("ajaxContentType","form"),_this10.registerTableOption("ajaxRequestFunc",!1),_this10.registerTableOption("ajaxRequesting",(function(){})),_this10.registerTableOption("ajaxResponse",!1),_this10.contentTypeFormatters=Ajax.contentTypeFormatters,_this10}return _createClass(Ajax,[{key:"initialize",value:function(){this.loaderPromise=this.table.options.ajaxRequestFunc||Ajax.defaultLoaderPromise,this.urlGenerator=this.table.options.ajaxURLGenerator||Ajax.defaultURLGenerator,this.table.options.ajaxURL&&this.setUrl(this.table.options.ajaxURL),this.setDefaultConfig(this.table.options.ajaxConfig),this.registerTableFunction("getAjaxUrl",this.getUrl.bind(this)),this.subscribe("data-loading",this.requestDataCheck.bind(this)),this.subscribe("data-params",this.requestParams.bind(this)),this.subscribe("data-load",this.requestData.bind(this))}},{key:"requestParams",value:function(data,config,silent,params){var ajaxParams=this.table.options.ajaxParams;return ajaxParams&&("function"==typeof ajaxParams&&(ajaxParams=ajaxParams.call(this.table)),params=Object.assign(params,ajaxParams)),params}},{key:"requestDataCheck",value:function(data,params,config,silent){return!((data||!this.url)&&"string"!=typeof data)}},{key:"requestData",value:function(url,params,config,silent,previousData){var ajaxConfig;return!previousData&&this.requestDataCheck(url)?(url&&this.setUrl(url),ajaxConfig=this.generateConfig(config),this.sendRequest(this.url,params,ajaxConfig)):previousData}},{key:"setDefaultConfig",value:function(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=Object.assign({},Ajax.defaultConfig),"string"==typeof config?this.config.method=config:Object.assign(this.config,config)}},{key:"generateConfig",value:function(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},ajaxConfig=Object.assign({},this.config);return"string"==typeof config?ajaxConfig.method=config:Object.assign(ajaxConfig,config),ajaxConfig}},{key:"setUrl",value:function(url){this.url=url}},{key:"getUrl",value:function(){return this.url}},{key:"sendRequest",value:function(url,params,config){var _this11=this;return!1!==this.table.options.ajaxRequesting.call(this.table,url,params)?this.loaderPromise(url,config,params).then((function(data){return _this11.table.options.ajaxResponse&&(data=_this11.table.options.ajaxResponse.call(_this11.table,url,params,data)),data})):Promise.reject()}}]),Ajax}(Module);_exports.AjaxModule=Ajax,Ajax.moduleName="ajax",Ajax.defaultConfig={method:"GET"},Ajax.defaultURLGenerator=urlBuilder,Ajax.defaultLoaderPromise=function(url,config,params){var contentType,_this9=this;return new Promise((function(resolve,reject){if(url=_this9.urlGenerator.call(_this9.table,url,config,params),"GET"!=config.method.toUpperCase())if(contentType="object"===_typeof(_this9.table.options.ajaxContentType)?_this9.table.options.ajaxContentType:_this9.contentTypeFormatters[_this9.table.options.ajaxContentType]){for(var key in contentType.headers)config.headers||(config.headers={}),void 0===config.headers[key]&&(config.headers[key]=contentType.headers[key]);config.body=contentType.body.call(_this9,url,config,params)}else console.warn("Ajax Error - Invalid ajaxContentType value:",_this9.table.options.ajaxContentType);url?(void 0===config.headers&&(config.headers={}),void 0===config.headers.Accept&&(config.headers.Accept="application/json"),void 0===config.headers["X-Requested-With"]&&(config.headers["X-Requested-With"]="XMLHttpRequest"),void 0===config.mode&&(config.mode="cors"),"cors"==config.mode?(void 0===config.headers.Origin&&(config.headers.Origin=window.location.origin),void 0===config.credentials&&(config.credentials="same-origin")):void 0===config.credentials&&(config.credentials="include"),fetch(url,config).then((function(response){response.ok?response.json().then((function(data){resolve(data)})).catch((function(error){reject(error),console.warn("Ajax Load Error - Invalid JSON returned",error)})):(console.error("Ajax Load Error - Connection Error: "+response.status,response.statusText),reject(response))})).catch((function(error){console.error("Ajax Load Error - Connection Error: ",error),reject(error)}))):(console.warn("Ajax Load Error - No URL Set"),resolve([]))}))},Ajax.contentTypeFormatters=defaultContentTypeFormatters;var Clipboard=function(_Module3){_inherits(Clipboard,_Module3);var _super5=_createSuper(Clipboard);function Clipboard(table){var _this12;return _classCallCheck(this,Clipboard),(_this12=_super5.call(this,table)).mode=!0,_this12.pasteParser=function(){},_this12.pasteAction=function(){},_this12.customSelection=!1,_this12.rowRange=!1,_this12.blocked=!0,_this12.registerTableOption("clipboard",!1),_this12.registerTableOption("clipboardCopyStyled",!0),_this12.registerTableOption("clipboardCopyConfig",!1),_this12.registerTableOption("clipboardCopyFormatter",!1),_this12.registerTableOption("clipboardCopyRowRange","active"),_this12.registerTableOption("clipboardPasteParser","table"),_this12.registerTableOption("clipboardPasteAction","insert"),_this12.registerColumnOption("clipboard"),_this12.registerColumnOption("titleClipboard"),_this12}return _createClass(Clipboard,[{key:"initialize",value:function(){var _this13=this;this.mode=this.table.options.clipboard,this.rowRange=this.table.options.clipboardCopyRowRange,!0!==this.mode&&"copy"!==this.mode||this.table.element.addEventListener("copy",(function(e){var plain,html,list;_this13.blocked||(e.preventDefault(),_this13.customSelection?(plain=_this13.customSelection,_this13.table.options.clipboardCopyFormatter&&(plain=_this13.table.options.clipboardCopyFormatter("plain",plain))):(list=_this13.table.modules.export.generateExportList(_this13.table.options.clipboardCopyConfig,_this13.table.options.clipboardCopyStyled,_this13.rowRange,"clipboard"),plain=(html=_this13.table.modules.export.generateHTMLTable(list))?_this13.generatePlainContent(list):"",_this13.table.options.clipboardCopyFormatter&&(plain=_this13.table.options.clipboardCopyFormatter("plain",plain),html=_this13.table.options.clipboardCopyFormatter("html",html))),window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",plain):e.clipboardData&&e.clipboardData.setData?(e.clipboardData.setData("text/plain",plain),html&&e.clipboardData.setData("text/html",html)):e.originalEvent&&e.originalEvent.clipboardData.setData&&(e.originalEvent.clipboardData.setData("text/plain",plain),html&&e.originalEvent.clipboardData.setData("text/html",html)),_this13.dispatchExternal("clipboardCopied",plain,html),_this13.reset())})),!0!==this.mode&&"paste"!==this.mode||this.table.element.addEventListener("paste",(function(e){_this13.paste(e)})),this.setPasteParser(this.table.options.clipboardPasteParser),this.setPasteAction(this.table.options.clipboardPasteAction),this.registerTableFunction("copyToClipboard",this.copy.bind(this))}},{key:"reset",value:function(){this.blocked=!0,this.customSelection=!1}},{key:"generatePlainContent",value:function(list){var output=[];return list.forEach((function(row){var rowData=[];row.columns.forEach((function(col){var value="";if(col)if("group"===row.type&&(col.value=col.component.getKey()),null===col.value)value="";else switch(_typeof(col.value)){case"object":value=JSON.stringify(col.value);break;case"undefined":value="";break;default:value=col.value}rowData.push(value)})),output.push(rowData.join("\t"))})),output.join("\n")}},{key:"copy",value:function(range,internal){var sel,textRange;this.blocked=!1,this.customSelection=!1,!0!==this.mode&&"copy"!==this.mode||(this.rowRange=range||this.table.options.clipboardCopyRowRange,void 0!==window.getSelection&&void 0!==document.createRange?((range=document.createRange()).selectNodeContents(this.table.element),(sel=window.getSelection()).toString()&&internal&&(this.customSelection=sel.toString()),sel.removeAllRanges(),sel.addRange(range)):void 0!==document.selection&&void 0!==document.body.createTextRange&&((textRange=document.body.createTextRange()).moveToElementText(this.table.element),textRange.select()),document.execCommand("copy"),sel&&sel.removeAllRanges())}},{key:"setPasteAction",value:function(action){switch(_typeof(action)){case"string":this.pasteAction=Clipboard.pasteActions[action],this.pasteAction||console.warn("Clipboard Error - No such paste action found:",action);break;case"function":this.pasteAction=action}}},{key:"setPasteParser",value:function(parser){switch(_typeof(parser)){case"string":this.pasteParser=Clipboard.pasteParsers[parser],this.pasteParser||console.warn("Clipboard Error - No such paste parser found:",parser);break;case"function":this.pasteParser=parser}}},{key:"paste",value:function(e){var data,rowData,rows;this.checkPaseOrigin(e)&&(data=this.getPasteData(e),(rowData=this.pasteParser.call(this,data))?(e.preventDefault(),this.table.modExists("mutator")&&(rowData=this.mutateData(rowData)),rows=this.pasteAction.call(this,rowData),this.dispatchExternal("clipboardPasted",data,rowData,rows)):this.dispatchExternal("clipboardPasteError",data))}},{key:"mutateData",value:function(data){var _this14=this,output=[];return Array.isArray(data)?data.forEach((function(row){output.push(_this14.table.modules.mutator.transformRow(row,"clipboard"))})):output=data,output}},{key:"checkPaseOrigin",value:function(e){var valid=!0;return("DIV"!=e.target.tagName||this.table.modules.edit.currentCell)&&(valid=!1),valid}},{key:"getPasteData",value:function(e){var data;return window.clipboardData&&window.clipboardData.getData?data=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?data=e.clipboardData.getData("text/plain"):e.originalEvent&&e.originalEvent.clipboardData.getData&&(data=e.originalEvent.clipboardData.getData("text/plain")),data}}]),Clipboard}(Module);_exports.ClipboardModule=Clipboard,Clipboard.moduleName="clipboard",Clipboard.pasteActions={replace:function(rows){return this.table.setData(rows)},update:function(rows){return this.table.updateOrAddData(rows)},insert:function(rows){return this.table.addData(rows)}},Clipboard.pasteParsers={table:function(clipboard){var data=[],headerFindSuccess=!0,columns=this.table.columnManager.columns,columnMap=[],rows=[];return(clipboard=clipboard.split("\n")).forEach((function(row){data.push(row.split("\t"))})),!(!data.length||1===data.length&&data[0].length<2)&&(data[0].forEach((function(value){var column=columns.find((function(column){return value&&column.definition.title&&value.trim()&&column.definition.title.trim()===value.trim()}));column?columnMap.push(column):headerFindSuccess=!1})),headerFindSuccess||(headerFindSuccess=!0,columnMap=[],data[0].forEach((function(value){var column=columns.find((function(column){return value&&column.field&&value.trim()&&column.field.trim()===value.trim()}));column?columnMap.push(column):headerFindSuccess=!1})),headerFindSuccess||(columnMap=this.table.columnManager.columnsByIndex)),headerFindSuccess&&data.shift(),data.forEach((function(item){var row={};item.forEach((function(value,i){columnMap[i]&&(row[columnMap[i].field]=value)})),rows.push(row)})),rows)}};var CalcComponent=function(){function CalcComponent(row){return _classCallCheck(this,CalcComponent),this._row=row,new Proxy(this,{get:function(target,name,receiver){return void 0!==target[name]?target[name]:target._row.table.componentFunctionBinder.handle("row",target._row,name)}})}return _createClass(CalcComponent,[{key:"getData",value:function(transform){return this._row.getData(transform)}},{key:"getElement",value:function(){return this._row.getElement()}},{key:"getTable",value:function(){return this._row.table}},{key:"getCells",value:function(){var cells=[];return this._row.getCells().forEach((function(cell){cells.push(cell.getComponent())})),cells}},{key:"getCell",value:function(column){var cell=this._row.getCell(column);return!!cell&&cell.getComponent()}},{key:"_getSelf",value:function(){return this._row}}]),CalcComponent}();_exports.CalcComponent=CalcComponent;var CellComponent=function(){function CellComponent(cell){return _classCallCheck(this,CellComponent),this._cell=cell,new Proxy(this,{get:function(target,name,receiver){return void 0!==target[name]?target[name]:target._cell.table.componentFunctionBinder.handle("cell",target._cell,name)}})}return _createClass(CellComponent,[{key:"getValue",value:function(){return this._cell.getValue()}},{key:"getOldValue",value:function(){return this._cell.getOldValue()}},{key:"getInitialValue",value:function(){return this._cell.initialValue}},{key:"getElement",value:function(){return this._cell.getElement()}},{key:"getRow",value:function(){return this._cell.row.getComponent()}},{key:"getData",value:function(){return this._cell.row.getData()}},{key:"getField",value:function(){return this._cell.column.getField()}},{key:"getColumn",value:function(){return this._cell.column.getComponent()}},{key:"setValue",value:function(value,mutate){void 0===mutate&&(mutate=!0),this._cell.setValue(value,mutate)}},{key:"restoreOldValue",value:function(){this._cell.setValueActual(this._cell.getOldValue())}},{key:"restoreInitialValue",value:function(){this._cell.setValueActual(this._cell.initialValue)}},{key:"checkHeight",value:function(){this._cell.checkHeight()}},{key:"getTable",value:function(){return this._cell.table}},{key:"_getSelf",value:function(){return this._cell}}]),CellComponent}();_exports.CellComponent=CellComponent;var Cell=function(_CoreFeature3){_inherits(Cell,_CoreFeature3);var _super6=_createSuper(Cell);function Cell(column,row){var _this15;return _classCallCheck(this,Cell),(_this15=_super6.call(this,column.table)).table=column.table,_this15.column=column,_this15.row=row,_this15.element=null,_this15.value=null,_this15.initialValue,_this15.oldValue=null,_this15.modules={},_this15.height=null,_this15.width=null,_this15.minWidth=null,_this15.component=null,_this15.loaded=!1,_this15.build(),_this15}return _createClass(Cell,[{key:"build",value:function(){this.generateElement(),this.setWidth(),this._configureCell(),this.setValueActual(this.column.getFieldValue(this.row.data)),this.initialValue=this.value}},{key:"generateElement",value:function(){this.element=document.createElement("div"),this.element.className="tabulator-cell",this.element.setAttribute("role","gridcell")}},{key:"_configureCell",value:function(){var element=this.element,field=this.column.getField();(element.style.textAlign=this.column.hozAlign,this.column.vertAlign&&(element.style.display="inline-flex",element.style.alignItems={top:"flex-start",bottom:"flex-end",middle:"center"}[this.column.vertAlign]||"",this.column.hozAlign&&(element.style.justifyContent={left:"flex-start",right:"flex-end",center:"center"}[this.column.hozAlign]||"")),field&&element.setAttribute("tabulator-field",field),this.column.definition.cssClass)&&this.column.definition.cssClass.split(" ").forEach((function(className){element.classList.add(className)}));this.dispatch("cell-init",this),this.column.visible||this.hide()}},{key:"_generateContents",value:function(){var val,_this16=this;switch(_typeof(val=this.chain("cell-format",this,null,(function(){return _this16.element.innerHTML=_this16.value})))){case"object":if(val instanceof Node){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(val)}else this.element.innerHTML="",null!=val&&console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",val);break;case"undefined":this.element.innerHTML="";break;default:this.element.innerHTML=val}}},{key:"cellRendered",value:function(){this.dispatch("cell-rendered",this)}},{key:"getElement",value:function(containerOnly){return this.loaded||(this.loaded=!0,containerOnly||this.layoutElement()),this.element}},{key:"getValue",value:function(){return this.value}},{key:"getOldValue",value:function(){return this.oldValue}},{key:"setValue",value:function(value,mutate,force){this.setValueProcessData(value,mutate,force)&&(this.dispatch("cell-value-updated",this),this.cellRendered(),this.column.definition.cellEdited&&this.column.definition.cellEdited.call(this.table,this.getComponent()),this.dispatchExternal("cellEdited",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()))}},{key:"setValueProcessData",value:function(value,mutate,force){var changed=!1;return(this.value!==value||force)&&(changed=!0,mutate&&(value=this.chain("cell-value-changing",[this,value],null,value))),this.setValueActual(value),changed&&this.dispatch("cell-value-changed",this),changed}},{key:"setValueActual",value:function(value){this.oldValue=this.value,this.value=value,this.dispatch("cell-value-save-before",this),this.column.setFieldValue(this.row.data,value),this.dispatch("cell-value-save-after",this),this.loaded&&this.layoutElement()}},{key:"layoutElement",value:function(){this._generateContents(),this.dispatch("cell-layout",this)}},{key:"setWidth",value:function(){this.width=this.column.width,this.element.style.width=this.column.widthStyled}},{key:"clearWidth",value:function(){this.width="",this.element.style.width=""}},{key:"getWidth",value:function(){return this.width||this.element.offsetWidth}},{key:"setMinWidth",value:function(){this.minWidth=this.column.minWidth,this.element.style.minWidth=this.column.minWidthStyled}},{key:"setMaxWidth",value:function(){this.maxWidth=this.column.maxWidth,this.element.style.maxWidth=this.column.maxWidthStyled}},{key:"checkHeight",value:function(){this.row.reinitializeHeight()}},{key:"clearHeight",value:function(){this.element.style.height="",this.height=null,this.dispatch("cell-height",this,"")}},{key:"setHeight",value:function(){this.height=this.row.height,this.element.style.height=this.row.heightStyled,this.dispatch("cell-height",this,this.row.heightStyled)}},{key:"getHeight",value:function(){return this.height||this.element.offsetHeight}},{key:"show",value:function(){this.element.style.display=this.column.vertAlign?"inline-flex":""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"delete",value:function(){this.dispatch("cell-delete",this),!this.table.rowManager.redrawBlock&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.column.deleteCell(this),this.row.deleteCell(this),this.calcs={}}},{key:"getIndex",value:function(){return this.row.getCellIndex(this)}},{key:"getComponent",value:function(){return this.component||(this.component=new CellComponent(this)),this.component}}]),Cell}(CoreFeature),ColumnComponent=function(){function ColumnComponent(column){return _classCallCheck(this,ColumnComponent),this._column=column,this.type="ColumnComponent",new Proxy(this,{get:function(target,name,receiver){return void 0!==target[name]?target[name]:target._column.table.componentFunctionBinder.handle("column",target._column,name)}})}return _createClass(ColumnComponent,[{key:"getElement",value:function(){return this._column.getElement()}},{key:"getDefinition",value:function(){return this._column.getDefinition()}},{key:"getField",value:function(){return this._column.getField()}},{key:"getTitleDownload",value:function(){return this._column.getTitleDownload()}},{key:"getCells",value:function(){var cells=[];return this._column.cells.forEach((function(cell){cells.push(cell.getComponent())})),cells}},{key:"isVisible",value:function(){return this._column.visible}},{key:"show",value:function(){this._column.isGroup?this._column.columns.forEach((function(column){column.show()})):this._column.show()}},{key:"hide",value:function(){this._column.isGroup?this._column.columns.forEach((function(column){column.hide()})):this._column.hide()}},{key:"toggle",value:function(){this._column.visible?this.hide():this.show()}},{key:"delete",value:function(){return this._column.delete()}},{key:"getSubColumns",value:function(){var output=[];return this._column.columns.length&&this._column.columns.forEach((function(column){output.push(column.getComponent())})),output}},{key:"getParentColumn",value:function(){return this._column.parent instanceof Column&&this._column.parent.getComponent()}},{key:"_getSelf",value:function(){return this._column}},{key:"scrollTo",value:function(){return this._column.table.columnManager.scrollToColumn(this._column)}},{key:"getTable",value:function(){return this._column.table}},{key:"move",value:function(to,after){var toColumn=this._column.table.columnManager.findColumn(to);toColumn?this._column.table.columnManager.moveColumn(this._column,toColumn,after):console.warn("Move Error - No matching column found:",toColumn)}},{key:"getNextColumn",value:function(){var nextCol=this._column.nextColumn();return!!nextCol&&nextCol.getComponent()}},{key:"getPrevColumn",value:function(){var prevCol=this._column.prevColumn();return!!prevCol&&prevCol.getComponent()}},{key:"updateDefinition",value:function(updates){return this._column.updateDefinition(updates)}},{key:"getWidth",value:function(){return this._column.getWidth()}},{key:"setWidth",value:function(width){var result;return result=!0===width?this._column.reinitializeWidth(!0):this._column.setWidth(width),this._column.table.columnManager.rerenderColumns(!0),result}}]),ColumnComponent}();_exports.ColumnComponent=ColumnComponent;var defaultColumnOptions={title:void 0,field:void 0,columns:void 0,visible:void 0,hozAlign:void 0,vertAlign:void 0,width:void 0,minWidth:40,maxWidth:void 0,maxInitialWidth:void 0,cssClass:void 0,variableHeight:void 0,headerVertical:void 0,headerHozAlign:void 0,headerWordWrap:!1,editableTitle:void 0},Column=function(_CoreFeature4){_inherits(Column,_CoreFeature4);var _super7=_createSuper(Column);function Column(def,parent){var _this17;return _classCallCheck(this,Column),(_this17=_super7.call(this,parent.table)).definition=def,_this17.parent=parent,_this17.type="column",_this17.columns=[],_this17.cells=[],_this17.element=_this17.createElement(),_this17.contentElement=!1,_this17.titleHolderElement=!1,_this17.titleElement=!1,_this17.groupElement=_this17.createGroupElement(),_this17.isGroup=!1,_this17.hozAlign="",_this17.vertAlign="",_this17.field="",_this17.fieldStructure="",_this17.getFieldValue="",_this17.setFieldValue="",_this17.titleDownload=null,_this17.titleFormatterRendered=!1,_this17.mapDefinitions(),_this17.setField(_this17.definition.field),_this17.modules={},_this17.width=null,_this17.widthStyled="",_this17.maxWidth=null,_this17.maxWidthStyled="",_this17.maxInitialWidth=null,_this17.minWidth=null,_this17.minWidthStyled="",_this17.widthFixed=!1,_this17.visible=!0,_this17.component=null,_this17.definition.columns?(_this17.isGroup=!0,_this17.definition.columns.forEach((function(def,i){var newCol=new Column(def,_assertThisInitialized(_this17));_this17.attachColumn(newCol)})),_this17.checkColumnVisibility()):parent.registerColumnField(_assertThisInitialized(_this17)),_this17._initialize(),_this17}return _createClass(Column,[{key:"createElement",value:function(){var el=document.createElement("div");switch(el.classList.add("tabulator-col"),el.setAttribute("role","columnheader"),el.setAttribute("aria-sort","none"),this.table.options.columnHeaderVertAlign){case"middle":el.style.justifyContent="center";break;case"bottom":el.style.justifyContent="flex-end"}return el}},{key:"createGroupElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-col-group-cols"),el}},{key:"mapDefinitions",value:function(){var defaults=this.table.options.columnDefaults;if(defaults)for(var key in defaults)void 0===this.definition[key]&&(this.definition[key]=defaults[key]);this.definition=this.table.columnManager.optionsList.generate(Column.defaultOptionList,this.definition)}},{key:"checkDefinition",value:function(){var _this18=this;Object.keys(this.definition).forEach((function(key){-1===Column.defaultOptionList.indexOf(key)&&console.warn("Invalid column definition option in '"+(_this18.field||_this18.definition.title)+"' column:",key)}))}},{key:"setField",value:function(field){this.field=field,this.fieldStructure=field?this.table.options.nestedFieldSeparator?field.split(this.table.options.nestedFieldSeparator):[field]:[],this.getFieldValue=this.fieldStructure.length>1?this._getNestedData:this._getFlatData,this.setFieldValue=this.fieldStructure.length>1?this._setNestedData:this._setFlatData}},{key:"registerColumnPosition",value:function(column){this.parent.registerColumnPosition(column)}},{key:"registerColumnField",value:function(column){this.parent.registerColumnField(column)}},{key:"reRegisterPosition",value:function(){this.isGroup?this.columns.forEach((function(column){column.reRegisterPosition()})):this.registerColumnPosition(this)}},{key:"_initialize",value:function(){for(var def=this.definition;this.element.firstChild;)this.element.removeChild(this.element.firstChild);def.headerVertical&&(this.element.classList.add("tabulator-col-vertical"),"flip"===def.headerVertical&&this.element.classList.add("tabulator-col-vertical-flip")),this.contentElement=this._buildColumnHeaderContent(),this.element.appendChild(this.contentElement),this.isGroup?this._buildGroupHeader():this._buildColumnHeader(),this.dispatch("column-init",this)}},{key:"_buildColumnHeader",value:function(){var _this19=this,def=this.definition;(this.dispatch("column-layout",this),void 0!==def.visible&&(def.visible?this.show(!0):this.hide(!0)),def.cssClass)&&def.cssClass.split(" ").forEach((function(className){_this19.element.classList.add(className)}));def.field&&this.element.setAttribute("tabulator-field",def.field),this.setMinWidth(parseInt(def.minWidth)),def.maxInitialWidth&&(this.maxInitialWidth=parseInt(def.maxInitialWidth)),def.maxWidth&&this.setMaxWidth(parseInt(def.maxWidth)),this.reinitializeWidth(),this.hozAlign=this.definition.hozAlign,this.vertAlign=this.definition.vertAlign,this.titleElement.style.textAlign=this.definition.headerHozAlign}},{key:"_buildColumnHeaderContent",value:function(){var contentElement=document.createElement("div");return contentElement.classList.add("tabulator-col-content"),this.titleHolderElement=document.createElement("div"),this.titleHolderElement.classList.add("tabulator-col-title-holder"),contentElement.appendChild(this.titleHolderElement),this.titleElement=this._buildColumnHeaderTitle(),this.titleHolderElement.appendChild(this.titleElement),contentElement}},{key:"_buildColumnHeaderTitle",value:function(){var _this20=this,def=this.definition,titleHolderElement=document.createElement("div");if(titleHolderElement.classList.add("tabulator-col-title"),def.headerWordWrap&&titleHolderElement.classList.add("tabulator-col-title-wrap"),def.editableTitle){var titleElement=document.createElement("input");titleElement.classList.add("tabulator-title-editor"),titleElement.addEventListener("click",(function(e){e.stopPropagation(),titleElement.focus()})),titleElement.addEventListener("change",(function(){def.title=titleElement.value,_this20.dispatchExternal("columnTitleChanged",_this20.getComponent())})),titleHolderElement.appendChild(titleElement),def.field?this.langBind("columns|"+def.field,(function(text){titleElement.value=text||def.title||"&nbsp;"})):titleElement.value=def.title||"&nbsp;"}else def.field?this.langBind("columns|"+def.field,(function(text){_this20._formatColumnHeaderTitle(titleHolderElement,text||def.title||"&nbsp;")})):this._formatColumnHeaderTitle(titleHolderElement,def.title||"&nbsp;");return titleHolderElement}},{key:"_formatColumnHeaderTitle",value:function(el,title){var contents=this.chain("column-format",[this,title,el],null,(function(){return title}));switch(_typeof(contents)){case"object":contents instanceof Node?el.appendChild(contents):(el.innerHTML="",console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",contents));break;case"undefined":el.innerHTML="";break;default:el.innerHTML=contents}}},{key:"_buildGroupHeader",value:function(){var _this21=this;(this.element.classList.add("tabulator-col-group"),this.element.setAttribute("role","columngroup"),this.element.setAttribute("aria-title",this.definition.title),this.definition.cssClass)&&this.definition.cssClass.split(" ").forEach((function(className){_this21.element.classList.add(className)}));this.titleElement.style.textAlign=this.definition.headerHozAlign,this.element.appendChild(this.groupElement)}},{key:"_getFlatData",value:function(data){return data[this.field]}},{key:"_getNestedData",value:function(data){for(var output,dataObj=data,structure=this.fieldStructure,length=structure.length,i=0;i<length&&(output=dataObj=dataObj[structure[i]],dataObj);i++);return output}},{key:"_setFlatData",value:function(data,value){this.field&&(data[this.field]=value)}},{key:"_setNestedData",value:function(data,value){for(var dataObj=data,structure=this.fieldStructure,length=structure.length,i=0;i<length;i++)if(i==length-1)dataObj[structure[i]]=value;else{if(!dataObj[structure[i]]){if(void 0===value)break;dataObj[structure[i]]={}}dataObj=dataObj[structure[i]]}}},{key:"attachColumn",value:function(column){this.groupElement?(this.columns.push(column),this.groupElement.appendChild(column.getElement()),column.columnRendered()):console.warn("Column Warning - Column being attached to another column instead of column group")}},{key:"verticalAlign",value:function(alignment,height){var parentHeight=this.parent.isGroup?this.parent.getGroupElement().clientHeight:height||this.parent.getHeadersElement().clientHeight;this.element.style.height=parentHeight+"px",this.dispatch("column-height",this,this.element.style.height),this.isGroup&&(this.groupElement.style.minHeight=parentHeight-this.contentElement.offsetHeight+"px"),this.columns.forEach((function(column){column.verticalAlign(alignment)}))}},{key:"clearVerticalAlign",value:function(){this.element.style.paddingTop="",this.element.style.height="",this.element.style.minHeight="",this.groupElement.style.minHeight="",this.columns.forEach((function(column){column.clearVerticalAlign()})),this.dispatch("column-height",this,"")}},{key:"getElement",value:function(){return this.element}},{key:"getGroupElement",value:function(){return this.groupElement}},{key:"getField",value:function(){return this.field}},{key:"getTitleDownload",value:function(){return this.titleDownload}},{key:"getFirstColumn",value:function(){return this.isGroup?!!this.columns.length&&this.columns[0].getFirstColumn():this}},{key:"getLastColumn",value:function(){return this.isGroup?!!this.columns.length&&this.columns[this.columns.length-1].getLastColumn():this}},{key:"getColumns",value:function(traverse){var columns=[];return traverse?this.columns.forEach((function(column){columns.push(column),columns=columns.concat(column.getColumns(!0))})):columns=this.columns,columns}},{key:"getCells",value:function(){return this.cells}},{key:"getTopColumn",value:function(){return this.parent.isGroup?this.parent.getTopColumn():this}},{key:"getDefinition",value:function(updateBranches){var colDefs=[];return this.isGroup&&updateBranches&&(this.columns.forEach((function(column){colDefs.push(column.getDefinition(!0))})),this.definition.columns=colDefs),this.definition}},{key:"checkColumnVisibility",value:function(){var visible=!1;this.columns.forEach((function(column){column.visible&&(visible=!0)})),visible?(this.show(),this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1)):this.hide()}},{key:"show",value:function(silent,responsiveToggle){this.visible||(this.visible=!0,this.element.style.display="",this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach((function(cell){cell.show()})),this.isGroup||null!==this.width||this.reinitializeWidth(),this.table.columnManager.verticalAlignHeaders(),this.dispatch("column-show",this,responsiveToggle),silent||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!0),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}},{key:"hide",value:function(silent,responsiveToggle){this.visible&&(this.visible=!1,this.element.style.display="none",this.table.columnManager.verticalAlignHeaders(),this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach((function(cell){cell.hide()})),this.dispatch("column-hide",this,responsiveToggle),silent||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}},{key:"matchChildWidths",value:function(){var childWidth=0;this.contentElement&&this.columns.length&&(this.columns.forEach((function(column){column.visible&&(childWidth+=column.getWidth())})),this.contentElement.style.maxWidth=childWidth-1+"px",this.parent.isGroup&&this.parent.matchChildWidths())}},{key:"removeChild",value:function(child){var index=this.columns.indexOf(child);index>-1&&this.columns.splice(index,1),this.columns.length||this.delete()}},{key:"setWidth",value:function(width){this.widthFixed=!0,this.setWidthActual(width)}},{key:"setWidthActual",value:function(width){isNaN(width)&&(width=Math.floor(this.table.element.clientWidth/100*parseInt(width))),width=Math.max(this.minWidth,width),this.maxWidth&&(width=Math.min(this.maxWidth,width)),this.width=width,this.widthStyled=width?width+"px":"",this.element.style.width=this.widthStyled,this.isGroup||this.cells.forEach((function(cell){cell.setWidth()})),this.parent.isGroup&&this.parent.matchChildWidths(),this.dispatch("column-width",this)}},{key:"checkCellHeights",value:function(){var rows=[];this.cells.forEach((function(cell){cell.row.heightInitialized&&(null!==cell.row.getElement().offsetParent?(rows.push(cell.row),cell.row.clearCellHeight()):cell.row.heightInitialized=!1)})),rows.forEach((function(row){row.calcHeight()})),rows.forEach((function(row){row.setCellHeight()}))}},{key:"getWidth",value:function(){var width=0;return this.isGroup?this.columns.forEach((function(column){column.visible&&(width+=column.getWidth())})):width=this.width,width}},{key:"getLeftOffset",value:function(){var offset=this.element.offsetLeft;return this.parent.isGroup&&(offset+=this.parent.getLeftOffset()),offset}},{key:"getHeight",value:function(){return Math.ceil(this.element.getBoundingClientRect().height)}},{key:"setMinWidth",value:function(minWidth){this.maxWidth&&minWidth>this.maxWidth&&(minWidth=this.maxWidth,console.warn("the minWidth ("+minWidth+"px) for column '"+this.field+"' cannot be bigger that its maxWidth ("+this.maxWidthStyled+")")),this.minWidth=minWidth,this.minWidthStyled=minWidth?minWidth+"px":"",this.element.style.minWidth=this.minWidthStyled,this.cells.forEach((function(cell){cell.setMinWidth()}))}},{key:"setMaxWidth",value:function(maxWidth){this.minWidth&&maxWidth<this.minWidth&&(maxWidth=this.minWidth,console.warn("the maxWidth ("+maxWidth+"px) for column '"+this.field+"' cannot be smaller that its minWidth ("+this.minWidthStyled+")")),this.maxWidth=maxWidth,this.maxWidthStyled=maxWidth?maxWidth+"px":"",this.element.style.maxWidth=this.maxWidthStyled,this.cells.forEach((function(cell){cell.setMaxWidth()}))}},{key:"delete",value:function(){var _this22=this;return new Promise((function(resolve,reject){_this22.isGroup&&_this22.columns.forEach((function(column){column.delete()})),_this22.dispatch("column-delete",_this22);for(var cellCount=_this22.cells.length,i=0;i<cellCount;i++)_this22.cells[0].delete();_this22.element.parentNode&&_this22.element.parentNode.removeChild(_this22.element),_this22.element=!1,_this22.contentElement=!1,_this22.titleElement=!1,_this22.groupElement=!1,_this22.parent.isGroup&&_this22.parent.removeChild(_this22),_this22.table.columnManager.deregisterColumn(_this22),_this22.table.columnManager.rerenderColumns(!0),resolve()}))}},{key:"columnRendered",value:function(){this.titleFormatterRendered&&this.titleFormatterRendered(),this.dispatch("column-rendered",this)}},{key:"generateCell",value:function(row){var cell=new Cell(this,row);return this.cells.push(cell),cell}},{key:"nextColumn",value:function(){var index=this.table.columnManager.findColumnIndex(this);return index>-1&&this._nextVisibleColumn(index+1)}},{key:"_nextVisibleColumn",value:function(index){var column=this.table.columnManager.getColumnByIndex(index);return!column||column.visible?column:this._nextVisibleColumn(index+1)}},{key:"prevColumn",value:function(){var index=this.table.columnManager.findColumnIndex(this);return index>-1&&this._prevVisibleColumn(index-1)}},{key:"_prevVisibleColumn",value:function(index){var column=this.table.columnManager.getColumnByIndex(index);return!column||column.visible?column:this._prevVisibleColumn(index-1)}},{key:"reinitializeWidth",value:function(force){this.widthFixed=!1,void 0===this.definition.width||force||this.setWidth(this.definition.width),this.dispatch("column-width-fit-before",this),this.fitToData(force),this.dispatch("column-width-fit-after",this)}},{key:"fitToData",value:function(force){if(!this.isGroup){this.widthFixed||(this.element.style.width="",this.cells.forEach((function(cell){cell.clearWidth()})));var maxWidth=this.element.offsetWidth;if((!this.width||!this.widthFixed)&&(this.cells.forEach((function(cell){var width=cell.getWidth();width>maxWidth&&(maxWidth=width)})),maxWidth)){var setTo=maxWidth+1;this.maxInitialWidth&&!force&&(setTo=Math.min(setTo,this.maxInitialWidth)),this.setWidthActual(setTo)}}}},{key:"updateDefinition",value:function(updates){var definition,_this23=this;return this.isGroup||this.parent.isGroup?(console.error("Column Update Error - The updateDefinition function is only available on ungrouped columns"),Promise.reject("Column Update Error - The updateDefinition function is only available on columns, not column groups")):(definition=Object.assign({},this.getDefinition()),definition=Object.assign(definition,updates),this.table.columnManager.addColumn(definition,!1,this).then((function(column){return definition.field==_this23.field&&(_this23.field=!1),_this23.delete().then((function(){return column.getComponent()}))})))}},{key:"deleteCell",value:function(cell){var index=this.cells.indexOf(cell);index>-1&&this.cells.splice(index,1)}},{key:"getComponent",value:function(){return this.component||(this.component=new ColumnComponent(this)),this.component}}]),Column}(CoreFeature);Column.defaultOptionList=defaultColumnOptions;var RowComponent=function(){function RowComponent(row){return _classCallCheck(this,RowComponent),this._row=row,new Proxy(this,{get:function(target,name,receiver){return void 0!==target[name]?target[name]:target._row.table.componentFunctionBinder.handle("row",target._row,name)}})}return _createClass(RowComponent,[{key:"getData",value:function(transform){return this._row.getData(transform)}},{key:"getElement",value:function(){return this._row.getElement()}},{key:"getCells",value:function(){var cells=[];return this._row.getCells().forEach((function(cell){cells.push(cell.getComponent())})),cells}},{key:"getCell",value:function(column){var cell=this._row.getCell(column);return!!cell&&cell.getComponent()}},{key:"getIndex",value:function(){return this._row.getData("data")[this._row.table.options.index]}},{key:"getPosition",value:function(){return this._row.getPosition()}},{key:"watchPosition",value:function(callback){return this._row.watchPosition(callback)}},{key:"delete",value:function(){return this._row.delete()}},{key:"scrollTo",value:function(){return this._row.table.rowManager.scrollToRow(this._row)}},{key:"move",value:function(to,after){this._row.moveToRow(to,after)}},{key:"update",value:function(data){return this._row.updateData(data)}},{key:"normalizeHeight",value:function(){this._row.normalizeHeight(!0)}},{key:"_getSelf",value:function(){return this._row}},{key:"reformat",value:function(){return this._row.reinitialize()}},{key:"getTable",value:function(){return this._row.table}},{key:"getNextRow",value:function(){var row=this._row.nextRow();return row?row.getComponent():row}},{key:"getPrevRow",value:function(){var row=this._row.prevRow();return row?row.getComponent():row}}]),RowComponent}();_exports.RowComponent=RowComponent;var Row=function(_CoreFeature5){_inherits(Row,_CoreFeature5);var _super8=_createSuper(Row);function Row(data,parent){var _this24,type=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"row";return _classCallCheck(this,Row),(_this24=_super8.call(this,parent.table)).parent=parent,_this24.data={},_this24.type=type,_this24.element=!1,_this24.modules={},_this24.cells=[],_this24.height=0,_this24.heightStyled="",_this24.manualHeight=!1,_this24.outerHeight=0,_this24.initialized=!1,_this24.heightInitialized=!1,_this24.position=0,_this24.positionWatchers=[],_this24.component=null,_this24.created=!1,_this24.setData(data),_this24}return _createClass(Row,[{key:"create",value:function(){this.created||(this.created=!0,this.generateElement())}},{key:"createElement",value:function(){var el=document.createElement("div");el.classList.add("tabulator-row"),el.setAttribute("role","row"),this.element=el}},{key:"getElement",value:function(){return this.create(),this.element}},{key:"detachElement",value:function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}},{key:"generateElement",value:function(){this.createElement(),this.dispatch("row-init",this)}},{key:"generateCells",value:function(){this.cells=this.table.columnManager.generateCells(this)}},{key:"initialize",value:function(force){if(this.create(),!this.initialized||force){for(this.deleteCells();this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.dispatch("row-layout-before",this),this.generateCells(),this.initialized=!0,this.table.columnManager.renderer.renderRowCells(this),force&&this.normalizeHeight(),this.dispatch("row-layout",this),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent()),this.dispatch("row-layout-after",this)}else this.table.columnManager.renderer.rerenderRowCells(this)}},{key:"reinitializeHeight",value:function(){this.heightInitialized=!1,this.element&&null!==this.element.offsetParent&&this.normalizeHeight(!0)}},{key:"deinitialize",value:function(){this.initialized=!1}},{key:"deinitializeHeight",value:function(){this.heightInitialized=!1}},{key:"reinitialize",value:function(children){this.initialized=!1,this.heightInitialized=!1,this.manualHeight||(this.height=0,this.heightStyled=""),this.element&&null!==this.element.offsetParent&&this.initialize(!0),this.dispatch("row-relayout",this)}},{key:"calcHeight",value:function(force){var minHeight,maxHeight=0;this.table.options.rowHeight?this.height=this.table.options.rowHeight:(minHeight=this.table.options.resizableRows?this.element.clientHeight:0,this.cells.forEach((function(cell){var height=cell.getHeight();height>maxHeight&&(maxHeight=height)})),this.height=force?Math.max(maxHeight,minHeight):this.manualHeight?this.height:Math.max(maxHeight,minHeight)),this.heightStyled=this.height?this.height+"px":"",this.outerHeight=this.element.offsetHeight}},{key:"setCellHeight",value:function(){this.cells.forEach((function(cell){cell.setHeight()})),this.heightInitialized=!0}},{key:"clearCellHeight",value:function(){this.cells.forEach((function(cell){cell.clearHeight()}))}},{key:"normalizeHeight",value:function(force){force&&!this.table.options.rowHeight&&this.clearCellHeight(),this.calcHeight(force),this.setCellHeight()}},{key:"setHeight",value:function(height,force){(this.height!=height||force)&&(this.manualHeight=!0,this.height=height,this.heightStyled=height?height+"px":"",this.setCellHeight(),this.outerHeight=this.element.offsetHeight)}},{key:"getHeight",value:function(){return this.outerHeight}},{key:"getWidth",value:function(){return this.element.offsetWidth}},{key:"deleteCell",value:function(cell){var index=this.cells.indexOf(cell);index>-1&&this.cells.splice(index,1)}},{key:"setData",value:function(data){this.data=this.chain("row-data-init-before",[this,data],void 0,data),this.dispatch("row-data-init-after",this)}},{key:"updateData",value:function(updatedData){var newRowData,_this25=this,visible=this.element&&Helpers.elVisible(this.element),tempData={};return new Promise((function(resolve,reject){for(var attrname in"string"==typeof updatedData&&(updatedData=JSON.parse(updatedData)),_this25.dispatch("row-data-save-before",_this25),_this25.subscribed("row-data-changing")&&(tempData=Object.assign(tempData,_this25.data),tempData=Object.assign(tempData,updatedData)),newRowData=_this25.chain("row-data-changing",[_this25,tempData,updatedData],null,updatedData))_this25.data[attrname]=newRowData[attrname];for(var _attrname in _this25.dispatch("row-data-save-after",_this25),updatedData){_this25.table.columnManager.getColumnsByFieldRoot(_attrname).forEach((function(column){var cell=_this25.getCell(column.getField());if(cell){var value=column.getFieldValue(newRowData);cell.getValue()!==value&&(cell.setValueProcessData(value),visible&&cell.cellRendered())}}))}visible?(_this25.normalizeHeight(!0),_this25.table.options.rowFormatter&&_this25.table.options.rowFormatter(_this25.getComponent())):(_this25.initialized=!1,_this25.height=0,_this25.heightStyled=""),_this25.dispatch("row-data-changed",_this25,visible,updatedData),_this25.dispatchExternal("rowUpdated",_this25.getComponent()),_this25.subscribedExternal("dataChanged")&&_this25.dispatchExternal("dataChanged",_this25.table.rowManager.getData()),resolve()}))}},{key:"getData",value:function(transform){return transform?this.chain("row-data-retrieve",[this,transform],null,this.data):this.data}},{key:"getCell",value:function(column){return column=this.table.columnManager.findColumn(column),this.initialized||this.generateCells(),this.cells.find((function(cell){return cell.column===column}))}},{key:"getCellIndex",value:function(findCell){return this.cells.findIndex((function(cell){return cell===findCell}))}},{key:"findCell",value:function(subject){return this.cells.find((function(cell){return cell.element===subject}))}},{key:"getCells",value:function(){return this.initialized||this.generateCells(),this.cells}},{key:"nextRow",value:function(){return this.table.rowManager.nextDisplayRow(this,!0)||!1}},{key:"prevRow",value:function(){return this.table.rowManager.prevDisplayRow(this,!0)||!1}},{key:"moveToRow",value:function(to,before){var toRow=this.table.rowManager.findRow(to);toRow?(this.table.rowManager.moveRowActual(this,toRow,!before),this.table.rowManager.refreshActiveData("display",!1,!0)):console.warn("Move Error - No matching row found:",to)}},{key:"delete",value:function(){return this.dispatch("row-delete",this),this.deleteActual(),Promise.resolve()}},{key:"deleteActual",value:function(blockRedraw){this.detachModules(),this.table.rowManager.deleteRow(this,blockRedraw),this.deleteCells(),this.initialized=!1,this.heightInitialized=!1,this.element=!1,this.dispatch("row-deleted",this)}},{key:"detachModules",value:function(){this.dispatch("row-deleting",this)}},{key:"deleteCells",value:function(){for(var cellCount=this.cells.length,i=0;i<cellCount;i++)this.cells[0].delete()}},{key:"wipe",value:function(){if(this.detachModules(),this.deleteCells(),this.element){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.parentNode&&this.element.parentNode.removeChild(this.element)}this.element=!1,this.modules={}}},{key:"isDisplayed",value:function(){return this.table.rowManager.getDisplayRows().includes(this)}},{key:"getPosition",value:function(){return!!this.isDisplayed()&&this.position}},{key:"setPosition",value:function(position){var _this26=this;position!=this.position&&(this.position=position,this.positionWatchers.forEach((function(callback){callback(_this26.position)})))}},{key:"watchPosition",value:function(callback){this.positionWatchers.push(callback),callback(this.position)}},{key:"getGroup",value:function(){return this.modules.group||!1}},{key:"getComponent",value:function(){return this.component||(this.component=new RowComponent(this)),this.component}}]),Row}(CoreFeature),defaultCalculations={avg:function(values,data,calcParams){var output=0,precision=void 0!==calcParams.precision?calcParams.precision:2;return values.length&&(output=values.reduce((function(sum,value){return Number(sum)+Number(value)})),output/=values.length,output=!1!==precision?output.toFixed(precision):output),parseFloat(output).toString()},max:function(values,data,calcParams){var output=null,precision=void 0!==calcParams.precision&&calcParams.precision;return values.forEach((function(value){((value=Number(value))>output||null===output)&&(output=value)})),null!==output?!1!==precision?output.toFixed(precision):output:""},min:function(values,data,calcParams){var output=null,precision=void 0!==calcParams.precision&&calcParams.precision;return values.forEach((function(value){((value=Number(value))<output||null===output)&&(output=value)})),null!==output?!1!==precision?output.toFixed(precision):output:""},sum:function(values,data,calcParams){var output=0,precision=void 0!==calcParams.precision&&calcParams.precision;return values.length&&values.forEach((function(value){value=Number(value),output+=isNaN(value)?0:Number(value)})),!1!==precision?output.toFixed(precision):output},concat:function(values,data,calcParams){var output=0;return values.length&&(output=values.reduce((function(sum,value){return String(sum)+String(value)}))),output},count:function(values,data,calcParams){var output=0;return values.length&&values.forEach((function(value){value&&output++})),output}},ColumnCalcs=function(_Module4){_inherits(ColumnCalcs,_Module4);var _super9=_createSuper(ColumnCalcs);function ColumnCalcs(table){var _this27;return _classCallCheck(this,ColumnCalcs),(_this27=_super9.call(this,table)).topCalcs=[],_this27.botCalcs=[],_this27.genColumn=!1,_this27.topElement=_this27.createElement(),_this27.botElement=_this27.createElement(),_this27.topRow=!1,_this27.botRow=!1,_this27.topInitialized=!1,_this27.botInitialized=!1,_this27.blocked=!1,_this27.recalcAfterBlock=!1,_this27.registerTableOption("columnCalcs",!0),_this27.registerColumnOption("topCalc"),_this27.registerColumnOption("topCalcParams"),_this27.registerColumnOption("topCalcFormatter"),_this27.registerColumnOption("topCalcFormatterParams"),_this27.registerColumnOption("bottomCalc"),_this27.registerColumnOption("bottomCalcParams"),_this27.registerColumnOption("bottomCalcFormatter"),_this27.registerColumnOption("bottomCalcFormatterParams"),_this27}return _createClass(ColumnCalcs,[{key:"createElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-calcs-holder"),el}},{key:"initialize",value:function(){this.genColumn=new Column({field:"value"},this),this.subscribe("cell-value-changed",this.cellValueChanged.bind(this)),this.subscribe("column-init",this.initializeColumnCheck.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("column-moved",this.recalcActiveRows.bind(this)),this.subscribe("column-add",this.recalcActiveRows.bind(this)),this.subscribe("data-refreshed",this.recalcActiveRowsRefresh.bind(this)),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this)),this.subscribe("redraw-blocked",this.blockRedraw.bind(this)),this.subscribe("redraw-restored",this.restoreRedraw.bind(this)),this.registerTableFunction("getCalcResults",this.getResults.bind(this)),this.registerTableFunction("recalc",this.userRecalc.bind(this))}},{key:"tableRedraw",value:function(force){this.recalc(this.table.rowManager.activeRows),force&&this.redraw()}},{key:"blockRedraw",value:function(){this.blocked=!0,this.recalcAfterBlock=!1}},{key:"restoreRedraw",value:function(){this.blocked=!1,this.recalcAfterBlock&&(this.recalcAfterBlock=!1,this.recalcActiveRowsRefresh())}},{key:"userRecalc",value:function(){this.recalc(this.table.rowManager.activeRows)}},{key:"blockCheck",value:function(){return this.blocked&&(this.recalcAfterBlock=!0),this.blocked}},{key:"visibleRows",value:function(viewable,rows){return this.topRow&&rows.unshift(this.topRow),this.botRow&&rows.push(this.botRow),rows}},{key:"rowsUpdated",value:function(row){this.table.options.groupBy?this.recalcRowGroup(row):this.recalcActiveRows()}},{key:"recalcActiveRowsRefresh",value:function(){this.table.options.groupBy&&this.table.options.dataTreeStartExpanded&&this.table.options.dataTree?this.recalcAll():this.recalcActiveRows()}},{key:"recalcActiveRows",value:function(){this.recalc(this.table.rowManager.activeRows)}},{key:"cellValueChanged",value:function(cell){(cell.column.definition.topCalc||cell.column.definition.bottomCalc)&&(this.table.options.groupBy?("table"!=this.table.options.columnCalcs&&"both"!=this.table.options.columnCalcs||this.recalcActiveRows(),"table"!=this.table.options.columnCalcs&&this.recalcRowGroup(cell.row)):this.recalcActiveRows())}},{key:"initializeColumnCheck",value:function(column){(column.definition.topCalc||column.definition.bottomCalc)&&this.initializeColumn(column)}},{key:"initializeColumn",value:function(column){var def=column.definition,config={topCalcParams:def.topCalcParams||{},botCalcParams:def.bottomCalcParams||{}};if(def.topCalc){switch(_typeof(def.topCalc)){case"string":ColumnCalcs.calculations[def.topCalc]?config.topCalc=ColumnCalcs.calculations[def.topCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",def.topCalc);break;case"function":config.topCalc=def.topCalc}config.topCalc&&(column.modules.columnCalcs=config,this.topCalcs.push(column),"group"!=this.table.options.columnCalcs&&this.initializeTopRow())}if(def.bottomCalc){switch(_typeof(def.bottomCalc)){case"string":ColumnCalcs.calculations[def.bottomCalc]?config.botCalc=ColumnCalcs.calculations[def.bottomCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",def.bottomCalc);break;case"function":config.botCalc=def.bottomCalc}config.botCalc&&(column.modules.columnCalcs=config,this.botCalcs.push(column),"group"!=this.table.options.columnCalcs&&this.initializeBottomRow())}}},{key:"registerColumnField",value:function(){}},{key:"removeCalcs",value:function(){var changed=!1;this.topInitialized&&(this.topInitialized=!1,this.topElement.parentNode.removeChild(this.topElement),changed=!0),this.botInitialized&&(this.botInitialized=!1,this.footerRemove(this.botElement),changed=!0),changed&&this.table.rowManager.adjustTableSize()}},{key:"reinitializeCalcs",value:function(){this.topCalcs.length&&this.initializeTopRow(),this.botCalcs.length&&this.initializeBottomRow()}},{key:"initializeTopRow",value:function(){this.topInitialized||(this.table.columnManager.getContentsElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling),this.topInitialized=!0)}},{key:"initializeBottomRow",value:function(){this.botInitialized||(this.footerPrepend(this.botElement),this.botInitialized=!0)}},{key:"scrollHorizontal",value:function(left){this.botInitialized&&this.botRow&&(this.botElement.scrollLeft=left)}},{key:"recalc",value:function(rows){var data,row;if(!this.blockCheck()&&(this.topInitialized||this.botInitialized)){if(data=this.rowsToData(rows),this.topInitialized){for(this.topRow&&this.topRow.deleteCells(),row=this.generateRow("top",data),this.topRow=row;this.topElement.firstChild;)this.topElement.removeChild(this.topElement.firstChild);this.topElement.appendChild(row.getElement()),row.initialize(!0)}if(this.botInitialized){for(this.botRow&&this.botRow.deleteCells(),row=this.generateRow("bottom",data),this.botRow=row;this.botElement.firstChild;)this.botElement.removeChild(this.botElement.firstChild);this.botElement.appendChild(row.getElement()),row.initialize(!0)}this.table.rowManager.adjustTableSize(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()}}},{key:"recalcRowGroup",value:function(row){this.recalcGroup(this.table.modules.groupRows.getRowGroup(row))}},{key:"recalcAll",value:function(){var _this28=this;(this.topCalcs.length||this.botCalcs.length)&&("group"!==this.table.options.columnCalcs&&this.recalcActiveRows(),this.table.options.groupBy&&"table"!==this.table.options.columnCalcs&&this.table.modules.groupRows.getChildGroups().forEach((function(group){_this28.recalcGroup(group)})))}},{key:"recalcGroup",value:function(group){var data,rowData;this.blockCheck()||group&&group.calcs&&(group.calcs.bottom&&(data=this.rowsToData(group.rows),rowData=this.generateRowData("bottom",data),group.calcs.bottom.updateData(rowData),group.calcs.bottom.reinitialize()),group.calcs.top&&(data=this.rowsToData(group.rows),rowData=this.generateRowData("top",data),group.calcs.top.updateData(rowData),group.calcs.top.reinitialize()))}},{key:"generateTopRow",value:function(rows){return this.generateRow("top",this.rowsToData(rows))}},{key:"generateBottomRow",value:function(rows){return this.generateRow("bottom",this.rowsToData(rows))}},{key:"rowsToData",value:function(rows){var _this29=this,data=[];return rows.forEach((function(row){if(data.push(row.getData()),_this29.table.options.dataTree&&_this29.table.options.dataTreeChildColumnCalcs&&row.modules.dataTree&&row.modules.dataTree.open){var children=_this29.rowsToData(_this29.table.modules.dataTree.getFilteredTreeChildren(row));data=data.concat(children)}})),data}},{key:"generateRow",value:function(pos,data){var row,_this30=this,rowData=this.generateRowData(pos,data);return this.table.modExists("mutator")&&this.table.modules.mutator.disable(),row=new Row(rowData,this,"calc"),this.table.modExists("mutator")&&this.table.modules.mutator.enable(),row.getElement().classList.add("tabulator-calcs","tabulator-calcs-"+pos),row.component=!1,row.getComponent=function(){return row.component||(row.component=new CalcComponent(row)),row.component},row.generateCells=function(){var cells=[];_this30.table.columnManager.columnsByIndex.forEach((function(column){_this30.genColumn.setField(column.getField()),_this30.genColumn.hozAlign=column.hozAlign,column.definition[pos+"CalcFormatter"]&&_this30.table.modExists("format")?_this30.genColumn.modules.format={formatter:_this30.table.modules.format.getFormatter(column.definition[pos+"CalcFormatter"]),params:column.definition[pos+"CalcFormatterParams"]||{}}:_this30.genColumn.modules.format={formatter:_this30.table.modules.format.getFormatter("plaintext"),params:{}},_this30.genColumn.definition.cssClass=column.definition.cssClass;var cell=new Cell(_this30.genColumn,row);cell.getElement(),cell.column=column,cell.setWidth(),column.cells.push(cell),cells.push(cell),column.visible||cell.hide()})),row.cells=cells},row}},{key:"generateRowData",value:function(pos,data){var params,paramKey,rowData={},calcs="top"==pos?this.topCalcs:this.botCalcs,type="top"==pos?"topCalc":"botCalc";return calcs.forEach((function(column){var values=[];column.modules.columnCalcs&&column.modules.columnCalcs[type]&&(data.forEach((function(item){values.push(column.getFieldValue(item))})),paramKey=type+"Params",params="function"==typeof column.modules.columnCalcs[paramKey]?column.modules.columnCalcs[paramKey](values,data):column.modules.columnCalcs[paramKey],column.setFieldValue(rowData,column.modules.columnCalcs[type](values,data,params)))})),rowData}},{key:"hasTopCalcs",value:function(){return!!this.topCalcs.length}},{key:"hasBottomCalcs",value:function(){return!!this.botCalcs.length}},{key:"redraw",value:function(){this.topRow&&this.topRow.normalizeHeight(!0),this.botRow&&this.botRow.normalizeHeight(!0)}},{key:"getResults",value:function(){var _this31=this,results={};return this.table.options.groupBy&&this.table.modExists("groupRows")?this.table.modules.groupRows.getGroups(!0).forEach((function(group){results[group.getKey()]=_this31.getGroupResults(group)})):results={top:this.topRow?this.topRow.getData():{},bottom:this.botRow?this.botRow.getData():{}},results}},{key:"getGroupResults",value:function(group){var _this32=this,groupObj=group._getSelf(),subGroups=group.getSubGroups(),subGroupResults={};return subGroups.forEach((function(subgroup){subGroupResults[subgroup.getKey()]=_this32.getGroupResults(subgroup)})),{top:groupObj.calcs.top?groupObj.calcs.top.getData():{},bottom:groupObj.calcs.bottom?groupObj.calcs.bottom.getData():{},groups:subGroupResults}}},{key:"adjustForScrollbar",value:function(width){this.botRow&&(this.table.rtl?this.botElement.style.paddingLeft=width+"px":this.botElement.style.paddingRight=width+"px")}}]),ColumnCalcs}(Module);_exports.ColumnCalcsModule=ColumnCalcs,ColumnCalcs.moduleName="columnCalcs",ColumnCalcs.calculations=defaultCalculations;var DataTree=function(_Module5){_inherits(DataTree,_Module5);var _super10=_createSuper(DataTree);function DataTree(table){var _this33;return _classCallCheck(this,DataTree),(_this33=_super10.call(this,table)).indent=10,_this33.field="",_this33.collapseEl=null,_this33.expandEl=null,_this33.branchEl=null,_this33.elementField=!1,_this33.startOpen=function(){},_this33.registerTableOption("dataTree",!1),_this33.registerTableOption("dataTreeFilter",!0),_this33.registerTableOption("dataTreeSort",!0),_this33.registerTableOption("dataTreeElementColumn",!1),_this33.registerTableOption("dataTreeBranchElement",!0),_this33.registerTableOption("dataTreeChildIndent",9),_this33.registerTableOption("dataTreeChildField","_children"),_this33.registerTableOption("dataTreeCollapseElement",!1),_this33.registerTableOption("dataTreeExpandElement",!1),_this33.registerTableOption("dataTreeStartExpanded",!1),_this33.registerTableOption("dataTreeChildColumnCalcs",!1),_this33.registerTableOption("dataTreeSelectPropagate",!1),_this33.registerComponentFunction("row","treeCollapse",_this33.collapseRow.bind(_assertThisInitialized(_this33))),_this33.registerComponentFunction("row","treeExpand",_this33.expandRow.bind(_assertThisInitialized(_this33))),_this33.registerComponentFunction("row","treeToggle",_this33.toggleRow.bind(_assertThisInitialized(_this33))),_this33.registerComponentFunction("row","getTreeParent",_this33.getTreeParent.bind(_assertThisInitialized(_this33))),_this33.registerComponentFunction("row","getTreeChildren",_this33.getRowChildren.bind(_assertThisInitialized(_this33))),_this33.registerComponentFunction("row","addTreeChild",_this33.addTreeChildRow.bind(_assertThisInitialized(_this33))),_this33.registerComponentFunction("row","isTreeExpanded",_this33.isRowExpanded.bind(_assertThisInitialized(_this33))),_this33}return _createClass(DataTree,[{key:"initialize",value:function(){if(this.table.options.dataTree){var dummyEl=null,options=this.table.options;switch(this.field=options.dataTreeChildField,this.indent=options.dataTreeChildIndent,this.options("movableRows")&&console.warn("The movableRows option is not available with dataTree enabled, moving of child rows could result in unpredictable behavior"),options.dataTreeBranchElement&&(!0===options.dataTreeBranchElement?(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch")):"string"==typeof options.dataTreeBranchElement?((dummyEl=document.createElement("div")).innerHTML=options.dataTreeBranchElement,this.branchEl=dummyEl.firstChild):this.branchEl=options.dataTreeBranchElement),options.dataTreeCollapseElement?"string"==typeof options.dataTreeCollapseElement?((dummyEl=document.createElement("div")).innerHTML=options.dataTreeCollapseElement,this.collapseEl=dummyEl.firstChild):this.collapseEl=options.dataTreeCollapseElement:(this.collapseEl=document.createElement("div"),this.collapseEl.classList.add("tabulator-data-tree-control"),this.collapseEl.tabIndex=0,this.collapseEl.innerHTML="<div class='tabulator-data-tree-control-collapse'></div>"),options.dataTreeExpandElement?"string"==typeof options.dataTreeExpandElement?((dummyEl=document.createElement("div")).innerHTML=options.dataTreeExpandElement,this.expandEl=dummyEl.firstChild):this.expandEl=options.dataTreeExpandElement:(this.expandEl=document.createElement("div"),this.expandEl.classList.add("tabulator-data-tree-control"),this.expandEl.tabIndex=0,this.expandEl.innerHTML="<div class='tabulator-data-tree-control-expand'></div>"),_typeof(options.dataTreeStartExpanded)){case"boolean":this.startOpen=function(row,index){return options.dataTreeStartExpanded};break;case"function":this.startOpen=options.dataTreeStartExpanded;break;default:this.startOpen=function(row,index){return options.dataTreeStartExpanded[index]}}this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("row-deleted",this.rowDelete.bind(this),0),this.subscribe("row-data-changed",this.rowDataChanged.bind(this),10),this.subscribe("cell-value-updated",this.cellValueChanged.bind(this)),this.subscribe("edit-cancelled",this.cellValueChanged.bind(this)),this.subscribe("column-moving-rows",this.columnMoving.bind(this)),this.subscribe("table-built",this.initializeElementField.bind(this)),this.subscribe("table-redrawing",this.tableRedrawing.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),30)}}},{key:"tableRedrawing",value:function(force){var _this34=this;force&&this.table.rowManager.getRows().forEach((function(row){_this34.reinitializeRowChildren(row)}))}},{key:"initializeElementField",value:function(){var firstCol=this.table.columnManager.getFirstVisibleColumn();this.elementField=this.table.options.dataTreeElementColumn||!!firstCol&&firstCol.field}},{key:"getRowChildren",value:function(row){return this.getTreeChildren(row,!0)}},{key:"columnMoving",value:function(){var _this35=this,rows=[];return this.table.rowManager.rows.forEach((function(row){rows=rows.concat(_this35.getTreeChildren(row,!1,!0))})),rows}},{key:"rowDataChanged",value:function(row,visible,updatedData){this.redrawNeeded(updatedData)&&(this.initializeRow(row),visible&&(this.layoutRow(row),this.refreshData(!0)))}},{key:"cellValueChanged",value:function(cell){cell.column.getField()===this.elementField&&this.layoutRow(cell.row)}},{key:"initializeRow",value:function(row){var childArray=row.getData()[this.field],isArray=Array.isArray(childArray),children=isArray||!isArray&&"object"===_typeof(childArray)&&null!==childArray;!children&&row.modules.dataTree&&row.modules.dataTree.branchEl&&row.modules.dataTree.branchEl.parentNode.removeChild(row.modules.dataTree.branchEl),!children&&row.modules.dataTree&&row.modules.dataTree.controlEl&&row.modules.dataTree.controlEl.parentNode.removeChild(row.modules.dataTree.controlEl),row.modules.dataTree={index:row.modules.dataTree?row.modules.dataTree.index:0,open:!!children&&(row.modules.dataTree?row.modules.dataTree.open:this.startOpen(row.getComponent(),0)),controlEl:!(!row.modules.dataTree||!children)&&row.modules.dataTree.controlEl,branchEl:!(!row.modules.dataTree||!children)&&row.modules.dataTree.branchEl,parent:!!row.modules.dataTree&&row.modules.dataTree.parent,children:children}}},{key:"reinitializeRowChildren",value:function(row){this.getTreeChildren(row,!1,!0).forEach((function(child){child.reinitialize(!0)}))}},{key:"layoutRow",value:function(row){var el=(this.elementField?row.getCell(this.elementField):row.getCells()[0]).getElement(),config=row.modules.dataTree;config.branchEl&&(config.branchEl.parentNode&&config.branchEl.parentNode.removeChild(config.branchEl),config.branchEl=!1),config.controlEl&&(config.controlEl.parentNode&&config.controlEl.parentNode.removeChild(config.controlEl),config.controlEl=!1),this.generateControlElement(row,el),row.getElement().classList.add("tabulator-tree-level-"+config.index),config.index&&(this.branchEl?(config.branchEl=this.branchEl.cloneNode(!0),el.insertBefore(config.branchEl,el.firstChild),this.table.rtl?config.branchEl.style.marginRight=(config.branchEl.offsetWidth+config.branchEl.style.marginLeft)*(config.index-1)+config.index*this.indent+"px":config.branchEl.style.marginLeft=(config.branchEl.offsetWidth+config.branchEl.style.marginRight)*(config.index-1)+config.index*this.indent+"px"):this.table.rtl?el.style.paddingRight=parseInt(window.getComputedStyle(el,null).getPropertyValue("padding-right"))+config.index*this.indent+"px":el.style.paddingLeft=parseInt(window.getComputedStyle(el,null).getPropertyValue("padding-left"))+config.index*this.indent+"px")}},{key:"generateControlElement",value:function(row,el){var _this36=this,config=row.modules.dataTree,oldControl=config.controlEl;el=el||row.getCells()[0].getElement(),!1!==config.children&&(config.open?(config.controlEl=this.collapseEl.cloneNode(!0),config.controlEl.addEventListener("click",(function(e){e.stopPropagation(),_this36.collapseRow(row)}))):(config.controlEl=this.expandEl.cloneNode(!0),config.controlEl.addEventListener("click",(function(e){e.stopPropagation(),_this36.expandRow(row)}))),config.controlEl.addEventListener("mousedown",(function(e){e.stopPropagation()})),oldControl&&oldControl.parentNode===el?oldControl.parentNode.replaceChild(config.controlEl,oldControl):el.insertBefore(config.controlEl,el.firstChild))}},{key:"getRows",value:function(rows){var _this37=this,output=[];return rows.forEach((function(row,i){var config;output.push(row),row instanceof Row&&(row.create(),(config=row.modules.dataTree.children).index||!1===config.children||_this37.getChildren(row).forEach((function(child){child.create(),output.push(child)})))})),output}},{key:"getChildren",value:function(row,allChildren){var _this38=this,config=row.modules.dataTree,children=[],output=[];return!1!==config.children&&(config.open||allChildren)&&(Array.isArray(config.children)||(config.children=this.generateChildren(row)),children=this.table.modExists("filter")&&this.table.options.dataTreeFilter?this.table.modules.filter.filter(config.children):config.children,this.table.modExists("sort")&&this.table.options.dataTreeSort&&this.table.modules.sort.sort(children),children.forEach((function(child){output.push(child),_this38.getChildren(child).forEach((function(sub){output.push(sub)}))}))),output}},{key:"generateChildren",value:function(row){var _this39=this,children=[],childArray=row.getData()[this.field];return Array.isArray(childArray)||(childArray=[childArray]),childArray.forEach((function(childData){var childRow=new Row(childData||{},_this39.table.rowManager);childRow.create(),childRow.modules.dataTree.index=row.modules.dataTree.index+1,childRow.modules.dataTree.parent=row,childRow.modules.dataTree.children&&(childRow.modules.dataTree.open=_this39.startOpen(childRow.getComponent(),childRow.modules.dataTree.index)),children.push(childRow)})),children}},{key:"expandRow",value:function(row,silent){var config=row.modules.dataTree;!1!==config.children&&(config.open=!0,row.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowExpanded",row.getComponent(),row.modules.dataTree.index))}},{key:"collapseRow",value:function(row){var config=row.modules.dataTree;!1!==config.children&&(config.open=!1,row.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowCollapsed",row.getComponent(),row.modules.dataTree.index))}},{key:"toggleRow",value:function(row){var config=row.modules.dataTree;!1!==config.children&&(config.open?this.collapseRow(row):this.expandRow(row))}},{key:"isRowExpanded",value:function(row){return row.modules.dataTree.open}},{key:"getTreeParent",value:function(row){return!!row.modules.dataTree.parent&&row.modules.dataTree.parent.getComponent()}},{key:"getTreeParentRoot",value:function(row){return row.modules.dataTree&&row.modules.dataTree.parent?this.getTreeParentRoot(row.modules.dataTree.parent):row}},{key:"getFilteredTreeChildren",value:function(row){var config=row.modules.dataTree,output=[];return config.children&&(Array.isArray(config.children)||(config.children=this.generateChildren(row)),(this.table.modExists("filter")&&this.table.options.dataTreeFilter?this.table.modules.filter.filter(config.children):config.children).forEach((function(childRow){childRow instanceof Row&&output.push(childRow)}))),output}},{key:"rowDelete",value:function(row){var childIndex,parent=row.modules.dataTree.parent;parent&&(!1!==(childIndex=this.findChildIndex(row,parent))&&parent.data[this.field].splice(childIndex,1),parent.data[this.field].length||delete parent.data[this.field],this.initializeRow(parent),this.layoutRow(parent)),this.refreshData(!0)}},{key:"addTreeChildRow",value:function(row,data,top,index){var childIndex=!1;"string"==typeof data&&(data=JSON.parse(data)),Array.isArray(row.data[this.field])||(row.data[this.field]=[],row.modules.dataTree.open=this.startOpen(row.getComponent(),row.modules.dataTree.index)),void 0!==index&&!1!==(childIndex=this.findChildIndex(index,row))&&row.data[this.field].splice(top?childIndex:childIndex+1,0,data),!1===childIndex&&(top?row.data[this.field].unshift(data):row.data[this.field].push(data)),this.initializeRow(row),this.layoutRow(row),this.refreshData(!0)}},{key:"findChildIndex",value:function(subject,parent){var _this40=this,match=!1;return"object"==_typeof(subject)?subject instanceof Row?match=subject.data:subject instanceof RowComponent?match=subject._getSelf().data:"undefined"!=typeof HTMLElement&&subject instanceof HTMLElement?parent.modules.dataTree&&(match=parent.modules.dataTree.children.find((function(childRow){return childRow instanceof Row&&childRow.element===subject})))&&(match=match.data):null===subject&&(match=!1):match=void 0!==subject&&parent.data[this.field].find((function(row){return row.data[_this40.table.options.index]==subject})),match&&(Array.isArray(parent.data[this.field])&&(match=parent.data[this.field].indexOf(match)),-1==match&&(match=!1)),match}},{key:"getTreeChildren",value:function(row,component,recurse){var _this41=this,config=row.modules.dataTree,output=[];return config.children&&(Array.isArray(config.children)||(config.children=this.generateChildren(row)),config.children.forEach((function(childRow){childRow instanceof Row&&(output.push(component?childRow.getComponent():childRow),recurse&&(output=output.concat(_this41.getTreeChildren(childRow,component,recurse))))}))),output}},{key:"getChildField",value:function(){return this.field}},{key:"redrawNeeded",value:function(data){return!!this.field&&void 0!==data[this.field]||!!this.elementField&&void 0!==data[this.elementField]}}]),DataTree}(Module);_exports.DataTreeModule=DataTree,DataTree.moduleName="dataTree";var defaultDownloaders={csv:function(list){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},setFileContents=arguments.length>2?arguments[2]:void 0,delimiter=options.delimiter?options.delimiter:",",fileContents=[],headers=[];list.forEach((function(row){var item=[];switch(row.type){case"group":console.warn("Download Warning - CSV downloader cannot process row groups");break;case"calc":console.warn("Download Warning - CSV downloader cannot process column calculations");break;case"header":row.columns.forEach((function(col,i){col&&1===col.depth&&(headers[i]=void 0===col.value||null===col.value?"":'"'+String(col.value).split('"').join('""')+'"')}));break;case"row":row.columns.forEach((function(col){if(col){switch(_typeof(col.value)){case"object":col.value=null!==col.value?JSON.stringify(col.value):"";break;case"undefined":col.value=""}item.push('"'+String(col.value).split('"').join('""')+'"')}})),fileContents.push(item.join(delimiter))}})),headers.length&&fileContents.unshift(headers.join(delimiter)),fileContents=fileContents.join("\n"),options.bom&&(fileContents="\ufeff"+fileContents),setFileContents(fileContents,"text/csv")},json:function(list,options,setFileContents){var fileContents=[];list.forEach((function(row){var item={};switch(row.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":row.columns.forEach((function(col){col&&(item[col.component.getTitleDownload()||col.component.getField()]=col.value)})),fileContents.push(item)}})),setFileContents(fileContents=JSON.stringify(fileContents,null,"\t"),"application/json")},jsonLines:function(list,options,setFileContents){var fileContents=[];list.forEach((function(row){var item={};switch(row.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":row.columns.forEach((function(col){col&&(item[col.component.getTitleDownload()||col.component.getField()]=col.value)})),fileContents.push(JSON.stringify(item))}})),setFileContents(fileContents.join("\n"),"application/x-ndjson")},pdf:function(list){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},setFileContents=arguments.length>2?arguments[2]:void 0,header=[],body=[],autoTableParams={},rowGroupStyles=options.rowGroupStyles||{fontStyle:"bold",fontSize:12,cellPadding:6,fillColor:220},rowCalcStyles=options.rowCalcStyles||{fontStyle:"bold",fontSize:10,cellPadding:4,fillColor:232},jsPDFParams=options.jsPDF||{},title=options.title?options.title:"";function parseRow(row,styles){var rowData=[];return row.columns.forEach((function(col){var cell;if(col){switch(_typeof(col.value)){case"object":col.value=null!==col.value?JSON.stringify(col.value):"";break;case"undefined":col.value=""}cell={content:col.value,colSpan:col.width,rowSpan:col.height},styles&&(cell.styles=styles),rowData.push(cell)}})),rowData}jsPDFParams.orientation||(jsPDFParams.orientation=options.orientation||"landscape"),jsPDFParams.unit||(jsPDFParams.unit="pt"),list.forEach((function(row){switch(row.type){case"header":header.push(parseRow(row));break;case"group":body.push(parseRow(row,rowGroupStyles));break;case"calc":body.push(parseRow(row,rowCalcStyles));break;case"row":body.push(parseRow(row))}}));var doc=new jspdf.jsPDF(jsPDFParams);options.autoTable&&(autoTableParams="function"==typeof options.autoTable?options.autoTable(doc)||{}:options.autoTable),title&&(autoTableParams.didDrawPage=function(data){doc.text(title,40,30)}),autoTableParams.head=header,autoTableParams.body=body,doc.autoTable(autoTableParams),options.documentProcessing&&options.documentProcessing(doc),setFileContents(doc.output("arraybuffer"),"application/pdf")},xlsx:function(list,options,setFileContents){var sheetName=options.sheetName||"Sheet1",workbook=XLSX.utils.book_new(),tableFeatures=new CoreFeature(this),compression=!("compress"in options)||options.compress;function generateSheet(){var rows=[],merges=[],worksheet={},range={s:{c:0,r:0},e:{c:list[0]?list[0].columns.reduce((function(a,b){return a+(b&&b.width?b.width:1)}),0):0,r:list.length}};return list.forEach((function(row,i){var rowData=[];row.columns.forEach((function(col,j){col?(rowData.push(col.value instanceof Date||"object"!==_typeof(col.value)?col.value:JSON.stringify(col.value)),(col.width>1||col.height>-1)&&(col.height>1||col.width>1)&&merges.push({s:{r:i,c:j},e:{r:i+col.height-1,c:j+col.width-1}})):rowData.push("")})),rows.push(rowData)})),XLSX.utils.sheet_add_aoa(worksheet,rows),worksheet["!ref"]=XLSX.utils.encode_range(range),merges.length&&(worksheet["!merges"]=merges),worksheet}if(workbook.SheetNames=[],workbook.Sheets={},options.sheetOnly)setFileContents(generateSheet());else{if(options.sheets)for(var sheet in options.sheets)!0===options.sheets[sheet]?(workbook.SheetNames.push(sheet),workbook.Sheets[sheet]=generateSheet()):(workbook.SheetNames.push(sheet),tableFeatures.commsSend(options.sheets[sheet],"download","intercept",{type:"xlsx",options:{sheetOnly:!0},active:this.active,intercept:function(data){workbook.Sheets[sheet]=data}}));else workbook.SheetNames.push(sheetName),workbook.Sheets[sheetName]=generateSheet();options.documentProcessing&&(workbook=options.documentProcessing(workbook)),setFileContents(function(s){for(var buf=new ArrayBuffer(s.length),view=new Uint8Array(buf),i=0;i!=s.length;++i)view[i]=255&s.charCodeAt(i);return buf}(XLSX.write(workbook,{bookType:"xlsx",bookSST:!0,type:"binary",compression:compression})),"application/octet-stream")}},html:function(list,options,setFileContents){this.modExists("export",!0)&&setFileContents(this.modules.export.generateHTMLTable(list),"text/html")}},Download=function(_Module6){_inherits(Download,_Module6);var _super11=_createSuper(Download);function Download(table){var _this42;return _classCallCheck(this,Download),(_this42=_super11.call(this,table)).registerTableOption("downloadEncoder",(function(data,mimeType){return new Blob([data],{type:mimeType})})),_this42.registerTableOption("downloadReady",void 0),_this42.registerTableOption("downloadConfig",{}),_this42.registerTableOption("downloadRowRange","active"),_this42.registerColumnOption("download"),_this42.registerColumnOption("titleDownload"),_this42}return _createClass(Download,[{key:"initialize",value:function(){this.deprecatedOptionsCheck(),this.registerTableFunction("download",this.download.bind(this)),this.registerTableFunction("downloadToTab",this.downloadToTab.bind(this))}},{key:"deprecatedOptionsCheck",value:function(){this.deprecationCheck("downloadReady","downloadEncoder")}},{key:"downloadToTab",value:function(type,filename,options,active){this.download(type,filename,options,active,!0)}},{key:"download",value:function(type,filename,options,range,interceptCallback){var downloadFunc=!1;if("function"==typeof type?downloadFunc=type:Download.downloaders[type]?downloadFunc=Download.downloaders[type]:console.warn("Download Error - No such download type found: ",type),downloadFunc){var list=this.generateExportList(range);downloadFunc.call(this.table,list,options||{},function(data,mime){interceptCallback?!0===interceptCallback?this.triggerDownload(data,mime,type,filename,!0):interceptCallback(data):this.triggerDownload(data,mime,type,filename)}.bind(this))}}},{key:"generateExportList",value:function(range){var list=this.table.modules.export.generateExportList(this.table.options.downloadConfig,!1,range||this.table.options.downloadRowRange,"download"),groupHeader=this.table.options.groupHeaderDownload;return groupHeader&&!Array.isArray(groupHeader)&&(groupHeader=[groupHeader]),list.forEach((function(row){var group;"group"===row.type&&(group=row.columns[0],groupHeader&&groupHeader[row.indent]&&(group.value=groupHeader[row.indent](group.value,row.component._group.getRowCount(),row.component._group.getData(),row.component)))})),list}},{key:"triggerDownload",value:function(data,mime,type,filename,newTab){var element=document.createElement("a"),blob=this.table.options.downloadEncoder(data,mime);blob&&(newTab?window.open(window.URL.createObjectURL(blob)):(filename=filename||"Tabulator."+("function"==typeof type?"txt":type),navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(blob,filename):(element.setAttribute("href",window.URL.createObjectURL(blob)),element.setAttribute("download",filename),element.style.display="none",document.body.appendChild(element),element.click(),document.body.removeChild(element))),this.dispatchExternal("downloadComplete"))}},{key:"commsReceived",value:function(table,action,data){if("intercept"===action)this.download(data.type,"",data.options,data.active,data.intercept)}}]),Download}(Module);function maskInput(el,options){var mask=options.mask,maskLetter=void 0!==options.maskLetterChar?options.maskLetterChar:"A",maskNumber=void 0!==options.maskNumberChar?options.maskNumberChar:"9",maskWildcard=void 0!==options.maskWildcardChar?options.maskWildcardChar:"*";function fillSymbols(index){var symbol=mask[index];void 0!==symbol&&symbol!==maskWildcard&&symbol!==maskLetter&&symbol!==maskNumber&&(el.value=el.value+""+symbol,fillSymbols(index+1))}el.addEventListener("keydown",(function(e){var index=el.value.length,char=e.key;if(e.keyCode>46){if(index>=mask.length)return e.preventDefault(),e.stopPropagation(),!1;switch(mask[index]){case maskLetter:if(char.toUpperCase()==char.toLowerCase())return e.preventDefault(),e.stopPropagation(),!1;break;case maskNumber:if(isNaN(char))return e.preventDefault(),e.stopPropagation(),!1;break;case maskWildcard:break;default:if(char!==mask[index])return e.preventDefault(),e.stopPropagation(),!1}}})),el.addEventListener("keyup",(function(e){e.keyCode>46&&options.maskAutoFill&&fillSymbols(el.value.length)})),el.placeholder||(el.placeholder=mask),options.maskAutoFill&&fillSymbols(el.value.length)}_exports.DownloadModule=Download,Download.moduleName="download",Download.downloaders=defaultDownloaders;var Edit=function(){function Edit(editor,cell,onRendered,success,cancel,editorParams){_classCallCheck(this,Edit),this.edit=editor,this.table=editor.table,this.cell=cell,this.params=this._initializeParams(editorParams),this.data=[],this.displayItems=[],this.currentItems=[],this.focusedItem=null,this.input=this._createInputElement(),this.listEl=this._createListElement(),this.initialValues=null,this.isFilter=!cell._getSelf,this.filterTimeout=null,this.filtered=!1,this.typing=!1,this.values=[],this.popup=null,this.listIteration=0,this.lastAction="",this.filterTerm="",this.blurable=!0,this.actions={success:success,cancel:cancel},this._deprecatedOptionsCheck(),this._initializeValue(),onRendered(this._onRendered.bind(this))}return _createClass(Edit,[{key:"_deprecatedOptionsCheck",value:function(){this.params.listItemFormatter&&this.cell.getTable().deprecationAdvisor.msg("The listItemFormatter editor param has been deprecated, please see the latest editor documentation for updated options"),this.params.sortValuesList&&this.cell.getTable().deprecationAdvisor.msg("The sortValuesList editor param has been deprecated, please see the latest editor documentation for updated options"),this.params.searchFunc&&this.cell.getTable().deprecationAdvisor.msg("The searchFunc editor param has been deprecated, please see the latest editor documentation for updated options"),this.params.searchingPlaceholder&&this.cell.getTable().deprecationAdvisor.msg("The searchingPlaceholder editor param has been deprecated, please see the latest editor documentation for updated options")}},{key:"_initializeValue",value:function(){var initialValue=this.cell.getValue();void 0===initialValue&&void 0!==this.params.defaultValue&&(initialValue=this.params.defaultValue),this.initialValues=this.params.multiselect?initialValue:[initialValue],this.isFilter&&(this.input.value=this.initialValues?this.initialValues.join(","):"",this.headerFilterInitialListGen())}},{key:"_onRendered",value:function(){var cellEl=this.cell.getElement();function clickStop(e){e.stopPropagation()}this.input.style.height="100%",this.input.focus({preventScroll:!0}),cellEl.addEventListener("click",clickStop),setTimeout((function(){cellEl.removeEventListener("click",clickStop)}),1e3),this.input.addEventListener("mousedown",this._preventPopupBlur.bind(this))}},{key:"_createListElement",value:function(){var listEl=document.createElement("div");return listEl.classList.add("tabulator-edit-list"),listEl.addEventListener("mousedown",this._preventBlur.bind(this)),listEl.addEventListener("keydown",this._inputKeyDown.bind(this)),listEl}},{key:"_setListWidth",value:function(){var element=this.isFilter?this.input:this.cell.getElement();this.listEl.style.minWidth=element.offsetWidth+"px",this.params.maxWidth&&(!0===this.params.maxWidth?this.listEl.style.maxWidth=element.offsetWidth+"px":"number"==typeof this.params.maxWidth?this.listEl.style.maxWidth=this.params.maxWidth+"px":this.listEl.style.maxWidth=this.params.maxWidth)}},{key:"_createInputElement",value:function(){var attribs=this.params.elementAttributes,input=document.createElement("input");if(input.setAttribute("type",this.params.clearable?"search":"text"),input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",this.params.autocomplete||(input.style.cursor="default",input.style.caretColor="transparent"),attribs&&"object"==_typeof(attribs))for(var key in attribs)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+attribs["+"+key])):input.setAttribute(key,attribs[key]);return this.params.mask&&maskInput(input,this.params),this._bindInputEvents(input),input}},{key:"_initializeParams",value:function(params){var valueCheck,valueKeys=["values","valuesURL","valuesLookup"];return(params=Object.assign({},params)).verticalNavigation=params.verticalNavigation||"editor",params.placeholderLoading=void 0===params.placeholderLoading?"Searching ...":params.placeholderLoading,params.placeholderEmpty=void 0===params.placeholderEmpty?"No Results Found":params.placeholderEmpty,params.filterDelay=void 0===params.filterDelay?300:params.filterDelay,params.emptyValue=Object.keys(params).includes("emptyValue")?params.emptyValue:"",(valueCheck=Object.keys(params).filter((function(key){return valueKeys.includes(key)})).length)?valueCheck>1&&console.warn("list editor config error - only one of the values, valuesURL, or valuesLookup options can be set on the same editor"):console.warn("list editor config error - either the values, valuesURL, or valuesLookup option must be set"),params.autocomplete?params.multiselect&&(params.multiselect=!1,console.warn("list editor config error - multiselect option is not available when autocomplete is enabled")):(params.freetext&&(params.freetext=!1,console.warn("list editor config error - freetext option is only available when autocomplete is enabled")),params.filterFunc&&(params.filterFunc=!1,console.warn("list editor config error - filterFunc option is only available when autocomplete is enabled")),params.filterRemote&&(params.filterRemote=!1,console.warn("list editor config error - filterRemote option is only available when autocomplete is enabled")),params.mask&&(params.mask=!1,console.warn("list editor config error - mask option is only available when autocomplete is enabled")),params.allowEmpty&&(params.allowEmpty=!1,console.warn("list editor config error - allowEmpty option is only available when autocomplete is enabled")),params.listOnEmpty&&(params.listOnEmpty=!1,console.warn("list editor config error - listOnEmpty option is only available when autocomplete is enabled"))),params.filterRemote&&"function"!=typeof params.valuesLookup&&!params.valuesURL&&(params.filterRemote=!1,console.warn("list editor config error - filterRemote option should only be used when values list is populated from a remote source")),params}},{key:"_bindInputEvents",value:function(input){input.addEventListener("focus",this._inputFocus.bind(this)),input.addEventListener("click",this._inputClick.bind(this)),input.addEventListener("blur",this._inputBlur.bind(this)),input.addEventListener("keydown",this._inputKeyDown.bind(this)),input.addEventListener("search",this._inputSearch.bind(this)),this.params.autocomplete&&input.addEventListener("keyup",this._inputKeyUp.bind(this))}},{key:"_inputFocus",value:function(e){this.rebuildOptionsList()}},{key:"_filter",value:function(){var _this43=this;this.params.filterRemote?(clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout((function(){_this43.rebuildOptionsList()}),this.params.filterDelay)):this._filterList()}},{key:"_inputClick",value:function(e){e.stopPropagation()}},{key:"_inputBlur",value:function(e){this.blurable&&(this.popup?this.popup.hide():this._resolveValue(!0))}},{key:"_inputSearch",value:function(){this._clearChoices()}},{key:"_inputKeyDown",value:function(e){switch(e.keyCode){case 38:this._keyUp(e);break;case 40:this._keyDown(e);break;case 37:case 39:this._keySide(e);break;case 13:this._keyEnter();break;case 27:this._keyEsc();break;case 36:case 35:this._keyHomeEnd(e);break;case 9:break;default:this._keySelectLetter(e)}}},{key:"_inputKeyUp",value:function(e){switch(e.keyCode){case 38:case 37:case 39:case 40:case 13:case 27:break;default:this._keyAutoCompLetter(e)}}},{key:"_preventPopupBlur",value:function(){var _this44=this;this.popup&&this.popup.blockHide(),setTimeout((function(){_this44.popup&&_this44.popup.restoreHide()}),10)}},{key:"_preventBlur",value:function(){var _this45=this;this.blurable=!1,setTimeout((function(){_this45.blurable=!0}),10)}},{key:"_keyUp",value:function(e){var index=this.displayItems.indexOf(this.focusedItem);("editor"==this.params.verticalNavigation||"hybrid"==this.params.verticalNavigation&&index)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),index>0&&this._focusItem(this.displayItems[index-1]))}},{key:"_keyDown",value:function(e){var index=this.displayItems.indexOf(this.focusedItem);("editor"==this.params.verticalNavigation||"hybrid"==this.params.verticalNavigation&&index<this.displayItems.length-1)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),index<this.displayItems.length-1&&(-1==index?this._focusItem(this.displayItems[0]):this._focusItem(this.displayItems[index+1])))}},{key:"_keySide",value:function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},{key:"_keyEnter",value:function(e){this.params.autocomplete&&"typing"===this.lastAction?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem)}},{key:"_keyEsc",value:function(e){this._cancel()}},{key:"_keyHomeEnd",value:function(e){this.params.autocomplete&&e.stopImmediatePropagation()}},{key:"_keySelectLetter",value:function(e){this.params.autocomplete||(e.preventDefault(),e.keyCode>=38&&e.keyCode<=90&&this._scrollToValue(e.keyCode))}},{key:"_keyAutoCompLetter",value:function(e){this._filter(),this.lastAction="typing",this.typing=!0}},{key:"_scrollToValue",value:function(char){var _this46=this;clearTimeout(this.filterTimeout);var character=String.fromCharCode(char).toLowerCase();this.filterTerm+=character.toLowerCase();var match=this.displayItems.find((function(item){return void 0!==item.label&&item.label.toLowerCase().startsWith(_this46.filterTerm)}));match&&this._focusItem(match),this.filterTimeout=setTimeout((function(){_this46.filterTerm=""}),800)}},{key:"_focusItem",value:function(item){this.lastAction="focus",this.focusedItem&&this.focusedItem.element&&this.focusedItem.element.classList.remove("focused"),this.focusedItem=item,item&&item.element&&(item.element.classList.add("focused"),item.element.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}},{key:"headerFilterInitialListGen",value:function(){this._generateOptions(!0)}},{key:"rebuildOptionsList",value:function(){this._generateOptions().then(this._sortOptions.bind(this)).then(this._buildList.bind(this)).then(this._showList.bind(this)).catch((function(e){Number.isInteger(e)||console.error("List generation error",e)}))}},{key:"_filterList",value:function(){this._buildList(this._filterOptions()),this._showList()}},{key:"_generateOptions",value:function(silent){var _this47=this,values=[],iteration=++this.listIteration;return this.filtered=!1,this.params.values?values=this.params.values:this.params.valuesURL?values=this._ajaxRequest(this.params.valuesURL,this.input.value):"function"==typeof this.params.valuesLookup?values=this.params.valuesLookup(this.cell,this.input.value):this.params.valuesLookup&&(values=this._uniqueColumnValues(this.params.valuesLookupField)),values instanceof Promise?(silent||this._addPlaceholder(this.params.placeholderLoading),values.then().then((function(responseValues){return _this47.listIteration===iteration?_this47._parseList(responseValues):Promise.reject(iteration)}))):Promise.resolve(this._parseList(values))}},{key:"_addPlaceholder",value:function(contents){var placeholder=document.createElement("div");"function"==typeof contents&&(contents=contents(this.cell.getComponent(),this.listEl)),contents&&(this._clearList(),contents instanceof HTMLElement?placeholder=contents:(placeholder.classList.add("tabulator-edit-list-placeholder"),placeholder.innerHTML=contents),this.listEl.appendChild(placeholder),this._showList())}},{key:"_ajaxRequest",value:function(url,term){return url=urlBuilder(url,{},this.params.filterRemote?{term:term}:{}),fetch(url).then((function(response){return response.ok?response.json().catch((function(error){return console.warn("List Ajax Load Error - Invalid JSON returned",error),Promise.reject(error)})):(console.error("List Ajax Load Error - Connection Error: "+response.status,response.statusText),Promise.reject(response))})).catch((function(error){return console.error("List Ajax Load Error - Connection Error: ",error),Promise.reject(error)}))}},{key:"_uniqueColumnValues",value:function(field){var column,output={},data=this.table.getData(this.params.valuesLookup);return(column=field?this.table.columnManager.getColumnByField(field):this.cell.getColumn()._getSelf())?data.forEach((function(row){var val=column.getFieldValue(row);null!=val&&""!==val&&(output[val]=!0)})):(console.warn("unable to find matching column to create select lookup list:",field),output=[]),Object.keys(output)}},{key:"_parseList",value:function(inputValues){var _this48=this,data=[];return Array.isArray(inputValues)||(inputValues=Object.entries(inputValues).map((function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0];return{label:_ref2[1],value:key}}))),inputValues.forEach((function(value){"object"!==_typeof(value)&&(value={label:value,value:value}),_this48._parseListItem(value,data,0)})),!this.currentItems.length&&this.params.freetext&&(this.input.value=this.initialValues,this.typing=!0,this.lastAction="typing"),this.data=data,data}},{key:"_parseListItem",value:function(option,data,level){var item={};option.options?item=this._parseListGroup(option,level+1):(item={label:option.label,value:option.value,itemParams:option.itemParams,elementAttributes:option.elementAttributes,element:!1,selected:!1,visible:!0,level:level,original:option},this.initialValues&&this.initialValues.indexOf(option.value)>-1&&this._chooseItem(item,!0)),data.push(item)}},{key:"_parseListGroup",value:function(option,level){var _this49=this,item={label:option.label,group:!0,itemParams:option.itemParams,elementAttributes:option.elementAttributes,element:!1,visible:!0,level:level,options:[],original:option};return option.options.forEach((function(child){_this49._parseListItem(child,item.options,level)})),item}},{key:"_sortOptions",value:function(options){var sorter;return this.params.sort&&(sorter="function"==typeof this.params.sort?this.params.sort:this._defaultSortFunction.bind(this),this._sortGroup(sorter,options)),options}},{key:"_sortGroup",value:function(sorter,options){var _this50=this;options.sort((function(a,b){return sorter(a.label,b.label,a.value,b.value,a.original,b.original)})),options.forEach((function(option){option.group&&_this50._sortGroup(sorter,option.options)}))}},{key:"_defaultSortFunction",value:function(as,bs){var a,b,a1,b1,L,i=0,rx=/(\d+)|(\D+)/g,rd=/\d/,emptyAlign=0;if("desc"===this.params.sort){var _ref3=[bs,as];as=_ref3[0],bs=_ref3[1]}if(as||0===as){if(bs||0===bs){if(isFinite(as)&&isFinite(bs))return as-bs;if((a=String(as).toLowerCase())===(b=String(bs).toLowerCase()))return 0;if(!rd.test(a)||!rd.test(b))return a>b?1:-1;for(a=a.match(rx),b=b.match(rx),L=a.length>b.length?b.length:a.length;i<L;)if((a1=a[i])!==(b1=b[i++]))return isFinite(a1)&&isFinite(b1)?("0"===a1.charAt(0)&&(a1="."+a1),"0"===b1.charAt(0)&&(b1="."+b1),a1-b1):a1>b1?1:-1;return a.length>b.length}emptyAlign=1}else emptyAlign=bs||0===bs?-1:0;return emptyAlign}},{key:"_filterOptions",value:function(){var _this51=this,filterFunc=this.params.filterFunc||this._defaultFilterFunc,term=this.input.value;return term?(this.filtered=!0,this.data.forEach((function(item){_this51._filterItem(filterFunc,term,item)}))):this.filtered=!1,this.data}},{key:"_filterItem",value:function(func,term,item){var _this52=this,matches=!1;return item.group?(item.options.forEach((function(option){_this52._filterItem(func,term,option)&&(matches=!0)})),item.visible=matches):item.visible=func(term,item.label,item.value,item.original),item.visible}},{key:"_defaultFilterFunc",value:function(term,label,value,item){return term=String(term).toLowerCase(),null!=label&&(String(label).toLowerCase().indexOf(term)>-1||String(value).toLowerCase().indexOf(term)>-1)}},{key:"_clearList",value:function(){for(;this.listEl.firstChild;)this.listEl.removeChild(this.listEl.firstChild);this.displayItems=[]}},{key:"_buildList",value:function(data){var _this53=this;this._clearList(),data.forEach((function(option){_this53._buildItem(option)})),this.displayItems.length||this._addPlaceholder(this.params.placeholderEmpty)}},{key:"_buildItem",value:function(item){var contents,_this54=this,el=item.element;if(!this.filtered||item.visible){if(!el){if((el=document.createElement("div")).tabIndex=0,(contents=this.params.itemFormatter?this.params.itemFormatter(item.label,item.value,item.original,el):item.label)instanceof HTMLElement?el.appendChild(contents):el.innerHTML=contents,item.group?el.classList.add("tabulator-edit-list-group"):el.classList.add("tabulator-edit-list-item"),el.classList.add("tabulator-edit-list-group-level-"+item.level),item.elementAttributes&&"object"==_typeof(item.elementAttributes))for(var key in item.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),el.setAttribute(key,this.input.getAttribute(key)+item.elementAttributes["+"+key])):el.setAttribute(key,item.elementAttributes[key]);item.group?el.addEventListener("click",this._groupClick.bind(this,item)):el.addEventListener("click",this._itemClick.bind(this,item)),el.addEventListener("mousedown",this._preventBlur.bind(this)),item.element=el}this._styleItem(item),this.listEl.appendChild(el),item.group?item.options.forEach((function(option){_this54._buildItem(option)})):this.displayItems.push(item)}}},{key:"_showList",value:function(){var _this55=this,startVis=this.popup&&this.popup.isVisible();if(this.input.parentNode){if(this.params.autocomplete&&""===this.input.value&&!this.params.listOnEmpty)return void(this.popup&&this.popup.hide(!0));this._setListWidth(),this.popup||(this.popup=this.edit.popup(this.listEl)),this.popup.show(this.cell.getElement(),"bottom"),startVis||setTimeout((function(){_this55.popup.hideOnBlur(_this55._resolveValue.bind(_this55,!0))}),10)}}},{key:"_styleItem",value:function(item){item&&item.element&&(item.selected?item.element.classList.add("active"):item.element.classList.remove("active"))}},{key:"_itemClick",value:function(item,e){e.stopPropagation(),this._chooseItem(item)}},{key:"_groupClick",value:function(item,e){e.stopPropagation()}},{key:"_cancel",value:function(){this.popup.hide(!0),this.actions.cancel()}},{key:"_clearChoices",value:function(){var _this56=this;this.typing=!0,this.currentItems.forEach((function(item){item.selected=!1,_this56._styleItem(item)})),this.currentItems=[],this.focusedItem=null}},{key:"_chooseItem",value:function(item,silent){var index;this.typing=!1,this.params.multiselect?((index=this.currentItems.indexOf(item))>-1?(this.currentItems.splice(index,1),item.selected=!1):(this.currentItems.push(item),item.selected=!0),this.input.value=this.currentItems.map((function(item){return item.label})).join(","),this._styleItem(item)):(this.currentItems=[item],item.selected=!0,this.input.value=item.label,this._styleItem(item),silent||this._resolveValue()),this._focusItem(item)}},{key:"_resolveValue",value:function(blur){var output,initialValue;if(this.popup&&this.popup.hide(!0),this.params.multiselect)output=this.currentItems.map((function(item){return item.value}));else if(blur&&this.params.autocomplete&&this.typing){if(!(this.params.freetext||this.params.allowEmpty&&""===this.input.value))return void this.actions.cancel();output=this.input.value}else output=this.currentItems[0]?this.currentItems[0].value:null==(initialValue=this.initialValues[0])||""===initialValue?initialValue:this.params.emptyValue;""===output&&(output=this.params.emptyValue),this.actions.success(output),this.isFilter&&(this.initialValues=output&&!Array.isArray(output)?[output]:output,this.currentItems=[])}}]),Edit}();var defaultEditors={input:function(cell,onRendered,success,cancel,editorParams){var cellValue=cell.getValue(),input=document.createElement("input");if(input.setAttribute("type",editorParams.search?"search":"text"),input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==_typeof(editorParams.elementAttributes))for(var key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(e){null==cellValue&&""!==input.value||input.value!==cellValue?success(input.value)&&(cellValue=input.value):cancel()}return input.value=void 0!==cellValue?cellValue:"",onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%",editorParams.selectContents&&input.select()})),input.addEventListener("change",onChange),input.addEventListener("blur",onChange),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel();break;case 35:case 36:e.stopPropagation()}})),editorParams.mask&&maskInput(input,editorParams),input},textarea:function(cell,onRendered,success,cancel,editorParams){var cellValue=cell.getValue(),vertNav=editorParams.verticalNavigation||"hybrid",value=String(null!=cellValue?cellValue:""),input=document.createElement("textarea"),scrollHeight=0;if(input.style.display="block",input.style.padding="2px",input.style.height="100%",input.style.width="100%",input.style.boxSizing="border-box",input.style.whiteSpace="pre-wrap",input.style.resize="none",editorParams.elementAttributes&&"object"==_typeof(editorParams.elementAttributes))for(var key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(e){null==cellValue&&""!==input.value||input.value!==cellValue?(success(input.value)&&(cellValue=input.value),setTimeout((function(){cell.getRow().normalizeHeight()}),300)):cancel()}return input.value=value,onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%",input.scrollHeight,input.style.height=input.scrollHeight+"px",cell.getRow().normalizeHeight(),editorParams.selectContents&&input.select()})),input.addEventListener("change",onChange),input.addEventListener("blur",onChange),input.addEventListener("keyup",(function(){input.style.height="";var heightNow=input.scrollHeight;input.style.height=heightNow+"px",heightNow!=scrollHeight&&(scrollHeight=heightNow,cell.getRow().normalizeHeight())})),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:e.shiftKey&&editorParams.shiftEnterSubmit&&onChange();break;case 27:cancel();break;case 38:("editor"==vertNav||"hybrid"==vertNav&&input.selectionStart)&&(e.stopImmediatePropagation(),e.stopPropagation());break;case 40:("editor"==vertNav||"hybrid"==vertNav&&input.selectionStart!==input.value.length)&&(e.stopImmediatePropagation(),e.stopPropagation());break;case 35:case 36:e.stopPropagation()}})),editorParams.mask&&maskInput(input,editorParams),input},number:function(cell,onRendered,success,cancel,editorParams){var cellValue=cell.getValue(),vertNav=editorParams.verticalNavigation||"editor",input=document.createElement("input");if(input.setAttribute("type","number"),void 0!==editorParams.max&&input.setAttribute("max",editorParams.max),void 0!==editorParams.min&&input.setAttribute("min",editorParams.min),void 0!==editorParams.step&&input.setAttribute("step",editorParams.step),input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==_typeof(editorParams.elementAttributes))for(var key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);input.value=cellValue;var blurFunc=function(e){onChange()};function onChange(){var value=input.value;isNaN(value)||""===value||(value=Number(value)),value!==cellValue?success(value)&&(cellValue=value):cancel()}return onRendered((function(){input.removeEventListener("blur",blurFunc),input.focus({preventScroll:!0}),input.style.height="100%",input.addEventListener("blur",blurFunc),editorParams.selectContents&&input.select()})),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel();break;case 38:case 40:"editor"==vertNav&&(e.stopImmediatePropagation(),e.stopPropagation());break;case 35:case 36:e.stopPropagation()}})),editorParams.mask&&maskInput(input,editorParams),input},range:function(cell,onRendered,success,cancel,editorParams){var cellValue=cell.getValue(),input=document.createElement("input");if(input.setAttribute("type","range"),void 0!==editorParams.max&&input.setAttribute("max",editorParams.max),void 0!==editorParams.min&&input.setAttribute("min",editorParams.min),void 0!==editorParams.step&&input.setAttribute("step",editorParams.step),input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==_typeof(editorParams.elementAttributes))for(var key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(){var value=input.value;isNaN(value)||""===value||(value=Number(value)),value!=cellValue?success(value)&&(cellValue=value):cancel()}return input.value=cellValue,onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%"})),input.addEventListener("blur",(function(e){onChange()})),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel()}})),input},date:function(cell,onRendered,success,cancel,editorParams){var inputFormat=editorParams.format,DT=inputFormat?window.DateTime||luxon.DateTime:null,cellValue=cell.getValue(),input=document.createElement("input");function convertDate(value){return(DT.isDateTime(value)?value:"iso"===inputFormat?DT.fromISO(String(value)):DT.fromFormat(String(value),inputFormat)).toFormat("yyyy-MM-dd")}if(input.type="date",input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.max&&input.setAttribute("max",inputFormat?convertDate(editorParams.max):editorParams.max),editorParams.min&&input.setAttribute("min",inputFormat?convertDate(editorParams.min):editorParams.min),editorParams.elementAttributes&&"object"==_typeof(editorParams.elementAttributes))for(var key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(e){var value=input.value;null==cellValue&&""!==value||value!==cellValue?(value&&inputFormat&&(value=DT.fromFormat(String(value),"yyyy-MM-dd").toFormat(inputFormat)),success(value)&&(cellValue=input.value)):cancel()}return cellValue=void 0!==cellValue?cellValue:"",inputFormat&&(DT?cellValue=convertDate(cellValue):console.error("Editor Error - 'date' editor 'inputFormat' param is dependant on luxon.js")),input.value=cellValue,onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%",editorParams.selectContents&&input.select()})),input.addEventListener("change",onChange),input.addEventListener("blur",onChange),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel();break;case 35:case 36:e.stopPropagation()}})),input},time:function(cell,onRendered,success,cancel,editorParams){var newDatetime,inputFormat=editorParams.format,DT=inputFormat?window.DateTime||luxon.DateTime:null,cellValue=cell.getValue(),input=document.createElement("input");if(input.type="time",input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==_typeof(editorParams.elementAttributes))for(var key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(e){var value=input.value;null==cellValue&&""!==value||value!==cellValue?(value&&inputFormat&&(value=DT.fromFormat(String(value),"hh:mm").toFormat(inputFormat)),success(value)&&(cellValue=input.value)):cancel()}return cellValue=void 0!==cellValue?cellValue:"",inputFormat&&(DT?(newDatetime=DT.isDateTime(cellValue)?cellValue:"iso"===inputFormat?DT.fromISO(String(cellValue)):DT.fromFormat(String(cellValue),inputFormat),cellValue=newDatetime.toFormat("hh:mm")):console.error("Editor Error - 'date' editor 'inputFormat' param is dependant on luxon.js")),input.value=cellValue,onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%",editorParams.selectContents&&input.select()})),input.addEventListener("change",onChange),input.addEventListener("blur",onChange),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel();break;case 35:case 36:e.stopPropagation()}})),input},datetime:function(cell,onRendered,success,cancel,editorParams){var newDatetime,inputFormat=editorParams.format,DT=inputFormat?window.DateTime||luxon.DateTime:null,cellValue=cell.getValue(),input=document.createElement("input");if(input.type="datetime-local",input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==_typeof(editorParams.elementAttributes))for(var key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(e){var value=input.value;null==cellValue&&""!==value||value!==cellValue?(value&&inputFormat&&(value=DT.fromISO(String(value)).toFormat(inputFormat)),success(value)&&(cellValue=input.value)):cancel()}return cellValue=void 0!==cellValue?cellValue:"",inputFormat&&(DT?(newDatetime=DT.isDateTime(cellValue)?cellValue:"iso"===inputFormat?DT.fromISO(String(cellValue)):DT.fromFormat(String(cellValue),inputFormat),cellValue=newDatetime.toFormat("yyyy-MM-dd")+"T"+newDatetime.toFormat("hh:mm")):console.error("Editor Error - 'date' editor 'inputFormat' param is dependant on luxon.js")),input.value=cellValue,onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%",editorParams.selectContents&&input.select()})),input.addEventListener("change",onChange),input.addEventListener("blur",onChange),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel();break;case 35:case 36:e.stopPropagation()}})),input},select:function(cell,onRendered,success,cancel,editorParams){return this.deprecationMsg("The select editor has been deprecated, please use the new list editor"),new Edit(this,cell,onRendered,success,cancel,editorParams).input},list:function(cell,onRendered,success,cancel,editorParams){return new Edit(this,cell,onRendered,success,cancel,editorParams).input},autocomplete:function(cell,onRendered,success,cancel,editorParams){return this.deprecationMsg("The autocomplete editor has been deprecated, please use the new list editor with the 'autocomplete' editorParam"),editorParams.autocomplete=!0,new Edit(this,cell,onRendered,success,cancel,editorParams).input},star:function(cell,onRendered,success,cancel,editorParams){var self=this,element=cell.getElement(),value=cell.getValue(),maxStars=element.getElementsByTagName("svg").length||5,size=element.getElementsByTagName("svg")[0]?element.getElementsByTagName("svg")[0].getAttribute("width"):14,stars=[],starsHolder=document.createElement("div"),star=document.createElementNS("http://www.w3.org/2000/svg","svg");function starChange(val){stars.forEach((function(star,i){i<val?("ie"==self.table.browser?star.setAttribute("class","tabulator-star-active"):star.classList.replace("tabulator-star-inactive","tabulator-star-active"),star.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):("ie"==self.table.browser?star.setAttribute("class","tabulator-star-inactive"):star.classList.replace("tabulator-star-active","tabulator-star-inactive"),star.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')}))}function buildStar(i){var starHolder=document.createElement("span"),nextStar=star.cloneNode(!0);stars.push(nextStar),starHolder.addEventListener("mouseenter",(function(e){e.stopPropagation(),e.stopImmediatePropagation(),starChange(i)})),starHolder.addEventListener("mousemove",(function(e){e.stopPropagation(),e.stopImmediatePropagation()})),starHolder.addEventListener("click",(function(e){e.stopPropagation(),e.stopImmediatePropagation(),success(i),element.blur()})),starHolder.appendChild(nextStar),starsHolder.appendChild(starHolder)}function changeValue(val){value=val,starChange(val)}if(element.style.whiteSpace="nowrap",element.style.overflow="hidden",element.style.textOverflow="ellipsis",starsHolder.style.verticalAlign="middle",starsHolder.style.display="inline-block",starsHolder.style.padding="4px",star.setAttribute("width",size),star.setAttribute("height",size),star.setAttribute("viewBox","0 0 512 512"),star.setAttribute("xml:space","preserve"),star.style.padding="0 1px",editorParams.elementAttributes&&"object"==_typeof(editorParams.elementAttributes))for(var key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),starsHolder.setAttribute(key,starsHolder.getAttribute(key)+editorParams.elementAttributes["+"+key])):starsHolder.setAttribute(key,editorParams.elementAttributes[key]);for(var i=1;i<=maxStars;i++)buildStar(i);return starChange(value=Math.min(parseInt(value),maxStars)),starsHolder.addEventListener("mousemove",(function(e){starChange(0)})),starsHolder.addEventListener("click",(function(e){success(0)})),element.addEventListener("blur",(function(e){cancel()})),element.addEventListener("keydown",(function(e){switch(e.keyCode){case 39:changeValue(value+1);break;case 37:changeValue(value-1);break;case 13:success(value);break;case 27:cancel()}})),starsHolder},progress:function(cell,onRendered,success,cancel,editorParams){var mouseDrag,mouseDragWidth,element=cell.getElement(),max=void 0===editorParams.max?element.getElementsByTagName("div")[0]&&element.getElementsByTagName("div")[0].getAttribute("max")||100:editorParams.max,min=void 0===editorParams.min?element.getElementsByTagName("div")[0]&&element.getElementsByTagName("div")[0].getAttribute("min")||0:editorParams.min,percent=(max-min)/100,value=cell.getValue()||0,handle=document.createElement("div"),bar=document.createElement("div");function updateValue(){var style=window.getComputedStyle(element,null),calcVal=percent*Math.round(bar.offsetWidth/((element.clientWidth-parseInt(style.getPropertyValue("padding-left"))-parseInt(style.getPropertyValue("padding-right")))/100))+min;success(calcVal),element.setAttribute("aria-valuenow",calcVal),element.setAttribute("aria-label",value)}if(handle.style.position="absolute",handle.style.right="0",handle.style.top="0",handle.style.bottom="0",handle.style.width="5px",handle.classList.add("tabulator-progress-handle"),bar.style.display="inline-block",bar.style.position="relative",bar.style.height="100%",bar.style.backgroundColor="#488CE9",bar.style.maxWidth="100%",bar.style.minWidth="0%",editorParams.elementAttributes&&"object"==_typeof(editorParams.elementAttributes))for(var key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),bar.setAttribute(key,bar.getAttribute(key)+editorParams.elementAttributes["+"+key])):bar.setAttribute(key,editorParams.elementAttributes[key]);return element.style.padding="4px 4px",value=Math.min(parseFloat(value),max),value=Math.max(parseFloat(value),min),value=Math.round((value-min)/percent),bar.style.width=value+"%",element.setAttribute("aria-valuemin",min),element.setAttribute("aria-valuemax",max),bar.appendChild(handle),handle.addEventListener("mousedown",(function(e){mouseDrag=e.screenX,mouseDragWidth=bar.offsetWidth})),handle.addEventListener("mouseover",(function(){handle.style.cursor="ew-resize"})),element.addEventListener("mousemove",(function(e){mouseDrag&&(bar.style.width=mouseDragWidth+e.screenX-mouseDrag+"px")})),element.addEventListener("mouseup",(function(e){mouseDrag&&(e.stopPropagation(),e.stopImmediatePropagation(),mouseDrag=!1,mouseDragWidth=!1,updateValue())})),element.addEventListener("keydown",(function(e){switch(e.keyCode){case 39:e.preventDefault(),bar.style.width=bar.clientWidth+element.clientWidth/100+"px";break;case 37:e.preventDefault(),bar.style.width=bar.clientWidth-element.clientWidth/100+"px";break;case 9:case 13:updateValue();break;case 27:cancel()}})),element.addEventListener("blur",(function(){cancel()})),bar},tickCross:function(cell,onRendered,success,cancel,editorParams){var value=cell.getValue(),input=document.createElement("input"),tristate=editorParams.tristate,indetermValue=void 0===editorParams.indeterminateValue?null:editorParams.indeterminateValue,indetermState=!1,trueValueSet=Object.keys(editorParams).includes("trueValue"),falseValueSet=Object.keys(editorParams).includes("falseValue");if(input.setAttribute("type","checkbox"),input.style.marginTop="5px",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==_typeof(editorParams.elementAttributes))for(var key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function setValue(blur){var checkedValue=input.checked;return trueValueSet&&checkedValue?checkedValue=editorParams.trueValue:falseValueSet&&!checkedValue&&(checkedValue=editorParams.falseValue),tristate?blur?indetermState?indetermValue:checkedValue:input.checked&&!indetermState?(input.checked=!1,input.indeterminate=!0,indetermState=!0,indetermValue):(indetermState=!1,checkedValue):checkedValue}return input.value=value,!tristate||void 0!==value&&value!==indetermValue&&""!==value||(indetermState=!0,input.indeterminate=!0),"firefox"!=this.table.browser&&onRendered((function(){input.focus({preventScroll:!0})})),input.checked=trueValueSet?value===editorParams.trueValue:!0===value||"true"===value||"True"===value||1===value,onRendered((function(){input.focus()})),input.addEventListener("change",(function(e){success(setValue())})),input.addEventListener("blur",(function(e){success(setValue(!0))})),input.addEventListener("keydown",(function(e){13==e.keyCode&&success(setValue()),27==e.keyCode&&cancel()})),input}},Edit$1=function(_Module7){_inherits(Edit$1,_Module7);var _super12=_createSuper(Edit$1);function Edit$1(table){var _this57;return _classCallCheck(this,Edit$1),(_this57=_super12.call(this,table)).currentCell=!1,_this57.mouseClick=!1,_this57.recursionBlock=!1,_this57.invalidEdit=!1,_this57.editedCells=[],_this57.editors=Edit$1.editors,_this57.registerColumnOption("editable"),_this57.registerColumnOption("editor"),_this57.registerColumnOption("editorParams"),_this57.registerColumnOption("cellEditing"),_this57.registerColumnOption("cellEdited"),_this57.registerColumnOption("cellEditCancelled"),_this57.registerTableFunction("getEditedCells",_this57.getEditedCells.bind(_assertThisInitialized(_this57))),_this57.registerTableFunction("clearCellEdited",_this57.clearCellEdited.bind(_assertThisInitialized(_this57))),_this57.registerTableFunction("navigatePrev",_this57.navigatePrev.bind(_assertThisInitialized(_this57))),_this57.registerTableFunction("navigateNext",_this57.navigateNext.bind(_assertThisInitialized(_this57))),_this57.registerTableFunction("navigateLeft",_this57.navigateLeft.bind(_assertThisInitialized(_this57))),_this57.registerTableFunction("navigateRight",_this57.navigateRight.bind(_assertThisInitialized(_this57))),_this57.registerTableFunction("navigateUp",_this57.navigateUp.bind(_assertThisInitialized(_this57))),_this57.registerTableFunction("navigateDown",_this57.navigateDown.bind(_assertThisInitialized(_this57))),_this57.registerComponentFunction("cell","isEdited",_this57.cellIsEdited.bind(_assertThisInitialized(_this57))),_this57.registerComponentFunction("cell","clearEdited",_this57.clearEdited.bind(_assertThisInitialized(_this57))),_this57.registerComponentFunction("cell","edit",_this57.editCell.bind(_assertThisInitialized(_this57))),_this57.registerComponentFunction("cell","cancelEdit",_this57.cellCancelEdit.bind(_assertThisInitialized(_this57))),_this57.registerComponentFunction("cell","navigatePrev",_this57.navigatePrev.bind(_assertThisInitialized(_this57))),_this57.registerComponentFunction("cell","navigateNext",_this57.navigateNext.bind(_assertThisInitialized(_this57))),_this57.registerComponentFunction("cell","navigateLeft",_this57.navigateLeft.bind(_assertThisInitialized(_this57))),_this57.registerComponentFunction("cell","navigateRight",_this57.navigateRight.bind(_assertThisInitialized(_this57))),_this57.registerComponentFunction("cell","navigateUp",_this57.navigateUp.bind(_assertThisInitialized(_this57))),_this57.registerComponentFunction("cell","navigateDown",_this57.navigateDown.bind(_assertThisInitialized(_this57))),_this57}return _createClass(Edit$1,[{key:"initialize",value:function(){this.subscribe("cell-init",this.bindEditor.bind(this)),this.subscribe("cell-delete",this.clearEdited.bind(this)),this.subscribe("cell-value-changed",this.updateCellClass.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("column-delete",this.columnDeleteCheck.bind(this)),this.subscribe("row-deleting",this.rowDeleteCheck.bind(this)),this.subscribe("row-layout",this.rowEditableCheck.bind(this)),this.subscribe("data-refreshing",this.cancelEdit.bind(this)),this.subscribe("keybinding-nav-prev",this.navigatePrev.bind(this,void 0)),this.subscribe("keybinding-nav-next",this.keybindingNavigateNext.bind(this)),this.subscribe("keybinding-nav-left",this.navigateLeft.bind(this,void 0)),this.subscribe("keybinding-nav-right",this.navigateRight.bind(this,void 0)),this.subscribe("keybinding-nav-up",this.navigateUp.bind(this,void 0)),this.subscribe("keybinding-nav-down",this.navigateDown.bind(this,void 0))}},{key:"keybindingNavigateNext",value:function(e){var cell=this.currentCell,newRow=this.options("tabEndNewRow");cell&&(this.navigateNext(cell,e)||newRow&&(cell.getElement().firstChild.blur(),(newRow=!0===newRow?this.table.addRow({}):"function"==typeof newRow?this.table.addRow(newRow(cell.row.getComponent())):this.table.addRow(Object.assign({},newRow))).then((function(){setTimeout((function(){cell.getComponent().navigateNext()}))}))))}},{key:"cellIsEdited",value:function(cell){return!!cell.modules.edit&&cell.modules.edit.edited}},{key:"cellCancelEdit",value:function(cell){cell===this.currentCell?this.table.modules.edit.cancelEdit():console.warn("Cancel Editor Error - This cell is not currently being edited ")}},{key:"updateCellClass",value:function(cell){this.allowEdit(cell)?cell.getElement().classList.add("tabulator-editable"):cell.getElement().classList.remove("tabulator-editable")}},{key:"clearCellEdited",value:function(cells){var _this58=this;cells||(cells=this.table.modules.edit.getEditedCells()),Array.isArray(cells)||(cells=[cells]),cells.forEach((function(cell){_this58.table.modules.edit.clearEdited(cell._getSelf())}))}},{key:"navigatePrev",value:function(){var nextCell,prevRow,cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;if(cell){if(e&&e.preventDefault(),nextCell=this.navigateLeft())return!0;if((prevRow=this.table.rowManager.prevDisplayRow(cell.row,!0))&&(nextCell=this.findPrevEditableCell(prevRow,prevRow.cells.length)))return nextCell.getComponent().edit(),!0}return!1}},{key:"navigateNext",value:function(){var nextCell,nextRow,cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;if(cell){if(e&&e.preventDefault(),nextCell=this.navigateRight())return!0;if((nextRow=this.table.rowManager.nextDisplayRow(cell.row,!0))&&(nextCell=this.findNextEditableCell(nextRow,-1)))return nextCell.getComponent().edit(),!0}return!1}},{key:"navigateLeft",value:function(){var index,nextCell,cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;return!!(cell&&(e&&e.preventDefault(),index=cell.getIndex(),nextCell=this.findPrevEditableCell(cell.row,index)))&&(nextCell.getComponent().edit(),!0)}},{key:"navigateRight",value:function(){var index,nextCell,cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;return!!(cell&&(e&&e.preventDefault(),index=cell.getIndex(),nextCell=this.findNextEditableCell(cell.row,index)))&&(nextCell.getComponent().edit(),!0)}},{key:"navigateUp",value:function(){var index,nextRow,cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;return!!(cell&&(e&&e.preventDefault(),index=cell.getIndex(),nextRow=this.table.rowManager.prevDisplayRow(cell.row,!0)))&&(nextRow.cells[index].getComponent().edit(),!0)}},{key:"navigateDown",value:function(){var index,nextRow,cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;return!!(cell&&(e&&e.preventDefault(),index=cell.getIndex(),nextRow=this.table.rowManager.nextDisplayRow(cell.row,!0)))&&(nextRow.cells[index].getComponent().edit(),!0)}},{key:"findNextEditableCell",value:function(row,index){var nextCell=!1;if(index<row.cells.length-1)for(var i=index+1;i<row.cells.length;i++){var cell=row.cells[i];if(cell.column.modules.edit&&Helpers.elVisible(cell.getElement()))if(this.allowEdit(cell)){nextCell=cell;break}}return nextCell}},{key:"findPrevEditableCell",value:function(row,index){var prevCell=!1;if(index>0)for(var i=index-1;i>=0;i--){var cell=row.cells[i];if(cell.column.modules.edit&&Helpers.elVisible(cell.getElement()))if(this.allowEdit(cell)){prevCell=cell;break}}return prevCell}},{key:"initializeColumnCheck",value:function(column){void 0!==column.definition.editor&&this.initializeColumn(column)}},{key:"columnDeleteCheck",value:function(column){this.currentCell&&this.currentCell.column===column&&this.cancelEdit()}},{key:"rowDeleteCheck",value:function(row){this.currentCell&&this.currentCell.row===row&&this.cancelEdit()}},{key:"rowEditableCheck",value:function(row){var _this59=this;row.getCells().forEach((function(cell){cell.column.modules.edit&&"function"==typeof cell.column.modules.edit.check&&_this59.updateCellClass(cell)}))}},{key:"initializeColumn",value:function(column){var config={editor:!1,blocked:!1,check:column.definition.editable,params:column.definition.editorParams||{}};switch(_typeof(column.definition.editor)){case"string":this.editors[column.definition.editor]?config.editor=this.editors[column.definition.editor]:console.warn("Editor Error - No such editor found: ",column.definition.editor);break;case"function":config.editor=column.definition.editor;break;case"boolean":!0===column.definition.editor&&("function"!=typeof column.definition.formatter?this.editors[column.definition.formatter]?config.editor=this.editors[column.definition.formatter]:config.editor=this.editors.input:console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",column.definition.formatter))}config.editor&&(column.modules.edit=config)}},{key:"getCurrentCell",value:function(){return!!this.currentCell&&this.currentCell.getComponent()}},{key:"clearEditor",value:function(cancel){var cellEl,cell=this.currentCell;if(this.invalidEdit=!1,cell){for(this.currentCell=!1,cellEl=cell.getElement(),this.dispatch("edit-editor-clear",cell,cancel),cellEl.classList.remove("tabulator-editing");cellEl.firstChild;)cellEl.removeChild(cellEl.firstChild);cell.row.getElement().classList.remove("tabulator-editing"),cell.table.element.classList.remove("tabulator-editing")}}},{key:"cancelEdit",value:function(){if(this.currentCell){var cell=this.currentCell,component=this.currentCell.getComponent();this.clearEditor(!0),cell.setValueActual(cell.getValue()),cell.cellRendered(),("textarea"==cell.column.definition.editor||cell.column.definition.variableHeight)&&cell.row.normalizeHeight(!0),cell.column.definition.cellEditCancelled&&cell.column.definition.cellEditCancelled.call(this.table,component),this.dispatch("edit-cancelled",cell),this.dispatchExternal("cellEditCancelled",component)}}},{key:"bindEditor",value:function(cell){if(cell.column.modules.edit){var self=this,element=cell.getElement(!0);this.updateCellClass(cell),element.setAttribute("tabindex",0),element.addEventListener("click",(function(e){element.classList.contains("tabulator-editing")||element.focus({preventScroll:!0})})),element.addEventListener("mousedown",(function(e){2===e.button?e.preventDefault():self.mouseClick=!0})),element.addEventListener("focus",(function(e){self.recursionBlock||self.edit(cell,e,!1)}))}}},{key:"focusCellNoEvent",value:function(cell,block){this.recursionBlock=!0,block&&"ie"===this.table.browser||cell.getElement().focus({preventScroll:!0}),this.recursionBlock=!1}},{key:"editCell",value:function(cell,forceEdit){this.focusCellNoEvent(cell),this.edit(cell,!1,forceEdit)}},{key:"focusScrollAdjust",value:function(cell){if("virtual"==this.table.rowManager.getRenderMode()){var topEdge=this.table.rowManager.element.scrollTop,bottomEdge=this.table.rowManager.element.clientHeight+this.table.rowManager.element.scrollTop,rowEl=cell.row.getElement();rowEl.offsetTop<topEdge?this.table.rowManager.element.scrollTop-=topEdge-rowEl.offsetTop:rowEl.offsetTop+rowEl.offsetHeight>bottomEdge&&(this.table.rowManager.element.scrollTop+=rowEl.offsetTop+rowEl.offsetHeight-bottomEdge);var leftEdge=this.table.rowManager.element.scrollLeft,rightEdge=this.table.rowManager.element.clientWidth+this.table.rowManager.element.scrollLeft,cellEl=cell.getElement();this.table.modExists("frozenColumns")&&(leftEdge+=parseInt(this.table.modules.frozenColumns.leftMargin),rightEdge-=parseInt(this.table.modules.frozenColumns.rightMargin)),"virtual"===this.table.options.renderHorizontal&&(leftEdge-=parseInt(this.table.columnManager.renderer.vDomPadLeft),rightEdge-=parseInt(this.table.columnManager.renderer.vDomPadLeft)),cellEl.offsetLeft<leftEdge?this.table.rowManager.element.scrollLeft-=leftEdge-cellEl.offsetLeft:cellEl.offsetLeft+cellEl.offsetWidth>rightEdge&&(this.table.rowManager.element.scrollLeft+=cellEl.offsetLeft+cellEl.offsetWidth-rightEdge)}}},{key:"allowEdit",value:function(cell){var check=!!cell.column.modules.edit;if(cell.column.modules.edit)switch(_typeof(cell.column.modules.edit.check)){case"function":cell.row.initialized&&(check=cell.column.modules.edit.check(cell.getComponent()));break;case"string":check=!!cell.row.data[cell.column.modules.edit.check];break;case"boolean":check=cell.column.modules.edit.check}return check}},{key:"edit",value:function(cell,e,forceEdit){var cellEditor,component,params,self=this,rendered=function(){},element=cell.getElement();if(!this.currentCell){if(cell.column.modules.edit.blocked)return this.mouseClick=!1,element.blur(),!1;if(e&&e.stopPropagation(),this.allowEdit(cell)||forceEdit){if(self.cancelEdit(),self.currentCell=cell,this.focusScrollAdjust(cell),component=cell.getComponent(),this.mouseClick&&(this.mouseClick=!1,cell.column.definition.cellClick&&cell.column.definition.cellClick.call(this.table,e,component)),cell.column.definition.cellEditing&&cell.column.definition.cellEditing.call(this.table,component),this.dispatch("cell-editing",cell),this.dispatchExternal("cellEditing",component),params="function"==typeof cell.column.modules.edit.params?cell.column.modules.edit.params(component):cell.column.modules.edit.params,!1===(cellEditor=cell.column.modules.edit.editor.call(self,component,(function(callback){rendered=callback}),(function(value){if(self.currentCell===cell){var valid=self.chain("edit-success",[cell,value],!0,!0);return!0===valid||"highlight"===self.table.options.validationMode?(self.clearEditor(),cell.modules.edit||(cell.modules.edit={}),cell.modules.edit.edited=!0,-1==self.editedCells.indexOf(cell)&&self.editedCells.push(cell),cell.setValue(value,!0),!0===valid):(self.invalidEdit=!0,self.focusCellNoEvent(cell,!0),rendered(),!1)}}),(function(){self.currentCell===cell&&self.cancelEdit()}),params)))return element.blur(),!1;if(!(cellEditor instanceof Node))return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:",cellEditor),element.blur(),!1;for(element.classList.add("tabulator-editing"),cell.row.getElement().classList.add("tabulator-editing"),cell.table.element.classList.add("tabulator-editing");element.firstChild;)element.removeChild(element.firstChild);element.appendChild(cellEditor),rendered();for(var children=element.children,i=0;i<children.length;i++)children[i].addEventListener("click",(function(e){e.stopPropagation()}));return!0}return this.mouseClick=!1,element.blur(),!1}this.invalidEdit||this.cancelEdit()}},{key:"getEditedCells",value:function(){var output=[];return this.editedCells.forEach((function(cell){output.push(cell.getComponent())})),output}},{key:"clearEdited",value:function(cell){var editIndex;cell.modules.edit&&cell.modules.edit.edited&&(cell.modules.edit.edited=!1,this.dispatch("edit-edited-clear",cell)),(editIndex=this.editedCells.indexOf(cell))>-1&&this.editedCells.splice(editIndex,1)}}]),Edit$1}(Module);_exports.EditModule=Edit$1,Edit$1.moduleName="edit",Edit$1.editors=defaultEditors;var ExportRow=_createClass((function ExportRow(type,columns,component,indent){_classCallCheck(this,ExportRow),this.type=type,this.columns=columns,this.component=component||!1,this.indent=indent||0})),ExportColumn=_createClass((function ExportColumn(value,component,width,height,depth){_classCallCheck(this,ExportColumn),this.value=value,this.component=component||!1,this.width=width,this.height=height,this.depth=depth})),Export=function(_Module8){_inherits(Export,_Module8);var _super13=_createSuper(Export);function Export(table){var _this60;return _classCallCheck(this,Export),(_this60=_super13.call(this,table)).config={},_this60.cloneTableStyle=!0,_this60.colVisProp="",_this60.registerTableOption("htmlOutputConfig",!1),_this60.registerColumnOption("htmlOutput"),_this60.registerColumnOption("titleHtmlOutput"),_this60}return _createClass(Export,[{key:"initialize",value:function(){this.registerTableFunction("getHtml",this.getHtml.bind(this))}},{key:"generateExportList",value:function(config,style,range,colVisProp){this.cloneTableStyle=style,this.config=config||{},this.colVisProp=colVisProp;var headers=!1!==this.config.columnHeaders?this.headersToExportRows(this.generateColumnGroupHeaders()):[],body=this.bodyToExportRows(this.rowLookup(range));return headers.concat(body)}},{key:"generateTable",value:function(config,style,range,colVisProp){var list=this.generateExportList(config,style,range,colVisProp);return this.generateTableElement(list)}},{key:"rowLookup",value:function(range){var _this61=this,rows=[];if("function"==typeof range)range.call(this.table).forEach((function(row){(row=_this61.table.rowManager.findRow(row))&&rows.push(row)}));else switch(range){case!0:case"visible":rows=this.table.rowManager.getVisibleRows(!1,!0);break;case"all":rows=this.table.rowManager.rows;break;case"selected":rows=this.table.modules.selectRow.selectedRows;break;default:rows=this.table.options.pagination?this.table.rowManager.getDisplayRows(this.table.rowManager.displayRows.length-2):this.table.rowManager.getDisplayRows()}return Object.assign([],rows)}},{key:"generateColumnGroupHeaders",value:function(){var _this62=this,output=[];return(!1!==this.config.columnGroups?this.table.columnManager.columns:this.table.columnManager.columnsByIndex).forEach((function(column){var colData=_this62.processColumnGroup(column);colData&&output.push(colData)})),output}},{key:"processColumnGroup",value:function(column){var _this63=this,subGroups=column.columns,maxDepth=0,groupData={title:column.definition["title"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))]||column.definition.title,column:column,depth:1};if(subGroups.length){if(groupData.subGroups=[],groupData.width=0,subGroups.forEach((function(subGroup){var subGroupData=_this63.processColumnGroup(subGroup);subGroupData&&(groupData.width+=subGroupData.width,groupData.subGroups.push(subGroupData),subGroupData.depth>maxDepth&&(maxDepth=subGroupData.depth))})),groupData.depth+=maxDepth,!groupData.width)return!1}else{if(!this.columnVisCheck(column))return!1;groupData.width=1}return groupData}},{key:"columnVisCheck",value:function(column){var visProp=column.definition[this.colVisProp];return"function"==typeof visProp&&(visProp=visProp.call(this.table,column.getComponent())),!1!==visProp&&(column.visible||!column.visible&&visProp)}},{key:"headersToExportRows",value:function(columns){var headers=[],headerDepth=0,exportRows=[];function parseColumnGroup(column,level){var depth=headerDepth-level;if(void 0===headers[level]&&(headers[level]=[]),column.height=column.subGroups?1:depth-column.depth+1,headers[level].push(column),column.height>1)for(var i=1;i<column.height;i++)void 0===headers[level+i]&&(headers[level+i]=[]),headers[level+i].push(!1);if(column.width>1)for(var _i2=1;_i2<column.width;_i2++)headers[level].push(!1);column.subGroups&&column.subGroups.forEach((function(subGroup){parseColumnGroup(subGroup,level+1)}))}return columns.forEach((function(column){column.depth>headerDepth&&(headerDepth=column.depth)})),columns.forEach((function(column){parseColumnGroup(column,0)})),headers.forEach((function(header){var columns=[];header.forEach((function(col){if(col){var title=void 0===col.title?"":col.title;columns.push(new ExportColumn(title,col.column.getComponent(),col.width,col.height,col.depth))}else columns.push(null)})),exportRows.push(new ExportRow("header",columns))})),exportRows}},{key:"bodyToExportRows",value:function(rows){var _this64=this,columns=[],exportRows=[];return this.table.columnManager.columnsByIndex.forEach((function(column){_this64.columnVisCheck(column)&&columns.push(column.getComponent())})),!1!==this.config.columnCalcs&&this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&rows.unshift(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&rows.push(this.table.modules.columnCalcs.botRow)),(rows=rows.filter((function(row){switch(row.type){case"group":return!1!==_this64.config.rowGroups;case"calc":return!1!==_this64.config.columnCalcs;case"row":return!(_this64.table.options.dataTree&&!1===_this64.config.dataTree&&row.modules.dataTree.parent)}return!0}))).forEach((function(row,i){var rowData=row.getData(_this64.colVisProp),exportCols=[],indent=0;switch(row.type){case"group":indent=row.level,exportCols.push(new ExportColumn(row.key,row.getComponent(),columns.length,1));break;case"calc":case"row":columns.forEach((function(col){exportCols.push(new ExportColumn(col._column.getFieldValue(rowData),col,1,1))})),_this64.table.options.dataTree&&!1!==_this64.config.dataTree&&(indent=row.modules.dataTree.index)}exportRows.push(new ExportRow(row.type,exportCols,row.getComponent(),indent))})),exportRows}},{key:"generateTableElement",value:function(list){var _this65=this,table=document.createElement("table"),headerEl=document.createElement("thead"),bodyEl=document.createElement("tbody"),styles=this.lookupTableStyles(),rowFormatter=this.table.options["rowFormatter"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))],setup={};return setup.rowFormatter=null!==rowFormatter?rowFormatter:this.table.options.rowFormatter,this.table.options.dataTree&&!1!==this.config.dataTree&&this.table.modExists("columnCalcs")&&(setup.treeElementField=this.table.modules.dataTree.elementField),setup.groupHeader=this.table.options["groupHeader"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))],setup.groupHeader&&!Array.isArray(setup.groupHeader)&&(setup.groupHeader=[setup.groupHeader]),table.classList.add("tabulator-print-table"),this.mapElementStyles(this.table.columnManager.getHeadersElement(),headerEl,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),list.length>1e3&&console.warn("It may take a long time to render an HTML table with more than 1000 rows"),list.forEach((function(row,i){var rowEl;switch(row.type){case"header":headerEl.appendChild(_this65.generateHeaderElement(row,setup,styles));break;case"group":bodyEl.appendChild(_this65.generateGroupElement(row,setup,styles));break;case"calc":bodyEl.appendChild(_this65.generateCalcElement(row,setup,styles));break;case"row":rowEl=_this65.generateRowElement(row,setup,styles),_this65.mapElementStyles(i%2&&styles.evenRow?styles.evenRow:styles.oddRow,rowEl,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),bodyEl.appendChild(rowEl)}})),headerEl.innerHTML&&table.appendChild(headerEl),table.appendChild(bodyEl),this.mapElementStyles(this.table.element,table,["border-top","border-left","border-right","border-bottom"]),table}},{key:"lookupTableStyles",value:function(){var styles={};return this.cloneTableStyle&&window.getComputedStyle&&(styles.oddRow=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),styles.evenRow=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),styles.calcRow=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),styles.firstRow=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),styles.firstGroup=this.table.element.getElementsByClassName("tabulator-group")[0],styles.firstRow&&(styles.styleCells=styles.firstRow.getElementsByClassName("tabulator-cell"),styles.firstCell=styles.styleCells[0],styles.lastCell=styles.styleCells[styles.styleCells.length-1])),styles}},{key:"generateHeaderElement",value:function(row,setup,styles){var _this66=this,rowEl=document.createElement("tr");return row.columns.forEach((function(column){if(column){var cellEl=document.createElement("th"),classNames=column.component._column.definition.cssClass?column.component._column.definition.cssClass.split(" "):[];cellEl.colSpan=column.width,cellEl.rowSpan=column.height,cellEl.innerHTML=column.value,_this66.cloneTableStyle&&(cellEl.style.boxSizing="border-box"),classNames.forEach((function(className){cellEl.classList.add(className)})),_this66.mapElementStyles(column.component.getElement(),cellEl,["text-align","border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),_this66.mapElementStyles(column.component._column.contentElement,cellEl,["padding-top","padding-left","padding-right","padding-bottom"]),column.component._column.visible?_this66.mapElementStyles(column.component.getElement(),cellEl,["width"]):column.component._column.definition.width&&(cellEl.style.width=column.component._column.definition.width+"px"),column.component._column.parent&&_this66.mapElementStyles(column.component._column.parent.groupElement,cellEl,["border-top"]),rowEl.appendChild(cellEl)}})),rowEl}},{key:"generateGroupElement",value:function(row,setup,styles){var rowEl=document.createElement("tr"),cellEl=document.createElement("td"),group=row.columns[0];return rowEl.classList.add("tabulator-print-table-row"),setup.groupHeader&&setup.groupHeader[row.indent]?group.value=setup.groupHeader[row.indent](group.value,row.component._group.getRowCount(),row.component._group.getData(),row.component):!1!==setup.groupHeader&&(group.value=row.component._group.generator(group.value,row.component._group.getRowCount(),row.component._group.getData(),row.component)),cellEl.colSpan=group.width,cellEl.innerHTML=group.value,rowEl.classList.add("tabulator-print-table-group"),rowEl.classList.add("tabulator-group-level-"+row.indent),group.component.isVisible()&&rowEl.classList.add("tabulator-group-visible"),this.mapElementStyles(styles.firstGroup,rowEl,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),this.mapElementStyles(styles.firstGroup,cellEl,["padding-top","padding-left","padding-right","padding-bottom"]),rowEl.appendChild(cellEl),rowEl}},{key:"generateCalcElement",value:function(row,setup,styles){var rowEl=this.generateRowElement(row,setup,styles);return rowEl.classList.add("tabulator-print-table-calcs"),this.mapElementStyles(styles.calcRow,rowEl,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),rowEl}},{key:"generateRowElement",value:function(row,setup,styles){var _this67=this,rowEl=document.createElement("tr");return rowEl.classList.add("tabulator-print-table-row"),row.columns.forEach((function(col,i){if(col){var cellStyle,cellEl=document.createElement("td"),column=col.component._column,index=_this67.table.columnManager.findColumnIndex(column),value=col.value,cellWrapper={modules:{},getValue:function(){return value},getField:function(){return column.definition.field},getElement:function(){return cellEl},getColumn:function(){return column.getComponent()},getData:function(){return row.component.getData()},getRow:function(){return row.component},getComponent:function(){return cellWrapper},column:column};if((column.definition.cssClass?column.definition.cssClass.split(" "):[]).forEach((function(className){cellEl.classList.add(className)})),_this67.table.modExists("format")&&!1!==_this67.config.formatCells)value=_this67.table.modules.format.formatExportValue(cellWrapper,_this67.colVisProp);else switch(_typeof(value)){case"object":value=null!==value?JSON.stringify(value):"";break;case"undefined":value=""}value instanceof Node?cellEl.appendChild(value):cellEl.innerHTML=value,(cellStyle=styles.styleCells&&styles.styleCells[index]?styles.styleCells[index]:styles.firstCell)&&(_this67.mapElementStyles(cellStyle,cellEl,["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","text-align"]),column.definition.align&&(cellEl.style.textAlign=column.definition.align)),_this67.table.options.dataTree&&!1!==_this67.config.dataTree&&(setup.treeElementField&&setup.treeElementField==column.field||!setup.treeElementField&&0==i)&&(row.component._row.modules.dataTree.controlEl&&cellEl.insertBefore(row.component._row.modules.dataTree.controlEl.cloneNode(!0),cellEl.firstChild),row.component._row.modules.dataTree.branchEl&&cellEl.insertBefore(row.component._row.modules.dataTree.branchEl.cloneNode(!0),cellEl.firstChild)),rowEl.appendChild(cellEl),cellWrapper.modules.format&&cellWrapper.modules.format.renderedCallback&&cellWrapper.modules.format.renderedCallback(),setup.rowFormatter&&!1!==_this67.config.formatCells&&setup.rowFormatter(row.component)}})),rowEl}},{key:"generateHTMLTable",value:function(list){var holder=document.createElement("div");return holder.appendChild(this.generateTableElement(list)),holder.innerHTML}},{key:"getHtml",value:function(visible,style,config,colVisProp){var list=this.generateExportList(config||this.table.options.htmlOutputConfig,style,visible,colVisProp||"htmlOutput");return this.generateHTMLTable(list)}},{key:"mapElementStyles",value:function(from,to,props){if(this.cloneTableStyle&&from&&to){var lookup={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var fromStyle=window.getComputedStyle(from);props.forEach((function(prop){to.style[lookup[prop]]=fromStyle.getPropertyValue(prop)}))}}}}]),Export}(Module);_exports.ExportModule=Export,Export.moduleName="export";var defaultFilters={"=":function(filterVal,rowVal,rowData,filterParams){return rowVal==filterVal},"<":function(filterVal,rowVal,rowData,filterParams){return rowVal<filterVal},"<=":function(filterVal,rowVal,rowData,filterParams){return rowVal<=filterVal},">":function(filterVal,rowVal,rowData,filterParams){return rowVal>filterVal},">=":function(filterVal,rowVal,rowData,filterParams){return rowVal>=filterVal},"!=":function(filterVal,rowVal,rowData,filterParams){return rowVal!=filterVal},regex:function(filterVal,rowVal,rowData,filterParams){return"string"==typeof filterVal&&(filterVal=new RegExp(filterVal)),filterVal.test(rowVal)},like:function(filterVal,rowVal,rowData,filterParams){return null==filterVal?rowVal===filterVal:null!=rowVal&&String(rowVal).toLowerCase().indexOf(filterVal.toLowerCase())>-1},keywords:function(filterVal,rowVal,rowData,filterParams){var keywords=filterVal.toLowerCase().split(void 0===filterParams.separator?" ":filterParams.separator),value=String(null==rowVal?"":rowVal).toLowerCase(),matches=[];return keywords.forEach((function(keyword){value.includes(keyword)&&matches.push(!0)})),filterParams.matchAll?matches.length===keywords.length:!!matches.length},starts:function(filterVal,rowVal,rowData,filterParams){return null==filterVal?rowVal===filterVal:null!=rowVal&&String(rowVal).toLowerCase().startsWith(filterVal.toLowerCase())},ends:function(filterVal,rowVal,rowData,filterParams){return null==filterVal?rowVal===filterVal:null!=rowVal&&String(rowVal).toLowerCase().endsWith(filterVal.toLowerCase())},in:function(filterVal,rowVal,rowData,filterParams){return Array.isArray(filterVal)?!filterVal.length||filterVal.indexOf(rowVal)>-1:(console.warn("Filter Error - filter value is not an array:",filterVal),!1)}},Filter=function(_Module9){_inherits(Filter,_Module9);var _super14=_createSuper(Filter);function Filter(table){var _this68;return _classCallCheck(this,Filter),(_this68=_super14.call(this,table)).filterList=[],_this68.headerFilters={},_this68.headerFilterColumns=[],_this68.prevHeaderFilterChangeCheck="",_this68.prevHeaderFilterChangeCheck="{}",_this68.changed=!1,_this68.tableInitialized=!1,_this68.registerTableOption("filterMode","local"),_this68.registerTableOption("initialFilter",!1),_this68.registerTableOption("initialHeaderFilter",!1),_this68.registerTableOption("headerFilterLiveFilterDelay",300),_this68.registerColumnOption("headerFilter"),_this68.registerColumnOption("headerFilterPlaceholder"),_this68.registerColumnOption("headerFilterParams"),_this68.registerColumnOption("headerFilterEmptyCheck"),_this68.registerColumnOption("headerFilterFunc"),_this68.registerColumnOption("headerFilterFuncParams"),_this68.registerColumnOption("headerFilterLiveFilter"),_this68.registerTableFunction("searchRows",_this68.searchRows.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("searchData",_this68.searchData.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("setFilter",_this68.userSetFilter.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("refreshFilter",_this68.userRefreshFilter.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("addFilter",_this68.userAddFilter.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("getFilters",_this68.getFilters.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("setHeaderFilterFocus",_this68.userSetHeaderFilterFocus.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("getHeaderFilterValue",_this68.userGetHeaderFilterValue.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("setHeaderFilterValue",_this68.userSetHeaderFilterValue.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("getHeaderFilters",_this68.getHeaderFilters.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("removeFilter",_this68.userRemoveFilter.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("clearFilter",_this68.userClearFilter.bind(_assertThisInitialized(_this68))),_this68.registerTableFunction("clearHeaderFilter",_this68.userClearHeaderFilter.bind(_assertThisInitialized(_this68))),_this68.registerComponentFunction("column","headerFilterFocus",_this68.setHeaderFilterFocus.bind(_assertThisInitialized(_this68))),_this68.registerComponentFunction("column","reloadHeaderFilter",_this68.reloadHeaderFilter.bind(_assertThisInitialized(_this68))),_this68.registerComponentFunction("column","getHeaderFilterValue",_this68.getHeaderFilterValue.bind(_assertThisInitialized(_this68))),_this68.registerComponentFunction("column","setHeaderFilterValue",_this68.setHeaderFilterValue.bind(_assertThisInitialized(_this68))),_this68}return _createClass(Filter,[{key:"initialize",value:function(){this.subscribe("column-init",this.initializeColumnHeaderFilter.bind(this)),this.subscribe("column-width-fit-before",this.hideHeaderFilterElements.bind(this)),this.subscribe("column-width-fit-after",this.showHeaderFilterElements.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),"remote"===this.table.options.filterMode&&this.subscribe("data-params",this.remoteFilterParams.bind(this)),this.registerDataHandler(this.filter.bind(this),10)}},{key:"tableBuilt",value:function(){var _this69=this;this.table.options.initialFilter&&this.setFilter(this.table.options.initialFilter),this.table.options.initialHeaderFilter&&this.table.options.initialHeaderFilter.forEach((function(item){var column=_this69.table.columnManager.findColumn(item.field);if(!column)return console.warn("Column Filter Error - No matching column found:",item.field),!1;_this69.setHeaderFilterValue(column,item.value)})),this.tableInitialized=!0}},{key:"remoteFilterParams",value:function(data,config,silent,params){return params.filter=this.getFilters(!0,!0),params}},{key:"userSetFilter",value:function(field,type,value,params){this.setFilter(field,type,value,params),this.refreshFilter()}},{key:"userRefreshFilter",value:function(){this.refreshFilter()}},{key:"userAddFilter",value:function(field,type,value,params){this.addFilter(field,type,value,params),this.refreshFilter()}},{key:"userSetHeaderFilterFocus",value:function(field){var column=this.table.columnManager.findColumn(field);if(!column)return console.warn("Column Filter Focus Error - No matching column found:",field),!1;this.setHeaderFilterFocus(column)}},{key:"userGetHeaderFilterValue",value:function(field){var column=this.table.columnManager.findColumn(field);if(column)return this.getHeaderFilterValue(column);console.warn("Column Filter Error - No matching column found:",field)}},{key:"userSetHeaderFilterValue",value:function(field,value){var column=this.table.columnManager.findColumn(field);if(!column)return console.warn("Column Filter Error - No matching column found:",field),!1;this.setHeaderFilterValue(column,value)}},{key:"userRemoveFilter",value:function(field,type,value){this.removeFilter(field,type,value),this.refreshFilter()}},{key:"userClearFilter",value:function(all){this.clearFilter(all),this.refreshFilter()}},{key:"userClearHeaderFilter",value:function(){this.clearHeaderFilter(),this.refreshFilter()}},{key:"searchRows",value:function(field,type,value){return this.search("rows",field,type,value)}},{key:"searchData",value:function(field,type,value){return this.search("data",field,type,value)}},{key:"initializeColumnHeaderFilter",value:function(column){var def=column.definition;def.headerFilter&&(void 0!==def.headerFilterPlaceholder&&def.field&&this.module("localize").setHeaderFilterColumnPlaceholder(def.field,def.headerFilterPlaceholder),this.initializeColumn(column))}},{key:"initializeColumn",value:function(column,value){var self=this,field=column.getField();column.modules.filter={success:function(value){var filterFunc,filterType="input"==column.modules.filter.tagType&&"text"==column.modules.filter.attrType||"textarea"==column.modules.filter.tagType?"partial":"match",type="",filterChangeCheck="";if(void 0===column.modules.filter.prevSuccess||column.modules.filter.prevSuccess!==value){if(column.modules.filter.prevSuccess=value,column.modules.filter.emptyFunc(value))delete self.headerFilters[field];else{switch(column.modules.filter.value=value,_typeof(column.definition.headerFilterFunc)){case"string":Filter.filters[column.definition.headerFilterFunc]?(type=column.definition.headerFilterFunc,filterFunc=function(data){var params=column.definition.headerFilterFuncParams||{},fieldVal=column.getFieldValue(data);return params="function"==typeof params?params(value,fieldVal,data):params,Filter.filters[column.definition.headerFilterFunc](value,fieldVal,data,params)}):console.warn("Header Filter Error - Matching filter function not found: ",column.definition.headerFilterFunc);break;case"function":type=filterFunc=function(data){var params=column.definition.headerFilterFuncParams||{},fieldVal=column.getFieldValue(data);return params="function"==typeof params?params(value,fieldVal,data):params,column.definition.headerFilterFunc(value,fieldVal,data,params)}}if(!filterFunc)if("partial"===filterType)filterFunc=function(data){var colVal=column.getFieldValue(data);return null!=colVal&&String(colVal).toLowerCase().indexOf(String(value).toLowerCase())>-1},type="like";else filterFunc=function(data){return column.getFieldValue(data)==value},type="=";self.headerFilters[field]={value:value,func:filterFunc,type:type}}column.modules.filter.value=value,filterChangeCheck=JSON.stringify(self.headerFilters),self.prevHeaderFilterChangeCheck!==filterChangeCheck&&(self.prevHeaderFilterChangeCheck=filterChangeCheck,self.trackChanges(),self.refreshFilter())}return!0},attrType:!1,tagType:!1,emptyFunc:!1},this.generateHeaderFilterElement(column)}},{key:"generateHeaderFilterElement",value:function(column,initialValue,reinitialize){var filterElement,editor,editorElement,cellWrapper,typingTimer,searchTrigger,params,_this70=this,self=this,success=column.modules.filter.success,field=column.getField();if(column.modules.filter.value=initialValue,column.modules.filter.headerElement&&column.modules.filter.headerElement.parentNode&&column.contentElement.removeChild(column.modules.filter.headerElement.parentNode),field){switch(column.modules.filter.emptyFunc=column.definition.headerFilterEmptyCheck||function(value){return!value&&0!==value},(filterElement=document.createElement("div")).classList.add("tabulator-header-filter"),_typeof(column.definition.headerFilter)){case"string":self.table.modules.edit.editors[column.definition.headerFilter]?(editor=self.table.modules.edit.editors[column.definition.headerFilter],"tick"!==column.definition.headerFilter&&"tickCross"!==column.definition.headerFilter||column.definition.headerFilterEmptyCheck||(column.modules.filter.emptyFunc=function(value){return!0!==value&&!1!==value})):console.warn("Filter Error - Cannot build header filter, No such editor found: ",column.definition.editor);break;case"function":editor=column.definition.headerFilter;break;case"boolean":column.modules.edit&&column.modules.edit.editor?editor=column.modules.edit.editor:column.definition.formatter&&self.table.modules.edit.editors[column.definition.formatter]?(editor=self.table.modules.edit.editors[column.definition.formatter],"tick"!==column.definition.formatter&&"tickCross"!==column.definition.formatter||column.definition.headerFilterEmptyCheck||(column.modules.filter.emptyFunc=function(value){return!0!==value&&!1!==value})):editor=self.table.modules.edit.editors.input}if(editor){if(cellWrapper={getValue:function(){return void 0!==initialValue?initialValue:""},getField:function(){return column.definition.field},getElement:function(){return filterElement},getColumn:function(){return column.getComponent()},getTable:function(){return _this70.table},getRow:function(){return{normalizeHeight:function(){}}}},params="function"==typeof(params=column.definition.headerFilterParams||{})?params.call(self.table,cellWrapper):params,!(editorElement=editor.call(this.table.modules.edit,cellWrapper,(function(){}),success,(function(){}),params)))return void console.warn("Filter Error - Cannot add filter to "+field+" column, editor returned a value of false");if(!(editorElement instanceof Node))return void console.warn("Filter Error - Cannot add filter to "+field+" column, editor should return an instance of Node, the editor returned:",editorElement);self.langBind("headerFilters|columns|"+column.definition.field,(function(value){editorElement.setAttribute("placeholder",void 0!==value&&value?value:self.langText("headerFilters|default"))})),editorElement.addEventListener("click",(function(e){e.stopPropagation(),editorElement.focus()})),editorElement.addEventListener("focus",(function(e){var left=_this70.table.columnManager.contentsElement.scrollLeft;left!==_this70.table.rowManager.element.scrollLeft&&(_this70.table.rowManager.scrollHorizontal(left),_this70.table.columnManager.scrollHorizontal(left))})),typingTimer=!1,searchTrigger=function(e){typingTimer&&clearTimeout(typingTimer),typingTimer=setTimeout((function(){success(editorElement.value)}),self.table.options.headerFilterLiveFilterDelay)},column.modules.filter.headerElement=editorElement,column.modules.filter.attrType=editorElement.hasAttribute("type")?editorElement.getAttribute("type").toLowerCase():"",column.modules.filter.tagType=editorElement.tagName.toLowerCase(),!1!==column.definition.headerFilterLiveFilter&&("autocomplete"!==column.definition.headerFilter&&"tickCross"!==column.definition.headerFilter&&("autocomplete"!==column.definition.editor&&"tickCross"!==column.definition.editor||!0!==column.definition.headerFilter)&&(editorElement.addEventListener("keyup",searchTrigger),editorElement.addEventListener("search",searchTrigger),"number"==column.modules.filter.attrType&&editorElement.addEventListener("change",(function(e){success(editorElement.value)})),"text"==column.modules.filter.attrType&&"ie"!==this.table.browser&&editorElement.setAttribute("type","search")),"input"!=column.modules.filter.tagType&&"select"!=column.modules.filter.tagType&&"textarea"!=column.modules.filter.tagType||editorElement.addEventListener("mousedown",(function(e){e.stopPropagation()}))),filterElement.appendChild(editorElement),column.contentElement.appendChild(filterElement),reinitialize||self.headerFilterColumns.push(column)}}else console.warn("Filter Error - Cannot add header filter, column has no field set:",column.definition.title)}},{key:"hideHeaderFilterElements",value:function(){this.headerFilterColumns.forEach((function(column){column.modules.filter&&column.modules.filter.headerElement&&(column.modules.filter.headerElement.style.display="none")}))}},{key:"showHeaderFilterElements",value:function(){this.headerFilterColumns.forEach((function(column){column.modules.filter&&column.modules.filter.headerElement&&(column.modules.filter.headerElement.style.display="")}))}},{key:"setHeaderFilterFocus",value:function(column){column.modules.filter&&column.modules.filter.headerElement?column.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",column.getField())}},{key:"getHeaderFilterValue",value:function(column){if(column.modules.filter&&column.modules.filter.headerElement)return column.modules.filter.value;console.warn("Column Filter Error - No header filter set on column:",column.getField())}},{key:"setHeaderFilterValue",value:function(column,value){column&&(column.modules.filter&&column.modules.filter.headerElement?(this.generateHeaderFilterElement(column,value,!0),column.modules.filter.success(value)):console.warn("Column Filter Error - No header filter set on column:",column.getField()))}},{key:"reloadHeaderFilter",value:function(column){column&&(column.modules.filter&&column.modules.filter.headerElement?this.generateHeaderFilterElement(column,column.modules.filter.value,!0):console.warn("Column Filter Error - No header filter set on column:",column.getField()))}},{key:"refreshFilter",value:function(){this.tableInitialized&&("remote"===this.table.options.filterMode?this.reloadData(null,!1,!1):this.refreshData(!0))}},{key:"trackChanges",value:function(){this.changed=!0,this.dispatch("filter-changed")}},{key:"hasChanged",value:function(){var changed=this.changed;return this.changed=!1,changed}},{key:"setFilter",value:function(field,type,value,params){this.filterList=[],Array.isArray(field)||(field=[{field:field,type:type,value:value,params:params}]),this.addFilter(field)}},{key:"addFilter",value:function(field,type,value,params){var _this71=this,changed=!1;Array.isArray(field)||(field=[{field:field,type:type,value:value,params:params}]),field.forEach((function(filter){(filter=_this71.findFilter(filter))&&(_this71.filterList.push(filter),changed=!0)})),changed&&this.trackChanges()}},{key:"findFilter",value:function(filter){var column;if(Array.isArray(filter))return this.findSubFilters(filter);var filterFunc=!1;return"function"==typeof filter.field?filterFunc=function(data){return filter.field(data,filter.type||{})}:Filter.filters[filter.type]?filterFunc=(column=this.table.columnManager.getColumnByField(filter.field))?function(data){return Filter.filters[filter.type](filter.value,column.getFieldValue(data),data,filter.params||{})}:function(data){return Filter.filters[filter.type](filter.value,data[filter.field],data,filter.params||{})}:console.warn("Filter Error - No such filter type found, ignoring: ",filter.type),filter.func=filterFunc,!!filter.func&&filter}},{key:"findSubFilters",value:function(filters){var _this72=this,output=[];return filters.forEach((function(filter){(filter=_this72.findFilter(filter))&&output.push(filter)})),!!output.length&&output}},{key:"getFilters",value:function(all,ajax){var output=[];return all&&(output=this.getHeaderFilters()),ajax&&output.forEach((function(item){"function"==typeof item.type&&(item.type="function")})),output=output.concat(this.filtersToArray(this.filterList,ajax))}},{key:"filtersToArray",value:function(filterList,ajax){var _this73=this,output=[];return filterList.forEach((function(filter){var item;Array.isArray(filter)?output.push(_this73.filtersToArray(filter,ajax)):(item={field:filter.field,type:filter.type,value:filter.value},ajax&&"function"==typeof item.type&&(item.type="function"),output.push(item))})),output}},{key:"getHeaderFilters",value:function(){var output=[];for(var key in this.headerFilters)output.push({field:key,type:this.headerFilters[key].type,value:this.headerFilters[key].value});return output}},{key:"removeFilter",value:function(field,type,value){var _this74=this;Array.isArray(field)||(field=[{field:field,type:type,value:value}]),field.forEach((function(filter){var index=-1;(index="object"==_typeof(filter.field)?_this74.filterList.findIndex((function(element){return filter===element})):_this74.filterList.findIndex((function(element){return filter.field===element.field&&filter.type===element.type&&filter.value===element.value})))>-1?_this74.filterList.splice(index,1):console.warn("Filter Error - No matching filter type found, ignoring: ",filter.type)})),this.trackChanges()}},{key:"clearFilter",value:function(all){this.filterList=[],all&&this.clearHeaderFilter(),this.trackChanges()}},{key:"clearHeaderFilter",value:function(){var _this75=this;this.headerFilters={},this.prevHeaderFilterChangeCheck="{}",this.headerFilterColumns.forEach((function(column){void 0!==column.modules.filter.value&&delete column.modules.filter.value,column.modules.filter.prevSuccess=void 0,_this75.reloadHeaderFilter(column)})),this.trackChanges()}},{key:"search",value:function(searchType,field,type,value){var _this76=this,activeRows=[],filterList=[];return Array.isArray(field)||(field=[{field:field,type:type,value:value}]),field.forEach((function(filter){(filter=_this76.findFilter(filter))&&filterList.push(filter)})),this.table.rowManager.rows.forEach((function(row){var match=!0;filterList.forEach((function(filter){_this76.filterRecurse(filter,row.getData())||(match=!1)})),match&&activeRows.push("data"===searchType?row.getData("data"):row.getComponent())})),activeRows}},{key:"filter",value:function(rowList,filters){var _this77=this,activeRows=[],activeRowComponents=[];return this.subscribedExternal("dataFiltering")&&this.dispatchExternal("dataFiltering",this.getFilters(!0)),"remote"!==this.table.options.filterMode&&(this.filterList.length||Object.keys(this.headerFilters).length)?rowList.forEach((function(row){_this77.filterRow(row)&&activeRows.push(row)})):activeRows=rowList.slice(0),this.subscribedExternal("dataFiltered")&&(activeRows.forEach((function(row){activeRowComponents.push(row.getComponent())})),this.dispatchExternal("dataFiltered",this.getFilters(!0),activeRowComponents)),activeRows}},{key:"filterRow",value:function(row,filters){var _this78=this,match=!0,data=row.getData();for(var field in this.filterList.forEach((function(filter){_this78.filterRecurse(filter,data)||(match=!1)})),this.headerFilters)this.headerFilters[field].func(data)||(match=!1);return match}},{key:"filterRecurse",value:function(filter,data){var _this79=this,match=!1;return Array.isArray(filter)?filter.forEach((function(subFilter){_this79.filterRecurse(subFilter,data)&&(match=!0)})):match=filter.func(data),match}}]),Filter}(Module);_exports.FilterModule=Filter,Filter.moduleName="filter",Filter.filters=defaultFilters;var defaultFormatters={plaintext:function(cell,formatterParams,onRendered){return this.emptyToSpace(this.sanitizeHTML(cell.getValue()))},html:function(cell,formatterParams,onRendered){return cell.getValue()},textarea:function(cell,formatterParams,onRendered){return cell.getElement().style.whiteSpace="pre-wrap",this.emptyToSpace(this.sanitizeHTML(cell.getValue()))},money:function(cell,formatterParams,onRendered){var number,integer,decimal,rgx,floatVal=parseFloat(cell.getValue()),sign="",decimalSym=formatterParams.decimal||".",thousandSym=formatterParams.thousand||",",negativeSign=formatterParams.negativeSign||"-",symbol=formatterParams.symbol||"",after=!!formatterParams.symbolAfter,precision=void 0!==formatterParams.precision?formatterParams.precision:2;if(isNaN(floatVal))return this.emptyToSpace(this.sanitizeHTML(cell.getValue()));if(floatVal<0&&(floatVal=Math.abs(floatVal),sign=negativeSign),number=!1!==precision?floatVal.toFixed(precision):floatVal,integer=(number=String(number).split("."))[0],decimal=number.length>1?decimalSym+number[1]:"",!1!==formatterParams.thousand)for(rgx=/(\d+)(\d{3})/;rgx.test(integer);)integer=integer.replace(rgx,"$1"+thousandSym+"$2");return after?sign+integer+decimal+symbol:sign+symbol+integer+decimal},link:function(cell,formatterParams,onRendered){var data,value=cell.getValue(),urlPrefix=formatterParams.urlPrefix||"",download=formatterParams.download,label=value,el=document.createElement("a");if(formatterParams.labelField&&(data=cell.getData(),label=function labelTraverse(path,data){var value=data[path.shift()];return path.length&&"object"===_typeof(value)?labelTraverse(path,value):value}(formatterParams.labelField.split(this.table.options.nestedFieldSeparator),data)),formatterParams.label)switch(_typeof(formatterParams.label)){case"string":label=formatterParams.label;break;case"function":label=formatterParams.label(cell)}if(label){if(formatterParams.urlField&&(value=(data=cell.getData())[formatterParams.urlField]),formatterParams.url)switch(_typeof(formatterParams.url)){case"string":value=formatterParams.url;break;case"function":value=formatterParams.url(cell)}return el.setAttribute("href",urlPrefix+value),formatterParams.target&&el.setAttribute("target",formatterParams.target),formatterParams.download&&(download="function"==typeof download?download(cell):!0===download?"":download,el.setAttribute("download",download)),el.innerHTML=this.emptyToSpace(this.sanitizeHTML(label)),el}return"&nbsp;"},image:function(cell,formatterParams,onRendered){var el=document.createElement("img"),src=cell.getValue();switch(formatterParams.urlPrefix&&(src=formatterParams.urlPrefix+cell.getValue()),formatterParams.urlSuffix&&(src+=formatterParams.urlSuffix),el.setAttribute("src",src),_typeof(formatterParams.height)){case"number":el.style.height=formatterParams.height+"px";break;case"string":el.style.height=formatterParams.height}switch(_typeof(formatterParams.width)){case"number":el.style.width=formatterParams.width+"px";break;case"string":el.style.width=formatterParams.width}return el.addEventListener("load",(function(){cell.getRow().normalizeHeight()})),el},tickCross:function(cell,formatterParams,onRendered){var value=cell.getValue(),element=cell.getElement(),empty=formatterParams.allowEmpty,truthy=formatterParams.allowTruthy,trueValueSet=Object.keys(formatterParams).includes("trueValue"),tick=void 0!==formatterParams.tickElement?formatterParams.tickElement:'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>',cross=void 0!==formatterParams.crossElement?formatterParams.crossElement:'<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';return trueValueSet&&value===formatterParams.trueValue||!trueValueSet&&(truthy&&value||!0===value||"true"===value||"True"===value||1===value||"1"===value)?(element.setAttribute("aria-checked",!0),tick||""):!empty||"null"!==value&&""!==value&&null!=value?(element.setAttribute("aria-checked",!1),cross||""):(element.setAttribute("aria-checked","mixed"),"")},datetime:function(cell,formatterParams,onRendered){var newDatetime,DT=window.DateTime||luxon.DateTime,inputFormat=formatterParams.inputFormat||"yyyy-MM-dd HH:mm:ss",outputFormat=formatterParams.outputFormat||"dd/MM/yyyy HH:mm:ss",invalid=void 0!==formatterParams.invalidPlaceholder?formatterParams.invalidPlaceholder:"",value=cell.getValue();if(void 0!==DT)return(newDatetime=DT.isDateTime(value)?value:"iso"===inputFormat?DT.fromISO(String(value)):DT.fromFormat(String(value),inputFormat)).isValid?(formatterParams.timezone&&(newDatetime=newDatetime.setZone(formatterParams.timezone)),newDatetime.toFormat(outputFormat)):!0!==invalid&&value?"function"==typeof invalid?invalid(value):invalid:value;console.error("Format Error - 'datetime' formatter is dependant on luxon.js")},datetimediff:function(cell,formatterParams,onRendered){var newDatetime,DT=window.DateTime||luxon.DateTime,inputFormat=formatterParams.inputFormat||"yyyy-MM-dd HH:mm:ss",invalid=void 0!==formatterParams.invalidPlaceholder?formatterParams.invalidPlaceholder:"",suffix=void 0!==formatterParams.suffix&&formatterParams.suffix,unit=void 0!==formatterParams.unit?formatterParams.unit:"days",humanize=void 0!==formatterParams.humanize&&formatterParams.humanize,date=void 0!==formatterParams.date?formatterParams.date:DT.now(),value=cell.getValue();if(void 0!==DT)return(newDatetime=DT.isDateTime(value)?value:"iso"===inputFormat?DT.fromISO(String(value)):DT.fromFormat(String(value),inputFormat)).isValid?humanize?newDatetime.diff(date,unit).toHuman()+(suffix?" "+suffix:""):parseInt(newDatetime.diff(date,unit)[unit])+(suffix?" "+suffix:""):!0===invalid?value:"function"==typeof invalid?invalid(value):invalid;console.error("Format Error - 'datetimediff' formatter is dependant on luxon.js")},lookup:function(cell,formatterParams,onRendered){var value=cell.getValue();return void 0===formatterParams[value]?(console.warn("Missing display value for "+value),value):formatterParams[value]},star:function(cell,formatterParams,onRendered){var value=cell.getValue(),element=cell.getElement(),maxStars=formatterParams&&formatterParams.stars?formatterParams.stars:5,stars=document.createElement("span"),star=document.createElementNS("http://www.w3.org/2000/svg","svg");stars.style.verticalAlign="middle",star.setAttribute("width","14"),star.setAttribute("height","14"),star.setAttribute("viewBox","0 0 512 512"),star.setAttribute("xml:space","preserve"),star.style.padding="0 1px",value=value&&!isNaN(value)?parseInt(value):0,value=Math.max(0,Math.min(value,maxStars));for(var i=1;i<=maxStars;i++){var nextStar=star.cloneNode(!0);nextStar.innerHTML=i<=value?'<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>':'<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>',stars.appendChild(nextStar)}return element.style.whiteSpace="nowrap",element.style.overflow="hidden",element.style.textOverflow="ellipsis",element.setAttribute("aria-label",value),stars},traffic:function(cell,formatterParams,onRendered){var percent,percentValue,value=this.sanitizeHTML(cell.getValue())||0,el=document.createElement("span"),max=formatterParams&&formatterParams.max?formatterParams.max:100,min=formatterParams&&formatterParams.min?formatterParams.min:0,colors=formatterParams&&void 0!==formatterParams.color?formatterParams.color:["red","orange","green"],color="#666666";if(!isNaN(value)&&void 0!==cell.getValue()){switch(el.classList.add("tabulator-traffic-light"),percentValue=parseFloat(value)<=max?parseFloat(value):max,percentValue=parseFloat(percentValue)>=min?parseFloat(percentValue):min,percent=(max-min)/100,percentValue=Math.round((percentValue-min)/percent),_typeof(colors)){case"string":color=colors;break;case"function":color=colors(value);break;case"object":if(Array.isArray(colors)){var unit=100/colors.length,index=Math.floor(percentValue/unit);index=Math.min(index,colors.length-1),color=colors[index=Math.max(index,0)];break}}return el.style.backgroundColor=color,el}},progress:function(cell){var percent,percentValue,color,legend,legendColor,formatterParams=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},onRendered=arguments.length>2?arguments[2]:void 0,value=this.sanitizeHTML(cell.getValue())||0,element=cell.getElement(),max=formatterParams.max?formatterParams.max:100,min=formatterParams.min?formatterParams.min:0,legendAlign=formatterParams.legendAlign?formatterParams.legendAlign:"center";switch(percentValue=parseFloat(value)<=max?parseFloat(value):max,percentValue=parseFloat(percentValue)>=min?parseFloat(percentValue):min,percent=(max-min)/100,percentValue=Math.round((percentValue-min)/percent),_typeof(formatterParams.color)){case"string":color=formatterParams.color;break;case"function":color=formatterParams.color(value);break;case"object":if(Array.isArray(formatterParams.color)){var unit=100/formatterParams.color.length,index=Math.floor(percentValue/unit);index=Math.min(index,formatterParams.color.length-1),index=Math.max(index,0),color=formatterParams.color[index];break}default:color="#2DC214"}switch(_typeof(formatterParams.legend)){case"string":legend=formatterParams.legend;break;case"function":legend=formatterParams.legend(value);break;case"boolean":legend=value;break;default:legend=!1}switch(_typeof(formatterParams.legendColor)){case"string":legendColor=formatterParams.legendColor;break;case"function":legendColor=formatterParams.legendColor(value);break;case"object":if(Array.isArray(formatterParams.legendColor)){var _unit=100/formatterParams.legendColor.length,_index=Math.floor(percentValue/_unit);_index=Math.min(_index,formatterParams.legendColor.length-1),_index=Math.max(_index,0),legendColor=formatterParams.legendColor[_index]}break;default:legendColor="#000"}element.style.minWidth="30px",element.style.position="relative",element.setAttribute("aria-label",percentValue);var barEl=document.createElement("div");barEl.style.display="inline-block",barEl.style.width=percentValue+"%",barEl.style.backgroundColor=color,barEl.style.height="100%",barEl.setAttribute("data-max",max),barEl.setAttribute("data-min",min);var barContainer=document.createElement("div");if(barContainer.style.position="relative",barContainer.style.width="100%",barContainer.style.height="100%",legend){var legendEl=document.createElement("div");legendEl.style.position="absolute",legendEl.style.top=0,legendEl.style.left=0,legendEl.style.textAlign=legendAlign,legendEl.style.width="100%",legendEl.style.color=legendColor,legendEl.innerHTML=legend}return onRendered((function(){if(!(cell instanceof CellComponent)){var holderEl=document.createElement("div");holderEl.style.position="absolute",holderEl.style.top="4px",holderEl.style.bottom="4px",holderEl.style.left="4px",holderEl.style.right="4px",element.appendChild(holderEl),element=holderEl}element.appendChild(barContainer),barContainer.appendChild(barEl),legend&&barContainer.appendChild(legendEl)})),""},color:function(cell,formatterParams,onRendered){return cell.getElement().style.backgroundColor=this.sanitizeHTML(cell.getValue()),""},buttonTick:function(cell,formatterParams,onRendered){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>'},buttonCross:function(cell,formatterParams,onRendered){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>'},rownum:function(cell,formatterParams,onRendered){var content=document.createElement("span");return cell.getRow().watchPosition((function(position){content.innerText=position})),content},handle:function(cell,formatterParams,onRendered){return cell.getElement().classList.add("tabulator-row-handle"),"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>"},responsiveCollapse:function(cell,formatterParams,onRendered){var el=document.createElement("div"),config=cell.getRow()._row.modules.responsiveLayout;function toggleList(isOpen){var collapseEl=config.element;config.open=isOpen,collapseEl&&(config.open?(el.classList.add("open"),collapseEl.style.display=""):(el.classList.remove("open"),collapseEl.style.display="none"))}return el.classList.add("tabulator-responsive-collapse-toggle"),el.innerHTML='<svg class=\'tabulator-responsive-collapse-toggle-open\' viewbox="0 0 24 24">\n  <line x1="7" y1="12" x2="17" y2="12" fill="none" stroke-width="3" stroke-linecap="round" />\n  <line y1="7" x1="12" y2="17" x2="12" fill="none" stroke-width="3" stroke-linecap="round" />\n</svg>\n\n<svg class=\'tabulator-responsive-collapse-toggle-close\' viewbox="0 0 24 24">\n  <line x1="7" y1="12" x2="17" y2="12"  fill="none" stroke-width="3" stroke-linecap="round" />\n</svg>',cell.getElement().classList.add("tabulator-row-handle"),el.addEventListener("click",(function(e){e.stopImmediatePropagation(),toggleList(!config.open),cell.getTable().rowManager.adjustTableSize()})),toggleList(config.open),el},rowSelection:function(cell,formatterParams,onRendered){var _this80=this,checkbox=document.createElement("input"),blocked=!1;if(checkbox.type="checkbox",checkbox.setAttribute("aria-label","Select Row"),this.table.modExists("selectRow",!0))if(checkbox.addEventListener("click",(function(e){e.stopPropagation()})),"function"==typeof cell.getRow){var row=cell.getRow();row instanceof RowComponent?(checkbox.addEventListener("change",(function(e){"click"===_this80.table.options.selectableRangeMode&&blocked?blocked=!1:row.toggleSelect()})),"click"===this.table.options.selectableRangeMode&&checkbox.addEventListener("click",(function(e){blocked=!0,_this80.table.modules.selectRow.handleComplexRowClick(row._row,e)})),checkbox.checked=row.isSelected&&row.isSelected(),this.table.modules.selectRow.registerRowSelectCheckbox(row,checkbox)):checkbox=""}else checkbox.addEventListener("change",(function(e){_this80.table.modules.selectRow.selectedRows.length?_this80.table.deselectRow():_this80.table.selectRow(formatterParams.rowRange)})),this.table.modules.selectRow.registerHeaderSelectCheckbox(checkbox);return checkbox}},Format=function(_Module10){_inherits(Format,_Module10);var _super15=_createSuper(Format);function Format(table){var _this81;return _classCallCheck(this,Format),(_this81=_super15.call(this,table)).registerColumnOption("formatter"),_this81.registerColumnOption("formatterParams"),_this81.registerColumnOption("formatterPrint"),_this81.registerColumnOption("formatterPrintParams"),_this81.registerColumnOption("formatterClipboard"),_this81.registerColumnOption("formatterClipboardParams"),_this81.registerColumnOption("formatterHtmlOutput"),_this81.registerColumnOption("formatterHtmlOutputParams"),_this81.registerColumnOption("titleFormatter"),_this81.registerColumnOption("titleFormatterParams"),_this81}return _createClass(Format,[{key:"initialize",value:function(){this.subscribe("cell-format",this.formatValue.bind(this)),this.subscribe("cell-rendered",this.cellRendered.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-format",this.formatHeader.bind(this))}},{key:"initializeColumn",value:function(column){column.modules.format=this.lookupFormatter(column,""),void 0!==column.definition.formatterPrint&&(column.modules.format.print=this.lookupFormatter(column,"Print")),void 0!==column.definition.formatterClipboard&&(column.modules.format.clipboard=this.lookupFormatter(column,"Clipboard")),void 0!==column.definition.formatterHtmlOutput&&(column.modules.format.htmlOutput=this.lookupFormatter(column,"HtmlOutput"))}},{key:"lookupFormatter",value:function(column,type){var config={params:column.definition["formatter"+type+"Params"]||{}},formatter=column.definition["formatter"+type];switch(_typeof(formatter)){case"string":Format.formatters[formatter]?config.formatter=Format.formatters[formatter]:(console.warn("Formatter Error - No such formatter found: ",formatter),config.formatter=Format.formatters.plaintext);break;case"function":config.formatter=formatter;break;default:config.formatter=Format.formatters.plaintext}return config}},{key:"cellRendered",value:function(cell){cell.modules.format&&cell.modules.format.renderedCallback&&!cell.modules.format.rendered&&(cell.modules.format.renderedCallback(),cell.modules.format.rendered=!0)}},{key:"formatHeader",value:function(column,title,el){var formatter,params,onRendered,mockCell,_this82=this;return column.definition.titleFormatter?(formatter=this.getFormatter(column.definition.titleFormatter),onRendered=function(callback){column.titleFormatterRendered=callback},mockCell={getValue:function(){return title},getElement:function(){return el},getColumn:function(){return column.getComponent()},getTable:function(){return _this82.table}},params="function"==typeof(params=column.definition.titleFormatterParams||{})?params():params,formatter.call(this,mockCell,params,onRendered)):title}},{key:"formatValue",value:function(cell){var component=cell.getComponent(),params="function"==typeof cell.column.modules.format.params?cell.column.modules.format.params(component):cell.column.modules.format.params;return cell.column.modules.format.formatter.call(this,component,params,(function(callback){cell.modules.format||(cell.modules.format={}),cell.modules.format.renderedCallback=callback,cell.modules.format.rendered=!1}))}},{key:"formatExportValue",value:function(cell,type){var params,formatter=cell.column.modules.format[type];if(formatter){return params="function"==typeof formatter.params?formatter.params(cell.getComponent()):formatter.params,formatter.formatter.call(this,cell.getComponent(),params,(function(callback){cell.modules.format||(cell.modules.format={}),cell.modules.format.renderedCallback=callback,cell.modules.format.rendered=!1}))}return this.formatValue(cell)}},{key:"sanitizeHTML",value:function(value){if(value){var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(value).replace(/[&<>"'`=/]/g,(function(s){return entityMap[s]}))}return value}},{key:"emptyToSpace",value:function(value){return null==value||""===value?"&nbsp;":value}},{key:"getFormatter",value:function(formatter){switch(_typeof(formatter)){case"string":Format.formatters[formatter]?formatter=Format.formatters[formatter]:(console.warn("Formatter Error - No such formatter found: ",formatter),formatter=Format.formatters.plaintext);break;case"function":break;default:formatter=Format.formatters.plaintext}return formatter}}]),Format}(Module);_exports.FormatModule=Format,Format.moduleName="format",Format.formatters=defaultFormatters;var FrozenColumns=function(_Module11){_inherits(FrozenColumns,_Module11);var _super16=_createSuper(FrozenColumns);function FrozenColumns(table){var _this83;return _classCallCheck(this,FrozenColumns),(_this83=_super16.call(this,table)).leftColumns=[],_this83.rightColumns=[],_this83.initializationMode="left",_this83.active=!1,_this83.blocked=!0,_this83.registerColumnOption("frozen"),_this83}return _createClass(FrozenColumns,[{key:"reset",value:function(){this.initializationMode="left",this.leftColumns=[],this.rightColumns=[],this.active=!1}},{key:"initialize",value:function(){this.subscribe("cell-layout",this.layoutCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-width",this.layout.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("table-layout",this.layout.bind(this)),this.subscribe("columns-loading",this.reset.bind(this)),this.subscribe("column-add",this.reinitializeColumns.bind(this)),this.subscribe("column-delete",this.reinitializeColumns.bind(this)),this.subscribe("table-redraw",this.layout.bind(this)),this.subscribe("layout-refreshing",this.blockLayout.bind(this)),this.subscribe("layout-refreshed",this.unblockLayout.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this))}},{key:"blockLayout",value:function(){this.blocked=!0}},{key:"unblockLayout",value:function(){this.blocked=!1}},{key:"layoutCell",value:function(cell){this.layoutElement(cell.element,cell.column)}},{key:"reinitializeColumns",value:function(){var _this84=this;this.reset(),this.table.columnManager.columnsByIndex.forEach((function(column){_this84.initializeColumn(column)}))}},{key:"initializeColumn",value:function(column){var config={margin:0,edge:!1};column.isGroup||(this.frozenCheck(column)?(config.position=this.initializationMode,"left"==this.initializationMode?this.leftColumns.push(column):this.rightColumns.unshift(column),this.active=!0,column.modules.frozen=config):this.initializationMode="right")}},{key:"frozenCheck",value:function(column){return column.parent.isGroup&&column.definition.frozen&&console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"),column.parent.isGroup?this.frozenCheck(column.parent):column.definition.frozen}},{key:"layoutCalcRows",value:function(){this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&this.table.modules.columnCalcs.topRow&&this.layoutRow(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&this.table.modules.columnCalcs.botRow&&this.layoutRow(this.table.modules.columnCalcs.botRow),this.table.modExists("groupRows")&&this.layoutGroupCalcs(this.table.modules.groupRows.getGroups()))}},{key:"layoutGroupCalcs",value:function(groups){var _this85=this;groups.forEach((function(group){group.calcs.top&&_this85.layoutRow(group.calcs.top),group.calcs.bottom&&_this85.layoutRow(group.calcs.bottom),group.groupList&&group.groupList.length&&_this85.layoutGroupCalcs(group.groupList)}))}},{key:"layoutColumnPosition",value:function(allCells){var _this86=this,leftParents=[],leftMargin=0,rightMargin=0;this.leftColumns.forEach((function(column,i){if(column.modules.frozen.marginValue=leftMargin,column.modules.frozen.margin=column.modules.frozen.marginValue+"px",column.visible&&(leftMargin+=column.getWidth()),i==_this86.leftColumns.length-1?column.modules.frozen.edge=!0:column.modules.frozen.edge=!1,column.parent.isGroup){var parentEl=_this86.getColGroupParentElement(column);leftParents.includes(parentEl)||(_this86.layoutElement(parentEl,column),leftParents.push(parentEl)),column.modules.frozen.edge&&parentEl.classList.add("tabulator-frozen-"+column.modules.frozen.position)}else _this86.layoutElement(column.getElement(),column);allCells&&column.cells.forEach((function(cell){_this86.layoutElement(cell.getElement(!0),column)}))})),this.rightColumns.forEach((function(column,i){column.modules.frozen.marginValue=rightMargin,column.modules.frozen.margin=column.modules.frozen.marginValue+"px",column.visible&&(rightMargin+=column.getWidth()),i==_this86.rightColumns.length-1?column.modules.frozen.edge=!0:column.modules.frozen.edge=!1,column.parent.isGroup?_this86.layoutElement(_this86.getColGroupParentElement(column),column):_this86.layoutElement(column.getElement(),column),allCells&&column.cells.forEach((function(cell){_this86.layoutElement(cell.getElement(!0),column)}))}))}},{key:"getColGroupParentElement",value:function(column){return column.parent.isGroup?this.getColGroupParentElement(column.parent):column.getElement()}},{key:"layout",value:function(){this.active&&!this.blocked&&(this.layoutColumnPosition(),this.reinitializeRows(),this.layoutCalcRows())}},{key:"reinitializeRows",value:function(){var _this87=this,visibleRows=this.table.rowManager.getVisibleRows(!0);this.table.rowManager.getRows().filter((function(row){return!visibleRows.includes(row)})).forEach((function(row){row.deinitialize()})),visibleRows.forEach((function(row){"row"===row.type&&_this87.layoutRow(row)}))}},{key:"layoutRow",value:function(row){var _this88=this;"fitDataFill"===this.table.options.layout&&this.rightColumns.length&&(this.table.rowManager.getTableElement().style.minWidth="calc(100% - "+this.rightMargin+")"),this.leftColumns.forEach((function(column){var cell=row.getCell(column);cell&&_this88.layoutElement(cell.getElement(!0),column)})),this.rightColumns.forEach((function(column){var cell=row.getCell(column);cell&&_this88.layoutElement(cell.getElement(!0),column)}))}},{key:"layoutElement",value:function(element,column){var position;column.modules.frozen&&(element.style.position="sticky",position=this.table.rtl?"left"===column.modules.frozen.position?"right":"left":column.modules.frozen.position,element.style[position]=column.modules.frozen.margin,element.classList.add("tabulator-frozen"),column.modules.frozen.edge&&element.classList.add("tabulator-frozen-"+column.modules.frozen.position))}},{key:"adjustForScrollbar",value:function(width){this.rightColumns.length&&(this.table.columnManager.getContentsElement().style.width="calc(100% - "+width+"px)")}},{key:"_calcSpace",value:function(columns,index){for(var width=0,i=0;i<index;i++)columns[i].visible&&(width+=columns[i].getWidth());return width}}]),FrozenColumns}(Module);_exports.FrozenColumnsModule=FrozenColumns,FrozenColumns.moduleName="frozenColumns";var FrozenRows=function(_Module12){_inherits(FrozenRows,_Module12);var _super17=_createSuper(FrozenRows);function FrozenRows(table){var _this89;return _classCallCheck(this,FrozenRows),(_this89=_super17.call(this,table)).topElement=document.createElement("div"),_this89.rows=[],_this89.registerComponentFunction("row","freeze",_this89.freezeRow.bind(_assertThisInitialized(_this89))),_this89.registerComponentFunction("row","unfreeze",_this89.unfreezeRow.bind(_assertThisInitialized(_this89))),_this89.registerComponentFunction("row","isFrozen",_this89.isRowFrozen.bind(_assertThisInitialized(_this89))),_this89.registerTableOption("frozenRowsField","id"),_this89.registerTableOption("frozenRows",!1),_this89}return _createClass(FrozenRows,[{key:"initialize",value:function(){this.rows=[],this.topElement.classList.add("tabulator-frozen-rows-holder"),this.table.columnManager.getContentsElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling),this.subscribe("row-deleting",this.detachRow.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),10),this.table.options.frozenRows&&(this.subscribe("data-processed",this.initializeRows.bind(this)),this.subscribe("row-added",this.initializeRow.bind(this)))}},{key:"initializeRows",value:function(){var _this90=this;this.table.rowManager.getRows().forEach((function(row){_this90.initializeRow(row)}))}},{key:"initializeRow",value:function(row){var frozenRows=this.table.options.frozenRows,rowType=_typeof(frozenRows);"number"===rowType?row.getPosition()&&row.getPosition()+this.rows.length<=frozenRows&&this.freezeRow(row):"function"===rowType?frozenRows.call(this.table,row.getComponent())&&this.freezeRow(row):Array.isArray(frozenRows)&&frozenRows.includes(row.data[this.options("frozenRowsField")])&&this.freezeRow(row)}},{key:"isRowFrozen",value:function(row){return this.rows.indexOf(row)>-1}},{key:"isFrozen",value:function(){return!!this.rows.length}},{key:"visibleRows",value:function(viewable,rows){return this.rows.forEach((function(row){rows.push(row)})),rows}},{key:"getRows",value:function(rows){var output=rows.slice(0);return this.rows.forEach((function(row){var index=output.indexOf(row);index>-1&&output.splice(index,1)})),output}},{key:"freezeRow",value:function(row){row.modules.frozen?console.warn("Freeze Error - Row is already frozen"):(row.modules.frozen=!0,this.topElement.appendChild(row.getElement()),row.initialize(),row.normalizeHeight(),this.rows.push(row),this.refreshData(!1,"display"),this.table.rowManager.adjustTableSize(),this.styleRows())}},{key:"unfreezeRow",value:function(row){row.modules.frozen?(row.modules.frozen=!1,this.detachRow(row),this.table.rowManager.adjustTableSize(),this.refreshData(!1,"display"),this.rows.length&&this.styleRows()):console.warn("Freeze Error - Row is already unfrozen")}},{key:"detachRow",value:function(row){var index=this.rows.indexOf(row);if(index>-1){var rowEl=row.getElement();rowEl.parentNode&&rowEl.parentNode.removeChild(rowEl),this.rows.splice(index,1)}}},{key:"styleRows",value:function(row){var _this91=this;this.rows.forEach((function(row,i){_this91.table.rowManager.styleRow(row,i)}))}}]),FrozenRows}(Module);_exports.FrozenRowsModule=FrozenRows,FrozenRows.moduleName="frozenRows";var GroupComponent=function(){function GroupComponent(group){return _classCallCheck(this,GroupComponent),this._group=group,this.type="GroupComponent",new Proxy(this,{get:function(target,name,receiver){return void 0!==target[name]?target[name]:target._group.groupManager.table.componentFunctionBinder.handle("row",target._group,name)}})}return _createClass(GroupComponent,[{key:"getKey",value:function(){return this._group.key}},{key:"getField",value:function(){return this._group.field}},{key:"getElement",value:function(){return this._group.element}},{key:"getRows",value:function(){return this._group.getRows(!0)}},{key:"getSubGroups",value:function(){return this._group.getSubGroups(!0)}},{key:"getParentGroup",value:function(){return!!this._group.parent&&this._group.parent.getComponent()}},{key:"isVisible",value:function(){return this._group.visible}},{key:"show",value:function(){this._group.show()}},{key:"hide",value:function(){this._group.hide()}},{key:"toggle",value:function(){this._group.toggleVisibility()}},{key:"_getSelf",value:function(){return this._group}},{key:"getTable",value:function(){return this._group.groupManager.table}}]),GroupComponent}();_exports.GroupComponent=GroupComponent;var Group=function(){function Group(groupManager,parent,level,key,field,generator,oldGroup){_classCallCheck(this,Group),this.groupManager=groupManager,this.parent=parent,this.key=key,this.level=level,this.field=field,this.hasSubGroups=level<groupManager.groupIDLookups.length-1,this.addRow=this.hasSubGroups?this._addRowToGroup:this._addRow,this.type="group",this.old=oldGroup,this.rows=[],this.groups=[],this.groupList=[],this.generator=generator,this.element=!1,this.elementContents=!1,this.height=0,this.outerHeight=0,this.initialized=!1,this.calcs={},this.initialized=!1,this.modules={},this.arrowElement=!1,this.visible=oldGroup?oldGroup.visible:void 0!==groupManager.startOpen[level]?groupManager.startOpen[level]:groupManager.startOpen[0],this.component=null,this.createElements(),this.addBindings(),this.createValueGroups()}return _createClass(Group,[{key:"wipe",value:function(elementsOnly){elementsOnly||(this.groupList.length?this.groupList.forEach((function(group){group.wipe()})):this.rows.forEach((function(row){row.modules&&delete row.modules.group}))),this.element=!1,this.arrowElement=!1,this.elementContents=!1}},{key:"createElements",value:function(){var arrow=document.createElement("div");arrow.classList.add("tabulator-arrow"),this.element=document.createElement("div"),this.element.classList.add("tabulator-row"),this.element.classList.add("tabulator-group"),this.element.classList.add("tabulator-group-level-"+this.level),this.element.setAttribute("role","rowgroup"),this.arrowElement=document.createElement("div"),this.arrowElement.classList.add("tabulator-group-toggle"),this.arrowElement.appendChild(arrow),!1!==this.groupManager.table.options.movableRows&&this.groupManager.table.modExists("moveRow")&&this.groupManager.table.modules.moveRow.initializeGroupHeader(this)}},{key:"createValueGroups",value:function(){var _this92=this,level=this.level+1;this.groupManager.allowedValues&&this.groupManager.allowedValues[level]&&this.groupManager.allowedValues[level].forEach((function(value){_this92._createGroup(value,level)}))}},{key:"addBindings",value:function(){var _this93=this;this.groupManager.table.options.groupToggleElement&&("arrow"==this.groupManager.table.options.groupToggleElement?this.arrowElement:this.element).addEventListener("click",(function(e){e.stopPropagation(),e.stopImmediatePropagation(),_this93.toggleVisibility()}))}},{key:"_createGroup",value:function(groupID,level){var groupKey=level+"_"+groupID,group=new Group(this.groupManager,this,level,groupID,this.groupManager.groupIDLookups[level].field,this.groupManager.headerGenerator[level]||this.groupManager.headerGenerator[0],!!this.old&&this.old.groups[groupKey]);this.groups[groupKey]=group,this.groupList.push(group)}},{key:"_addRowToGroup",value:function(row){var level=this.level+1;if(this.hasSubGroups){var groupID=this.groupManager.groupIDLookups[level].func(row.getData()),groupKey=level+"_"+groupID;this.groupManager.allowedValues&&this.groupManager.allowedValues[level]?this.groups[groupKey]&&this.groups[groupKey].addRow(row):(this.groups[groupKey]||this._createGroup(groupID,level),this.groups[groupKey].addRow(row))}}},{key:"_addRow",value:function(row){this.rows.push(row),row.modules.group=this}},{key:"insertRow",value:function(row,to,after){var data=this.conformRowData({});row.updateData(data);var toIndex=this.rows.indexOf(to);toIndex>-1?after?this.rows.splice(toIndex+1,0,row):this.rows.splice(toIndex,0,row):after?this.rows.push(row):this.rows.unshift(row),row.modules.group=this,this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this),this.groupManager.updateGroupRows(!0)}},{key:"scrollHeader",value:function(left){this.arrowElement&&(this.arrowElement.style.marginLeft=left,this.groupList.forEach((function(child){child.scrollHeader(left)})))}},{key:"getRowIndex",value:function(row){}},{key:"conformRowData",value:function(data){return this.field?data[this.field]=this.key:console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"),this.parent&&(data=this.parent.conformRowData(data)),data}},{key:"removeRow",value:function(row){var index=this.rows.indexOf(row),el=row.getElement();index>-1&&this.rows.splice(index,1),this.groupManager.table.options.groupValues||this.rows.length?(el.parentNode&&el.parentNode.removeChild(el),this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this)):(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this),this.groupManager.updateGroupRows(!0))}},{key:"removeGroup",value:function(group){var index,groupKey=group.level+"_"+group.key;this.groups[groupKey]&&(delete this.groups[groupKey],(index=this.groupList.indexOf(group))>-1&&this.groupList.splice(index,1),this.groupList.length||(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this)))}},{key:"getHeadersAndRows",value:function(){var output=[];return output.push(this),this._visSet(),this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.visible?this.groupList.length?this.groupList.forEach((function(group){output=output.concat(group.getHeadersAndRows())})):("table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),output.push(this.calcs.top)),output=output.concat(this.rows),"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),output.push(this.calcs.bottom))):this.groupList.length||"table"==this.groupManager.table.options.columnCalcs||this.groupManager.table.modExists("columnCalcs")&&(this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),output.push(this.calcs.top)),this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),output.push(this.calcs.bottom))),output}},{key:"getData",value:function(visible,transform){var output=[];return this._visSet(),(!visible||visible&&this.visible)&&this.rows.forEach((function(row){output.push(row.getData(transform||"data"))})),output}},{key:"getRowCount",value:function(){var count=0;return this.groupList.length?this.groupList.forEach((function(group){count+=group.getRowCount()})):count=this.rows.length,count}},{key:"toggleVisibility",value:function(){this.visible?this.hide():this.show()}},{key:"hide",value:function(){this.visible=!1,"basic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination||(this.element.classList.remove("tabulator-group-visible"),this.groupList.length?this.groupList.forEach((function(group){group.getHeadersAndRows().forEach((function(row){row.detachElement()}))})):this.rows.forEach((function(row){var rowEl=row.getElement();rowEl.parentNode.removeChild(rowEl)}))),this.groupManager.updateGroupRows(!0),this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!1)}},{key:"show",value:function(){if(this.visible=!0,"basic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination)this.groupManager.updateGroupRows(!0);else{this.element.classList.add("tabulator-group-visible");var prev=this.generateElement();this.groupList.length?this.groupList.forEach((function(group){group.getHeadersAndRows().forEach((function(row){var rowEl=row.getElement();prev.parentNode.insertBefore(rowEl,prev.nextSibling),row.initialize(),prev=rowEl}))})):this.rows.forEach((function(row){var rowEl=row.getElement();prev.parentNode.insertBefore(rowEl,prev.nextSibling),row.initialize(),prev=rowEl})),this.groupManager.updateGroupRows(!0)}this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!0)}},{key:"_visSet",value:function(){var data=[];"function"==typeof this.visible&&(this.rows.forEach((function(row){data.push(row.getData())})),this.visible=this.visible(this.key,this.getRowCount(),data,this.getComponent()))}},{key:"getRowGroup",value:function(row){var match=!1;return this.groupList.length?this.groupList.forEach((function(group){var result=group.getRowGroup(row);result&&(match=result)})):this.rows.find((function(item){return item===row}))&&(match=this),match}},{key:"getSubGroups",value:function(component){var output=[];return this.groupList.forEach((function(child){output.push(component?child.getComponent():child)})),output}},{key:"getRows",value:function(component){var output=[];return this.rows.forEach((function(row){output.push(component?row.getComponent():row)})),output}},{key:"generateGroupHeaderContents",value:function(){var data=[];for(this.rows.forEach((function(row){data.push(row.getData())})),this.elementContents=this.generator(this.key,this.getRowCount(),data,this.getComponent());this.element.firstChild;)this.element.removeChild(this.element.firstChild);"string"==typeof this.elementContents?this.element.innerHTML=this.elementContents:this.element.appendChild(this.elementContents),this.element.insertBefore(this.arrowElement,this.element.firstChild)}},{key:"getPath",value:function(){var path=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return path.unshift(this.key),this.parent&&this.parent.getPath(path),path}},{key:"getElement",value:function(){return this.elementContents?this.element:this.generateElement()}},{key:"generateElement",value:function(){this.addBindings=!1,this._visSet(),this.visible?this.element.classList.add("tabulator-group-visible"):this.element.classList.remove("tabulator-group-visible");for(var i=0;i<this.element.childNodes.length;++i)this.element.childNodes[i].parentNode.removeChild(this.element.childNodes[i]);return this.generateGroupHeaderContents(),this.element}},{key:"detachElement",value:function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}},{key:"normalizeHeight",value:function(){this.setHeight(this.element.clientHeight)}},{key:"initialize",value:function(force){this.initialized&&!force||(this.normalizeHeight(),this.initialized=!0)}},{key:"reinitialize",value:function(){this.initialized=!1,this.height=0,Helpers.elVisible(this.element)&&this.initialize(!0)}},{key:"setHeight",value:function(height){this.height!=height&&(this.height=height,this.outerHeight=this.element.offsetHeight)}},{key:"getHeight",value:function(){return this.outerHeight}},{key:"getGroup",value:function(){return this}},{key:"reinitializeHeight",value:function(){}},{key:"calcHeight",value:function(){}},{key:"setCellHeight",value:function(){}},{key:"clearCellHeight",value:function(){}},{key:"deinitializeHeight",value:function(){}},{key:"getComponent",value:function(){return this.component||(this.component=new GroupComponent(this)),this.component}}]),Group}(),GroupRows=function(_Module13){_inherits(GroupRows,_Module13);var _super18=_createSuper(GroupRows);function GroupRows(table){var _this94;return _classCallCheck(this,GroupRows),(_this94=_super18.call(this,table)).groupIDLookups=!1,_this94.startOpen=[function(){return!1}],_this94.headerGenerator=[function(){return""}],_this94.groupList=[],_this94.allowedValues=!1,_this94.groups={},_this94.displayHandler=_this94.getRows.bind(_assertThisInitialized(_this94)),_this94.registerTableOption("groupBy",!1),_this94.registerTableOption("groupStartOpen",!0),_this94.registerTableOption("groupValues",!1),_this94.registerTableOption("groupUpdateOnCellEdit",!1),_this94.registerTableOption("groupHeader",!1),_this94.registerTableOption("groupHeaderPrint",null),_this94.registerTableOption("groupHeaderClipboard",null),_this94.registerTableOption("groupHeaderHtmlOutput",null),_this94.registerTableOption("groupHeaderDownload",null),_this94.registerTableOption("groupToggleElement","arrow"),_this94.registerTableOption("groupClosedShowCalcs",!1),_this94.registerTableFunction("setGroupBy",_this94.setGroupBy.bind(_assertThisInitialized(_this94))),_this94.registerTableFunction("setGroupValues",_this94.setGroupValues.bind(_assertThisInitialized(_this94))),_this94.registerTableFunction("setGroupStartOpen",_this94.setGroupStartOpen.bind(_assertThisInitialized(_this94))),_this94.registerTableFunction("setGroupHeader",_this94.setGroupHeader.bind(_assertThisInitialized(_this94))),_this94.registerTableFunction("getGroups",_this94.userGetGroups.bind(_assertThisInitialized(_this94))),_this94.registerTableFunction("getGroupedData",_this94.userGetGroupedData.bind(_assertThisInitialized(_this94))),_this94.registerComponentFunction("row","getGroup",_this94.rowGetGroup.bind(_assertThisInitialized(_this94))),_this94}return _createClass(GroupRows,[{key:"initialize",value:function(){this.table.options.groupBy&&(this.table.options.groupUpdateOnCellEdit&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("row-data-changed",this.reassignRowToGroup.bind(this),0)),this.subscribe("table-built",this.configureGroupSetup.bind(this)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHeaders.bind(this)),this.subscribe("rows-wipe",this.wipe.bind(this)),this.subscribe("rows-added",this.rowsUpdated.bind(this)),this.subscribe("row-moving",this.rowMoving.bind(this)),this.subscribe("row-adding-index",this.rowAddingIndex.bind(this)),this.subscribe("rows-sample",this.rowSample.bind(this)),this.subscribe("render-virtual-fill",this.virtualRenderFill.bind(this)),this.registerDisplayHandler(this.displayHandler,20),this.initialized=!0)}},{key:"configureGroupSetup",value:function(){var _this95=this;if(this.table.options.groupBy){var groupBy=this.table.options.groupBy,startOpen=this.table.options.groupStartOpen,groupHeader=this.table.options.groupHeader;if(this.allowedValues=this.table.options.groupValues,Array.isArray(groupBy)&&Array.isArray(groupHeader)&&groupBy.length>groupHeader.length&&console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"),this.headerGenerator=[function(){return""}],this.startOpen=[function(){return!1}],this.langBind("groups|item",(function(langValue,lang){_this95.headerGenerator[0]=function(value,count,data){return(void 0===value?"":value)+"<span>("+count+" "+(1===count?langValue:lang.groups.items)+")</span>"}})),this.groupIDLookups=[],groupBy)this.table.modExists("columnCalcs")&&"table"!=this.table.options.columnCalcs&&"both"!=this.table.options.columnCalcs&&this.table.modules.columnCalcs.removeCalcs();else if(this.table.modExists("columnCalcs")&&"group"!=this.table.options.columnCalcs)this.table.columnManager.getRealColumns().forEach((function(col){col.definition.topCalc&&_this95.table.modules.columnCalcs.initializeTopRow(),col.definition.bottomCalc&&_this95.table.modules.columnCalcs.initializeBottomRow()}));Array.isArray(groupBy)||(groupBy=[groupBy]),groupBy.forEach((function(group,i){var lookupFunc,column;lookupFunc="function"==typeof group?group:(column=_this95.table.columnManager.getColumnByField(group))?function(data){return column.getFieldValue(data)}:function(data){return data[group]},_this95.groupIDLookups.push({field:"function"!=typeof group&&group,func:lookupFunc,values:!!_this95.allowedValues&&_this95.allowedValues[i]})})),startOpen&&(Array.isArray(startOpen)||(startOpen=[startOpen]),startOpen.forEach((function(level){})),this.startOpen=startOpen),groupHeader&&(this.headerGenerator=Array.isArray(groupHeader)?groupHeader:[groupHeader])}else this.groupList=[],this.groups={}}},{key:"rowSample",value:function(rows,prevValue){if(this.table.options.groupBy){var group=this.getGroups(!1)[0];prevValue.push(group.getRows(!1)[0])}return prevValue}},{key:"virtualRenderFill",value:function(){var el=this.table.rowManager.tableElement,rows=this.table.rowManager.getVisibleRows();if(!this.table.options.groupBy)return rows;rows=rows.filter((function(row){return"group"!==row.type})),el.style.minWidth=rows.length?"":this.table.columnManager.getWidth()+"px"}},{key:"rowAddingIndex",value:function(row,index,top){if(this.table.options.groupBy){this.assignRowToGroup(row);var groupRows=row.modules.group.rows;return groupRows.length>1&&(!index||index&&-1==groupRows.indexOf(index)?top?groupRows[0]!==row&&(index=groupRows[0],this.table.rowManager.moveRowInArray(row.modules.group.rows,row,index,!top)):groupRows[groupRows.length-1]!==row&&(index=groupRows[groupRows.length-1],this.table.rowManager.moveRowInArray(row.modules.group.rows,row,index,!top)):this.table.rowManager.moveRowInArray(row.modules.group.rows,row,index,!top)),index}}},{key:"trackChanges",value:function(){this.dispatch("group-changed")}},{key:"setGroupBy",value:function(groups){this.table.options.groupBy=groups,this.initialized||this.initialize(),this.configureGroupSetup(),!groups&&this.table.modExists("columnCalcs")&&!0===this.table.options.columnCalcs&&this.table.modules.columnCalcs.reinitializeCalcs(),this.refreshData(),this.trackChanges()}},{key:"setGroupValues",value:function(groupValues){this.table.options.groupValues=groupValues,this.configureGroupSetup(),this.refreshData(),this.trackChanges()}},{key:"setGroupStartOpen",value:function(values){this.table.options.groupStartOpen=values,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}},{key:"setGroupHeader",value:function(values){this.table.options.groupHeader=values,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}},{key:"userGetGroups",value:function(values){return this.getGroups(!0)}},{key:"userGetGroupedData",value:function(){return this.table.options.groupBy?this.getGroupedData():this.getData()}},{key:"rowGetGroup",value:function(row){return!!row.modules.group&&row.modules.group.getComponent()}},{key:"rowMoving",value:function(from,to,after){if(this.table.options.groupBy){!after&&to instanceof Group&&(to=this.table.rowManager.prevDisplayRow(from)||to);var toGroup=to instanceof Group?to:to.modules.group,fromGroup=from instanceof Group?from:from.modules.group;toGroup===fromGroup?this.table.rowManager.moveRowInArray(toGroup.rows,from,to,after):(fromGroup&&fromGroup.removeRow(from),toGroup.insertRow(from,to,after))}}},{key:"rowDeleting",value:function(row){this.table.options.groupBy&&row.modules.group&&row.modules.group.removeRow(row)}},{key:"rowsUpdated",value:function(row){this.table.options.groupBy&&this.updateGroupRows(!0)}},{key:"cellUpdated",value:function(cell){this.table.options.groupBy&&this.reassignRowToGroup(cell.row)}},{key:"getRows",value:function(rows){return this.table.options.groupBy&&this.groupIDLookups.length?(this.dispatchExternal("dataGrouping"),this.generateGroups(rows),this.subscribedExternal("dataGrouped")&&this.dispatchExternal("dataGrouped",this.getGroups(!0)),this.updateGroupRows()):rows.slice(0)}},{key:"getGroups",value:function(component){var groupComponents=[];return this.groupList.forEach((function(group){groupComponents.push(component?group.getComponent():group)})),groupComponents}},{key:"getChildGroups",value:function(group){var _this96=this,groupComponents=[];return group||(group=this),group.groupList.forEach((function(child){child.groupList.length?groupComponents=groupComponents.concat(_this96.getChildGroups(child)):groupComponents.push(child)})),groupComponents}},{key:"wipe",value:function(){this.table.options.groupBy&&(this.groupList.forEach((function(group){group.wipe()})),this.groupList=[],this.groups={})}},{key:"pullGroupListData",value:function(groupList){var _this97=this,groupListData=[];return groupList.forEach((function(group){var groupHeader={level:0,rowCount:0,headerContent:""},childData=[];group.hasSubGroups?(childData=_this97.pullGroupListData(group.groupList),groupHeader.level=group.level,groupHeader.rowCount=childData.length-group.groupList.length,groupHeader.headerContent=group.generator(group.key,groupHeader.rowCount,group.rows,group),groupListData.push(groupHeader),groupListData=groupListData.concat(childData)):(groupHeader.level=group.level,groupHeader.headerContent=group.generator(group.key,group.rows.length,group.rows,group),groupHeader.rowCount=group.getRows().length,groupListData.push(groupHeader),group.getRows().forEach((function(row){groupListData.push(row.getData("data"))})))})),groupListData}},{key:"getGroupedData",value:function(){return this.pullGroupListData(this.groupList)}},{key:"getRowGroup",value:function(row){var match=!1;return this.options("dataTree")&&(row=this.table.modules.dataTree.getTreeParentRoot(row)),this.groupList.forEach((function(group){var result=group.getRowGroup(row);result&&(match=result)})),match}},{key:"countGroups",value:function(){return this.groupList.length}},{key:"generateGroups",value:function(rows){var _this98=this,oldGroups=this.groups;this.groups={},this.groupList=[],this.allowedValues&&this.allowedValues[0]?(this.allowedValues[0].forEach((function(value){_this98.createGroup(value,0,oldGroups)})),rows.forEach((function(row){_this98.assignRowToExistingGroup(row,oldGroups)}))):rows.forEach((function(row){_this98.assignRowToGroup(row,oldGroups)})),Object.values(oldGroups).forEach((function(group){group.wipe(!0)}))}},{key:"createGroup",value:function(groupID,level,oldGroups){var group,groupKey=level+"_"+groupID;oldGroups=oldGroups||[],group=new Group(this,!1,level,groupID,this.groupIDLookups[0].field,this.headerGenerator[0],oldGroups[groupKey]),this.groups[groupKey]=group,this.groupList.push(group)}},{key:"assignRowToExistingGroup",value:function(row,oldGroups){var groupKey="0_"+this.groupIDLookups[0].func(row.getData());this.groups[groupKey]&&this.groups[groupKey].addRow(row)}},{key:"assignRowToGroup",value:function(row,oldGroups){var groupID=this.groupIDLookups[0].func(row.getData()),newGroupNeeded=!this.groups["0_"+groupID];return newGroupNeeded&&this.createGroup(groupID,0,oldGroups),this.groups["0_"+groupID].addRow(row),!newGroupNeeded}},{key:"reassignRowToGroup",value:function(row){if("row"===row.type){var oldRowGroup=row.modules.group,oldGroupPath=oldRowGroup.getPath(),newGroupPath=this.getExpectedPath(row);oldGroupPath.length==newGroupPath.length&&oldGroupPath.every((function(element,index){return element===newGroupPath[index]}))||(oldRowGroup.removeRow(row),this.assignRowToGroup(row,this.groups),this.refreshData(!0))}}},{key:"getExpectedPath",value:function(row){var groupPath=[],rowData=row.getData();return this.groupIDLookups.forEach((function(groupId){groupPath.push(groupId.func(rowData))})),groupPath}},{key:"updateGroupRows",value:function(force){var output=[];return this.groupList.forEach((function(group){output=output.concat(group.getHeadersAndRows())})),force&&this.refreshData(!0,this.displayHandler),output}},{key:"scrollHeaders",value:function(left){this.table.options.groupBy&&("virtual"===this.table.options.renderHorizontal&&(left-=this.table.columnManager.renderer.vDomPadLeft),left+="px",this.groupList.forEach((function(group){group.scrollHeader(left)})))}},{key:"removeGroup",value:function(group){var index,groupKey=group.level+"_"+group.key;this.groups[groupKey]&&(delete this.groups[groupKey],(index=this.groupList.indexOf(group))>-1&&this.groupList.splice(index,1))}},{key:"checkBasicModeGroupHeaderWidth",value:function(){var _this99=this,element=this.table.rowManager.tableElement,onlyGroupHeaders=!0;this.table.rowManager.getDisplayRows().forEach((function(row,index){_this99.table.rowManager.styleRow(row,index),element.appendChild(row.getElement()),row.initialize(!0),"group"!==row.type&&(onlyGroupHeaders=!1)})),element.style.minWidth=onlyGroupHeaders?this.table.columnManager.getWidth()+"px":""}}]),GroupRows}(Module);_exports.GroupRowsModule=GroupRows,GroupRows.moduleName="groupRows";var History=function(_Module14){_inherits(History,_Module14);var _super19=_createSuper(History);function History(table){var _this100;return _classCallCheck(this,History),(_this100=_super19.call(this,table)).history=[],_this100.index=-1,_this100.registerTableOption("history",!1),_this100}return _createClass(History,[{key:"initialize",value:function(){this.table.options.history&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("cell-delete",this.clearComponentHistory.bind(this)),this.subscribe("row-delete",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clear.bind(this)),this.subscribe("row-added",this.rowAdded.bind(this)),this.subscribe("row-move",this.rowMoved.bind(this))),this.registerTableFunction("undo",this.undo.bind(this)),this.registerTableFunction("redo",this.redo.bind(this)),this.registerTableFunction("getHistoryUndoSize",this.getHistoryUndoSize.bind(this)),this.registerTableFunction("getHistoryRedoSize",this.getHistoryRedoSize.bind(this)),this.registerTableFunction("clearHistory",this.clear.bind(this))}},{key:"rowMoved",value:function(from,to,after){this.action("rowMove",from,{posFrom:from.getPosition(),posTo:to.getPosition(),to:to,after:after})}},{key:"rowAdded",value:function(row,data,pos,index){this.action("rowAdd",row,{data:data,pos:pos,index:index})}},{key:"rowDeleted",value:function(row){var index,rows;this.table.options.groupBy?(index=(rows=row.getComponent().getGroup()._getSelf().rows).indexOf(row))&&(index=rows[index-1]):(index=row.table.rowManager.getRowIndex(row))&&(index=row.table.rowManager.rows[index-1]),this.action("rowDelete",row,{data:row.getData(),pos:!index,index:index})}},{key:"cellUpdated",value:function(cell){this.action("cellEdit",cell,{oldValue:cell.oldValue,newValue:cell.value})}},{key:"clear",value:function(){this.history=[],this.index=-1}},{key:"action",value:function(type,component,data){this.history=this.history.slice(0,this.index+1),this.history.push({type:type,component:component,data:data}),this.index++}},{key:"getHistoryUndoSize",value:function(){return this.index+1}},{key:"getHistoryRedoSize",value:function(){return this.history.length-(this.index+1)}},{key:"clearComponentHistory",value:function(component){var index=this.history.findIndex((function(item){return item.component===component}));index>-1&&(this.history.splice(index,1),index<=this.index&&this.index--,this.clearComponentHistory(component))}},{key:"undo",value:function(){if(this.index>-1){var action=this.history[this.index];return History.undoers[action.type].call(this,action),this.index--,this.dispatchExternal("historyUndo",action.type,action.component.getComponent(),action.data),!0}return console.warn("History Undo Error - No more history to undo"),!1}},{key:"redo",value:function(){if(this.history.length-1>this.index){this.index++;var action=this.history[this.index];return History.redoers[action.type].call(this,action),this.dispatchExternal("historyRedo",action.type,action.component.getComponent(),action.data),!0}return console.warn("History Redo Error - No more history to redo"),!1}},{key:"_rebindRow",value:function(oldRow,newRow){this.history.forEach((function(action){if(action.component instanceof Row)action.component===oldRow&&(action.component=newRow);else if(action.component instanceof Cell&&action.component.row===oldRow){var field=action.component.column.getField();field&&(action.component=newRow.getCell(field))}}))}}]),History}(Module);_exports.HistoryModule=History,History.moduleName="history",History.undoers={cellEdit:function(action){action.component.setValueProcessData(action.data.oldValue),action.component.cellRendered()},rowAdd:function(action){action.component.deleteActual()},rowDelete:function(action){var newRow=this.table.rowManager.addRowActual(action.data.data,action.data.pos,action.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(action.component,newRow)},rowMove:function(action){this.table.rowManager.moveRowActual(action.component,this.table.rowManager.rows[action.data.posFrom],!action.data.after),this.table.rowManager.redraw()}},History.redoers={cellEdit:function(action){action.component.setValueProcessData(action.data.newValue),action.component.cellRendered()},rowAdd:function(action){var newRow=this.table.rowManager.addRowActual(action.data.data,action.data.pos,action.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(action.component,newRow)},rowDelete:function(action){action.component.deleteActual()},rowMove:function(action){this.table.rowManager.moveRowActual(action.component,this.table.rowManager.rows[action.data.posTo],action.data.after),this.table.rowManager.redraw()}};var HtmlTableImport=function(_Module15){_inherits(HtmlTableImport,_Module15);var _super20=_createSuper(HtmlTableImport);function HtmlTableImport(table){var _this101;return _classCallCheck(this,HtmlTableImport),(_this101=_super20.call(this,table)).fieldIndex=[],_this101.hasIndex=!1,_this101}return _createClass(HtmlTableImport,[{key:"initialize",value:function(){this.tableElementCheck()}},{key:"tableElementCheck",value:function(){this.table.originalElement&&"TABLE"===this.table.originalElement.tagName&&(this.table.originalElement.childNodes.length?this.parseTable():console.warn("Unable to parse data from empty table tag, Tabulator should be initialized on a div tag unless importing data from a table element."))}},{key:"parseTable",value:function(){var element=this.table.originalElement,options=this.table.options,headers=element.getElementsByTagName("th"),rows=element.getElementsByTagName("tbody")[0],data=[];this.hasIndex=!1,this.dispatchExternal("htmlImporting"),rows=rows?rows.getElementsByTagName("tr"):[],this._extractOptions(element,options),headers.length?this._extractHeaders(headers,rows):this._generateBlankHeaders(headers,rows);for(var index=0;index<rows.length;index++){var cells=rows[index].getElementsByTagName("td"),item={};this.hasIndex||(item[options.index]=index);for(var i=0;i<cells.length;i++){var cell=cells[i];void 0!==this.fieldIndex[i]&&(item[this.fieldIndex[i]]=cell.innerHTML)}data.push(item)}options.data=data,this.dispatchExternal("htmlImported")}},{key:"_extractOptions",value:function(element,options,defaultOptions){var attributes=element.attributes,optionsArr=defaultOptions?Object.keys(defaultOptions):Object.keys(options),optionsList={};for(var index in optionsArr.forEach((function(item){optionsList[item.toLowerCase()]=item})),attributes){var name,attrib=attributes[index];attrib&&"object"==_typeof(attrib)&&attrib.name&&0===attrib.name.indexOf("tabulator-")&&(name=attrib.name.replace("tabulator-",""),void 0!==optionsList[name]&&(options[optionsList[name]]=this._attribValue(attrib.value)))}}},{key:"_attribValue",value:function(value){return"true"===value||"false"!==value&&value}},{key:"_findCol",value:function(title){return this.table.options.columns.find((function(column){return column.title===title}))||!1}},{key:"_extractHeaders",value:function(headers,rows){for(var index=0;index<headers.length;index++){var width,header=headers[index],exists=!1,col=this._findCol(header.textContent);col?exists=!0:col={title:header.textContent.trim()},col.field||(col.field=header.textContent.trim().toLowerCase().replace(" ","_")),(width=header.getAttribute("width"))&&!col.width&&(col.width=width),this._extractOptions(header,col,this.table.columnManager.optionsList.registeredDefaults),this.fieldIndex[index]=col.field,col.field==this.table.options.index&&(this.hasIndex=!0),exists||this.table.options.columns.push(col)}}},{key:"_generateBlankHeaders",value:function(headers,rows){for(var index=0;index<headers.length;index++){var header=headers[index],col={title:"",field:"col"+index};this.fieldIndex[index]=col.field;var width=header.getAttribute("width");width&&(col.width=width),this.table.options.columns.push(col)}}}]),HtmlTableImport}(Module);_exports.HtmlTableImportModule=HtmlTableImport,HtmlTableImport.moduleName="htmlTableImport";var defaultImporters={csv:function(input){for(var data=[],row=0,col=0,inQuote=!1,index=0;index<input.length;index++){var char=input[index],nextChar=input[index+1];data[row]||(data[row]=[]),data[row][col]||(data[row][col]=""),'"'==char&&inQuote&&'"'==nextChar?(data[row][col]+=char,index++):'"'!=char?","!=char||inQuote?"\r"!=char||"\n"!=nextChar||inQuote?"\r"!=char&&"\n"!=char||inQuote?data[row][col]+=char:(col=0,row++):(col=0,row++,index++):col++:inQuote=!inQuote}return data},json:function(input){try{return JSON.parse(input)}catch(e){return console.warn("JSON Import Error - File contents is invalid JSON",e),Promise.reject()}},array:function(input){return input}},Import=function(_Module16){_inherits(Import,_Module16);var _super21=_createSuper(Import);function Import(table){var _this102;return _classCallCheck(this,Import),(_this102=_super21.call(this,table)).registerTableOption("importFormat"),_this102.registerTableOption("importReader","text"),_this102}return _createClass(Import,[{key:"initialize",value:function(){this.registerTableFunction("import",this.importFromFile.bind(this)),this.table.options.importFormat&&(this.subscribe("data-loading",this.loadDataCheck.bind(this),10),this.subscribe("data-load",this.loadData.bind(this),10))}},{key:"loadDataCheck",value:function(data){return this.table.options.importFormat&&("string"==typeof data||Array.isArray(data)&&data.length&&Array.isArray(data))}},{key:"loadData",value:function(data,params,config,silent,previousData){return this.importData(this.lookupImporter(),data).then(this.structureData.bind(this)).catch((function(err){return console.error("Import Error:",err||"Unable to import data"),Promise.reject(err)}))}},{key:"lookupImporter",value:function(importFormat){var importer;return importFormat||(importFormat=this.table.options.importFormat),(importer="string"==typeof importFormat?Import.importers[importFormat]:importFormat)||console.error("Import Error - Importer not found:",importFormat),importer}},{key:"importFromFile",value:function(importFormat,extension){var importer=this.lookupImporter(importFormat);if(importer)return this.pickFile(extension).then(this.importData.bind(this,importer)).then(this.structureData.bind(this)).then(this.setData.bind(this)).catch((function(err){return console.error("Import Error:",err||"Unable to import file"),Promise.reject(err)}))}},{key:"pickFile",value:function(extensions){var _this103=this;return new Promise((function(resolve,reject){var input=document.createElement("input");input.type="file",input.accept=extensions,input.addEventListener("change",(function(e){var file=input.files[0],reader=new FileReader;switch(_this103.table.options.importReader){case"buffer":reader.readAsArrayBuffer(file);break;case"binary":reader.readAsBinaryString(file);break;case"url":reader.readAsDataURL(file);break;default:reader.readAsText(file)}reader.onload=function(e){resolve(reader.result)},reader.onerror=function(e){console.warn("File Load Error - Unable to read file"),reject()}})),input.click()}))}},{key:"importData",value:function(importer,fileContents){var data=importer.call(this.table,fileContents);return data instanceof Promise?data:data?Promise.resolve(data):Promise.reject()}},{key:"structureData",value:function(parsedData){return Array.isArray(parsedData)&&parsedData.length&&Array.isArray(parsedData[0])?this.table.options.autoColumns?this.structureArrayToObject(parsedData):this.structureArrayToColumns(parsedData):parsedData}},{key:"structureArrayToObject",value:function(parsedData){var columns=parsedData.shift();return parsedData.map((function(values){var row={};return columns.forEach((function(key,i){row[key]=values[i]})),row}))}},{key:"structureArrayToColumns",value:function(parsedData){var data=[],columns=this.table.getColumns();return columns[0]&&parsedData[0][0]&&columns[0].getDefinition().title===parsedData[0][0]&&parsedData.shift(),parsedData.forEach((function(rowData){var row={};rowData.forEach((function(value,index){var column=columns[index];column&&(row[column.getField()]=value)})),data.push(row)})),data}},{key:"setData",value:function(data){return this.table.setData(data)}}]),Import}(Module);_exports.ImportModule=Import,Import.moduleName="import",Import.importers=defaultImporters;var Interaction=function(_Module17){_inherits(Interaction,_Module17);var _super22=_createSuper(Interaction);function Interaction(table){var _this104;return _classCallCheck(this,Interaction),(_this104=_super22.call(this,table)).eventMap={rowClick:"row-click",rowDblClick:"row-dblclick",rowContext:"row-contextmenu",rowMouseEnter:"row-mouseenter",rowMouseLeave:"row-mouseleave",rowMouseOver:"row-mouseover",rowMouseOut:"row-mouseout",rowMouseMove:"row-mousemove",rowMouseDown:"row-mousedown",rowMouseUp:"row-mouseup",rowTap:"row",rowDblTap:"row",rowTapHold:"row",cellClick:"cell-click",cellDblClick:"cell-dblclick",cellContext:"cell-contextmenu",cellMouseEnter:"cell-mouseenter",cellMouseLeave:"cell-mouseleave",cellMouseOver:"cell-mouseover",cellMouseOut:"cell-mouseout",cellMouseMove:"cell-mousemove",cellMouseDown:"cell-mousedown",cellMouseUp:"cell-mouseup",cellTap:"cell",cellDblTap:"cell",cellTapHold:"cell",headerClick:"column-click",headerDblClick:"column-dblclick",headerContext:"column-contextmenu",headerMouseEnter:"column-mouseenter",headerMouseLeave:"column-mouseleave",headerMouseOver:"column-mouseover",headerMouseOut:"column-mouseout",headerMouseMove:"column-mousemove",headerMouseDown:"column-mousedown",headerMouseUp:"column-mouseup",headerTap:"column",headerDblTap:"column",headerTapHold:"column",groupClick:"group-click",groupDblClick:"group-dblclick",groupContext:"group-contextmenu",groupMouseEnter:"group-mouseenter",groupMouseLeave:"group-mouseleave",groupMouseOver:"group-mouseover",groupMouseOut:"group-mouseout",groupMouseMove:"group-mousemove",groupMouseDown:"group-mousedown",groupMouseUp:"group-mouseup",groupTap:"group",groupDblTap:"group",groupTapHold:"group"},_this104.subscribers={},_this104.touchSubscribers={},_this104.columnSubscribers={},_this104.touchWatchers={row:{tap:null,tapDbl:null,tapHold:null},cell:{tap:null,tapDbl:null,tapHold:null},column:{tap:null,tapDbl:null,tapHold:null},group:{tap:null,tapDbl:null,tapHold:null}},_this104.registerColumnOption("headerClick"),_this104.registerColumnOption("headerDblClick"),_this104.registerColumnOption("headerContext"),_this104.registerColumnOption("headerMouseEnter"),_this104.registerColumnOption("headerMouseLeave"),_this104.registerColumnOption("headerMouseOver"),_this104.registerColumnOption("headerMouseOut"),_this104.registerColumnOption("headerMouseMove"),_this104.registerColumnOption("headerMouseDown"),_this104.registerColumnOption("headerMouseUp"),_this104.registerColumnOption("headerTap"),_this104.registerColumnOption("headerDblTap"),_this104.registerColumnOption("headerTapHold"),_this104.registerColumnOption("cellClick"),_this104.registerColumnOption("cellDblClick"),_this104.registerColumnOption("cellContext"),_this104.registerColumnOption("cellMouseEnter"),_this104.registerColumnOption("cellMouseLeave"),_this104.registerColumnOption("cellMouseOver"),_this104.registerColumnOption("cellMouseOut"),_this104.registerColumnOption("cellMouseMove"),_this104.registerColumnOption("cellMouseDown"),_this104.registerColumnOption("cellMouseUp"),_this104.registerColumnOption("cellTap"),_this104.registerColumnOption("cellDblTap"),_this104.registerColumnOption("cellTapHold"),_this104}return _createClass(Interaction,[{key:"initialize",value:function(){this.initializeExternalEvents(),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("cell-dblclick",this.cellContentsSelectionFixer.bind(this))}},{key:"cellContentsSelectionFixer",value:function(e,cell){var range;if(!this.table.modExists("edit")||this.table.modules.edit.currentCell!==cell){e.preventDefault();try{document.selection?((range=document.body.createTextRange()).moveToElementText(cell.getElement()),range.select()):window.getSelection&&((range=document.createRange()).selectNode(cell.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(range))}catch(e){}}}},{key:"initializeExternalEvents",value:function(){for(var key in this.eventMap)this.subscriptionChangeExternal(key,this.subscriptionChanged.bind(this,key))}},{key:"subscriptionChanged",value:function(key,added){added?this.subscribers[key]||(this.eventMap[key].includes("-")?(this.subscribers[key]=this.handle.bind(this,key),this.subscribe(this.eventMap[key],this.subscribers[key])):this.subscribeTouchEvents(key)):this.eventMap[key].includes("-")?!this.subscribers[key]||this.columnSubscribers[key]||this.subscribedExternal(key)||(this.unsubscribe(this.eventMap[key],this.subscribers[key]),delete this.subscribers[key]):this.unsubscribeTouchEvents(key)}},{key:"subscribeTouchEvents",value:function(key){var type=this.eventMap[key];this.touchSubscribers[type+"-touchstart"]||(this.touchSubscribers[type+"-touchstart"]=this.handleTouch.bind(this,type,"start"),this.touchSubscribers[type+"-touchend"]=this.handleTouch.bind(this,type,"end"),this.subscribe(type+"-touchstart",this.touchSubscribers[type+"-touchstart"]),this.subscribe(type+"-touchend",this.touchSubscribers[type+"-touchend"])),this.subscribers[key]=!0}},{key:"unsubscribeTouchEvents",value:function(key){var noTouch=!0,type=this.eventMap[key];if(this.subscribers[key]&&!this.subscribedExternal(key)){for(var i in delete this.subscribers[key],this.eventMap)this.eventMap[i]===type&&this.subscribers[i]&&(noTouch=!1);noTouch&&(this.unsubscribe(type+"-touchstart",this.touchSubscribers[type+"-touchstart"]),this.unsubscribe(type+"-touchend",this.touchSubscribers[type+"-touchend"]),delete this.touchSubscribers[type+"-touchstart"],delete this.touchSubscribers[type+"-touchend"])}}},{key:"initializeColumn",value:function(column){var def=column.definition;for(var key in this.eventMap)def[key]&&(this.subscriptionChanged(key,!0),this.columnSubscribers[key]||(this.columnSubscribers[key]=[]),this.columnSubscribers[key].push(column))}},{key:"handle",value:function(action,e,component){this.dispatchEvent(action,e,component)}},{key:"handleTouch",value:function(type,action,e,component){var _this105=this,watchers=this.touchWatchers[type];switch("column"===type&&(type="header"),action){case"start":watchers.tap=!0,clearTimeout(watchers.tapHold),watchers.tapHold=setTimeout((function(){clearTimeout(watchers.tapHold),watchers.tapHold=null,watchers.tap=null,clearTimeout(watchers.tapDbl),watchers.tapDbl=null,_this105.dispatchEvent(type+"TapHold",e,component)}),1e3);break;case"end":watchers.tap&&(watchers.tap=null,this.dispatchEvent(type+"Tap",e,component)),watchers.tapDbl?(clearTimeout(watchers.tapDbl),watchers.tapDbl=null,this.dispatchEvent(type+"DblTap",e,component)):watchers.tapDbl=setTimeout((function(){clearTimeout(watchers.tapDbl),watchers.tapDbl=null}),300),clearTimeout(watchers.tapHold),watchers.tapHold=null}}},{key:"dispatchEvent",value:function(action,e,component){var callback,componentObj=component.getComponent();this.columnSubscribers[action]&&(component instanceof Cell?callback=component.column.definition[action]:component instanceof Column&&(callback=component.definition[action]),callback&&callback(e,componentObj)),this.dispatchExternal(action,e,componentObj)}}]),Interaction}(Module);_exports.InteractionModule=Interaction,Interaction.moduleName="interaction";var Keybindings=function(_Module18){_inherits(Keybindings,_Module18);var _super23=_createSuper(Keybindings);function Keybindings(table){var _this106;return _classCallCheck(this,Keybindings),(_this106=_super23.call(this,table)).watchKeys=null,_this106.pressedKeys=null,_this106.keyupBinding=!1,_this106.keydownBinding=!1,_this106.registerTableOption("keybindings",{}),_this106.registerTableOption("tabEndNewRow",!1),_this106}return _createClass(Keybindings,[{key:"initialize",value:function(){var bindings=this.table.options.keybindings,mergedBindings={};this.watchKeys={},this.pressedKeys=[],!1!==bindings&&(Object.assign(mergedBindings,Keybindings.bindings),Object.assign(mergedBindings,bindings),this.mapBindings(mergedBindings),this.bindEvents()),this.subscribe("table-destroy",this.clearBindings.bind(this))}},{key:"mapBindings",value:function(bindings){var _this107=this,_loop2=function(key){Keybindings.actions[key]?bindings[key]&&("object"!==_typeof(bindings[key])&&(bindings[key]=[bindings[key]]),bindings[key].forEach((function(binding){(Array.isArray(binding)?binding:[binding]).forEach((function(item){_this107.mapBinding(key,item)}))}))):console.warn("Key Binding Error - no such action:",key)};for(var key in bindings)_loop2(key)}},{key:"mapBinding",value:function(action,symbolsList){var _this108=this,binding={action:Keybindings.actions[action],keys:[],ctrl:!1,shift:!1,meta:!1};symbolsList.toString().toLowerCase().split(" ").join("").split("+").forEach((function(symbol){switch(symbol){case"ctrl":binding.ctrl=!0;break;case"shift":binding.shift=!0;break;case"meta":binding.meta=!0;break;default:symbol=isNaN(symbol)?symbol.toUpperCase().charCodeAt(0):parseInt(symbol),binding.keys.push(symbol),_this108.watchKeys[symbol]||(_this108.watchKeys[symbol]=[]),_this108.watchKeys[symbol].push(binding)}}))}},{key:"bindEvents",value:function(){var self=this;this.keyupBinding=function(e){var code=e.keyCode,bindings=self.watchKeys[code];bindings&&(self.pressedKeys.push(code),bindings.forEach((function(binding){self.checkBinding(e,binding)})))},this.keydownBinding=function(e){var code=e.keyCode;if(self.watchKeys[code]){var index=self.pressedKeys.indexOf(code);index>-1&&self.pressedKeys.splice(index,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)}},{key:"clearBindings",value:function(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)}},{key:"checkBinding",value:function(e,binding){var _this109=this,match=!0;return e.ctrlKey==binding.ctrl&&e.shiftKey==binding.shift&&e.metaKey==binding.meta&&(binding.keys.forEach((function(key){-1==_this109.pressedKeys.indexOf(key)&&(match=!1)})),match&&binding.action.call(this,e),!0)}}]),Keybindings}(Module);_exports.KeybindingsModule=Keybindings,Keybindings.moduleName="keybindings",Keybindings.bindings={navPrev:"shift + 9",navNext:9,navUp:38,navDown:40,scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35,undo:["ctrl + 90","meta + 90"],redo:["ctrl + 89","meta + 89"],copyToClipboard:["ctrl + 67","meta + 89"]},Keybindings.actions={keyBlock:function(e){e.stopPropagation(),e.preventDefault()},scrollPageUp:function(e){var rowManager=this.table.rowManager,newPos=rowManager.scrollTop-rowManager.element.clientHeight;e.preventDefault(),rowManager.displayRowsCount&&(newPos>=0?rowManager.element.scrollTop=newPos:rowManager.scrollToRow(rowManager.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(e){var rowManager=this.table.rowManager,newPos=rowManager.scrollTop+rowManager.element.clientHeight,scrollMax=rowManager.element.scrollHeight;e.preventDefault(),rowManager.displayRowsCount&&(newPos<=scrollMax?rowManager.element.scrollTop=newPos:rowManager.scrollToRow(rowManager.getDisplayRows()[rowManager.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(e){var rowManager=this.table.rowManager;e.preventDefault(),rowManager.displayRowsCount&&rowManager.scrollToRow(rowManager.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(e){var rowManager=this.table.rowManager;e.preventDefault(),rowManager.displayRowsCount&&rowManager.scrollToRow(rowManager.getDisplayRows()[rowManager.displayRowsCount-1]),this.table.element.focus()},navPrev:function(e){this.dispatch("keybinding-nav-prev",e)},navNext:function(e){this.dispatch("keybinding-nav-next",e)},navLeft:function(e){this.dispatch("keybinding-nav-left",e)},navRight:function(e){this.dispatch("keybinding-nav-right",e)},navUp:function(e){this.dispatch("keybinding-nav-up",e)},navDown:function(e){this.dispatch("keybinding-nav-down",e)},undo:function(e){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(e.preventDefault(),this.table.modules.history.undo()))},redo:function(e){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(e.preventDefault(),this.table.modules.history.redo()))},copyToClipboard:function(e){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}};var Menu=function(_Module19){_inherits(Menu,_Module19);var _super24=_createSuper(Menu);function Menu(table){var _this110;return _classCallCheck(this,Menu),(_this110=_super24.call(this,table)).menuContainer=null,_this110.nestedMenuBlock=!1,_this110.currentComponent=null,_this110.rootPopup=null,_this110.columnSubscribers={},_this110.registerTableOption("menuContainer",void 0),_this110.registerTableOption("rowContextMenu",!1),_this110.registerTableOption("rowClickMenu",!1),_this110.registerTableOption("rowDblClickMenu",!1),_this110.registerTableOption("groupContextMenu",!1),_this110.registerTableOption("groupClickMenu",!1),_this110.registerTableOption("groupDblClickMenu",!1),_this110.registerColumnOption("headerContextMenu"),_this110.registerColumnOption("headerClickMenu"),_this110.registerColumnOption("headerDblClickMenu"),_this110.registerColumnOption("headerMenu"),_this110.registerColumnOption("headerMenuIcon"),_this110.registerColumnOption("contextMenu"),_this110.registerColumnOption("clickMenu"),_this110.registerColumnOption("dblClickMenu"),_this110}return _createClass(Menu,[{key:"initialize",value:function(){this.deprecatedOptionsCheck(),this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}},{key:"deprecatedOptionsCheck",value:function(){this.deprecationCheck("menuContainer","popupContainer")||(this.table.options.popupContainer=this.table.options.menuContainer)}},{key:"initializeRowWatchers",value:function(){this.table.options.rowContextMenu&&(this.subscribe("row-contextmenu",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu)),this.table.on("rowTapHold",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu))),this.table.options.rowClickMenu&&this.subscribe("row-click",this.loadMenuEvent.bind(this,this.table.options.rowClickMenu)),this.table.options.rowDblClickMenu&&this.subscribe("row-dblclick",this.loadMenuEvent.bind(this,this.table.options.rowDblClickMenu))}},{key:"initializeGroupWatchers",value:function(){this.table.options.groupContextMenu&&(this.subscribe("group-contextmenu",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu)),this.table.on("groupTapHold",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu))),this.table.options.groupClickMenu&&this.subscribe("group-click",this.loadMenuEvent.bind(this,this.table.options.groupClickMenu)),this.table.options.groupDblClickMenu&&this.subscribe("group-dblclick",this.loadMenuEvent.bind(this,this.table.options.groupDblClickMenu))}},{key:"initializeColumn",value:function(column){var def=column.definition;def.headerContextMenu&&!this.columnSubscribers.headerContextMenu&&(this.columnSubscribers.headerContextMenu=this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextMenu),this.table.on("headerTapHold",this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"))),def.headerClickMenu&&!this.columnSubscribers.headerClickMenu&&(this.columnSubscribers.headerClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerClickMenu"),this.subscribe("column-click",this.columnSubscribers.headerClickMenu)),def.headerDblClickMenu&&!this.columnSubscribers.headerDblClickMenu&&(this.columnSubscribers.headerDblClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerDblClickMenu"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickMenu)),def.headerMenu&&this.initializeColumnHeaderMenu(column),def.contextMenu&&!this.columnSubscribers.contextMenu&&(this.columnSubscribers.contextMenu=this.loadMenuTableCellEvent.bind(this,"contextMenu"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextMenu),this.table.on("cellTapHold",this.loadMenuTableCellEvent.bind(this,"contextMenu"))),def.clickMenu&&!this.columnSubscribers.clickMenu&&(this.columnSubscribers.clickMenu=this.loadMenuTableCellEvent.bind(this,"clickMenu"),this.subscribe("cell-click",this.columnSubscribers.clickMenu)),def.dblClickMenu&&!this.columnSubscribers.dblClickMenu&&(this.columnSubscribers.dblClickMenu=this.loadMenuTableCellEvent.bind(this,"dblClickMenu"),this.subscribe("cell-dblclick",this.columnSubscribers.dblClickMenu))}},{key:"initializeColumnHeaderMenu",value:function(column){var headerMenuEl,_this111=this,icon=column.definition.headerMenuIcon;(headerMenuEl=document.createElement("span")).classList.add("tabulator-header-popup-button"),icon?("function"==typeof icon&&(icon=icon(column.getComponent())),icon instanceof HTMLElement?headerMenuEl.appendChild(icon):headerMenuEl.innerHTML=icon):headerMenuEl.innerHTML="&vellip;",headerMenuEl.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault(),_this111.loadMenuEvent(column.definition.headerMenu,e,column)})),column.titleElement.insertBefore(headerMenuEl,column.titleElement.firstChild)}},{key:"loadMenuTableCellEvent",value:function(option,e,cell){cell._cell&&(cell=cell._cell),cell.column.definition[option]&&this.loadMenuEvent(cell.column.definition[option],e,cell)}},{key:"loadMenuTableColumnEvent",value:function(option,e,column){column._column&&(column=column._column),column.definition[option]&&this.loadMenuEvent(column.definition[option],e,column)}},{key:"loadMenuEvent",value:function(menu,e,component){component._group?component=component._group:component._row&&(component=component._row),menu="function"==typeof menu?menu.call(this.table,e,component.getComponent()):menu,this.loadMenu(e,component,menu)}},{key:"loadMenu",value:function(e,component,menu,parentEl,parentPopup){var popup,_this112=this,touch=!(e instanceof MouseEvent),menuEl=document.createElement("div");if(menuEl.classList.add("tabulator-menu"),touch||e.preventDefault(),menu&&menu.length){if(parentEl)popup=parentPopup.child(menuEl);else{if(this.nestedMenuBlock){if(this.rootPopup)return}else this.nestedMenuBlock=setTimeout((function(){_this112.nestedMenuBlock=!1}),100);this.rootPopup&&this.rootPopup.hide(),this.rootPopup=popup=this.popup(menuEl)}menu.forEach((function(item){var itemEl=document.createElement("div"),label=item.label,disabled=item.disabled;item.separator?itemEl.classList.add("tabulator-menu-separator"):(itemEl.classList.add("tabulator-menu-item"),"function"==typeof label&&(label=label.call(_this112.table,component.getComponent())),label instanceof Node?itemEl.appendChild(label):itemEl.innerHTML=label,"function"==typeof disabled&&(disabled=disabled.call(_this112.table,component.getComponent())),disabled?(itemEl.classList.add("tabulator-menu-item-disabled"),itemEl.addEventListener("click",(function(e){e.stopPropagation()}))):item.menu&&item.menu.length?itemEl.addEventListener("click",(function(e){e.stopPropagation(),_this112.loadMenu(e,component,item.menu,itemEl,popup)})):item.action&&itemEl.addEventListener("click",(function(e){item.action(e,component.getComponent())})),item.menu&&item.menu.length&&itemEl.classList.add("tabulator-menu-item-submenu")),menuEl.appendChild(itemEl)})),menuEl.addEventListener("click",(function(e){_this112.rootPopup&&_this112.rootPopup.hide()})),popup.show(parentEl||e),popup===this.rootPopup&&(this.rootPopup.hideOnBlur((function(){_this112.rootPopup=null,_this112.currentComponent&&(_this112.dispatchExternal("menuClosed",_this112.currentComponent.getComponent()),_this112.currentComponent=null)})),this.currentComponent=component,this.dispatchExternal("menuOpened",component.getComponent()))}}}]),Menu}(Module);_exports.MenuModule=Menu,Menu.moduleName="menu";var MoveColumns=function(_Module20){_inherits(MoveColumns,_Module20);var _super25=_createSuper(MoveColumns);function MoveColumns(table){var _this113;return _classCallCheck(this,MoveColumns),(_this113=_super25.call(this,table)).placeholderElement=_this113.createPlaceholderElement(),_this113.hoverElement=!1,_this113.checkTimeout=!1,_this113.checkPeriod=250,_this113.moving=!1,_this113.toCol=!1,_this113.toColAfter=!1,_this113.startX=0,_this113.autoScrollMargin=40,_this113.autoScrollStep=5,_this113.autoScrollTimeout=!1,_this113.touchMove=!1,_this113.moveHover=_this113.moveHover.bind(_assertThisInitialized(_this113)),_this113.endMove=_this113.endMove.bind(_assertThisInitialized(_this113)),_this113.registerTableOption("movableColumns",!1),_this113}return _createClass(MoveColumns,[{key:"createPlaceholderElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-col"),el.classList.add("tabulator-col-placeholder"),el}},{key:"initialize",value:function(){this.table.options.movableColumns&&this.subscribe("column-init",this.initializeColumn.bind(this))}},{key:"initializeColumn",value:function(column){var colEl,self=this,config={};column.modules.frozen||column.isGroup||(colEl=column.getElement(),config.mousemove=function(e){column.parent===self.moving.parent&&((self.touchMove?e.touches[0].pageX:e.pageX)-Helpers.elOffset(colEl).left+self.table.columnManager.contentsElement.scrollLeft>column.getWidth()/2?self.toCol===column&&self.toColAfter||(colEl.parentNode.insertBefore(self.placeholderElement,colEl.nextSibling),self.moveColumn(column,!0)):(self.toCol!==column||self.toColAfter)&&(colEl.parentNode.insertBefore(self.placeholderElement,colEl),self.moveColumn(column,!1)))}.bind(self),colEl.addEventListener("mousedown",(function(e){self.touchMove=!1,1===e.which&&(self.checkTimeout=setTimeout((function(){self.startMove(e,column)}),self.checkPeriod))})),colEl.addEventListener("mouseup",(function(e){1===e.which&&self.checkTimeout&&clearTimeout(self.checkTimeout)})),self.bindTouchEvents(column)),column.modules.moveColumn=config}},{key:"bindTouchEvents",value:function(column){var nextCol,prevCol,nextColWidth,prevColWidth,nextColWidthLast,prevColWidthLast,_this114=this,colEl=column.getElement(),startXMove=!1;colEl.addEventListener("touchstart",(function(e){_this114.checkTimeout=setTimeout((function(){_this114.touchMove=!0,nextCol=column.nextColumn(),nextColWidth=nextCol?nextCol.getWidth()/2:0,prevCol=column.prevColumn(),prevColWidth=prevCol?prevCol.getWidth()/2:0,nextColWidthLast=0,prevColWidthLast=0,startXMove=!1,_this114.startMove(e,column)}),_this114.checkPeriod)}),{passive:!0}),colEl.addEventListener("touchmove",(function(e){var diff,moveToCol;_this114.moving&&(_this114.moveHover(e),startXMove||(startXMove=e.touches[0].pageX),(diff=e.touches[0].pageX-startXMove)>0?nextCol&&diff-nextColWidthLast>nextColWidth&&(moveToCol=nextCol)!==column&&(startXMove=e.touches[0].pageX,moveToCol.getElement().parentNode.insertBefore(_this114.placeholderElement,moveToCol.getElement().nextSibling),_this114.moveColumn(moveToCol,!0)):prevCol&&-diff-prevColWidthLast>prevColWidth&&(moveToCol=prevCol)!==column&&(startXMove=e.touches[0].pageX,moveToCol.getElement().parentNode.insertBefore(_this114.placeholderElement,moveToCol.getElement()),_this114.moveColumn(moveToCol,!1)),moveToCol&&(nextCol=moveToCol.nextColumn(),nextColWidthLast=nextColWidth,nextColWidth=nextCol?nextCol.getWidth()/2:0,prevCol=moveToCol.prevColumn(),prevColWidthLast=prevColWidth,prevColWidth=prevCol?prevCol.getWidth()/2:0))}),{passive:!0}),colEl.addEventListener("touchend",(function(e){_this114.checkTimeout&&clearTimeout(_this114.checkTimeout),_this114.moving&&_this114.endMove(e)}))}},{key:"startMove",value:function(e,column){var element=column.getElement(),headerElement=this.table.columnManager.getContentsElement(),headersElement=this.table.columnManager.getHeadersElement();this.moving=column,this.startX=(this.touchMove?e.touches[0].pageX:e.pageX)-Helpers.elOffset(element).left,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=column.getWidth()+"px",this.placeholderElement.style.height=column.getHeight()+"px",element.parentNode.insertBefore(this.placeholderElement,element),element.parentNode.removeChild(element),this.hoverElement=element.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),headerElement.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.bottom=headerElement.clientHeight-headersElement.offsetHeight+"px",this.touchMove||(this._bindMouseMove(),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove)),this.moveHover(e)}},{key:"_bindMouseMove",value:function(){this.table.columnManager.columnsByIndex.forEach((function(column){column.modules.moveColumn.mousemove&&column.getElement().addEventListener("mousemove",column.modules.moveColumn.mousemove)}))}},{key:"_unbindMouseMove",value:function(){this.table.columnManager.columnsByIndex.forEach((function(column){column.modules.moveColumn.mousemove&&column.getElement().removeEventListener("mousemove",column.modules.moveColumn.mousemove)}))}},{key:"moveColumn",value:function(column,after){var movingCells=this.moving.getCells();this.toCol=column,this.toColAfter=after,after?column.getCells().forEach((function(cell,i){var cellEl=cell.getElement(!0);cellEl.parentNode&&movingCells[i]&&cellEl.parentNode.insertBefore(movingCells[i].getElement(),cellEl.nextSibling)})):column.getCells().forEach((function(cell,i){var cellEl=cell.getElement(!0);cellEl.parentNode&&movingCells[i]&&cellEl.parentNode.insertBefore(movingCells[i].getElement(),cellEl)}))}},{key:"endMove",value:function(e){(1===e.which||this.touchMove)&&(this._unbindMouseMove(),this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toCol&&this.table.columnManager.moveColumnActual(this.moving,this.toCol,this.toColAfter),this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.touchMove||(document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove)))}},{key:"moveHover",value:function(e){var scrollPos,_this115=this,columnHolder=this.table.columnManager.getContentsElement(),scrollLeft=columnHolder.scrollLeft,xPos=(this.touchMove?e.touches[0].pageX:e.pageX)-Helpers.elOffset(columnHolder).left+scrollLeft;this.hoverElement.style.left=xPos-this.startX+"px",xPos-scrollLeft<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout((function(){scrollPos=Math.max(0,scrollLeft-5),_this115.table.rowManager.getElement().scrollLeft=scrollPos,_this115.autoScrollTimeout=!1}),1))),scrollLeft+columnHolder.clientWidth-xPos<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout((function(){scrollPos=Math.min(columnHolder.clientWidth,scrollLeft+5),_this115.table.rowManager.getElement().scrollLeft=scrollPos,_this115.autoScrollTimeout=!1}),1)))}}]),MoveColumns}(Module);_exports.MoveColumnsModule=MoveColumns,MoveColumns.moduleName="moveColumn";var MoveRows=function(_Module21){_inherits(MoveRows,_Module21);var _super26=_createSuper(MoveRows);function MoveRows(table){var _this116;return _classCallCheck(this,MoveRows),(_this116=_super26.call(this,table)).placeholderElement=_this116.createPlaceholderElement(),_this116.hoverElement=!1,_this116.checkTimeout=!1,_this116.checkPeriod=150,_this116.moving=!1,_this116.toRow=!1,_this116.toRowAfter=!1,_this116.hasHandle=!1,_this116.startY=0,_this116.startX=0,_this116.moveHover=_this116.moveHover.bind(_assertThisInitialized(_this116)),_this116.endMove=_this116.endMove.bind(_assertThisInitialized(_this116)),_this116.tableRowDropEvent=!1,_this116.touchMove=!1,_this116.connection=!1,_this116.connectionSelectorsTables=!1,_this116.connectionSelectorsElements=!1,_this116.connectionElements=[],_this116.connections=[],_this116.connectedTable=!1,_this116.connectedRow=!1,_this116.registerTableOption("movableRows",!1),_this116.registerTableOption("movableRowsConnectedTables",!1),_this116.registerTableOption("movableRowsConnectedElements",!1),_this116.registerTableOption("movableRowsSender",!1),_this116.registerTableOption("movableRowsReceiver","insert"),_this116.registerColumnOption("rowHandle"),_this116}return _createClass(MoveRows,[{key:"createPlaceholderElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-row"),el.classList.add("tabulator-row-placeholder"),el}},{key:"initialize",value:function(){this.table.options.movableRows&&(this.connectionSelectorsTables=this.table.options.movableRowsConnectedTables,this.connectionSelectorsElements=this.table.options.movableRowsConnectedElements,this.connection=this.connectionSelectorsTables||this.connectionSelectorsElements,this.subscribe("cell-init",this.initializeCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)))}},{key:"initializeGroupHeader",value:function(group){var self=this,config={};config.mouseup=function(e){self.tableRowDrop(e,group)}.bind(self),config.mousemove=function(e){var rowEl;e.pageY-Helpers.elOffset(group.element).top+self.table.rowManager.element.scrollTop>group.getHeight()/2?self.toRow===group&&self.toRowAfter||((rowEl=group.getElement()).parentNode.insertBefore(self.placeholderElement,rowEl.nextSibling),self.moveRow(group,!0)):(self.toRow!==group||self.toRowAfter)&&(rowEl=group.getElement()).previousSibling&&(rowEl.parentNode.insertBefore(self.placeholderElement,rowEl),self.moveRow(group,!1))}.bind(self),group.modules.moveRow=config}},{key:"initializeRow",value:function(row){var rowEl,self=this,config={};config.mouseup=function(e){self.tableRowDrop(e,row)}.bind(self),config.mousemove=function(e){var rowEl=row.getElement();e.pageY-Helpers.elOffset(rowEl).top+self.table.rowManager.element.scrollTop>row.getHeight()/2?self.toRow===row&&self.toRowAfter||(rowEl.parentNode.insertBefore(self.placeholderElement,rowEl.nextSibling),self.moveRow(row,!0)):(self.toRow!==row||self.toRowAfter)&&(rowEl.parentNode.insertBefore(self.placeholderElement,rowEl),self.moveRow(row,!1))}.bind(self),this.hasHandle||((rowEl=row.getElement()).addEventListener("mousedown",(function(e){1===e.which&&(self.checkTimeout=setTimeout((function(){self.startMove(e,row)}),self.checkPeriod))})),rowEl.addEventListener("mouseup",(function(e){1===e.which&&self.checkTimeout&&clearTimeout(self.checkTimeout)})),this.bindTouchEvents(row,row.getElement())),row.modules.moveRow=config}},{key:"initializeColumn",value:function(column){column.definition.rowHandle&&!1!==this.table.options.movableRows&&(this.hasHandle=!0)}},{key:"initializeCell",value:function(cell){if(cell.column.definition.rowHandle&&!1!==this.table.options.movableRows){var self=this,cellEl=cell.getElement(!0);cellEl.addEventListener("mousedown",(function(e){1===e.which&&(self.checkTimeout=setTimeout((function(){self.startMove(e,cell.row)}),self.checkPeriod))})),cellEl.addEventListener("mouseup",(function(e){1===e.which&&self.checkTimeout&&clearTimeout(self.checkTimeout)})),this.bindTouchEvents(cell.row,cellEl)}}},{key:"bindTouchEvents",value:function(row,element){var nextRow,prevRow,nextRowHeight,prevRowHeight,nextRowHeightLast,prevRowHeightLast,_this117=this,startYMove=!1;element.addEventListener("touchstart",(function(e){_this117.checkTimeout=setTimeout((function(){_this117.touchMove=!0,nextRow=row.nextRow(),nextRowHeight=nextRow?nextRow.getHeight()/2:0,prevRow=row.prevRow(),prevRowHeight=prevRow?prevRow.getHeight()/2:0,nextRowHeightLast=0,prevRowHeightLast=0,startYMove=!1,_this117.startMove(e,row)}),_this117.checkPeriod)}),{passive:!0}),this.moving,this.toRow,this.toRowAfter,element.addEventListener("touchmove",(function(e){var diff,moveToRow;_this117.moving&&(e.preventDefault(),_this117.moveHover(e),startYMove||(startYMove=e.touches[0].pageY),(diff=e.touches[0].pageY-startYMove)>0?nextRow&&diff-nextRowHeightLast>nextRowHeight&&(moveToRow=nextRow)!==row&&(startYMove=e.touches[0].pageY,moveToRow.getElement().parentNode.insertBefore(_this117.placeholderElement,moveToRow.getElement().nextSibling),_this117.moveRow(moveToRow,!0)):prevRow&&-diff-prevRowHeightLast>prevRowHeight&&(moveToRow=prevRow)!==row&&(startYMove=e.touches[0].pageY,moveToRow.getElement().parentNode.insertBefore(_this117.placeholderElement,moveToRow.getElement()),_this117.moveRow(moveToRow,!1)),moveToRow&&(nextRow=moveToRow.nextRow(),nextRowHeightLast=nextRowHeight,nextRowHeight=nextRow?nextRow.getHeight()/2:0,prevRow=moveToRow.prevRow(),prevRowHeightLast=prevRowHeight,prevRowHeight=prevRow?prevRow.getHeight()/2:0))})),element.addEventListener("touchend",(function(e){_this117.checkTimeout&&clearTimeout(_this117.checkTimeout),_this117.moving&&(_this117.endMove(e),_this117.touchMove=!1)}))}},{key:"_bindMouseMove",value:function(){this.table.rowManager.getDisplayRows().forEach((function(row){("row"===row.type||"group"===row.type)&&row.modules.moveRow&&row.modules.moveRow.mousemove&&row.getElement().addEventListener("mousemove",row.modules.moveRow.mousemove)}))}},{key:"_unbindMouseMove",value:function(){this.table.rowManager.getDisplayRows().forEach((function(row){("row"===row.type||"group"===row.type)&&row.modules.moveRow&&row.modules.moveRow.mousemove&&row.getElement().removeEventListener("mousemove",row.modules.moveRow.mousemove)}))}},{key:"startMove",value:function(e,row){var element=row.getElement();this.setStartPosition(e,row),this.moving=row,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=row.getWidth()+"px",this.placeholderElement.style.height=row.getHeight()+"px",this.connection?(this.table.element.classList.add("tabulator-movingrow-sending"),this.connectToTables(row)):(element.parentNode.insertBefore(this.placeholderElement,element),element.parentNode.removeChild(element)),this.hoverElement=element.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.connection?(document.body.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this.hoverElement.style.width=this.table.element.clientWidth+"px",this.hoverElement.style.whiteSpace="nowrap",this.hoverElement.style.overflow="hidden",this.hoverElement.style.pointerEvents="none"):(this.table.rowManager.getTableElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this._bindMouseMove()),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove),this.dispatchExternal("rowMoving",row.getComponent()),this.moveHover(e)}},{key:"setStartPosition",value:function(e,row){var element,position,pageX=this.touchMove?e.touches[0].pageX:e.pageX,pageY=this.touchMove?e.touches[0].pageY:e.pageY;element=row.getElement(),this.connection?(position=element.getBoundingClientRect(),this.startX=position.left-pageX+window.pageXOffset,this.startY=position.top-pageY+window.pageYOffset):this.startY=pageY-element.getBoundingClientRect().top}},{key:"endMove",value:function(e){e&&1!==e.which&&!this.touchMove||(this._unbindMouseMove(),this.connection||(this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement)),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toRow?this.table.rowManager.moveRow(this.moving,this.toRow,this.toRowAfter):this.dispatchExternal("rowMoveCancelled",this.moving.getComponent()),this.moving=!1,this.toRow=!1,this.toRowAfter=!1,document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove),this.connection&&(this.table.element.classList.remove("tabulator-movingrow-sending"),this.disconnectFromTables()))}},{key:"moveRow",value:function(row,after){this.toRow=row,this.toRowAfter=after}},{key:"moveHover",value:function(e){this.connection?this.moveHoverConnections.call(this,e):this.moveHoverTable.call(this,e)}},{key:"moveHoverTable",value:function(e){var rowHolder=this.table.rowManager.getElement(),scrollTop=rowHolder.scrollTop,yPos=(this.touchMove?e.touches[0].pageY:e.pageY)-rowHolder.getBoundingClientRect().top+scrollTop;this.hoverElement.style.top=Math.min(yPos-this.startY,this.table.rowManager.element.scrollHeight-this.hoverElement.offsetHeight)+"px"}},{key:"moveHoverConnections",value:function(e){this.hoverElement.style.left=this.startX+(this.touchMove?e.touches[0].pageX:e.pageX)+"px",this.hoverElement.style.top=this.startY+(this.touchMove?e.touches[0].pageY:e.pageY)+"px"}},{key:"elementRowDrop",value:function(e,element,row){this.dispatchExternal("movableRowsElementDrop",e,element,!!row&&row.getComponent())}},{key:"connectToTables",value:function(row){var connectionTables,_this118=this;this.connectionSelectorsTables&&(connectionTables=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStart",connectionTables),this.commsSend(this.connectionSelectorsTables,"moveRow","connect",{row:row})),this.connectionSelectorsElements&&(this.connectionElements=[],Array.isArray(this.connectionSelectorsElements)||(this.connectionSelectorsElements=[this.connectionSelectorsElements]),this.connectionSelectorsElements.forEach((function(query){"string"==typeof query?_this118.connectionElements=_this118.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(query))):_this118.connectionElements.push(query)})),this.connectionElements.forEach((function(element){var dropEvent=function(e){_this118.elementRowDrop(e,element,_this118.moving)};element.addEventListener("mouseup",dropEvent),element.tabulatorElementDropEvent=dropEvent,element.classList.add("tabulator-movingrow-receiving")})))}},{key:"disconnectFromTables",value:function(){var connectionTables;this.connectionSelectorsTables&&(connectionTables=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStop",connectionTables),this.commsSend(this.connectionSelectorsTables,"moveRow","disconnect")),this.connectionElements.forEach((function(element){element.classList.remove("tabulator-movingrow-receiving"),element.removeEventListener("mouseup",element.tabulatorElementDropEvent),delete element.tabulatorElementDropEvent}))}},{key:"connect",value:function(table,row){return this.connectedTable?(console.warn("Move Row Error - Table cannot accept connection, already connected to table:",this.connectedTable),!1):(this.connectedTable=table,this.connectedRow=row,this.table.element.classList.add("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach((function(row){"row"===row.type&&row.modules.moveRow&&row.modules.moveRow.mouseup&&row.getElement().addEventListener("mouseup",row.modules.moveRow.mouseup)})),this.tableRowDropEvent=this.tableRowDrop.bind(this),this.table.element.addEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStart",row,table),!0)}},{key:"disconnect",value:function(table){table===this.connectedTable?(this.connectedTable=!1,this.connectedRow=!1,this.table.element.classList.remove("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach((function(row){"row"===row.type&&row.modules.moveRow&&row.modules.moveRow.mouseup&&row.getElement().removeEventListener("mouseup",row.modules.moveRow.mouseup)})),this.table.element.removeEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStop",table)):console.warn("Move Row Error - trying to disconnect from non connected table")}},{key:"dropComplete",value:function(table,row,success){var sender=!1;if(success){switch(_typeof(this.table.options.movableRowsSender)){case"string":sender=this.senders[this.table.options.movableRowsSender];break;case"function":sender=this.table.options.movableRowsSender}sender?sender.call(this,this.moving?this.moving.getComponent():void 0,row?row.getComponent():void 0,table):this.table.options.movableRowsSender&&console.warn("Mover Row Error - no matching sender found:",this.table.options.movableRowsSender),this.dispatchExternal("movableRowsSent",this.moving.getComponent(),row?row.getComponent():void 0,table)}else this.dispatchExternal("movableRowsSentFailed",this.moving.getComponent(),row?row.getComponent():void 0,table);this.endMove()}},{key:"tableRowDrop",value:function(e,row){var receiver=!1,success=!1;switch(e.stopImmediatePropagation(),_typeof(this.table.options.movableRowsReceiver)){case"string":receiver=this.receivers[this.table.options.movableRowsReceiver];break;case"function":receiver=this.table.options.movableRowsReceiver}receiver?success=receiver.call(this,this.connectedRow.getComponent(),row?row.getComponent():void 0,this.connectedTable):console.warn("Mover Row Error - no matching receiver found:",this.table.options.movableRowsReceiver),success?this.dispatchExternal("movableRowsReceived",this.connectedRow.getComponent(),row?row.getComponent():void 0,this.connectedTable):this.dispatchExternal("movableRowsReceivedFailed",this.connectedRow.getComponent(),row?row.getComponent():void 0,this.connectedTable),this.commsSend(this.connectedTable,"moveRow","dropcomplete",{row:row,success:success})}},{key:"commsReceived",value:function(table,action,data){switch(action){case"connect":return this.connect(table,data.row);case"disconnect":return this.disconnect(table);case"dropcomplete":return this.dropComplete(table,data.row,data.success)}}}]),MoveRows}(Module);_exports.MoveRowsModule=MoveRows,MoveRows.prototype.receivers={insert:function(fromRow,toRow,fromTable){return this.table.addRow(fromRow.getData(),void 0,toRow),!0},add:function(fromRow,toRow,fromTable){return this.table.addRow(fromRow.getData()),!0},update:function(fromRow,toRow,fromTable){return!!toRow&&(toRow.update(fromRow.getData()),!0)},replace:function(fromRow,toRow,fromTable){return!!toRow&&(this.table.addRow(fromRow.getData(),void 0,toRow),toRow.delete(),!0)}},MoveRows.prototype.senders={delete:function(fromRow,toRow,toTable){fromRow.delete()}},MoveRows.moduleName="moveRow";var Mutator=function(_Module22){_inherits(Mutator,_Module22);var _super27=_createSuper(Mutator);function Mutator(table){var _this119;return _classCallCheck(this,Mutator),(_this119=_super27.call(this,table)).allowedTypes=["","data","edit","clipboard"],_this119.enabled=!0,_this119.registerColumnOption("mutator"),_this119.registerColumnOption("mutatorParams"),_this119.registerColumnOption("mutatorData"),_this119.registerColumnOption("mutatorDataParams"),_this119.registerColumnOption("mutatorEdit"),_this119.registerColumnOption("mutatorEditParams"),_this119.registerColumnOption("mutatorClipboard"),_this119.registerColumnOption("mutatorClipboardParams"),_this119.registerColumnOption("mutateLink"),_this119}return _createClass(Mutator,[{key:"initialize",value:function(){this.subscribe("cell-value-changing",this.transformCell.bind(this)),this.subscribe("cell-value-changed",this.mutateLink.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-init-before",this.rowDataChanged.bind(this)),this.subscribe("row-data-changing",this.rowDataChanged.bind(this))}},{key:"rowDataChanged",value:function(row,tempData,updatedData){return this.transformRow(tempData,"data",updatedData)}},{key:"initializeColumn",value:function(column){var _this120=this,match=!1,config={};this.allowedTypes.forEach((function(type){var mutator,key="mutator"+(type.charAt(0).toUpperCase()+type.slice(1));column.definition[key]&&(mutator=_this120.lookupMutator(column.definition[key]))&&(match=!0,config[key]={mutator:mutator,params:column.definition[key+"Params"]||{}})})),match&&(column.modules.mutate=config)}},{key:"lookupMutator",value:function(value){var mutator=!1;switch(_typeof(value)){case"string":Mutator.mutators[value]?mutator=Mutator.mutators[value]:console.warn("Mutator Error - No such mutator found, ignoring: ",value);break;case"function":mutator=value}return mutator}},{key:"transformRow",value:function(data,type,updatedData){var value,key="mutator"+(type.charAt(0).toUpperCase()+type.slice(1));return this.enabled&&this.table.columnManager.traverse((function(column){var mutator,params,component;column.modules.mutate&&(mutator=column.modules.mutate[key]||column.modules.mutate.mutator||!1)&&(value=column.getFieldValue(void 0!==updatedData?updatedData:data),"data"!=type&&void 0===value||(component=column.getComponent(),params="function"==typeof mutator.params?mutator.params(value,data,type,component):mutator.params,column.setFieldValue(data,mutator.mutator(value,data,type,params,component))))})),data}},{key:"transformCell",value:function(cell,value){if(cell.column.modules.mutate){var mutator=cell.column.modules.mutate.mutatorEdit||cell.column.modules.mutate.mutator||!1,tempData={};if(mutator)return tempData=Object.assign(tempData,cell.row.getData()),cell.column.setFieldValue(tempData,value),mutator.mutator(value,tempData,"edit",mutator.params,cell.getComponent())}return value}},{key:"mutateLink",value:function(cell){var links=cell.column.definition.mutateLink;links&&(Array.isArray(links)||(links=[links]),links.forEach((function(link){var linkCell=cell.row.getCell(link);linkCell&&linkCell.setValue(linkCell.getValue(),!0,!0)})))}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1}}]),Mutator}(Module);_exports.MutatorModule=Mutator,Mutator.moduleName="mutator",Mutator.mutators={};var defaultPageCounters={rows:function(pageSize,currentRow,currentPage,totalRows,totalPages){var el=document.createElement("span"),showingEl=document.createElement("span"),valueEl=document.createElement("span"),ofEl=document.createElement("span"),totalEl=document.createElement("span"),rowsEl=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",(function(value){showingEl.innerHTML=value})),this.table.modules.localize.langBind("pagination|counter|of",(function(value){ofEl.innerHTML=value})),this.table.modules.localize.langBind("pagination|counter|rows",(function(value){rowsEl.innerHTML=value})),totalRows?(valueEl.innerHTML=" "+currentRow+"-"+Math.min(currentRow+pageSize-1,totalRows)+" ",totalEl.innerHTML=" "+totalRows+" ",el.appendChild(showingEl),el.appendChild(valueEl),el.appendChild(ofEl),el.appendChild(totalEl),el.appendChild(rowsEl)):(valueEl.innerHTML=" 0 ",el.appendChild(showingEl),el.appendChild(valueEl),el.appendChild(rowsEl)),el},pages:function(pageSize,currentRow,currentPage,totalRows,totalPages){var el=document.createElement("span"),showingEl=document.createElement("span"),valueEl=document.createElement("span"),ofEl=document.createElement("span"),totalEl=document.createElement("span"),rowsEl=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",(function(value){showingEl.innerHTML=value})),valueEl.innerHTML=" "+currentPage+" ",this.table.modules.localize.langBind("pagination|counter|of",(function(value){ofEl.innerHTML=value})),totalEl.innerHTML=" "+totalPages+" ",this.table.modules.localize.langBind("pagination|counter|pages",(function(value){rowsEl.innerHTML=value})),el.appendChild(showingEl),el.appendChild(valueEl),el.appendChild(ofEl),el.appendChild(totalEl),el.appendChild(rowsEl),el}},Page=function(_Module23){_inherits(Page,_Module23);var _super28=_createSuper(Page);function Page(table){var _this121;return _classCallCheck(this,Page),(_this121=_super28.call(this,table)).mode="local",_this121.progressiveLoad=!1,_this121.element=null,_this121.pageCounterElement=null,_this121.pageCounter=null,_this121.size=0,_this121.page=1,_this121.count=5,_this121.max=1,_this121.remoteRowCountEstimate=null,_this121.initialLoad=!0,_this121.dataChanging=!1,_this121.pageSizes=[],_this121.registerTableOption("pagination",!1),_this121.registerTableOption("paginationMode","local"),_this121.registerTableOption("paginationSize",!1),_this121.registerTableOption("paginationInitialPage",1),_this121.registerTableOption("paginationCounter",!1),_this121.registerTableOption("paginationCounterElement",!1),_this121.registerTableOption("paginationButtonCount",5),_this121.registerTableOption("paginationSizeSelector",!1),_this121.registerTableOption("paginationElement",!1),_this121.registerTableOption("paginationAddRow","page"),_this121.registerTableOption("progressiveLoad",!1),_this121.registerTableOption("progressiveLoadDelay",0),_this121.registerTableOption("progressiveLoadScrollMargin",0),_this121.registerTableFunction("setMaxPage",_this121.setMaxPage.bind(_assertThisInitialized(_this121))),_this121.registerTableFunction("setPage",_this121.setPage.bind(_assertThisInitialized(_this121))),_this121.registerTableFunction("setPageToRow",_this121.userSetPageToRow.bind(_assertThisInitialized(_this121))),_this121.registerTableFunction("setPageSize",_this121.userSetPageSize.bind(_assertThisInitialized(_this121))),_this121.registerTableFunction("getPageSize",_this121.getPageSize.bind(_assertThisInitialized(_this121))),_this121.registerTableFunction("previousPage",_this121.previousPage.bind(_assertThisInitialized(_this121))),_this121.registerTableFunction("nextPage",_this121.nextPage.bind(_assertThisInitialized(_this121))),_this121.registerTableFunction("getPage",_this121.getPage.bind(_assertThisInitialized(_this121))),_this121.registerTableFunction("getPageMax",_this121.getPageMax.bind(_assertThisInitialized(_this121))),_this121.registerComponentFunction("row","pageTo",_this121.setPageToRow.bind(_assertThisInitialized(_this121))),_this121}return _createClass(Page,[{key:"initialize",value:function(){this.table.options.pagination?(this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("footer-redraw",this.footerRedraw.bind(this)),"page"==this.table.options.paginationAddRow&&this.subscribe("row-adding-position",this.rowAddingPosition.bind(this)),"remote"===this.table.options.paginationMode&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this))),this.table.options.progressiveLoad&&console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time"),this.registerDisplayHandler(this.restOnRenderBefore.bind(this),40),this.registerDisplayHandler(this.getRows.bind(this),50),this.createElements(),this.initializePageCounter(),this.initializePaginator()):this.table.options.progressiveLoad&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.initializeProgressive(this.table.options.progressiveLoad),"scroll"===this.table.options.progressiveLoad&&this.subscribe("scroll-vertical",this.scrollVertical.bind(this)))}},{key:"rowAddingPosition",value:function(row,top){var index,rowManager=this.table.rowManager,displayRows=rowManager.getDisplayRows();return top?displayRows.length?index=displayRows[0]:rowManager.activeRows.length&&(index=rowManager.activeRows[rowManager.activeRows.length-1],top=!1):displayRows.length&&(index=displayRows[displayRows.length-1],top=!(displayRows.length<this.size)),{index:index,top:top}}},{key:"calculatePageSizes",value:function(){var testElRow,testElCell;this.table.options.paginationSize?this.size=this.table.options.paginationSize:((testElRow=document.createElement("div")).classList.add("tabulator-row"),testElRow.style.visibility="hidden",(testElCell=document.createElement("div")).classList.add("tabulator-cell"),testElCell.innerHTML="Page Row Test",testElRow.appendChild(testElCell),this.table.rowManager.getTableElement().appendChild(testElRow),this.size=Math.floor(this.table.rowManager.getElement().clientHeight/testElRow.offsetHeight),this.table.rowManager.getTableElement().removeChild(testElRow)),this.dispatchExternal("pageSizeChanged",this.size),this.generatePageSizeSelectList()}},{key:"initialLoadComplete",value:function(){this.initialLoad=!1}},{key:"remotePageParams",value:function(data,config,silent,params){return this.initialLoad||(this.progressiveLoad&&!silent||!this.progressiveLoad&&!this.dataChanging)&&this.reset(!0),params.page=this.page,this.size&&(params.size=this.size),params}},{key:"userSetPageToRow",value:function(row){return this.table.options.pagination&&(row=this.rowManager.findRow(row))?this.setPageToRow(row):Promise.reject()}},{key:"userSetPageSize",value:function(size){return!!this.table.options.pagination&&(this.setPageSize(size),this.setPage(1))}},{key:"scrollVertical",value:function(top,dir){var element;dir||this.table.dataLoader.loading||(element=this.table.rowManager.getElement()).scrollHeight-element.clientHeight-top<(this.table.options.progressiveLoadScrollMargin||2*element.clientHeight)&&this.nextPage().catch((function(){}))}},{key:"restOnRenderBefore",value:function(rows,renderInPosition){return renderInPosition||"local"===this.mode&&this.reset(),rows}},{key:"rowsUpdated",value:function(){this.refreshData(!0,"all")}},{key:"createElements",value:function(){var button;this.element=document.createElement("span"),this.element.classList.add("tabulator-paginator"),this.pagesElement=document.createElement("span"),this.pagesElement.classList.add("tabulator-pages"),(button=document.createElement("button")).classList.add("tabulator-page"),button.setAttribute("type","button"),button.setAttribute("role","button"),button.setAttribute("aria-label",""),button.setAttribute("title",""),this.firstBut=button.cloneNode(!0),this.firstBut.setAttribute("data-page","first"),this.prevBut=button.cloneNode(!0),this.prevBut.setAttribute("data-page","prev"),this.nextBut=button.cloneNode(!0),this.nextBut.setAttribute("data-page","next"),this.lastBut=button.cloneNode(!0),this.lastBut.setAttribute("data-page","last"),this.table.options.paginationSizeSelector&&(this.pageSizeSelect=document.createElement("select"),this.pageSizeSelect.classList.add("tabulator-page-size"))}},{key:"generatePageSizeSelectList",value:function(){var _this122=this,pageSizes=[];if(this.pageSizeSelect){if(Array.isArray(this.table.options.paginationSizeSelector))pageSizes=this.table.options.paginationSizeSelector,this.pageSizes=pageSizes,-1==this.pageSizes.indexOf(this.size)&&pageSizes.unshift(this.size);else if(-1==this.pageSizes.indexOf(this.size)){pageSizes=[];for(var i=1;i<5;i++)pageSizes.push(this.size*i);this.pageSizes=pageSizes}else pageSizes=this.pageSizes;for(;this.pageSizeSelect.firstChild;)this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);pageSizes.forEach((function(item){var itemEl=document.createElement("option");itemEl.value=item,!0===item?_this122.langBind("pagination|all",(function(value){itemEl.innerHTML=value})):itemEl.innerHTML=item,_this122.pageSizeSelect.appendChild(itemEl)})),this.pageSizeSelect.value=this.size}}},{key:"initializePageCounter",value:function(){var counter=this.table.options.paginationCounter,pageCounter=null;counter&&((pageCounter="function"==typeof counter?counter:Page.pageCounters[counter])?(this.pageCounter=pageCounter,this.pageCounterElement=document.createElement("span"),this.pageCounterElement.classList.add("tabulator-page-counter")):console.warn("Pagination Error - No such page counter found: ",counter))}},{key:"initializePaginator",value:function(hidden){var pageSelectLabel,paginationCounterHolder,_this123=this;hidden||(this.langBind("pagination|first",(function(value){_this123.firstBut.innerHTML=value})),this.langBind("pagination|first_title",(function(value){_this123.firstBut.setAttribute("aria-label",value),_this123.firstBut.setAttribute("title",value)})),this.langBind("pagination|prev",(function(value){_this123.prevBut.innerHTML=value})),this.langBind("pagination|prev_title",(function(value){_this123.prevBut.setAttribute("aria-label",value),_this123.prevBut.setAttribute("title",value)})),this.langBind("pagination|next",(function(value){_this123.nextBut.innerHTML=value})),this.langBind("pagination|next_title",(function(value){_this123.nextBut.setAttribute("aria-label",value),_this123.nextBut.setAttribute("title",value)})),this.langBind("pagination|last",(function(value){_this123.lastBut.innerHTML=value})),this.langBind("pagination|last_title",(function(value){_this123.lastBut.setAttribute("aria-label",value),_this123.lastBut.setAttribute("title",value)})),this.firstBut.addEventListener("click",(function(){_this123.setPage(1)})),this.prevBut.addEventListener("click",(function(){_this123.previousPage()})),this.nextBut.addEventListener("click",(function(){_this123.nextPage()})),this.lastBut.addEventListener("click",(function(){_this123.setPage(_this123.max)})),this.table.options.paginationElement&&(this.element=this.table.options.paginationElement),this.pageSizeSelect&&(pageSelectLabel=document.createElement("label"),this.langBind("pagination|page_size",(function(value){_this123.pageSizeSelect.setAttribute("aria-label",value),_this123.pageSizeSelect.setAttribute("title",value),pageSelectLabel.innerHTML=value})),this.element.appendChild(pageSelectLabel),this.element.appendChild(this.pageSizeSelect),this.pageSizeSelect.addEventListener("change",(function(e){_this123.setPageSize("true"==_this123.pageSizeSelect.value||_this123.pageSizeSelect.value),_this123.setPage(1)}))),this.element.appendChild(this.firstBut),this.element.appendChild(this.prevBut),this.element.appendChild(this.pagesElement),this.element.appendChild(this.nextBut),this.element.appendChild(this.lastBut),this.table.options.paginationElement||(this.table.options.paginationCounter&&(this.table.options.paginationCounterElement?this.table.options.paginationCounterElement instanceof HTMLElement?this.table.options.paginationCounterElement.appendChild(this.pageCounterElement):"string"==typeof this.table.options.paginationCounterElement&&((paginationCounterHolder=document.querySelector(this.table.options.paginationCounterElement))?paginationCounterHolder.appendChild(this.pageCounterElement):console.warn("Pagination Error - Unable to find element matching paginationCounterElement selector:",this.table.options.paginationCounterElement)):this.footerAppend(this.pageCounterElement)),this.footerAppend(this.element)),this.page=this.table.options.paginationInitialPage,this.count=this.table.options.paginationButtonCount),this.mode=this.table.options.paginationMode}},{key:"initializeProgressive",value:function(mode){this.initializePaginator(!0),this.mode="progressive_"+mode,this.progressiveLoad=!0}},{key:"trackChanges",value:function(){this.dispatch("page-changed")}},{key:"setMaxRows",value:function(rowCount){this.max=rowCount?!0===this.size?1:Math.ceil(rowCount/this.size):1,this.page>this.max&&(this.page=this.max)}},{key:"reset",value:function(force){this.initialLoad||("local"==this.mode||force)&&(this.page=1,this.trackChanges())}},{key:"setMaxPage",value:function(max){max=parseInt(max),this.max=max||1,this.page>this.max&&(this.page=this.max,this.trigger())}},{key:"setPage",value:function(page){switch(page){case"first":return this.setPage(1);case"prev":return this.previousPage();case"next":return this.nextPage();case"last":return this.setPage(this.max)}return(page=parseInt(page))>0&&page<=this.max||"local"!==this.mode?(this.page=page,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Requested page is out of range of 1 - "+this.max+":",page),Promise.reject())}},{key:"setPageToRow",value:function(row){var index=this.displayRows(-1).indexOf(row);if(index>-1){var page=!0===this.size?1:Math.ceil((index+1)/this.size);return this.setPage(page)}return console.warn("Pagination Error - Requested row is not visible"),Promise.reject()}},{key:"setPageSize",value:function(size){!0!==size&&(size=parseInt(size)),size>0&&(this.size=size,this.dispatchExternal("pageSizeChanged",size)),this.pageSizeSelect&&this.generatePageSizeSelectList(),this.trackChanges()}},{key:"_setPageCounter",value:function(totalRows,size,currentRow){var content;if(this.pageCounter)switch("remote"===this.mode&&(size=this.size,currentRow=(this.page-1)*this.size+1,totalRows=this.remoteRowCountEstimate),_typeof(content=this.pageCounter.call(this,size,currentRow,this.page,totalRows,this.max))){case"object":if(content instanceof Node){for(;this.pageCounterElement.firstChild;)this.pageCounterElement.removeChild(this.pageCounterElement.firstChild);this.pageCounterElement.appendChild(content)}else this.pageCounterElement.innerHTML="",null!=content&&console.warn("Page Counter Error - Page Counter has returned a type of object, the only valid page counter object return is an instance of Node, the page counter returned:",content);break;case"undefined":this.pageCounterElement.innerHTML="";break;default:this.pageCounterElement.innerHTML=content}}},{key:"_setPageButtons",value:function(){for(var leftSize=Math.floor((this.count-1)/2),rightSize=Math.ceil((this.count-1)/2),min=this.max-this.page+leftSize+1<this.count?this.max-this.count+1:Math.max(this.page-leftSize,1),max=this.page<=rightSize?Math.min(this.count,this.max):Math.min(this.page+rightSize,this.max);this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);1==this.page?(this.firstBut.disabled=!0,this.prevBut.disabled=!0):(this.firstBut.disabled=!1,this.prevBut.disabled=!1),this.page==this.max?(this.lastBut.disabled=!0,this.nextBut.disabled=!0):(this.lastBut.disabled=!1,this.nextBut.disabled=!1);for(var i=min;i<=max;i++)i>0&&i<=this.max&&this.pagesElement.appendChild(this._generatePageButton(i));this.footerRedraw()}},{key:"_generatePageButton",value:function(page){var _this124=this,button=document.createElement("button");return button.classList.add("tabulator-page"),page==this.page&&button.classList.add("active"),button.setAttribute("type","button"),button.setAttribute("role","button"),this.langBind("pagination|page_title",(function(value){button.setAttribute("aria-label",value+" "+page),button.setAttribute("title",value+" "+page)})),button.setAttribute("data-page",page),button.textContent=page,button.addEventListener("click",(function(e){_this124.setPage(page)})),button}},{key:"previousPage",value:function(){return this.page>1?(this.page--,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Previous page would be less than page 1:",0),Promise.reject())}},{key:"nextPage",value:function(){return this.page<this.max?(this.page++,this.trackChanges(),this.trigger()):(this.progressiveLoad||console.warn("Pagination Error - Next page would be greater than maximum page of "+this.max+":",this.max+1),Promise.reject())}},{key:"getPage",value:function(){return this.page}},{key:"getPageMax",value:function(){return this.max}},{key:"getPageSize",value:function(size){return this.size}},{key:"getMode",value:function(){return this.mode}},{key:"getRows",value:function(data){var output,start,end,actualStartRow,actualRowPageSize=0,actualRows=data.filter((function(row){return"row"===row.type}));if("local"==this.mode){output=[],this.setMaxRows(data.length),!0===this.size?(start=0,end=data.length):end=(start=this.size*(this.page-1))+parseInt(this.size),this._setPageButtons();for(var i=start;i<end;i++){var row=data[i];row&&(output.push(row),"row"===row.type&&(actualStartRow||(actualStartRow=row),actualRowPageSize++))}return this._setPageCounter(actualRows.length,actualRowPageSize,actualStartRow?actualRows.indexOf(actualStartRow)+1:0),output}return this._setPageButtons(),this._setPageCounter(actualRows.length),data.slice(0)}},{key:"trigger",value:function(){var left,_this125=this;switch(this.mode){case"local":return left=this.table.rowManager.scrollLeft,this.refreshData(),this.table.rowManager.scrollHorizontal(left),this.dispatchExternal("pageLoaded",this.getPage()),Promise.resolve();case"remote":return this.dataChanging=!0,this.reloadData(null).finally((function(){_this125.dataChanging=!1}));case"progressive_load":case"progressive_scroll":return this.reloadData(null,!0);default:return console.warn("Pagination Error - no such pagination mode:",this.mode),Promise.reject()}}},{key:"_parseRemoteData",value:function(data){var margin,_this126=this;if(void 0===data.last_page&&console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").last_page||"last_page")+"' property"),data.data){if(this.max=parseInt(data.last_page)||1,this.remoteRowCountEstimate=void 0!==data.last_row?data.last_row:data.last_page*this.size-(this.page==data.last_page?this.size-data.data.length:0),this.progressiveLoad){switch(this.mode){case"progressive_load":1==this.page?this.table.rowManager.setData(data.data,!1,1==this.page):this.table.rowManager.addRows(data.data),this.page<this.max&&setTimeout((function(){_this126.nextPage()}),this.table.options.progressiveLoadDelay);break;case"progressive_scroll":data=1===this.page?data.data:this.table.rowManager.getData().concat(data.data),this.table.rowManager.setData(data,1!==this.page,1==this.page),margin=this.table.options.progressiveLoadScrollMargin||2*this.table.rowManager.element.clientHeight,this.table.rowManager.element.scrollHeight<=this.table.rowManager.element.clientHeight+margin&&this.page<this.max&&setTimeout((function(){_this126.nextPage()}))}return!1}this.dispatchExternal("pageLoaded",this.getPage())}else console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").data||"data")+"' property");return data.data}},{key:"footerRedraw",value:function(){var footer=this.table.footerManager.containerElement;Math.ceil(footer.clientWidth)-footer.scrollWidth<0?this.pagesElement.style.display="none":(this.pagesElement.style.display="",Math.ceil(footer.clientWidth)-footer.scrollWidth<0&&(this.pagesElement.style.display="none"))}}]),Page}(Module);_exports.PageModule=Page,Page.moduleName="page",Page.pageCounters=defaultPageCounters;var defaultReaders={local:function(id,type){var data=localStorage.getItem(id+"-"+type);return!!data&&JSON.parse(data)},cookie:function(id,type){var end,data,cookie=document.cookie,key=id+"-"+type,cookiePos=cookie.indexOf(key+"=");return cookiePos>-1&&(cookie=cookie.slice(cookiePos),(end=cookie.indexOf(";"))>-1&&(cookie=cookie.slice(0,end)),data=cookie.replace(key+"=","")),!!data&&JSON.parse(data)}},defaultWriters={local:function(id,type,data){localStorage.setItem(id+"-"+type,JSON.stringify(data))},cookie:function(id,type,data){var expireDate=new Date;expireDate.setDate(expireDate.getDate()+1e4),document.cookie=id+"-"+type+"="+JSON.stringify(data)+"; expires="+expireDate.toUTCString()}},Persistence=function(_Module24){_inherits(Persistence,_Module24);var _super29=_createSuper(Persistence);function Persistence(table){var _this127;return _classCallCheck(this,Persistence),(_this127=_super29.call(this,table)).mode="",_this127.id="",_this127.defWatcherBlock=!1,_this127.config={},_this127.readFunc=!1,_this127.writeFunc=!1,_this127.registerTableOption("persistence",!1),_this127.registerTableOption("persistenceID",""),_this127.registerTableOption("persistenceMode",!0),_this127.registerTableOption("persistenceReaderFunc",!1),_this127.registerTableOption("persistenceWriterFunc",!1),_this127}return _createClass(Persistence,[{key:"localStorageTest",value:function(){var testKey="_tabulator_test";try{return window.localStorage.setItem(testKey,testKey),window.localStorage.removeItem(testKey),!0}catch(e){return!1}}},{key:"initialize",value:function(){if(this.table.options.persistence){var retrievedData,mode=this.table.options.persistenceMode,id=this.table.options.persistenceID;this.mode=!0!==mode?mode:this.localStorageTest()?"local":"cookie",this.table.options.persistenceReaderFunc?"function"==typeof this.table.options.persistenceReaderFunc?this.readFunc=this.table.options.persistenceReaderFunc:Persistence.readers[this.table.options.persistenceReaderFunc]?this.readFunc=Persistence.readers[this.table.options.persistenceReaderFunc]:console.warn("Persistence Read Error - invalid reader set",this.table.options.persistenceReaderFunc):Persistence.readers[this.mode]?this.readFunc=Persistence.readers[this.mode]:console.warn("Persistence Read Error - invalid reader set",this.mode),this.table.options.persistenceWriterFunc?"function"==typeof this.table.options.persistenceWriterFunc?this.writeFunc=this.table.options.persistenceWriterFunc:Persistence.writers[this.table.options.persistenceWriterFunc]?this.writeFunc=Persistence.writers[this.table.options.persistenceWriterFunc]:console.warn("Persistence Write Error - invalid reader set",this.table.options.persistenceWriterFunc):Persistence.writers[this.mode]?this.writeFunc=Persistence.writers[this.mode]:console.warn("Persistence Write Error - invalid writer set",this.mode),this.id="tabulator-"+(id||this.table.element.getAttribute("id")||""),this.config={sort:!0===this.table.options.persistence||this.table.options.persistence.sort,filter:!0===this.table.options.persistence||this.table.options.persistence.filter,group:!0===this.table.options.persistence||this.table.options.persistence.group,page:!0===this.table.options.persistence||this.table.options.persistence.page,columns:!0===this.table.options.persistence?["title","width","visible"]:this.table.options.persistence.columns},this.config.page&&(retrievedData=this.retrieveData("page"))&&(void 0===retrievedData.paginationSize||!0!==this.config.page&&!this.config.page.size||(this.table.options.paginationSize=retrievedData.paginationSize),void 0===retrievedData.paginationInitialPage||!0!==this.config.page&&!this.config.page.page||(this.table.options.paginationInitialPage=retrievedData.paginationInitialPage)),this.config.group&&(retrievedData=this.retrieveData("group"))&&(void 0===retrievedData.groupBy||!0!==this.config.group&&!this.config.group.groupBy||(this.table.options.groupBy=retrievedData.groupBy),void 0===retrievedData.groupStartOpen||!0!==this.config.group&&!this.config.group.groupStartOpen||(this.table.options.groupStartOpen=retrievedData.groupStartOpen),void 0===retrievedData.groupHeader||!0!==this.config.group&&!this.config.group.groupHeader||(this.table.options.groupHeader=retrievedData.groupHeader)),this.config.columns&&(this.table.options.columns=this.load("columns",this.table.options.columns),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-show",this.save.bind(this,"columns")),this.subscribe("column-hide",this.save.bind(this,"columns")),this.subscribe("column-moved",this.save.bind(this,"columns"))),this.subscribe("table-built",this.tableBuilt.bind(this),0),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("filter-changed",this.eventSave.bind(this,"filter")),this.subscribe("sort-changed",this.eventSave.bind(this,"sort")),this.subscribe("group-changed",this.eventSave.bind(this,"group")),this.subscribe("page-changed",this.eventSave.bind(this,"page")),this.subscribe("column-resized",this.eventSave.bind(this,"columns")),this.subscribe("column-width",this.eventSave.bind(this,"columns")),this.subscribe("layout-refreshed",this.eventSave.bind(this,"columns"))}this.registerTableFunction("getColumnLayout",this.getColumnLayout.bind(this)),this.registerTableFunction("setColumnLayout",this.setColumnLayout.bind(this))}},{key:"eventSave",value:function(type){this.config[type]&&this.save(type)}},{key:"tableBuilt",value:function(){var sorters,filters;this.config.sort&&!1==!(sorters=this.load("sort"))&&(this.table.options.initialSort=sorters),this.config.filter&&!1==!(filters=this.load("filter"))&&(this.table.options.initialFilter=filters)}},{key:"tableRedraw",value:function(force){force&&this.config.columns&&this.save("columns")}},{key:"getColumnLayout",value:function(){return this.parseColumns(this.table.columnManager.getColumns())}},{key:"setColumnLayout",value:function(layout){return this.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns,layout)),!0}},{key:"initializeColumn",value:function(column){var def,_this128=this;this.config.columns&&(this.defWatcherBlock=!0,def=column.getDefinition(),(!0===this.config.columns?Object.keys(def):this.config.columns).forEach((function(key){var props=Object.getOwnPropertyDescriptor(def,key),value=def[key];props&&Object.defineProperty(def,key,{set:function(newValue){value=newValue,_this128.defWatcherBlock||_this128.save("columns"),props.set&&props.set(newValue)},get:function(){return props.get&&props.get(),value}})})),this.defWatcherBlock=!1)}},{key:"load",value:function(type,current){var data=this.retrieveData(type);return current&&(data=data?this.mergeDefinition(current,data):current),data}},{key:"retrieveData",value:function(type){return!!this.readFunc&&this.readFunc(this.id,type)}},{key:"mergeDefinition",value:function(oldCols,newCols){var _this129=this,output=[];return(newCols=newCols||[]).forEach((function(column,to){var keys,from=_this129._findColumn(oldCols,column);from&&(!0===_this129.config.columns||null==_this129.config.columns?(keys=Object.keys(from)).push("width"):keys=_this129.config.columns,keys.forEach((function(key){"columns"!==key&&void 0!==column[key]&&(from[key]=column[key])})),from.columns&&(from.columns=_this129.mergeDefinition(from.columns,column.columns)),output.push(from))})),oldCols.forEach((function(column,i){_this129._findColumn(newCols,column)||(output.length>i?output.splice(i,0,column):output.push(column))})),output}},{key:"_findColumn",value:function(columns,subject){var type=subject.columns?"group":subject.field?"field":"object";return columns.find((function(col){switch(type){case"group":return col.title===subject.title&&col.columns.length===subject.columns.length;case"field":return col.field===subject.field;case"object":return col===subject}}))}},{key:"save",value:function(type){var data={};switch(type){case"columns":data=this.parseColumns(this.table.columnManager.getColumns());break;case"filter":data=this.table.modules.filter.getFilters();break;case"sort":data=this.validateSorters(this.table.modules.sort.getSort());break;case"group":data=this.getGroupConfig();break;case"page":data=this.getPageConfig()}this.writeFunc&&this.writeFunc(this.id,type,data)}},{key:"validateSorters",value:function(data){return data.forEach((function(item){item.column=item.field,delete item.field})),data}},{key:"getGroupConfig",value:function(){var data={};return this.config.group&&((!0===this.config.group||this.config.group.groupBy)&&(data.groupBy=this.table.options.groupBy),(!0===this.config.group||this.config.group.groupStartOpen)&&(data.groupStartOpen=this.table.options.groupStartOpen),(!0===this.config.group||this.config.group.groupHeader)&&(data.groupHeader=this.table.options.groupHeader)),data}},{key:"getPageConfig",value:function(){var data={};return this.config.page&&((!0===this.config.page||this.config.page.size)&&(data.paginationSize=this.table.modules.page.getPageSize()),(!0===this.config.page||this.config.page.page)&&(data.paginationInitialPage=this.table.modules.page.getPage())),data}},{key:"parseColumns",value:function(columns){var _this130=this,definitions=[],excludedKeys=["headerContextMenu","headerMenu","contextMenu","clickMenu"];return columns.forEach((function(column){var keys,defStore={},colDef=column.getDefinition();column.isGroup?(defStore.title=colDef.title,defStore.columns=_this130.parseColumns(column.getColumns())):(defStore.field=column.getField(),!0===_this130.config.columns||null==_this130.config.columns?((keys=Object.keys(colDef)).push("width"),keys.push("visible")):keys=_this130.config.columns,keys.forEach((function(key){switch(key){case"width":defStore.width=column.getWidth();break;case"visible":defStore.visible=column.visible;break;default:"function"!=typeof colDef[key]&&-1===excludedKeys.indexOf(key)&&(defStore[key]=colDef[key])}}))),definitions.push(defStore)})),definitions}}]),Persistence}(Module);_exports.PersistenceModule=Persistence,Persistence.moduleName="persistence",Persistence.moduleInitOrder=-10,Persistence.readers=defaultReaders,Persistence.writers=defaultWriters;var Popup$1=function(_Module25){_inherits(Popup$1,_Module25);var _super30=_createSuper(Popup$1);function Popup$1(table){var _this131;return _classCallCheck(this,Popup$1),(_this131=_super30.call(this,table)).columnSubscribers={},_this131.registerTableOption("rowContextPopup",!1),_this131.registerTableOption("rowClickPopup",!1),_this131.registerTableOption("rowDblClickPopup",!1),_this131.registerTableOption("groupContextPopup",!1),_this131.registerTableOption("groupClickPopup",!1),_this131.registerTableOption("groupDblClickPopup",!1),_this131.registerColumnOption("headerContextPopup"),_this131.registerColumnOption("headerClickPopup"),_this131.registerColumnOption("headerDblClickPopup"),_this131.registerColumnOption("headerPopup"),_this131.registerColumnOption("headerPopupIcon"),_this131.registerColumnOption("contextPopup"),_this131.registerColumnOption("clickPopup"),_this131.registerColumnOption("dblClickPopup"),_this131.registerComponentFunction("cell","popup",_this131._componentPopupCall.bind(_assertThisInitialized(_this131))),_this131.registerComponentFunction("column","popup",_this131._componentPopupCall.bind(_assertThisInitialized(_this131))),_this131.registerComponentFunction("row","popup",_this131._componentPopupCall.bind(_assertThisInitialized(_this131))),_this131.registerComponentFunction("group","popup",_this131._componentPopupCall.bind(_assertThisInitialized(_this131))),_this131}return _createClass(Popup$1,[{key:"initialize",value:function(){this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}},{key:"_componentPopupCall",value:function(component,contents,position){this.loadPopupEvent(contents,null,component,position)}},{key:"initializeRowWatchers",value:function(){this.table.options.rowContextPopup&&(this.subscribe("row-contextmenu",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup)),this.table.on("rowTapHold",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup))),this.table.options.rowClickPopup&&this.subscribe("row-click",this.loadPopupEvent.bind(this,this.table.options.rowClickPopup)),this.table.options.rowDblClickPopup&&this.subscribe("row-dblclick",this.loadPopupEvent.bind(this,this.table.options.rowDblClickPopup))}},{key:"initializeGroupWatchers",value:function(){this.table.options.groupContextPopup&&(this.subscribe("group-contextmenu",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup)),this.table.on("groupTapHold",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup))),this.table.options.groupClickPopup&&this.subscribe("group-click",this.loadPopupEvent.bind(this,this.table.options.groupClickPopup)),this.table.options.groupDblClickPopup&&this.subscribe("group-dblclick",this.loadPopupEvent.bind(this,this.table.options.groupDblClickPopup))}},{key:"initializeColumn",value:function(column){var def=column.definition;def.headerContextPopup&&!this.columnSubscribers.headerContextPopup&&(this.columnSubscribers.headerContextPopup=this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextPopup),this.table.on("headerTapHold",this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"))),def.headerClickPopup&&!this.columnSubscribers.headerClickPopup&&(this.columnSubscribers.headerClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerClickPopup"),this.subscribe("column-click",this.columnSubscribers.headerClickPopup)),def.headerDblClickPopup&&!this.columnSubscribers.headerDblClickPopup&&(this.columnSubscribers.headerDblClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerDblClickPopup"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickPopup)),def.headerPopup&&this.initializeColumnHeaderPopup(column),def.contextPopup&&!this.columnSubscribers.contextPopup&&(this.columnSubscribers.contextPopup=this.loadPopupTableCellEvent.bind(this,"contextPopup"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextPopup),this.table.on("cellTapHold",this.loadPopupTableCellEvent.bind(this,"contextPopup"))),def.clickPopup&&!this.columnSubscribers.clickPopup&&(this.columnSubscribers.clickPopup=this.loadPopupTableCellEvent.bind(this,"clickPopup"),this.subscribe("cell-click",this.columnSubscribers.clickPopup)),def.dblClickPopup&&!this.columnSubscribers.dblClickPopup&&(this.columnSubscribers.dblClickPopup=this.loadPopupTableCellEvent.bind(this,"dblClickPopup"),this.subscribe("cell-click",this.columnSubscribers.dblClickPopup))}},{key:"initializeColumnHeaderPopup",value:function(column){var headerPopupEl,_this132=this,icon=column.definition.headerPopupIcon;(headerPopupEl=document.createElement("span")).classList.add("tabulator-header-popup-button"),icon?("function"==typeof icon&&(icon=icon(column.getComponent())),icon instanceof HTMLElement?headerPopupEl.appendChild(icon):headerPopupEl.innerHTML=icon):headerPopupEl.innerHTML="&vellip;",headerPopupEl.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault(),_this132.loadPopupEvent(column.definition.headerPopup,e,column)})),column.titleElement.insertBefore(headerPopupEl,column.titleElement.firstChild)}},{key:"loadPopupTableCellEvent",value:function(option,e,cell){cell._cell&&(cell=cell._cell),cell.column.definition[option]&&this.loadPopupEvent(cell.column.definition[option],e,cell)}},{key:"loadPopupTableColumnEvent",value:function(option,e,column){column._column&&(column=column._column),column.definition[option]&&this.loadPopupEvent(column.definition[option],e,column)}},{key:"loadPopupEvent",value:function(contents,e,component,position){var renderedCallback;component._group?component=component._group:component._row&&(component=component._row),contents="function"==typeof contents?contents.call(this.table,e,component.getComponent(),(function(callback){renderedCallback=callback})):contents,this.loadPopup(e,component,contents,renderedCallback,position)}},{key:"loadPopup",value:function(e,component,contents,renderedCallback,position){var contentsEl,popup,_this133=this,touch=!(e instanceof MouseEvent);contents instanceof HTMLElement?contentsEl=contents:(contentsEl=document.createElement("div")).innerHTML=contents,contentsEl.classList.add("tabulator-popup"),contentsEl.addEventListener("click",(function(e){e.stopPropagation()})),touch||e.preventDefault(),popup=this.popup(contentsEl),"function"==typeof renderedCallback&&popup.renderCallback(renderedCallback),e?popup.show(e):popup.show(component.getElement(),position||"center"),popup.hideOnBlur((function(){_this133.dispatchExternal("popupClosed",component.getComponent())})),this.dispatchExternal("popupOpened",component.getComponent())}}]),Popup$1}(Module);_exports.PopupModule=Popup$1,Popup$1.moduleName="popup";var Print=function(_Module26){_inherits(Print,_Module26);var _super31=_createSuper(Print);function Print(table){var _this134;return _classCallCheck(this,Print),(_this134=_super31.call(this,table)).element=!1,_this134.manualBlock=!1,_this134.registerTableOption("printAsHtml",!1),_this134.registerTableOption("printFormatter",!1),_this134.registerTableOption("printHeader",!1),_this134.registerTableOption("printFooter",!1),_this134.registerTableOption("printStyled",!0),_this134.registerTableOption("printRowRange","visible"),_this134.registerTableOption("printConfig",{}),_this134.registerColumnOption("print"),_this134.registerColumnOption("titlePrint"),_this134}return _createClass(Print,[{key:"initialize",value:function(){this.table.options.printAsHtml&&(window.addEventListener("beforeprint",this.replaceTable.bind(this)),window.addEventListener("afterprint",this.cleanup.bind(this))),this.registerTableFunction("print",this.printFullscreen.bind(this))}},{key:"replaceTable",value:function(){this.manualBlock||(this.element=document.createElement("div"),this.element.classList.add("tabulator-print-table"),this.element.appendChild(this.table.modules.export.generateTable(this.table.options.printConfig,this.table.options.printStyled,this.table.options.printRowRange,"print")),this.table.element.style.display="none",this.table.element.parentNode.insertBefore(this.element,this.table.element))}},{key:"cleanup",value:function(){document.body.classList.remove("tabulator-print-fullscreen-hide"),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.table.element.style.display="")}},{key:"printFullscreen",value:function(visible,style,config){var headerContent,footerContent,scrollX=window.scrollX,scrollY=window.scrollY,headerEl=document.createElement("div"),footerEl=document.createElement("div"),tableEl=this.table.modules.export.generateTable(void 0!==config?config:this.table.options.printConfig,void 0!==style?style:this.table.options.printStyled,visible||this.table.options.printRowRange,"print");this.manualBlock=!0,this.element=document.createElement("div"),this.element.classList.add("tabulator-print-fullscreen"),this.table.options.printHeader&&(headerEl.classList.add("tabulator-print-header"),"string"==typeof(headerContent="function"==typeof this.table.options.printHeader?this.table.options.printHeader.call(this.table):this.table.options.printHeader)?headerEl.innerHTML=headerContent:headerEl.appendChild(headerContent),this.element.appendChild(headerEl)),this.element.appendChild(tableEl),this.table.options.printFooter&&(footerEl.classList.add("tabulator-print-footer"),"string"==typeof(footerContent="function"==typeof this.table.options.printFooter?this.table.options.printFooter.call(this.table):this.table.options.printFooter)?footerEl.innerHTML=footerContent:footerEl.appendChild(footerContent),this.element.appendChild(footerEl)),document.body.classList.add("tabulator-print-fullscreen-hide"),document.body.appendChild(this.element),this.table.options.printFormatter&&this.table.options.printFormatter(this.element,tableEl),window.print(),this.cleanup(),window.scrollTo(scrollX,scrollY),this.manualBlock=!1}}]),Print}(Module);_exports.PrintModule=Print,Print.moduleName="print";var ReactiveData=function(_Module27){_inherits(ReactiveData,_Module27);var _super32=_createSuper(ReactiveData);function ReactiveData(table){var _this135;return _classCallCheck(this,ReactiveData),(_this135=_super32.call(this,table)).data=!1,_this135.blocked=!1,_this135.origFuncs={},_this135.currentVersion=0,_this135.registerTableOption("reactiveData",!1),_this135}return _createClass(ReactiveData,[{key:"initialize",value:function(){this.table.options.reactiveData&&(this.subscribe("cell-value-save-before",this.block.bind(this,"cellsave")),this.subscribe("cell-value-save-after",this.unblock.bind(this,"cellsave")),this.subscribe("row-data-save-before",this.block.bind(this,"rowsave")),this.subscribe("row-data-save-after",this.unblock.bind(this,"rowsave")),this.subscribe("row-data-init-after",this.watchRow.bind(this)),this.subscribe("data-processing",this.watchData.bind(this)),this.subscribe("table-destroy",this.unwatchData.bind(this)))}},{key:"watchData",value:function(data){var version,self=this;this.currentVersion++,version=this.currentVersion,this.unwatchData(),this.data=data,this.origFuncs.push=data.push,Object.defineProperty(this.data,"push",{enumerable:!1,configurable:!0,value:function(){var result,args=Array.from(arguments);return self.blocked||version!==self.currentVersion||(self.block("data-push"),args.forEach((function(arg){self.table.rowManager.addRowActual(arg,!1)})),result=self.origFuncs.push.apply(data,arguments),self.unblock("data-push")),result}}),this.origFuncs.unshift=data.unshift,Object.defineProperty(this.data,"unshift",{enumerable:!1,configurable:!0,value:function(){var result,args=Array.from(arguments);return self.blocked||version!==self.currentVersion||(self.block("data-unshift"),args.forEach((function(arg){self.table.rowManager.addRowActual(arg,!0)})),result=self.origFuncs.unshift.apply(data,arguments),self.unblock("data-unshift")),result}}),this.origFuncs.shift=data.shift,Object.defineProperty(this.data,"shift",{enumerable:!1,configurable:!0,value:function(){var row,result;return self.blocked||version!==self.currentVersion||(self.block("data-shift"),self.data.length&&(row=self.table.rowManager.getRowFromDataObject(self.data[0]))&&row.deleteActual(),result=self.origFuncs.shift.call(data),self.unblock("data-shift")),result}}),this.origFuncs.pop=data.pop,Object.defineProperty(this.data,"pop",{enumerable:!1,configurable:!0,value:function(){var row,result;return self.blocked||version!==self.currentVersion||(self.block("data-pop"),self.data.length&&(row=self.table.rowManager.getRowFromDataObject(self.data[self.data.length-1]))&&row.deleteActual(),result=self.origFuncs.pop.call(data),self.unblock("data-pop")),result}}),this.origFuncs.splice=data.splice,Object.defineProperty(this.data,"splice",{enumerable:!1,configurable:!0,value:function(){var startRow,result,args=Array.from(arguments),start=args[0]<0?data.length+args[0]:args[0],end=args[1],newRows=!!args[2]&&args.slice(2);if(!self.blocked&&version===self.currentVersion){if(self.block("data-splice"),newRows&&((startRow=!!data[start]&&self.table.rowManager.getRowFromDataObject(data[start]))?newRows.forEach((function(rowData){self.table.rowManager.addRowActual(rowData,!0,startRow,!0)})):(newRows=newRows.slice().reverse()).forEach((function(rowData){self.table.rowManager.addRowActual(rowData,!0,!1,!0)}))),0!==end){var oldRows=data.slice(start,void 0===args[1]?args[1]:start+end);oldRows.forEach((function(rowData,i){var row=self.table.rowManager.getRowFromDataObject(rowData);row&&row.deleteActual(i!==oldRows.length-1)}))}(newRows||0!==end)&&self.table.rowManager.reRenderInPosition(),result=self.origFuncs.splice.apply(data,arguments),self.unblock("data-splice")}return result}})}},{key:"unwatchData",value:function(){if(!1!==this.data)for(var key in this.origFuncs)Object.defineProperty(this.data,key,{enumerable:!0,configurable:!0,writable:!0,value:this.origFuncs.key})}},{key:"watchRow",value:function(row){var data=row.getData();for(var key in data)this.watchKey(row,data,key);this.table.options.dataTree&&this.watchTreeChildren(row)}},{key:"watchTreeChildren",value:function(row){var _arguments=arguments,_this136=this,self=this,childField=row.getData()[this.table.options.dataTreeChildField],origFuncs={};childField&&(origFuncs.push=childField.push,Object.defineProperty(childField,"push",{enumerable:!1,configurable:!0,value:function(){if(!self.blocked){self.block("tree-push");var result=origFuncs.push.apply(childField,_arguments);_this136.rebuildTree(row),self.unblock("tree-push")}return result}}),origFuncs.unshift=childField.unshift,Object.defineProperty(childField,"unshift",{enumerable:!1,configurable:!0,value:function(){if(!self.blocked){self.block("tree-unshift");var result=origFuncs.unshift.apply(childField,_arguments);_this136.rebuildTree(row),self.unblock("tree-unshift")}return result}}),origFuncs.shift=childField.shift,Object.defineProperty(childField,"shift",{enumerable:!1,configurable:!0,value:function(){if(!self.blocked){self.block("tree-shift");var result=origFuncs.shift.call(childField);_this136.rebuildTree(row),self.unblock("tree-shift")}return result}}),origFuncs.pop=childField.pop,Object.defineProperty(childField,"pop",{enumerable:!1,configurable:!0,value:function(){if(!self.blocked){self.block("tree-pop");var result=origFuncs.pop.call(childField);_this136.rebuildTree(row),self.unblock("tree-pop")}return result}}),origFuncs.splice=childField.splice,Object.defineProperty(childField,"splice",{enumerable:!1,configurable:!0,value:function(){if(!self.blocked){self.block("tree-splice");var result=origFuncs.splice.apply(childField,_arguments);_this136.rebuildTree(row),self.unblock("tree-splice")}return result}}))}},{key:"rebuildTree",value:function(row){this.table.modules.dataTree.initializeRow(row),this.table.modules.dataTree.layoutRow(row),this.table.rowManager.refreshActiveData("tree",!1,!0)}},{key:"watchKey",value:function(row,data,key){var self=this,props=Object.getOwnPropertyDescriptor(data,key),value=data[key],version=this.currentVersion;Object.defineProperty(data,key,{set:function(newValue){if(value=newValue,!self.blocked&&version===self.currentVersion){self.block("key");var update={};update[key]=newValue,row.updateData(update),self.unblock("key")}props.set&&props.set(newValue)},get:function(){return props.get&&props.get(),value}})}},{key:"unwatchRow",value:function(row){var data=row.getData();for(var key in data)Object.defineProperty(data,key,{value:data[key]})}},{key:"block",value:function(key){this.blocked||(this.blocked=key)}},{key:"unblock",value:function(key){this.blocked===key&&(this.blocked=!1)}}]),ReactiveData}(Module);_exports.ReactiveDataModule=ReactiveData,ReactiveData.moduleName="reactiveData";var ResizeColumns=function(_Module28){_inherits(ResizeColumns,_Module28);var _super33=_createSuper(ResizeColumns);function ResizeColumns(table){var _this137;return _classCallCheck(this,ResizeColumns),(_this137=_super33.call(this,table)).startColumn=!1,_this137.startX=!1,_this137.startWidth=!1,_this137.latestX=!1,_this137.handle=null,_this137.initialNextColumn=null,_this137.nextColumn=null,_this137.initialized=!1,_this137.registerColumnOption("resizable",!0),_this137.registerTableOption("resizableColumnFit",!1),_this137}return _createClass(ResizeColumns,[{key:"initialize",value:function(){this.subscribe("column-rendered",this.layoutColumnHeader.bind(this))}},{key:"initializeEventWatchers",value:function(){this.initialized||(this.subscribe("cell-rendered",this.layoutCellHandles.bind(this)),this.subscribe("cell-delete",this.deInitializeComponent.bind(this)),this.subscribe("cell-height",this.resizeHandle.bind(this)),this.subscribe("column-moved",this.columnLayoutUpdated.bind(this)),this.subscribe("column-hide",this.deInitializeColumn.bind(this)),this.subscribe("column-show",this.columnLayoutUpdated.bind(this)),this.subscribe("column-width",this.columnWidthUpdated.bind(this)),this.subscribe("column-delete",this.deInitializeComponent.bind(this)),this.subscribe("column-height",this.resizeHandle.bind(this)),this.initialized=!0)}},{key:"layoutCellHandles",value:function(cell){"row"===cell.row.type&&(this.deInitializeComponent(cell),this.initializeColumn("cell",cell,cell.column,cell.element))}},{key:"layoutColumnHeader",value:function(column){column.definition.resizable&&(this.initializeEventWatchers(),this.deInitializeComponent(column),this.initializeColumn("header",column,column,column.element))}},{key:"columnLayoutUpdated",value:function(column){var prev=column.prevColumn();this.reinitializeColumn(column),prev&&this.reinitializeColumn(prev)}},{key:"columnWidthUpdated",value:function(column){var _this138=this;column.modules.frozen&&(this.table.modules.frozenColumns.leftColumns.includes(column)?this.table.modules.frozenColumns.leftColumns.forEach((function(col){_this138.reinitializeColumn(col)})):this.table.modules.frozenColumns.rightColumns.includes(column)&&this.table.modules.frozenColumns.rightColumns.forEach((function(col){_this138.reinitializeColumn(col)})))}},{key:"frozenColumnOffset",value:function(column){var offset=!1;return column.modules.frozen&&(offset=column.modules.frozen.marginValue,"left"===column.modules.frozen.position?offset+=column.getWidth()-3:offset&&(offset-=3)),!1!==offset&&offset+"px"}},{key:"reinitializeColumn",value:function(column){var frozenOffset=this.frozenColumnOffset(column);column.cells.forEach((function(cell){cell.modules.resize&&cell.modules.resize.handleEl&&(frozenOffset&&(cell.modules.resize.handleEl.style[column.modules.frozen.position]=frozenOffset),cell.element.after(cell.modules.resize.handleEl))})),column.modules.resize&&column.modules.resize.handleEl&&(frozenOffset&&(column.modules.resize.handleEl.style[column.modules.frozen.position]=frozenOffset),column.element.after(column.modules.resize.handleEl))}},{key:"initializeColumn",value:function(type,component,column,element){var self=this,mode=column.definition.resizable,config={},nearestColumn=column.getLastColumn();if("header"===type&&(config={variableHeight:"textarea"==column.definition.formatter||column.definition.variableHeight}),(!0===mode||mode==type)&&this._checkResizability(nearestColumn)){var handle=document.createElement("span");handle.className="tabulator-col-resize-handle",handle.addEventListener("click",(function(e){e.stopPropagation()}));var handleDown=function(e){self.startColumn=column,self.initialNextColumn=self.nextColumn=nearestColumn.nextColumn(),self._mouseDown(e,nearestColumn,handle)};handle.addEventListener("mousedown",handleDown),handle.addEventListener("touchstart",handleDown,{passive:!0}),handle.addEventListener("dblclick",(function(e){var oldWidth=nearestColumn.getWidth();e.stopPropagation(),nearestColumn.reinitializeWidth(!0),oldWidth!==nearestColumn.getWidth()&&(self.dispatch("column-resized",nearestColumn),self.table.externalEvents.dispatch("columnResized",nearestColumn.getComponent()))})),column.modules.frozen&&(handle.style.position="sticky",handle.style[column.modules.frozen.position]=this.frozenColumnOffset(column)),config.handleEl=handle,element.parentNode&&column.visible&&element.after(handle)}component.modules.resize=config}},{key:"deInitializeColumn",value:function(column){var _this139=this;this.deInitializeComponent(column),column.cells.forEach((function(cell){_this139.deInitializeComponent(cell)}))}},{key:"deInitializeComponent",value:function(component){var handleEl;component.modules.resize&&(handleEl=component.modules.resize.handleEl)&&handleEl.parentElement&&handleEl.parentElement.removeChild(handleEl)}},{key:"resizeHandle",value:function(component,height){component.modules.resize&&component.modules.resize.handleEl&&(component.modules.resize.handleEl.style.height=height)}},{key:"_checkResizability",value:function(column){return column.definition.resizable}},{key:"_mouseDown",value:function(e,column,handle){var self=this;function mouseMove(e){var blockedBefore,blockedAfter,x=void 0===e.screenX?e.touches[0].screenX:e.screenX,startDiff=x-self.startX,moveDiff=x-self.latestX;if(self.latestX=x,self.table.rtl&&(startDiff=-startDiff,moveDiff=-moveDiff),blockedBefore=column.width==column.minWidth||column.width==column.maxWidth,column.setWidth(self.startWidth+startDiff),blockedAfter=column.width==column.minWidth||column.width==column.maxWidth,moveDiff<0&&(self.nextColumn=self.initialNextColumn),self.table.options.resizableColumnFit&&self.nextColumn&&(!blockedBefore||!blockedAfter)){var colWidth=self.nextColumn.getWidth();moveDiff>0&&colWidth<=self.nextColumn.minWidth&&(self.nextColumn=self.nextColumn.nextColumn()),self.nextColumn&&self.nextColumn.setWidth(self.nextColumn.getWidth()-moveDiff)}self.table.columnManager.rerenderColumns(!0),!self.table.browserSlow&&column.modules.resize&&column.modules.resize.variableHeight&&column.checkCellHeights()}function mouseUp(e){self.startColumn.modules.edit&&(self.startColumn.modules.edit.blocked=!1),self.table.browserSlow&&column.modules.resize&&column.modules.resize.variableHeight&&column.checkCellHeights(),document.body.removeEventListener("mouseup",mouseUp),document.body.removeEventListener("mousemove",mouseMove),handle.removeEventListener("touchmove",mouseMove),handle.removeEventListener("touchend",mouseUp),self.table.element.classList.remove("tabulator-block-select"),self.startWidth!==column.getWidth()&&(self.table.columnManager.verticalAlignHeaders(),self.dispatch("column-resized",column),self.table.externalEvents.dispatch("columnResized",column.getComponent()))}self.table.element.classList.add("tabulator-block-select"),e.stopPropagation(),self.startColumn.modules.edit&&(self.startColumn.modules.edit.blocked=!0),self.startX=void 0===e.screenX?e.touches[0].screenX:e.screenX,self.latestX=self.startX,self.startWidth=column.getWidth(),document.body.addEventListener("mousemove",mouseMove),document.body.addEventListener("mouseup",mouseUp),handle.addEventListener("touchmove",mouseMove,{passive:!0}),handle.addEventListener("touchend",mouseUp)}}]),ResizeColumns}(Module);_exports.ResizeColumnsModule=ResizeColumns,ResizeColumns.moduleName="resizeColumns";var ResizeRows=function(_Module29){_inherits(ResizeRows,_Module29);var _super34=_createSuper(ResizeRows);function ResizeRows(table){var _this140;return _classCallCheck(this,ResizeRows),(_this140=_super34.call(this,table)).startColumn=!1,_this140.startY=!1,_this140.startHeight=!1,_this140.handle=null,_this140.prevHandle=null,_this140.registerTableOption("resizableRows",!1),_this140}return _createClass(ResizeRows,[{key:"initialize",value:function(){this.table.options.resizableRows&&this.subscribe("row-layout-after",this.initializeRow.bind(this))}},{key:"initializeRow",value:function(row){var self=this,rowEl=row.getElement(),handle=document.createElement("div");handle.className="tabulator-row-resize-handle";var prevHandle=document.createElement("div");prevHandle.className="tabulator-row-resize-handle prev",handle.addEventListener("click",(function(e){e.stopPropagation()}));var handleDown=function(e){self.startRow=row,self._mouseDown(e,row,handle)};handle.addEventListener("mousedown",handleDown),handle.addEventListener("touchstart",handleDown,{passive:!0}),prevHandle.addEventListener("click",(function(e){e.stopPropagation()}));var prevHandleDown=function(e){var prevRow=self.table.rowManager.prevDisplayRow(row);prevRow&&(self.startRow=prevRow,self._mouseDown(e,prevRow,prevHandle))};prevHandle.addEventListener("mousedown",prevHandleDown),prevHandle.addEventListener("touchstart",prevHandleDown,{passive:!0}),rowEl.appendChild(handle),rowEl.appendChild(prevHandle)}},{key:"_mouseDown",value:function(e,row,handle){var self=this;function mouseMove(e){row.setHeight(self.startHeight+((void 0===e.screenY?e.touches[0].screenY:e.screenY)-self.startY))}function mouseUp(e){document.body.removeEventListener("mouseup",mouseMove),document.body.removeEventListener("mousemove",mouseMove),handle.removeEventListener("touchmove",mouseMove),handle.removeEventListener("touchend",mouseUp),self.table.element.classList.remove("tabulator-block-select"),self.dispatchExternal("rowResized",row.getComponent())}self.table.element.classList.add("tabulator-block-select"),e.stopPropagation(),self.startY=void 0===e.screenY?e.touches[0].screenY:e.screenY,self.startHeight=row.getHeight(),document.body.addEventListener("mousemove",mouseMove),document.body.addEventListener("mouseup",mouseUp),handle.addEventListener("touchmove",mouseMove,{passive:!0}),handle.addEventListener("touchend",mouseUp)}}]),ResizeRows}(Module);_exports.ResizeRowsModule=ResizeRows,ResizeRows.moduleName="resizeRows";var ResizeTable=function(_Module30){_inherits(ResizeTable,_Module30);var _super35=_createSuper(ResizeTable);function ResizeTable(table){var _this141;return _classCallCheck(this,ResizeTable),(_this141=_super35.call(this,table)).binding=!1,_this141.visibilityObserver=!1,_this141.resizeObserver=!1,_this141.containerObserver=!1,_this141.tableHeight=0,_this141.tableWidth=0,_this141.containerHeight=0,_this141.containerWidth=0,_this141.autoResize=!1,_this141.visible=!1,_this141.initialized=!1,_this141.initialRedraw=!1,_this141.registerTableOption("autoResize",!0),_this141}return _createClass(ResizeTable,[{key:"initialize",value:function(){var _this142=this;if(this.table.options.autoResize){var tableStyle,table=this.table;this.tableHeight=table.element.clientHeight,this.tableWidth=table.element.clientWidth,table.element.parentNode&&(this.containerHeight=table.element.parentNode.clientHeight,this.containerWidth=table.element.parentNode.clientWidth),"undefined"!=typeof IntersectionObserver&&"undefined"!=typeof ResizeObserver&&"virtual"===table.rowManager.getRenderMode()?(this.initializeVisibilityObserver(),this.autoResize=!0,this.resizeObserver=new ResizeObserver((function(entry){if(!table.browserMobile||table.browserMobile&&!table.modules.edit.currentCell){var nodeHeight=Math.floor(entry[0].contentRect.height),nodeWidth=Math.floor(entry[0].contentRect.width);_this142.tableHeight==nodeHeight&&_this142.tableWidth==nodeWidth||(_this142.tableHeight=nodeHeight,_this142.tableWidth=nodeWidth,table.element.parentNode&&(_this142.containerHeight=table.element.parentNode.clientHeight,_this142.containerWidth=table.element.parentNode.clientWidth),_this142.redrawTable())}})),this.resizeObserver.observe(table.element),tableStyle=window.getComputedStyle(table.element),this.table.element.parentNode&&!this.table.rowManager.fixedHeight&&(tableStyle.getPropertyValue("max-height")||tableStyle.getPropertyValue("min-height"))&&(this.containerObserver=new ResizeObserver((function(entry){if(!table.browserMobile||table.browserMobile&&!table.modules.edit.currentCell){var nodeHeight=Math.floor(entry[0].contentRect.height),nodeWidth=Math.floor(entry[0].contentRect.width);_this142.containerHeight==nodeHeight&&_this142.containerWidth==nodeWidth||(_this142.containerHeight=nodeHeight,_this142.containerWidth=nodeWidth,_this142.tableHeight=table.element.clientHeight,_this142.tableWidth=table.element.clientWidth),_this142.redrawTable()}})),this.containerObserver.observe(this.table.element.parentNode)),this.subscribe("table-resize",this.tableResized.bind(this))):(this.binding=function(){(!table.browserMobile||table.browserMobile&&!table.modules.edit.currentCell)&&(table.columnManager.rerenderColumns(!0),table.redraw())},window.addEventListener("resize",this.binding)),this.subscribe("table-destroy",this.clearBindings.bind(this))}}},{key:"initializeVisibilityObserver",value:function(){var _this143=this;this.visibilityObserver=new IntersectionObserver((function(entries){_this143.visible=entries[0].isIntersecting,_this143.initialized?_this143.visible&&(_this143.redrawTable(_this143.initialRedraw),_this143.initialRedraw=!1):(_this143.initialized=!0,_this143.initialRedraw=!_this143.visible)})),this.visibilityObserver.observe(this.table.element)}},{key:"redrawTable",value:function(force){this.initialized&&this.visible&&(this.table.columnManager.rerenderColumns(!0),this.table.redraw(force))}},{key:"tableResized",value:function(){this.table.rowManager.redraw()}},{key:"clearBindings",value:function(){this.binding&&window.removeEventListener("resize",this.binding),this.resizeObserver&&this.resizeObserver.unobserve(this.table.element),this.visibilityObserver&&this.visibilityObserver.unobserve(this.table.element),this.containerObserver&&this.containerObserver.unobserve(this.table.element.parentNode)}}]),ResizeTable}(Module);_exports.ResizeTableModule=ResizeTable,ResizeTable.moduleName="resizeTable";var ResponsiveLayout=function(_Module31){_inherits(ResponsiveLayout,_Module31);var _super36=_createSuper(ResponsiveLayout);function ResponsiveLayout(table){var _this144;return _classCallCheck(this,ResponsiveLayout),(_this144=_super36.call(this,table)).columns=[],_this144.hiddenColumns=[],_this144.mode="",_this144.index=0,_this144.collapseFormatter=[],_this144.collapseStartOpen=!0,_this144.collapseHandleColumn=!1,_this144.registerTableOption("responsiveLayout",!1),_this144.registerTableOption("responsiveLayoutCollapseStartOpen",!0),_this144.registerTableOption("responsiveLayoutCollapseUseFormatters",!0),_this144.registerTableOption("responsiveLayoutCollapseFormatter",!1),_this144.registerColumnOption("responsive"),_this144}return _createClass(ResponsiveLayout,[{key:"initialize",value:function(){this.table.options.responsiveLayout&&(this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-show",this.updateColumnVisibility.bind(this)),this.subscribe("column-hide",this.updateColumnVisibility.bind(this)),this.subscribe("columns-loaded",this.initializeResponsivity.bind(this)),this.subscribe("column-moved",this.initializeResponsivity.bind(this)),this.subscribe("column-add",this.initializeResponsivity.bind(this)),this.subscribe("column-delete",this.initializeResponsivity.bind(this)),this.subscribe("table-redrawing",this.tableRedraw.bind(this)),"collapse"===this.table.options.responsiveLayout&&(this.subscribe("row-data-changed",this.generateCollapsedRowContent.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout",this.layoutRow.bind(this))))}},{key:"tableRedraw",value:function(force){-1===["fitColumns","fitDataStretch"].indexOf(this.layoutMode())&&(force||this.update())}},{key:"initializeResponsivity",value:function(){var _this145=this,columns=[];this.mode=this.table.options.responsiveLayout,this.collapseFormatter=this.table.options.responsiveLayoutCollapseFormatter||this.formatCollapsedData,this.collapseStartOpen=this.table.options.responsiveLayoutCollapseStartOpen,this.hiddenColumns=[],this.table.columnManager.columnsByIndex.forEach((function(column,i){column.modules.responsive&&column.modules.responsive.order&&column.modules.responsive.visible&&(column.modules.responsive.index=i,columns.push(column),column.visible||"collapse"!==_this145.mode||_this145.hiddenColumns.push(column))})),columns=(columns=columns.reverse()).sort((function(a,b){return b.modules.responsive.order-a.modules.responsive.order||b.modules.responsive.index-a.modules.responsive.index})),this.columns=columns,"collapse"===this.mode&&this.generateCollapsedContent();var _step,_iterator=_createForOfIteratorHelper(this.table.columnManager.columnsByIndex);try{for(_iterator.s();!(_step=_iterator.n()).done;){var col=_step.value;if("responsiveCollapse"==col.definition.formatter){this.collapseHandleColumn=col;break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}this.collapseHandleColumn&&(this.hiddenColumns.length?this.collapseHandleColumn.show():this.collapseHandleColumn.hide())}},{key:"initializeColumn",value:function(column){var def=column.getDefinition();column.modules.responsive={order:void 0===def.responsive?1:def.responsive,visible:!1!==def.visible}}},{key:"initializeRow",value:function(row){var el;"calc"!==row.type&&((el=document.createElement("div")).classList.add("tabulator-responsive-collapse"),row.modules.responsiveLayout={element:el,open:this.collapseStartOpen},this.collapseStartOpen||(el.style.display="none"))}},{key:"layoutRow",value:function(row){var rowEl=row.getElement();row.modules.responsiveLayout&&(rowEl.appendChild(row.modules.responsiveLayout.element),this.generateCollapsedRowContent(row))}},{key:"updateColumnVisibility",value:function(column,responsiveToggle){!responsiveToggle&&column.modules.responsive&&(column.modules.responsive.visible=column.visible,this.initializeResponsivity())}},{key:"hideColumn",value:function(column){var colCount=this.hiddenColumns.length;column.hide(!1,!0),"collapse"===this.mode&&(this.hiddenColumns.unshift(column),this.generateCollapsedContent(),this.collapseHandleColumn&&!colCount&&this.collapseHandleColumn.show())}},{key:"showColumn",value:function(column){var index;column.show(!1,!0),column.setWidth(column.getWidth()),"collapse"===this.mode&&((index=this.hiddenColumns.indexOf(column))>-1&&this.hiddenColumns.splice(index,1),this.generateCollapsedContent(),this.collapseHandleColumn&&!this.hiddenColumns.length&&this.collapseHandleColumn.hide())}},{key:"update",value:function(){for(var working=!0;working;){var width="fitColumns"==this.table.modules.layout.getMode()?this.table.columnManager.getFlexBaseWidth():this.table.columnManager.getWidth(),diff=(this.table.options.headerVisible?this.table.columnManager.element.clientWidth:this.table.element.clientWidth)-width;if(diff<0){var column=this.columns[this.index];column?(this.hideColumn(column),this.index++):working=!1}else{var _column=this.columns[this.index-1];_column&&diff>0&&diff>=_column.getWidth()?(this.showColumn(_column),this.index--):working=!1}this.table.rowManager.activeRowsCount||this.table.rowManager.renderEmptyScroll()}}},{key:"generateCollapsedContent",value:function(){var _this146=this;this.table.rowManager.getDisplayRows().forEach((function(row){_this146.generateCollapsedRowContent(row)}))}},{key:"generateCollapsedRowContent",value:function(row){var el,contents;if(row.modules.responsiveLayout){for(el=row.modules.responsiveLayout.element;el.firstChild;)el.removeChild(el.firstChild);(contents=this.collapseFormatter(this.generateCollapsedRowData(row)))&&el.appendChild(contents)}}},{key:"generateCollapsedRowData",value:function(row){var mockCellComponent,_this147=this,data=row.getData(),output=[];return this.hiddenColumns.forEach((function(column){var value=column.getFieldValue(data);if(column.definition.title&&column.field)if(column.modules.format&&_this147.table.options.responsiveLayoutCollapseUseFormatters){mockCellComponent={value:!1,data:{},getValue:function(){return value},getData:function(){return data},getElement:function(){return document.createElement("div")},getRow:function(){return row.getComponent()},getColumn:function(){return column.getComponent()},getTable:function(){return _this147.table}},output.push({field:column.field,title:column.definition.title,value:column.modules.format.formatter.call(_this147.table.modules.format,mockCellComponent,column.modules.format.params,(function(callback){callback()}))})}else output.push({field:column.field,title:column.definition.title,value:value})})),output}},{key:"formatCollapsedData",value:function(data){var list=document.createElement("table");return data.forEach((function(item){var node_content,row=document.createElement("tr"),titleData=document.createElement("td"),valueData=document.createElement("td"),titleHighlight=document.createElement("strong");titleData.appendChild(titleHighlight),this.langBind("columns|"+item.field,(function(text){titleHighlight.innerHTML=text||item.title})),item.value instanceof Node?((node_content=document.createElement("div")).appendChild(item.value),valueData.appendChild(node_content)):valueData.innerHTML=item.value,row.appendChild(titleData),row.appendChild(valueData),list.appendChild(row)}),this),Object.keys(data).length?list:""}}]),ResponsiveLayout}(Module);_exports.ResponsiveLayoutModule=ResponsiveLayout,ResponsiveLayout.moduleName="responsiveLayout";var SelectRow=function(_Module32){_inherits(SelectRow,_Module32);var _super37=_createSuper(SelectRow);function SelectRow(table){var _this148;return _classCallCheck(this,SelectRow),(_this148=_super37.call(this,table)).selecting=!1,_this148.lastClickedRow=!1,_this148.selectPrev=[],_this148.selectedRows=[],_this148.headerCheckboxElement=null,_this148.registerTableOption("selectable","highlight"),_this148.registerTableOption("selectableRangeMode","drag"),_this148.registerTableOption("selectableRollingSelection",!0),_this148.registerTableOption("selectablePersistence",!0),_this148.registerTableOption("selectableCheck",(function(data,row){return!0})),_this148.registerTableFunction("selectRow",_this148.selectRows.bind(_assertThisInitialized(_this148))),_this148.registerTableFunction("deselectRow",_this148.deselectRows.bind(_assertThisInitialized(_this148))),_this148.registerTableFunction("toggleSelectRow",_this148.toggleRow.bind(_assertThisInitialized(_this148))),_this148.registerTableFunction("getSelectedRows",_this148.getSelectedRows.bind(_assertThisInitialized(_this148))),_this148.registerTableFunction("getSelectedData",_this148.getSelectedData.bind(_assertThisInitialized(_this148))),_this148.registerComponentFunction("row","select",_this148.selectRows.bind(_assertThisInitialized(_this148))),_this148.registerComponentFunction("row","deselect",_this148.deselectRows.bind(_assertThisInitialized(_this148))),_this148.registerComponentFunction("row","toggleSelect",_this148.toggleRow.bind(_assertThisInitialized(_this148))),_this148.registerComponentFunction("row","isSelected",_this148.isRowSelected.bind(_assertThisInitialized(_this148))),_this148}return _createClass(SelectRow,[{key:"initialize",value:function(){!1!==this.table.options.selectable&&(this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-deleting",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clearSelectionData.bind(this)),this.subscribe("rows-retrieve",this.rowRetrieve.bind(this)),this.table.options.selectable&&!this.table.options.selectablePersistence&&this.subscribe("data-refreshing",this.deselectRows.bind(this)))}},{key:"rowRetrieve",value:function(type,prevValue){return"selected"===type?this.selectedRows:prevValue}},{key:"rowDeleted",value:function(row){this._deselectRow(row,!0)}},{key:"clearSelectionData",value:function(silent){this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],!0!==silent&&this._rowSelectionChanged()}},{key:"initializeRow",value:function(row){var self=this,element=row.getElement(),endSelect=function endSelect(){setTimeout((function(){self.selecting=!1}),50),document.body.removeEventListener("mouseup",endSelect)};row.modules.select={selected:!1},self.table.options.selectableCheck.call(this.table,row.getComponent())?(element.classList.add("tabulator-selectable"),element.classList.remove("tabulator-unselectable"),self.table.options.selectable&&"highlight"!=self.table.options.selectable&&("click"===self.table.options.selectableRangeMode?element.addEventListener("click",this.handleComplexRowClick.bind(this,row)):(element.addEventListener("click",(function(e){self.table.modExists("edit")&&self.table.modules.edit.getCurrentCell()||self.table._clearSelection(),self.selecting||self.toggleRow(row)})),element.addEventListener("mousedown",(function(e){if(e.shiftKey)return self.table._clearSelection(),self.selecting=!0,self.selectPrev=[],document.body.addEventListener("mouseup",endSelect),document.body.addEventListener("keyup",endSelect),self.toggleRow(row),!1})),element.addEventListener("mouseenter",(function(e){self.selecting&&(self.table._clearSelection(),self.toggleRow(row),self.selectPrev[1]==row&&self.toggleRow(self.selectPrev[0]))})),element.addEventListener("mouseout",(function(e){self.selecting&&(self.table._clearSelection(),self.selectPrev.unshift(row))}))))):(element.classList.add("tabulator-unselectable"),element.classList.remove("tabulator-selectable"))}},{key:"handleComplexRowClick",value:function(row,e){var _this149=this;if(e.shiftKey){this.table._clearSelection(),this.lastClickedRow=this.lastClickedRow||row;var lastClickedRowIdx=this.table.rowManager.getDisplayRowIndex(this.lastClickedRow),rowIdx=this.table.rowManager.getDisplayRowIndex(row),fromRowIdx=lastClickedRowIdx<=rowIdx?lastClickedRowIdx:rowIdx,toRowIdx=lastClickedRowIdx>=rowIdx?lastClickedRowIdx:rowIdx,toggledRows=this.table.rowManager.getDisplayRows().slice(0).splice(fromRowIdx,toRowIdx-fromRowIdx+1);e.ctrlKey||e.metaKey?(toggledRows.forEach((function(toggledRow){toggledRow!==_this149.lastClickedRow&&(!0===_this149.table.options.selectable||_this149.isRowSelected(row)||_this149.selectedRows.length<_this149.table.options.selectable)&&_this149.toggleRow(toggledRow)})),this.lastClickedRow=row):(this.deselectRows(void 0,!0),!0!==this.table.options.selectable&&toggledRows.length>this.table.options.selectable&&(toggledRows=toggledRows.slice(0,this.table.options.selectable)),this.selectRows(toggledRows)),this.table._clearSelection()}else e.ctrlKey||e.metaKey?(this.toggleRow(row),this.lastClickedRow=row):(this.deselectRows(void 0,!0),this.selectRows(row),this.lastClickedRow=row)}},{key:"toggleRow",value:function(row){this.table.options.selectableCheck.call(this.table,row.getComponent())&&(row.modules.select&&row.modules.select.selected?this._deselectRow(row):this._selectRow(row))}},{key:"selectRows",value:function(rows){var rowMatch,_this150=this;switch(_typeof(rows)){case"undefined":this.table.rowManager.rows.forEach((function(row){_this150._selectRow(row,!0,!0)})),this._rowSelectionChanged();break;case"string":(rowMatch=this.table.rowManager.findRow(rows))?(this._selectRow(rowMatch,!0,!0),this._rowSelectionChanged()):((rowMatch=this.table.rowManager.getRows(rows)).forEach((function(row){_this150._selectRow(row,!0,!0)})),rowMatch.length&&this._rowSelectionChanged());break;default:Array.isArray(rows)?(rows.forEach((function(row){_this150._selectRow(row,!0,!0)})),this._rowSelectionChanged()):this._selectRow(rows,!1,!0)}}},{key:"_selectRow",value:function(rowInfo,silent,force){if(!isNaN(this.table.options.selectable)&&!0!==this.table.options.selectable&&!force&&this.selectedRows.length>=this.table.options.selectable){if(!this.table.options.selectableRollingSelection)return!1;this._deselectRow(this.selectedRows[0])}var row=this.table.rowManager.findRow(rowInfo);row?-1==this.selectedRows.indexOf(row)&&(row.getElement().classList.add("tabulator-selected"),row.modules.select||(row.modules.select={}),row.modules.select.selected=!0,row.modules.select.checkboxEl&&(row.modules.select.checkboxEl.checked=!0),this.selectedRows.push(row),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(row,!0),this.dispatchExternal("rowSelected",row.getComponent()),this._rowSelectionChanged(silent)):silent||console.warn("Selection Error - No such row found, ignoring selection:"+rowInfo)}},{key:"isRowSelected",value:function(row){return-1!==this.selectedRows.indexOf(row)}},{key:"deselectRows",value:function(rows,silent){var rowCount,self=this;if(void 0===rows){rowCount=self.selectedRows.length;for(var i=0;i<rowCount;i++)self._deselectRow(self.selectedRows[0],!0);rowCount&&self._rowSelectionChanged(silent)}else Array.isArray(rows)?(rows.forEach((function(row){self._deselectRow(row,!0)})),self._rowSelectionChanged(silent)):self._deselectRow(rows,silent)}},{key:"_deselectRow",value:function(rowInfo,silent){var index,row=this.table.rowManager.findRow(rowInfo);row?(index=this.selectedRows.findIndex((function(selectedRow){return selectedRow==row})))>-1&&(row.getElement().classList.remove("tabulator-selected"),row.modules.select||(row.modules.select={}),row.modules.select.selected=!1,row.modules.select.checkboxEl&&(row.modules.select.checkboxEl.checked=!1),this.selectedRows.splice(index,1),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(row,!1),this.dispatchExternal("rowDeselected",row.getComponent()),this._rowSelectionChanged(silent)):silent||console.warn("Deselection Error - No such row found, ignoring selection:"+rowInfo)}},{key:"getSelectedData",value:function(){var data=[];return this.selectedRows.forEach((function(row){data.push(row.getData())})),data}},{key:"getSelectedRows",value:function(){var rows=[];return this.selectedRows.forEach((function(row){rows.push(row.getComponent())})),rows}},{key:"_rowSelectionChanged",value:function(silent){this.headerCheckboxElement&&(0===this.selectedRows.length?(this.headerCheckboxElement.checked=!1,this.headerCheckboxElement.indeterminate=!1):this.table.rowManager.rows.length===this.selectedRows.length?(this.headerCheckboxElement.checked=!0,this.headerCheckboxElement.indeterminate=!1):(this.headerCheckboxElement.indeterminate=!0,this.headerCheckboxElement.checked=!1)),silent||this.dispatchExternal("rowSelectionChanged",this.getSelectedData(),this.getSelectedRows())}},{key:"registerRowSelectCheckbox",value:function(row,element){row._row.modules.select||(row._row.modules.select={}),row._row.modules.select.checkboxEl=element}},{key:"registerHeaderSelectCheckbox",value:function(element){this.headerCheckboxElement=element}},{key:"childRowSelection",value:function(row,select){var children=this.table.modules.dataTree.getChildren(row,!0);if(select){var _step2,_iterator2=_createForOfIteratorHelper(children);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var child=_step2.value;this._selectRow(child,!0)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}else{var _step3,_iterator3=_createForOfIteratorHelper(children);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _child=_step3.value;this._deselectRow(_child,!0)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}}}]),SelectRow}(Module);function datetime$2(a,b,aRow,bRow,column,dir,params){var DT=window.DateTime||luxon.DateTime,format=params.format||"dd/MM/yyyy HH:mm:ss",alignEmptyValues=params.alignEmptyValues,emptyAlign=0;if(void 0!==DT){if(DT.isDateTime(a)||(a="iso"===format?DT.fromISO(String(a)):DT.fromFormat(String(a),format)),DT.isDateTime(b)||(b="iso"===format?DT.fromISO(String(b)):DT.fromFormat(String(b),format)),a.isValid){if(b.isValid)return a-b;emptyAlign=1}else emptyAlign=b.isValid?-1:0;return("top"===alignEmptyValues&&"desc"===dir||"bottom"===alignEmptyValues&&"asc"===dir)&&(emptyAlign*=-1),emptyAlign}console.error("Sort Error - 'datetime' sorter is dependant on luxon.js")}_exports.SelectRowModule=SelectRow,SelectRow.moduleName="selectRow";var defaultSorters={number:function(a,b,aRow,bRow,column,dir,params){var alignEmptyValues=params.alignEmptyValues,decimal=params.decimalSeparator,thousand=params.thousandSeparator,emptyAlign=0;if(a=String(a),b=String(b),thousand&&(a=a.split(thousand).join(""),b=b.split(thousand).join("")),decimal&&(a=a.split(decimal).join("."),b=b.split(decimal).join(".")),a=parseFloat(a),b=parseFloat(b),isNaN(a))emptyAlign=isNaN(b)?0:-1;else{if(!isNaN(b))return a-b;emptyAlign=1}return("top"===alignEmptyValues&&"desc"===dir||"bottom"===alignEmptyValues&&"asc"===dir)&&(emptyAlign*=-1),emptyAlign},string:function(a,b,aRow,bRow,column,dir,params){var locale,alignEmptyValues=params.alignEmptyValues,emptyAlign=0;if(a){if(b){switch(_typeof(params.locale)){case"boolean":params.locale&&(locale=this.langLocale());break;case"string":locale=params.locale}return String(a).toLowerCase().localeCompare(String(b).toLowerCase(),locale)}emptyAlign=1}else emptyAlign=b?-1:0;return("top"===alignEmptyValues&&"desc"===dir||"bottom"===alignEmptyValues&&"asc"===dir)&&(emptyAlign*=-1),emptyAlign},date:function(a,b,aRow,bRow,column,dir,params){return params.format||(params.format="dd/MM/yyyy"),datetime$2.call(this,a,b,aRow,bRow,column,dir,params)},time:function(a,b,aRow,bRow,column,dir,params){return params.format||(params.format="HH:mm"),datetime$2.call(this,a,b,aRow,bRow,column,dir,params)},datetime:datetime$2,boolean:function(a,b,aRow,bRow,column,dir,params){return(!0===a||"true"===a||"True"===a||1===a?1:0)-(!0===b||"true"===b||"True"===b||1===b?1:0)},array:function(a,b,aRow,bRow,column,dir,params){var type=params.type||"length",alignEmptyValues=params.alignEmptyValues,emptyAlign=0;function calc(value){var result;switch(type){case"length":result=value.length;break;case"sum":result=value.reduce((function(c,d){return c+d}));break;case"max":result=Math.max.apply(null,value);break;case"min":result=Math.min.apply(null,value);break;case"avg":result=value.reduce((function(c,d){return c+d}))/value.length}return result}if(Array.isArray(a)){if(Array.isArray(b))return calc(b)-calc(a);emptyAlign=1}else emptyAlign=Array.isArray(b)?-1:0;return("top"===alignEmptyValues&&"desc"===dir||"bottom"===alignEmptyValues&&"asc"===dir)&&(emptyAlign*=-1),emptyAlign},exists:function(a,b,aRow,bRow,column,dir,params){return(void 0===a?0:1)-(void 0===b?0:1)},alphanum:function(as,bs,aRow,bRow,column,dir,params){var a,b,a1,b1,L,i=0,rx=/(\d+)|(\D+)/g,rd=/\d/,alignEmptyValues=params.alignEmptyValues,emptyAlign=0;if(as||0===as){if(bs||0===bs){if(isFinite(as)&&isFinite(bs))return as-bs;if((a=String(as).toLowerCase())===(b=String(bs).toLowerCase()))return 0;if(!rd.test(a)||!rd.test(b))return a>b?1:-1;for(a=a.match(rx),b=b.match(rx),L=a.length>b.length?b.length:a.length;i<L;)if((a1=a[i])!==(b1=b[i++]))return isFinite(a1)&&isFinite(b1)?("0"===a1.charAt(0)&&(a1="."+a1),"0"===b1.charAt(0)&&(b1="."+b1),a1-b1):a1>b1?1:-1;return a.length>b.length}emptyAlign=1}else emptyAlign=bs||0===bs?-1:0;return("top"===alignEmptyValues&&"desc"===dir||"bottom"===alignEmptyValues&&"asc"===dir)&&(emptyAlign*=-1),emptyAlign}},Sort=function(_Module33){_inherits(Sort,_Module33);var _super38=_createSuper(Sort);function Sort(table){var _this151;return _classCallCheck(this,Sort),(_this151=_super38.call(this,table)).sortList=[],_this151.changed=!1,_this151.registerTableOption("sortMode","local"),_this151.registerTableOption("initialSort",!1),_this151.registerTableOption("columnHeaderSortMulti",!0),_this151.registerTableOption("sortOrderReverse",!1),_this151.registerTableOption("headerSortElement","<div class='tabulator-arrow'></div>"),_this151.registerTableOption("headerSortClickElement","header"),_this151.registerColumnOption("sorter"),_this151.registerColumnOption("sorterParams"),_this151.registerColumnOption("headerSort",!0),_this151.registerColumnOption("headerSortStartingDir"),_this151.registerColumnOption("headerSortTristate"),_this151}return _createClass(Sort,[{key:"initialize",value:function(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.registerDataHandler(this.sort.bind(this),20),this.registerTableFunction("setSort",this.userSetSort.bind(this)),this.registerTableFunction("getSorters",this.getSort.bind(this)),this.registerTableFunction("clearSort",this.clearSort.bind(this)),"remote"===this.table.options.sortMode&&this.subscribe("data-params",this.remoteSortParams.bind(this))}},{key:"tableBuilt",value:function(){this.table.options.initialSort&&this.setSort(this.table.options.initialSort)}},{key:"remoteSortParams",value:function(data,config,silent,params){var sorters=this.getSort();return sorters.forEach((function(item){delete item.column})),params.sort=sorters,params}},{key:"userSetSort",value:function(sortList,dir){this.setSort(sortList,dir),this.refreshSort()}},{key:"clearSort",value:function(){this.clear(),this.refreshSort()}},{key:"initializeColumn",value:function(column){var colEl,arrowEl,_this152=this,sorter=!1;switch(_typeof(column.definition.sorter)){case"string":Sort.sorters[column.definition.sorter]?sorter=Sort.sorters[column.definition.sorter]:console.warn("Sort Error - No such sorter found: ",column.definition.sorter);break;case"function":sorter=column.definition.sorter}if(column.modules.sort={sorter:sorter,dir:"none",params:column.definition.sorterParams||{},startingDir:column.definition.headerSortStartingDir||"asc",tristate:column.definition.headerSortTristate},!1!==column.definition.headerSort){if((colEl=column.getElement()).classList.add("tabulator-sortable"),(arrowEl=document.createElement("div")).classList.add("tabulator-col-sorter"),"icon"===this.table.options.headerSortClickElement)arrowEl.classList.add("tabulator-col-sorter-element");else colEl.classList.add("tabulator-col-sorter-element");switch(this.table.options.headerSortElement){case"function":break;case"object":arrowEl.appendChild(this.table.options.headerSortElement);break;default:arrowEl.innerHTML=this.table.options.headerSortElement}column.titleHolderElement.appendChild(arrowEl),column.modules.sort.element=arrowEl,this.setColumnHeaderSortIcon(column,"none"),("icon"===this.table.options.headerSortClickElement?arrowEl:colEl).addEventListener("click",(function(e){var dir="",sorters=[],match=!1;if(column.modules.sort){if(column.modules.sort.tristate)dir="none"==column.modules.sort.dir?column.modules.sort.startingDir:column.modules.sort.dir==column.modules.sort.startingDir?"asc"==column.modules.sort.dir?"desc":"asc":"none";else switch(column.modules.sort.dir){case"asc":dir="desc";break;case"desc":dir="asc";break;default:dir=column.modules.sort.startingDir}_this152.table.options.columnHeaderSortMulti&&(e.shiftKey||e.ctrlKey)?(match=(sorters=_this152.getSort()).findIndex((function(sorter){return sorter.field===column.getField()})),match>-1?(sorters[match].dir=dir,match=sorters.splice(match,1)[0],"none"!=dir&&sorters.push(match)):"none"!=dir&&sorters.push({column:column,dir:dir}),_this152.setSort(sorters)):"none"==dir?_this152.clear():_this152.setSort(column,dir),_this152.refreshSort()}}))}}},{key:"refreshSort",value:function(){"remote"===this.table.options.sortMode?this.reloadData(null,!1,!1):this.refreshData(!0)}},{key:"hasChanged",value:function(){var changed=this.changed;return this.changed=!1,changed}},{key:"getSort",value:function(){var sorters=[];return this.sortList.forEach((function(item){item.column&&sorters.push({column:item.column.getComponent(),field:item.column.getField(),dir:item.dir})})),sorters}},{key:"setSort",value:function(sortList,dir){var self=this,newSortList=[];Array.isArray(sortList)||(sortList=[{column:sortList,dir:dir}]),sortList.forEach((function(item){var column;(column=self.table.columnManager.findColumn(item.column))?(item.column=column,newSortList.push(item),self.changed=!0):console.warn("Sort Warning - Sort field does not exist and is being ignored: ",item.column)})),self.sortList=newSortList,this.dispatch("sort-changed")}},{key:"clear",value:function(){this.setSort([])}},{key:"findSorter",value:function(column){var value,row=this.table.rowManager.activeRows[0],sorter="string";if(row&&(row=row.getData(),column.getField()))switch(_typeof(value=column.getFieldValue(row))){case"undefined":sorter="string";break;case"boolean":sorter="boolean";break;default:isNaN(value)||""===value?value.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)&&(sorter="alphanum"):sorter="number"}return Sort.sorters[sorter]}},{key:"sort",value:function(data){var self=this,sortList=this.table.options.sortOrderReverse?self.sortList.slice().reverse():self.sortList,sortListActual=[],rowComponents=[];return this.subscribedExternal("dataSorting")&&this.dispatchExternal("dataSorting",self.getSort()),self.clearColumnHeaders(),"remote"!==this.table.options.sortMode?(sortList.forEach((function(item,i){var sortObj;item.column&&((sortObj=item.column.modules.sort)&&(sortObj.sorter||(sortObj.sorter=self.findSorter(item.column)),item.params="function"==typeof sortObj.params?sortObj.params(item.column.getComponent(),item.dir):sortObj.params,sortListActual.push(item)),self.setColumnHeader(item.column,item.dir))})),sortListActual.length&&self._sortItems(data,sortListActual)):sortList.forEach((function(item,i){self.setColumnHeader(item.column,item.dir)})),this.subscribedExternal("dataSorted")&&(data.forEach((function(row){rowComponents.push(row.getComponent())})),this.dispatchExternal("dataSorted",self.getSort(),rowComponents)),data}},{key:"clearColumnHeaders",value:function(){var _this153=this;this.table.columnManager.getRealColumns().forEach((function(column){column.modules.sort&&(column.modules.sort.dir="none",column.getElement().setAttribute("aria-sort","none"),_this153.setColumnHeaderSortIcon(column,"none"))}))}},{key:"setColumnHeader",value:function(column,dir){column.modules.sort.dir=dir,column.getElement().setAttribute("aria-sort","asc"===dir?"ascending":"descending"),this.setColumnHeaderSortIcon(column,dir)}},{key:"setColumnHeaderSortIcon",value:function(column,dir){var arrowEl,sortEl=column.modules.sort.element;if(column.definition.headerSort&&"function"==typeof this.table.options.headerSortElement){for(;sortEl.firstChild;)sortEl.removeChild(sortEl.firstChild);"object"===_typeof(arrowEl=this.table.options.headerSortElement.call(this.table,column.getComponent(),dir))?sortEl.appendChild(arrowEl):sortEl.innerHTML=arrowEl}}},{key:"_sortItems",value:function(data,sortList){var _this154=this,sorterCount=sortList.length-1;data.sort((function(a,b){for(var result,i=sorterCount;i>=0;i--){var sortItem=sortList[i];if(0!==(result=_this154._sortRow(a,b,sortItem.column,sortItem.dir,sortItem.params)))break}return result}))}},{key:"_sortRow",value:function(a,b,column,dir,params){var el1Comp,el2Comp,el1="asc"==dir?a:b,el2="asc"==dir?b:a;return a=void 0!==(a=column.getFieldValue(el1.getData()))?a:"",b=void 0!==(b=column.getFieldValue(el2.getData()))?b:"",el1Comp=el1.getComponent(),el2Comp=el2.getComponent(),column.modules.sort.sorter.call(this,a,b,el1Comp,el2Comp,column.getComponent(),dir,params)}}]),Sort}(Module);_exports.SortModule=Sort,Sort.moduleName="sort",Sort.sorters=defaultSorters;var Tooltip=function(_Module34){_inherits(Tooltip,_Module34);var _super39=_createSuper(Tooltip);function Tooltip(table){var _this155;return _classCallCheck(this,Tooltip),(_this155=_super39.call(this,table)).tooltipSubscriber=null,_this155.headerSubscriber=null,_this155.timeout=null,_this155.popupInstance=null,_this155.registerTableOption("tooltipGenerationMode",void 0),_this155.registerTableOption("tooltipDelay",300),_this155.registerColumnOption("tooltip"),_this155.registerColumnOption("headerTooltip"),_this155}return _createClass(Tooltip,[{key:"initialize",value:function(){this.deprecatedOptionsCheck(),this.subscribe("column-init",this.initializeColumn.bind(this))}},{key:"deprecatedOptionsCheck",value:function(){this.deprecationCheckMsg("tooltipGenerationMode","This option is no longer needed as tooltips are always generated on hover now")}},{key:"initializeColumn",value:function(column){column.definition.headerTooltip&&!this.headerSubscriber&&(this.headerSubscriber=!0,this.subscribe("column-mousemove",this.mousemoveCheck.bind(this,"headerTooltip")),this.subscribe("column-mouseout",this.mouseoutCheck.bind(this,"headerTooltip"))),column.definition.tooltip&&!this.tooltipSubscriber&&(this.tooltipSubscriber=!0,this.subscribe("cell-mousemove",this.mousemoveCheck.bind(this,"tooltip")),this.subscribe("cell-mouseout",this.mouseoutCheck.bind(this,"tooltip")))}},{key:"mousemoveCheck",value:function(action,e,component){var tooltip="tooltip"===action?component.column.definition.tooltip:component.definition.headerTooltip;tooltip&&(this.clearPopup(),this.timeout=setTimeout(this.loadTooltip.bind(this,e,component,tooltip),this.table.options.tooltipDelay))}},{key:"mouseoutCheck",value:function(action,e,component){this.popupInstance||this.clearPopup()}},{key:"clearPopup",value:function(action,e,component){clearTimeout(this.timeout),this.timeout=null,this.popupInstance&&this.popupInstance.hide()}},{key:"loadTooltip",value:function(e,component,tooltip){var contentsEl,renderedCallback,coords,_this156=this;"function"==typeof tooltip&&(tooltip=tooltip(e,component.getComponent(),(function(callback){renderedCallback=callback}))),tooltip instanceof HTMLElement?contentsEl=tooltip:(contentsEl=document.createElement("div"),!0===tooltip&&(component instanceof Cell?tooltip=component.value:component.definition.field?this.langBind("columns|"+component.definition.field,(function(value){contentsEl.innerHTML=tooltip=value||component.definition.title})):tooltip=component.definition.title),contentsEl.innerHTML=tooltip),(tooltip||0===tooltip||!1===tooltip)&&(contentsEl.classList.add("tabulator-tooltip"),contentsEl.addEventListener("mousemove",(function(e){return e.preventDefault()})),this.popupInstance=this.popup(contentsEl),"function"==typeof renderedCallback&&this.popupInstance.renderCallback(renderedCallback),coords=this.popupInstance.containerEventCoords(e),this.popupInstance.show(coords.x+15,coords.y+15).hideOnBlur((function(){_this156.dispatchExternal("TooltipClosed",component.getComponent()),_this156.popupInstance=null})),this.dispatchExternal("TooltipOpened",component.getComponent()))}}]),Tooltip}(Module);_exports.TooltipModule=Tooltip,Tooltip.moduleName="tooltip";var defaultValidators={integer:function(cell,value,parameters){return""===value||null==value||(value=Number(value),!isNaN(value)&&isFinite(value)&&Math.floor(value)===value)},float:function(cell,value,parameters){return""===value||null==value||(value=Number(value),!isNaN(value)&&isFinite(value)&&value%1!=0)},numeric:function(cell,value,parameters){return""===value||null==value||!isNaN(value)},string:function(cell,value,parameters){return""===value||null==value||isNaN(value)},max:function(cell,value,parameters){return""===value||null==value||parseFloat(value)<=parameters},min:function(cell,value,parameters){return""===value||null==value||parseFloat(value)>=parameters},starts:function(cell,value,parameters){return""===value||null==value||String(value).toLowerCase().startsWith(String(parameters).toLowerCase())},ends:function(cell,value,parameters){return""===value||null==value||String(value).toLowerCase().endsWith(String(parameters).toLowerCase())},minLength:function(cell,value,parameters){return""===value||null==value||String(value).length>=parameters},maxLength:function(cell,value,parameters){return""===value||null==value||String(value).length<=parameters},in:function(cell,value,parameters){return""===value||null==value||("string"==typeof parameters&&(parameters=parameters.split("|")),parameters.indexOf(value)>-1)},regex:function(cell,value,parameters){return""===value||null==value||new RegExp(parameters).test(value)},unique:function(cell,value,parameters){if(""===value||null==value)return!0;var unique=!0,cellData=cell.getData(),column=cell.getColumn()._getSelf();return this.table.rowManager.rows.forEach((function(row){var data=row.getData();data!==cellData&&value==column.getFieldValue(data)&&(unique=!1)})),unique},required:function(cell,value,parameters){return""!==value&&null!=value}},Validate=function(_Module35){_inherits(Validate,_Module35);var _super40=_createSuper(Validate);function Validate(table){var _this157;return _classCallCheck(this,Validate),(_this157=_super40.call(this,table)).invalidCells=[],_this157.registerTableOption("validationMode","blocking"),_this157.registerColumnOption("validator"),_this157.registerTableFunction("getInvalidCells",_this157.getInvalidCells.bind(_assertThisInitialized(_this157))),_this157.registerTableFunction("clearCellValidation",_this157.userClearCellValidation.bind(_assertThisInitialized(_this157))),_this157.registerTableFunction("validate",_this157.userValidate.bind(_assertThisInitialized(_this157))),_this157.registerComponentFunction("cell","isValid",_this157.cellIsValid.bind(_assertThisInitialized(_this157))),_this157.registerComponentFunction("cell","clearValidation",_this157.clearValidation.bind(_assertThisInitialized(_this157))),_this157.registerComponentFunction("cell","validate",_this157.cellValidate.bind(_assertThisInitialized(_this157))),_this157.registerComponentFunction("column","validate",_this157.columnValidate.bind(_assertThisInitialized(_this157))),_this157.registerComponentFunction("row","validate",_this157.rowValidate.bind(_assertThisInitialized(_this157))),_this157}return _createClass(Validate,[{key:"initialize",value:function(){this.subscribe("cell-delete",this.clearValidation.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("edit-success",this.editValidate.bind(this)),this.subscribe("edit-editor-clear",this.editorClear.bind(this)),this.subscribe("edit-edited-clear",this.editedClear.bind(this))}},{key:"editValidate",value:function(cell,value,previousValue){var _this158=this,valid="manual"===this.table.options.validationMode||this.validate(cell.column.modules.validate,cell,value);return!0!==valid&&setTimeout((function(){cell.getElement().classList.add("tabulator-validation-fail"),_this158.dispatchExternal("validationFailed",cell.getComponent(),value,valid)})),valid}},{key:"editorClear",value:function(cell,cancelled){cancelled&&cell.column.modules.validate&&this.cellValidate(cell),cell.getElement().classList.remove("tabulator-validation-fail")}},{key:"editedClear",value:function(cell){cell.modules.validate&&(cell.modules.validate.invalid=!1)}},{key:"cellIsValid",value:function(cell){return cell.modules.validate&&cell.modules.validate.invalid||!0}},{key:"cellValidate",value:function(cell){return this.validate(cell.column.modules.validate,cell,cell.getValue())}},{key:"columnValidate",value:function(column){var _this159=this,invalid=[];return column.cells.forEach((function(cell){!0!==_this159.cellValidate(cell)&&invalid.push(cell.getComponent())})),!invalid.length||invalid}},{key:"rowValidate",value:function(row){var _this160=this,invalid=[];return row.cells.forEach((function(cell){!0!==_this160.cellValidate(cell)&&invalid.push(cell.getComponent())})),!invalid.length||invalid}},{key:"userClearCellValidation",value:function(cells){var _this161=this;cells||(cells=this.getInvalidCells()),Array.isArray(cells)||(cells=[cells]),cells.forEach((function(cell){_this161.clearValidation(cell._getSelf())}))}},{key:"userValidate",value:function(cells){var output=[];return this.table.rowManager.rows.forEach((function(row){var valid=(row=row.getComponent()).validate();!0!==valid&&(output=output.concat(valid))})),!output.length||output}},{key:"initializeColumnCheck",value:function(column){void 0!==column.definition.validator&&this.initializeColumn(column)}},{key:"initializeColumn",value:function(column){var validator,self=this,config=[];column.definition.validator&&(Array.isArray(column.definition.validator)?column.definition.validator.forEach((function(item){(validator=self._extractValidator(item))&&config.push(validator)})):(validator=this._extractValidator(column.definition.validator))&&config.push(validator),column.modules.validate=!!config.length&&config)}},{key:"_extractValidator",value:function(value){var type,params,pos;switch(_typeof(value)){case"string":return(pos=value.indexOf(":"))>-1?(type=value.substring(0,pos),params=value.substring(pos+1)):type=value,this._buildValidator(type,params);case"function":return this._buildValidator(value);case"object":return this._buildValidator(value.type,value.parameters)}}},{key:"_buildValidator",value:function(type,params){var func="function"==typeof type?type:Validate.validators[type];return func?{type:"function"==typeof type?"function":type,func:func,params:params}:(console.warn("Validator Setup Error - No matching validator found:",type),!1)}},{key:"validate",value:function(validators,cell,value){var self=this,failedValidators=[],invalidIndex=this.invalidCells.indexOf(cell);return validators&&validators.forEach((function(item){item.func.call(self,cell.getComponent(),value,item.params)||failedValidators.push({type:item.type,parameters:item.params})})),cell.modules.validate||(cell.modules.validate={}),failedValidators.length?(cell.modules.validate.invalid=failedValidators,"manual"!==this.table.options.validationMode&&cell.getElement().classList.add("tabulator-validation-fail"),-1==invalidIndex&&this.invalidCells.push(cell)):(cell.modules.validate.invalid=!1,cell.getElement().classList.remove("tabulator-validation-fail"),invalidIndex>-1&&this.invalidCells.splice(invalidIndex,1)),!failedValidators.length||failedValidators}},{key:"getInvalidCells",value:function(){var output=[];return this.invalidCells.forEach((function(cell){output.push(cell.getComponent())})),output}},{key:"clearValidation",value:function(cell){var invalidIndex;cell.modules.validate&&cell.modules.validate.invalid&&(cell.getElement().classList.remove("tabulator-validation-fail"),cell.modules.validate.invalid=!1,(invalidIndex=this.invalidCells.indexOf(cell))>-1&&this.invalidCells.splice(invalidIndex,1))}}]),Validate}(Module);_exports.ValidateModule=Validate,Validate.moduleName="validate",Validate.validators=defaultValidators;var modules=Object.freeze({__proto__:null,AccessorModule:Accessor,AjaxModule:Ajax,ClipboardModule:Clipboard,ColumnCalcsModule:ColumnCalcs,DataTreeModule:DataTree,DownloadModule:Download,EditModule:Edit$1,ExportModule:Export,FilterModule:Filter,FormatModule:Format,FrozenColumnsModule:FrozenColumns,FrozenRowsModule:FrozenRows,GroupRowsModule:GroupRows,HistoryModule:History,HtmlTableImportModule:HtmlTableImport,ImportModule:Import,InteractionModule:Interaction,KeybindingsModule:Keybindings,MenuModule:Menu,MoveColumnsModule:MoveColumns,MoveRowsModule:MoveRows,MutatorModule:Mutator,PageModule:Page,PersistenceModule:Persistence,PopupModule:Popup$1,PrintModule:Print,ReactiveDataModule:ReactiveData,ResizeColumnsModule:ResizeColumns,ResizeRowsModule:ResizeRows,ResizeTableModule:ResizeTable,ResponsiveLayoutModule:ResponsiveLayout,SelectRowModule:SelectRow,SortModule:Sort,TooltipModule:Tooltip,ValidateModule:Validate}),OptionsList=function(){function OptionsList(table,msgType){var defaults=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,OptionsList),this.table=table,this.msgType=msgType,this.registeredDefaults=Object.assign({},defaults)}return _createClass(OptionsList,[{key:"register",value:function(option,value){this.registeredDefaults[option]=value}},{key:"generate",value:function(defaultOptions){var userOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},output=Object.assign({},this.registeredDefaults);if(Object.assign(output,defaultOptions),!1!==userOptions.debugInvalidOptions||this.table.options.debugInvalidOptions)for(var key in userOptions)output.hasOwnProperty(key)||console.warn("Invalid "+this.msgType+" option:",key);for(var _key in output)_key in userOptions?output[_key]=userOptions[_key]:Array.isArray(output[_key])?output[_key]=Object.assign([],output[_key]):"object"===_typeof(output[_key])&&null!==output[_key]?output[_key]=Object.assign({},output[_key]):void 0===output[_key]&&delete output[_key];return output}}]),OptionsList}(),Renderer=function(_CoreFeature6){_inherits(Renderer,_CoreFeature6);var _super41=_createSuper(Renderer);function Renderer(table){var _this162;return _classCallCheck(this,Renderer),(_this162=_super41.call(this,table)).elementVertical=table.rowManager.element,_this162.elementHorizontal=table.columnManager.element,_this162.tableElement=table.rowManager.tableElement,_this162.verticalFillMode="fit",_this162}return _createClass(Renderer,[{key:"initialize",value:function(){}},{key:"clearRows",value:function(){}},{key:"clearColumns",value:function(){}},{key:"reinitializeColumnWidths",value:function(columns){}},{key:"renderRows",value:function(){}},{key:"renderColumns",value:function(){}},{key:"rerenderRows",value:function(callback){callback&&callback()}},{key:"rerenderColumns",value:function(update,blockRedraw){}},{key:"renderRowCells",value:function(row){}},{key:"rerenderRowCells",value:function(row,force){}},{key:"scrollColumns",value:function(left,dir){}},{key:"scrollRows",value:function(top,dir){}},{key:"resize",value:function(){}},{key:"scrollToRow",value:function(row){}},{key:"scrollToRowNearestTop",value:function(row){}},{key:"visibleRows",value:function(includingBuffer){return[]}},{key:"rows",value:function(){return this.table.rowManager.getDisplayRows()}},{key:"styleRow",value:function(row,index){var rowEl=row.getElement();index%2?(rowEl.classList.add("tabulator-row-even"),rowEl.classList.remove("tabulator-row-odd")):(rowEl.classList.add("tabulator-row-odd"),rowEl.classList.remove("tabulator-row-even"))}},{key:"clear",value:function(){this.clearRows(),this.clearColumns()}},{key:"render",value:function(){this.renderRows(),this.renderColumns()}},{key:"rerender",value:function(callback){this.rerenderRows(),this.rerenderColumns()}},{key:"scrollToRowPosition",value:function(row,position,ifVisible){var _this163=this,rowIndex=this.rows().indexOf(row),rowEl=row.getElement(),offset=0;return new Promise((function(resolve,reject){if(rowIndex>-1){if(void 0===ifVisible&&(ifVisible=_this163.table.options.scrollToRowIfVisible),!ifVisible&&Helpers.elVisible(rowEl)&&(offset=Helpers.elOffset(rowEl).top-Helpers.elOffset(_this163.elementVertical).top)>0&&offset<_this163.elementVertical.clientHeight-rowEl.offsetHeight)return resolve(),!1;switch(void 0===position&&(position=_this163.table.options.scrollToRowPosition),"nearest"===position&&(position=_this163.scrollToRowNearestTop(row)?"top":"bottom"),_this163.scrollToRow(row),position){case"middle":case"center":_this163.elementVertical.scrollHeight-_this163.elementVertical.scrollTop==_this163.elementVertical.clientHeight?_this163.elementVertical.scrollTop=_this163.elementVertical.scrollTop+(rowEl.offsetTop-_this163.elementVertical.scrollTop)-(_this163.elementVertical.scrollHeight-rowEl.offsetTop)/2:_this163.elementVertical.scrollTop=_this163.elementVertical.scrollTop-_this163.elementVertical.clientHeight/2;break;case"bottom":_this163.elementVertical.scrollHeight-_this163.elementVertical.scrollTop==_this163.elementVertical.clientHeight?_this163.elementVertical.scrollTop=_this163.elementVertical.scrollTop-(_this163.elementVertical.scrollHeight-rowEl.offsetTop)+rowEl.offsetHeight:_this163.elementVertical.scrollTop=_this163.elementVertical.scrollTop-_this163.elementVertical.clientHeight+rowEl.offsetHeight;break;case"top":_this163.elementVertical.scrollTop=rowEl.offsetTop}resolve()}else console.warn("Scroll Error - Row not visible"),reject("Scroll Error - Row not visible")}))}}]),Renderer}(CoreFeature);_exports.Renderer=Renderer;var BasicHorizontal=function(_Renderer){_inherits(BasicHorizontal,_Renderer);var _super42=_createSuper(BasicHorizontal);function BasicHorizontal(table){return _classCallCheck(this,BasicHorizontal),_super42.call(this,table)}return _createClass(BasicHorizontal,[{key:"renderRowCells",value:function(row){row.cells.forEach((function(cell){row.element.appendChild(cell.getElement()),cell.cellRendered()}))}},{key:"reinitializeColumnWidths",value:function(columns){columns.forEach((function(column){column.reinitializeWidth()}))}}]),BasicHorizontal}(Renderer),VirtualDomHorizontal=function(_Renderer2){_inherits(VirtualDomHorizontal,_Renderer2);var _super43=_createSuper(VirtualDomHorizontal);function VirtualDomHorizontal(table){var _this164;return _classCallCheck(this,VirtualDomHorizontal),(_this164=_super43.call(this,table)).leftCol=0,_this164.rightCol=0,_this164.scrollLeft=0,_this164.vDomScrollPosLeft=0,_this164.vDomScrollPosRight=0,_this164.vDomPadLeft=0,_this164.vDomPadRight=0,_this164.fitDataColAvg=0,_this164.windowBuffer=200,_this164.visibleRows=null,_this164.initialized=!1,_this164.isFitData=!1,_this164.columns=[],_this164}return _createClass(VirtualDomHorizontal,[{key:"initialize",value:function(){this.compatibilityCheck(),this.layoutCheck(),this.vertScrollListen()}},{key:"compatibilityCheck",value:function(){"fitDataTable"==this.options("layout")&&console.warn("Horizontal Virtual DOM is not compatible with fitDataTable layout mode"),this.options("responsiveLayout")&&console.warn("Horizontal Virtual DOM is not compatible with responsive columns"),this.options("rtl")&&console.warn("Horizontal Virtual DOM is not currently compatible with RTL text direction")}},{key:"layoutCheck",value:function(){this.isFitData=this.options("layout").startsWith("fitData")}},{key:"vertScrollListen",value:function(){this.subscribe("scroll-vertical",this.clearVisRowCache.bind(this)),this.subscribe("data-refreshed",this.clearVisRowCache.bind(this))}},{key:"clearVisRowCache",value:function(){this.visibleRows=null}},{key:"renderColumns",value:function(row,force){this.dataChange()}},{key:"scrollColumns",value:function(left,dir){this.scrollLeft!=left&&(this.scrollLeft=left,this.scroll(left-(this.vDomScrollPosLeft+this.windowBuffer)))}},{key:"calcWindowBuffer",value:function(){var buffer=this.elementVertical.clientWidth;this.table.columnManager.columnsByIndex.forEach((function(column){if(column.visible){var width=column.getWidth();width>buffer&&(buffer=width)}})),this.windowBuffer=2*buffer}},{key:"rerenderColumns",value:function(update,blockRedraw){var _this165=this,old={cols:this.columns,leftCol:this.leftCol,rightCol:this.rightCol},colPos=0;update&&!this.initialized||(this.clear(),this.calcWindowBuffer(),this.scrollLeft=this.elementVertical.scrollLeft,this.vDomScrollPosLeft=this.scrollLeft-this.windowBuffer,this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,this.table.columnManager.columnsByIndex.forEach((function(column){var width,config={};column.visible&&(column.modules.frozen||(width=column.getWidth(),config.leftPos=colPos,config.rightPos=colPos+width,config.width=width,_this165.isFitData&&(config.fitDataCheck=!column.modules.vdomHoz||column.modules.vdomHoz.fitDataCheck),colPos+width>_this165.vDomScrollPosLeft&&colPos<_this165.vDomScrollPosRight?(-1==_this165.leftCol&&(_this165.leftCol=_this165.columns.length,_this165.vDomPadLeft=colPos),_this165.rightCol=_this165.columns.length):-1!==_this165.leftCol&&(_this165.vDomPadRight+=width),_this165.columns.push(column),column.modules.vdomHoz=config,colPos+=width))})),this.tableElement.style.paddingLeft=this.vDomPadLeft+"px",this.tableElement.style.paddingRight=this.vDomPadRight+"px",this.initialized=!0,blockRedraw||update&&!this.reinitChanged(old)||this.reinitializeRows(),this.elementVertical.scrollLeft=this.scrollLeft)}},{key:"renderRowCells",value:function(row){this.initialized?this.initializeRow(row):row.cells.forEach((function(cell){row.element.appendChild(cell.getElement()),cell.cellRendered()}))}},{key:"rerenderRowCells",value:function(row,force){this.reinitializeRow(row,force)}},{key:"reinitializeColumnWidths",value:function(columns){for(var i=this.leftCol;i<=this.rightCol;i++)this.columns[i].reinitializeWidth()}},{key:"deinitialize",value:function(){this.initialized=!1}},{key:"clear",value:function(){this.columns=[],this.leftCol=-1,this.rightCol=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0}},{key:"dataChange",value:function(){var row,rowEl,_this166=this,change=!1;if(this.isFitData){if(this.table.columnManager.columnsByIndex.forEach((function(column){!column.definition.width&&column.visible&&(change=!0)})),change&&this.table.rowManager.getDisplayRows().length&&(this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,row=this.chain("rows-sample",[1],[],(function(){return _this166.table.rowManager.getDisplayRows()}))[0])){rowEl=row.getElement(),row.generateCells(),this.tableElement.appendChild(rowEl);for(var colEnd=0;colEnd<row.cells.length;colEnd++){var cell=row.cells[colEnd];rowEl.appendChild(cell.getElement()),cell.column.reinitializeWidth()}rowEl.parentNode.removeChild(rowEl),this.rerenderColumns(!1,!0)}}else"fitColumns"===this.options("layout")&&(this.layoutRefresh(),this.rerenderColumns(!1,!0))}},{key:"reinitChanged",value:function(old){var _this167=this,match=!0;return old.cols.length!==this.columns.length||old.leftCol!==this.leftCol||old.rightCol!==this.rightCol||(old.cols.forEach((function(col,i){col!==_this167.columns[i]&&(match=!1)})),!match)}},{key:"reinitializeRows",value:function(){var _this168=this,visibleRows=this.getVisibleRows(),otherRows=this.table.rowManager.getRows().filter((function(row){return!visibleRows.includes(row)}));visibleRows.forEach((function(row){_this168.reinitializeRow(row,!0)})),otherRows.forEach((function(row){row.deinitialize()}))}},{key:"getVisibleRows",value:function(){return this.visibleRows||(this.visibleRows=this.table.rowManager.getVisibleRows()),this.visibleRows}},{key:"scroll",value:function(diff){this.vDomScrollPosLeft+=diff,this.vDomScrollPosRight+=diff,Math.abs(diff)>this.windowBuffer/2?this.rerenderColumns():diff>0?(this.addColRight(),this.removeColLeft()):(this.addColLeft(),this.removeColRight())}},{key:"colPositionAdjust",value:function(start,end,diff){for(var i=start;i<end;i++){var column=this.columns[i];column.modules.vdomHoz.leftPos+=diff,column.modules.vdomHoz.rightPos+=diff}}},{key:"addColRight",value:function(){for(var _this169=this,changes=!1,working=!0,_loop3=function(){var column=_this169.columns[_this169.rightCol+1];column&&column.modules.vdomHoz.leftPos<=_this169.vDomScrollPosRight?(changes=!0,_this169.getVisibleRows().forEach((function(row){if("group"!==row.type){var cell=row.getCell(column);row.getElement().insertBefore(cell.getElement(),row.getCell(_this169.columns[_this169.rightCol]).getElement().nextSibling),cell.cellRendered()}})),_this169.fitDataColActualWidthCheck(column),_this169.rightCol++,_this169.getVisibleRows().forEach((function(row){"group"!==row.type&&(row.modules.vdomHoz.rightCol=_this169.rightCol)})),_this169.rightCol>=_this169.columns.length-1?_this169.vDomPadRight=0:_this169.vDomPadRight-=column.getWidth()):working=!1};working;)_loop3();changes&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}},{key:"addColLeft",value:function(){for(var _this170=this,changes=!1,working=!0,_loop4=function(){var column=_this170.columns[_this170.leftCol-1];if(column)if(column.modules.vdomHoz.rightPos>=_this170.vDomScrollPosLeft){changes=!0,_this170.getVisibleRows().forEach((function(row){if("group"!==row.type){var cell=row.getCell(column);row.getElement().insertBefore(cell.getElement(),row.getCell(_this170.columns[_this170.leftCol]).getElement()),cell.cellRendered()}})),_this170.leftCol--,_this170.getVisibleRows().forEach((function(row){"group"!==row.type&&(row.modules.vdomHoz.leftCol=_this170.leftCol)})),_this170.leftCol<=0?_this170.vDomPadLeft=0:_this170.vDomPadLeft-=column.getWidth();var diff=_this170.fitDataColActualWidthCheck(column);diff&&(_this170.scrollLeft=_this170.elementVertical.scrollLeft=_this170.elementVertical.scrollLeft+diff,_this170.vDomPadRight-=diff)}else working=!1;else working=!1};working;)_loop4();changes&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}},{key:"removeColRight",value:function(){for(var _this171=this,changes=!1,working=!0,_loop5=function(){var column=_this171.columns[_this171.rightCol];column&&column.modules.vdomHoz.leftPos>_this171.vDomScrollPosRight?(changes=!0,_this171.getVisibleRows().forEach((function(row){if("group"!==row.type){var cell=row.getCell(column);try{row.getElement().removeChild(cell.getElement())}catch(ex){console.warn("Could not removeColRight",ex.message)}}})),_this171.vDomPadRight+=column.getWidth(),_this171.rightCol--,_this171.getVisibleRows().forEach((function(row){"group"!==row.type&&(row.modules.vdomHoz.rightCol=_this171.rightCol)}))):working=!1};working;)_loop5();changes&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}},{key:"removeColLeft",value:function(){for(var _this172=this,changes=!1,working=!0,_loop6=function(){var column=_this172.columns[_this172.leftCol];column&&column.modules.vdomHoz.rightPos<_this172.vDomScrollPosLeft?(changes=!0,_this172.getVisibleRows().forEach((function(row){if("group"!==row.type){var cell=row.getCell(column);try{row.getElement().removeChild(cell.getElement())}catch(ex){console.warn("Could not removeColLeft",ex.message)}}})),_this172.vDomPadLeft+=column.getWidth(),_this172.leftCol++,_this172.getVisibleRows().forEach((function(row){"group"!==row.type&&(row.modules.vdomHoz.leftCol=_this172.leftCol)}))):working=!1};working;)_loop6();changes&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}},{key:"fitDataColActualWidthCheck",value:function(column){var newWidth,widthDiff;return column.modules.vdomHoz.fitDataCheck&&(column.reinitializeWidth(),(widthDiff=(newWidth=column.getWidth())-column.modules.vdomHoz.width)&&(column.modules.vdomHoz.rightPos+=widthDiff,column.modules.vdomHoz.width=newWidth,this.colPositionAdjust(this.columns.indexOf(column)+1,this.columns.length,widthDiff)),column.modules.vdomHoz.fitDataCheck=!1),widthDiff}},{key:"initializeRow",value:function(row){var _this173=this;if("group"!==row.type){row.modules.vdomHoz={leftCol:this.leftCol,rightCol:this.rightCol},this.table.modules.frozenColumns&&this.table.modules.frozenColumns.leftColumns.forEach((function(column){_this173.appendCell(row,column)}));for(var i=this.leftCol;i<=this.rightCol;i++)this.appendCell(row,this.columns[i]);this.table.modules.frozenColumns&&this.table.modules.frozenColumns.rightColumns.forEach((function(column){_this173.appendCell(row,column)}))}}},{key:"appendCell",value:function(row,column){if(column&&column.visible){var cell=row.getCell(column);row.getElement().appendChild(cell.getElement()),cell.cellRendered()}}},{key:"reinitializeRow",value:function(row,force){if("group"!==row.type&&(force||!row.modules.vdomHoz||row.modules.vdomHoz.leftCol!==this.leftCol||row.modules.vdomHoz.rightCol!==this.rightCol)){for(var rowEl=row.getElement();rowEl.firstChild;)rowEl.removeChild(rowEl.firstChild);this.initializeRow(row)}}}]),VirtualDomHorizontal}(Renderer),ColumnManager=function(_CoreFeature7){_inherits(ColumnManager,_CoreFeature7);var _super44=_createSuper(ColumnManager);function ColumnManager(table){var _this174;return _classCallCheck(this,ColumnManager),(_this174=_super44.call(this,table)).blockHozScrollEvent=!1,_this174.headersElement=null,_this174.contentsElement=null,_this174.element=null,_this174.columns=[],_this174.columnsByIndex=[],_this174.columnsByField={},_this174.scrollLeft=0,_this174.optionsList=new OptionsList(_this174.table,"column definition",defaultColumnOptions),_this174.redrawBlock=!1,_this174.redrawBlockUpdate=null,_this174.renderer=null,_this174}return _createClass(ColumnManager,[{key:"initialize",value:function(){this.initializeRenderer(),this.headersElement=this.createHeadersElement(),this.contentsElement=this.createHeaderContentsElement(),this.element=this.createHeaderElement(),this.contentsElement.insertBefore(this.headersElement,this.contentsElement.firstChild),this.element.insertBefore(this.contentsElement,this.element.firstChild),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("scrollbar-vertical",this.padVerticalScrollbar.bind(this))}},{key:"padVerticalScrollbar",value:function(width){this.table.rtl?this.headersElement.style.marginLeft=width+"px":this.headersElement.style.marginRight=width+"px"}},{key:"initializeRenderer",value:function(){var renderClass,renderers={virtual:VirtualDomHorizontal,basic:BasicHorizontal};(renderClass="string"==typeof this.table.options.renderHorizontal?renderers[this.table.options.renderHorizontal]:this.table.options.renderHorizontal)?(this.renderer=new renderClass(this.table,this.element,this.tableElement),this.renderer.initialize()):console.error("Unable to find matching renderer:",this.table.options.renderHorizontal)}},{key:"createHeadersElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-headers"),el.setAttribute("role","row"),el}},{key:"createHeaderContentsElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-header-contents"),el.setAttribute("role","rowgroup"),el}},{key:"createHeaderElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-header"),el.setAttribute("role","rowgroup"),this.table.options.headerVisible||el.classList.add("tabulator-header-hidden"),el}},{key:"getElement",value:function(){return this.element}},{key:"getContentsElement",value:function(){return this.contentsElement}},{key:"getHeadersElement",value:function(){return this.headersElement}},{key:"scrollHorizontal",value:function(left){this.contentsElement.scrollLeft=left,this.scrollLeft=left,this.renderer.scrollColumns(left)}},{key:"generateColumnsFromRowData",value:function(data){var row,sorter,cols=[],definitions=this.table.options.autoColumnsDefinitions;if(data&&data.length){for(var key in row=data[0]){var col={field:key,title:key},value=row[key];switch(_typeof(value)){case"undefined":sorter="string";break;case"boolean":sorter="boolean";break;case"object":sorter=Array.isArray(value)?"array":"string";break;default:sorter=isNaN(value)||""===value?value.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)?"alphanum":"string":"number"}col.sorter=sorter,cols.push(col)}if(definitions)switch(_typeof(definitions)){case"function":this.table.options.columns=definitions.call(this.table,cols);break;case"object":Array.isArray(definitions)?cols.forEach((function(col){var match=definitions.find((function(def){return def.field===col.field}));match&&Object.assign(col,match)})):cols.forEach((function(col){definitions[col.field]&&Object.assign(col,definitions[col.field])})),this.table.options.columns=cols}else this.table.options.columns=cols;this.setColumns(this.table.options.columns)}}},{key:"setColumns",value:function(cols,row){for(var _this175=this;this.headersElement.firstChild;)this.headersElement.removeChild(this.headersElement.firstChild);this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.dispatch("columns-loading"),cols.forEach((function(def,i){_this175._addColumn(def)})),this._reIndexColumns(),this.dispatch("columns-loaded"),this.rerenderColumns(!1,!0),this.redraw(!0)}},{key:"_addColumn",value:function(definition,before,nextToColumn){var column=new Column(definition,this),colEl=column.getElement(),index=nextToColumn?this.findColumnIndex(nextToColumn):nextToColumn;if(nextToColumn&&index>-1){var topColumn=nextToColumn.getTopColumn(),parentIndex=this.columns.indexOf(topColumn),nextEl=topColumn.getElement();before?(this.columns.splice(parentIndex,0,column),nextEl.parentNode.insertBefore(colEl,nextEl)):(this.columns.splice(parentIndex+1,0,column),nextEl.parentNode.insertBefore(colEl,nextEl.nextSibling))}else before?(this.columns.unshift(column),this.headersElement.insertBefore(column.getElement(),this.headersElement.firstChild)):(this.columns.push(column),this.headersElement.appendChild(column.getElement()));return column.columnRendered(),column}},{key:"registerColumnField",value:function(col){col.definition.field&&(this.columnsByField[col.definition.field]=col)}},{key:"registerColumnPosition",value:function(col){this.columnsByIndex.push(col)}},{key:"_reIndexColumns",value:function(){this.columnsByIndex=[],this.columns.forEach((function(column){column.reRegisterPosition()}))}},{key:"verticalAlignHeaders",value:function(){var _this176=this,minHeight=0;this.redrawBlock||(this.headersElement.style.height="",this.columns.forEach((function(column){column.clearVerticalAlign()})),this.columns.forEach((function(column){var height=column.getHeight();height>minHeight&&(minHeight=height)})),this.headersElement.style.height=minHeight+"px",this.columns.forEach((function(column){column.verticalAlign(_this176.table.options.columnHeaderVertAlign,minHeight)})),this.table.rowManager.adjustTableSize())}},{key:"findColumn",value:function(subject){var columns;return"object"!=_typeof(subject)?this.columnsByField[subject]||!1:subject instanceof Column?subject:subject instanceof ColumnComponent?subject._getSelf()||!1:"undefined"!=typeof HTMLElement&&subject instanceof HTMLElement&&(columns=[],this.columns.forEach((function(column){columns.push(column),columns=columns.concat(column.getColumns(!0))})),columns.find((function(column){return column.element===subject}))||!1)}},{key:"getColumnByField",value:function(field){return this.columnsByField[field]}},{key:"getColumnsByFieldRoot",value:function(root){var _this177=this,matches=[];return Object.keys(this.columnsByField).forEach((function(field){field.split(".")[0]===root&&matches.push(_this177.columnsByField[field])})),matches}},{key:"getColumnByIndex",value:function(index){return this.columnsByIndex[index]}},{key:"getFirstVisibleColumn",value:function(){var index=this.columnsByIndex.findIndex((function(col){return col.visible}));return index>-1&&this.columnsByIndex[index]}},{key:"getColumns",value:function(){return this.columns}},{key:"findColumnIndex",value:function(column){return this.columnsByIndex.findIndex((function(col){return column===col}))}},{key:"getRealColumns",value:function(){return this.columnsByIndex}},{key:"traverse",value:function(callback){this.columnsByIndex.forEach((function(column,i){callback(column,i)}))}},{key:"getDefinitions",value:function(active){var output=[];return this.columnsByIndex.forEach((function(column){(!active||active&&column.visible)&&output.push(column.getDefinition())})),output}},{key:"getDefinitionTree",value:function(){var output=[];return this.columns.forEach((function(column){output.push(column.getDefinition(!0))})),output}},{key:"getComponents",value:function(structured){var output=[];return(structured?this.columns:this.columnsByIndex).forEach((function(column){output.push(column.getComponent())})),output}},{key:"getWidth",value:function(){var width=0;return this.columnsByIndex.forEach((function(column){column.visible&&(width+=column.getWidth())})),width}},{key:"moveColumn",value:function(from,to,after){to.element.parentNode.insertBefore(from.element,to.element),after&&to.element.parentNode.insertBefore(to.element,from.element),this.moveColumnActual(from,to,after),this.verticalAlignHeaders(),this.table.rowManager.reinitialize()}},{key:"moveColumnActual",value:function(from,to,after){from.parent.isGroup?this._moveColumnInArray(from.parent.columns,from,to,after):this._moveColumnInArray(this.columns,from,to,after),this._moveColumnInArray(this.columnsByIndex,from,to,after,!0),this.rerenderColumns(!0),this.dispatch("column-moved",from,to,after),this.subscribedExternal("columnMoved")&&this.dispatchExternal("columnMoved",from.getComponent(),this.table.columnManager.getComponents())}},{key:"_moveColumnInArray",value:function(columns,from,to,after,updateRows){var toIndex,fromIndex=columns.indexOf(from);fromIndex>-1&&(columns.splice(fromIndex,1),(toIndex=columns.indexOf(to))>-1?after&&(toIndex+=1):toIndex=fromIndex,columns.splice(toIndex,0,from),updateRows&&(this.chain("column-moving-rows",[from,to,after],null,[])||[]).concat(this.table.rowManager.rows).forEach((function(row){if(row.cells.length){var cell=row.cells.splice(fromIndex,1)[0];row.cells.splice(toIndex,0,cell)}})))}},{key:"scrollToColumn",value:function(column,position,ifVisible){var _this178=this,left=0,offset=column.getLeftOffset(),adjust=0,colEl=column.getElement();return new Promise((function(resolve,reject){if(void 0===position&&(position=_this178.table.options.scrollToColumnPosition),void 0===ifVisible&&(ifVisible=_this178.table.options.scrollToColumnIfVisible),column.visible){switch(position){case"middle":case"center":adjust=-_this178.element.clientWidth/2;break;case"right":adjust=colEl.clientWidth-_this178.headersElement.clientWidth}if(!ifVisible&&offset>0&&offset+colEl.offsetWidth<_this178.element.clientWidth)return!1;left=offset+adjust,left=Math.max(Math.min(left,_this178.table.rowManager.element.scrollWidth-_this178.table.rowManager.element.clientWidth),0),_this178.table.rowManager.scrollHorizontal(left),_this178.scrollHorizontal(left),resolve()}else console.warn("Scroll Error - Column not visible"),reject("Scroll Error - Column not visible")}))}},{key:"generateCells",value:function(row){var cells=[];return this.columnsByIndex.forEach((function(column){cells.push(column.generateCell(row))})),cells}},{key:"getFlexBaseWidth",value:function(){var totalWidth=this.table.element.clientWidth,fixedWidth=0;return this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(totalWidth-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),this.columnsByIndex.forEach((function(column){var width,minWidth,colWidth;column.visible&&(width=column.definition.width||0,minWidth=parseInt(column.minWidth),colWidth="string"==typeof width?width.indexOf("%")>-1?totalWidth/100*parseInt(width):parseInt(width):width,fixedWidth+=colWidth>minWidth?colWidth:minWidth)})),fixedWidth}},{key:"addColumn",value:function(definition,before,nextToColumn){var _this179=this;return new Promise((function(resolve,reject){var column=_this179._addColumn(definition,before,nextToColumn);_this179._reIndexColumns(),_this179.dispatch("column-add",definition,before,nextToColumn),"fitColumns"!=_this179.layoutMode()&&column.reinitializeWidth(),_this179.redraw(!0),_this179.table.rowManager.reinitialize(),_this179.rerenderColumns(),resolve(column)}))}},{key:"deregisterColumn",value:function(column){var index,field=column.getField();field&&delete this.columnsByField[field],(index=this.columnsByIndex.indexOf(column))>-1&&this.columnsByIndex.splice(index,1),(index=this.columns.indexOf(column))>-1&&this.columns.splice(index,1),this.verticalAlignHeaders(),this.redraw()}},{key:"rerenderColumns",value:function(update,silent){this.redrawBlock?(!1===update||!0===update&&null===this.redrawBlockUpdate)&&(this.redrawBlockUpdate=update):this.renderer.rerenderColumns(update,silent)}},{key:"blockRedraw",value:function(){this.redrawBlock=!0,this.redrawBlockUpdate=null}},{key:"restoreRedraw",value:function(){this.redrawBlock=!1,this.verticalAlignHeaders(),this.renderer.rerenderColumns(this.redrawBlockUpdate)}},{key:"redraw",value:function(force){Helpers.elVisible(this.element)&&this.verticalAlignHeaders(),force&&(this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),this.confirm("table-redrawing",force)||this.layoutRefresh(force),this.dispatch("table-redraw",force),this.table.footerManager.redraw()}}]),ColumnManager}(CoreFeature),BasicVertical=function(_Renderer3){_inherits(BasicVertical,_Renderer3);var _super45=_createSuper(BasicVertical);function BasicVertical(table){var _this180;return _classCallCheck(this,BasicVertical),(_this180=_super45.call(this,table)).verticalFillMode="fill",_this180.scrollTop=0,_this180.scrollLeft=0,_this180.scrollTop=0,_this180.scrollLeft=0,_this180}return _createClass(BasicVertical,[{key:"clearRows",value:function(){for(var element=this.tableElement;element.firstChild;)element.removeChild(element.firstChild);element.scrollTop=0,element.scrollLeft=0,element.style.minWidth="",element.style.minHeight="",element.style.display="",element.style.visibility=""}},{key:"renderRows",value:function(){var _this181=this,element=this.tableElement,onlyGroupHeaders=!0;this.rows().forEach((function(row,index){_this181.styleRow(row,index),element.appendChild(row.getElement()),row.initialize(!0),"group"!==row.type&&(onlyGroupHeaders=!1)})),element.style.minWidth=onlyGroupHeaders?this.table.columnManager.getWidth()+"px":""}},{key:"rerenderRows",value:function(callback){this.clearRows(),this.renderRows(),callback&&callback()}},{key:"scrollToRowNearestTop",value:function(row){var rowTop=Helpers.elOffset(row.getElement()).top;return!(Math.abs(this.elementVertical.scrollTop-rowTop)>Math.abs(this.elementVertical.scrollTop+this.elementVertical.clientHeight-rowTop))}},{key:"scrollToRow",value:function(row){var rowEl=row.getElement();this.elementVertical.scrollTop=Helpers.elOffset(rowEl).top-Helpers.elOffset(this.elementVertical).top+this.elementVertical.scrollTop}},{key:"visibleRows",value:function(includingBuffer){return this.rows()}}]),BasicVertical}(Renderer),VirtualDomVertical=function(_Renderer4){_inherits(VirtualDomVertical,_Renderer4);var _super46=_createSuper(VirtualDomVertical);function VirtualDomVertical(table){var _this182;return _classCallCheck(this,VirtualDomVertical),(_this182=_super46.call(this,table)).verticalFillMode="fill",_this182.scrollTop=0,_this182.scrollLeft=0,_this182.vDomRowHeight=20,_this182.vDomTop=0,_this182.vDomBottom=0,_this182.vDomScrollPosTop=0,_this182.vDomScrollPosBottom=0,_this182.vDomTopPad=0,_this182.vDomBottomPad=0,_this182.vDomMaxRenderChain=90,_this182.vDomWindowBuffer=0,_this182.vDomWindowMinTotalRows=20,_this182.vDomWindowMinMarginRows=5,_this182.vDomTopNewRows=[],_this182.vDomBottomNewRows=[],_this182}return _createClass(VirtualDomVertical,[{key:"clearRows",value:function(){for(var element=this.tableElement;element.firstChild;)element.removeChild(element.firstChild);element.style.paddingTop="",element.style.paddingBottom="",element.style.minHeight="",element.style.display="",element.style.visibility="",this.elementVertical.scrollTop=0,this.elementVertical.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0,this.vDomTop=0,this.vDomBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0}},{key:"renderRows",value:function(){this._virtualRenderFill()}},{key:"rerenderRows",value:function(callback){for(var scrollTop=this.elementVertical.scrollTop,topRow=!1,topOffset=!1,left=this.table.rowManager.scrollLeft,rows=this.rows(),i=this.vDomTop;i<=this.vDomBottom;i++)if(rows[i]){var diff=scrollTop-rows[i].getElement().offsetTop;if(!(!1===topOffset||Math.abs(diff)<topOffset))break;topOffset=diff,topRow=i}rows.forEach((function(row){row.deinitializeHeight()})),callback&&callback(),this.rows().length?this._virtualRenderFill(!1===topRow?this.rows.length-1:topRow,!0,topOffset||0):(this.clear(),this.table.rowManager._showPlaceholder()),this.scrollColumns(left)}},{key:"scrollColumns",value:function(left){this.table.rowManager.scrollHorizontal(left)}},{key:"scrollRows",value:function(top,dir){var topDiff=top-this.vDomScrollPosTop,bottomDiff=top-this.vDomScrollPosBottom,margin=2*this.vDomWindowBuffer,rows=this.rows();if(this.scrollTop=top,-topDiff>margin||bottomDiff>margin){var left=this.table.rowManager.scrollLeft;this._virtualRenderFill(Math.floor(this.elementVertical.scrollTop/this.elementVertical.scrollHeight*rows.length)),this.scrollColumns(left)}else dir?(topDiff<0&&this._addTopRow(rows,-topDiff),bottomDiff<0&&(this.vDomScrollHeight-this.scrollTop>this.vDomWindowBuffer?this._removeBottomRow(rows,-bottomDiff):this.vDomScrollPosBottom=this.scrollTop)):(bottomDiff>=0&&this._addBottomRow(rows,bottomDiff),topDiff>=0&&(this.scrollTop>this.vDomWindowBuffer?this._removeTopRow(rows,topDiff):this.vDomScrollPosTop=this.scrollTop))}},{key:"resize",value:function(){this.vDomWindowBuffer=this.table.options.renderVerticalBuffer||this.elementVertical.clientHeight}},{key:"scrollToRowNearestTop",value:function(row){var rowIndex=this.rows().indexOf(row);return!(Math.abs(this.vDomTop-rowIndex)>Math.abs(this.vDomBottom-rowIndex))}},{key:"scrollToRow",value:function(row){var index=this.rows().indexOf(row);index>-1&&this._virtualRenderFill(index,!0)}},{key:"visibleRows",value:function(includingBuffer){var topEdge=this.elementVertical.scrollTop,bottomEdge=this.elementVertical.clientHeight+topEdge,topFound=!1,topRow=0,bottomRow=0,rows=this.rows();if(includingBuffer)topRow=this.vDomTop,bottomRow=this.vDomBottom;else for(var i=this.vDomTop;i<=this.vDomBottom;i++)if(rows[i])if(topFound){if(!(bottomEdge-rows[i].getElement().offsetTop>=0))break;bottomRow=i}else if(topEdge-rows[i].getElement().offsetTop>=0)topRow=i;else{if(topFound=!0,!(bottomEdge-rows[i].getElement().offsetTop>=0))break;bottomRow=i}return rows.slice(topRow,bottomRow+1)}},{key:"_virtualRenderFill",value:function(position,forceMove,offset){var element=this.tableElement,holder=this.elementVertical,topPad=0,rowsHeight=0,heightOccupied=0,topPadHeight=0,i=0,rows=this.rows(),rowsCount=rows.length,containerHeight=this.elementVertical.clientHeight;if(offset=offset||0,position=position||0){for(;element.firstChild;)element.removeChild(element.firstChild);(heightOccupied=(rowsCount-position+1)*this.vDomRowHeight)<containerHeight&&(position-=Math.ceil((containerHeight-heightOccupied)/this.vDomRowHeight))<0&&(position=0),position-=topPad=Math.min(Math.max(Math.floor(this.vDomWindowBuffer/this.vDomRowHeight),this.vDomWindowMinMarginRows),position)}else this.clear();if(rowsCount&&Helpers.elVisible(this.elementVertical)){for(this.vDomTop=position,this.vDomBottom=position-1;(rowsHeight<=containerHeight+this.vDomWindowBuffer||i<this.vDomWindowMinTotalRows)&&this.vDomBottom<rowsCount-1;){var rowHeight,index=this.vDomBottom+1,row=rows[index];this.styleRow(row,index),element.appendChild(row.getElement()),row.initialize(),row.heightInitialized||row.normalizeHeight(!0),rowHeight=row.getHeight(),i<topPad?topPadHeight+=rowHeight:rowsHeight+=rowHeight,rowHeight>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*rowHeight),this.vDomBottom++,i++}position?(this.vDomTopPad=forceMove?this.vDomRowHeight*this.vDomTop+offset:this.scrollTop-topPadHeight,this.vDomBottomPad=this.vDomBottom==rowsCount-1?0:Math.max(this.vDomScrollHeight-this.vDomTopPad-rowsHeight-topPadHeight,0)):(this.vDomTopPad=0,this.vDomRowHeight=Math.floor((rowsHeight+topPadHeight)/i),this.vDomBottomPad=this.vDomRowHeight*(rowsCount-this.vDomBottom-1),this.vDomScrollHeight=topPadHeight+rowsHeight+this.vDomBottomPad-containerHeight),element.style.paddingTop=this.vDomTopPad+"px",element.style.paddingBottom=this.vDomBottomPad+"px",forceMove&&(this.scrollTop=this.vDomTopPad+topPadHeight+offset-(this.elementVertical.scrollWidth>this.elementVertical.clientWidth?this.elementVertical.offsetHeight-containerHeight:0)),this.scrollTop=Math.min(this.scrollTop,this.elementVertical.scrollHeight-containerHeight),this.elementVertical.scrollWidth>this.elementVertical.offsetWidth&&forceMove&&(this.scrollTop+=this.elementVertical.offsetHeight-containerHeight),this.vDomScrollPosTop=this.scrollTop,this.vDomScrollPosBottom=this.scrollTop,holder.scrollTop=this.scrollTop,this.dispatch("render-virtual-fill")}}},{key:"_addTopRow",value:function(rows,fillableSpace){for(var table=this.tableElement,addedRows=[],paddingAdjust=0,index=this.vDomTop-1,i=0,working=!0;working;)if(this.vDomTop){var row=rows[index],rowHeight=void 0,initialized=void 0;row&&i<this.vDomMaxRenderChain?(rowHeight=row.getHeight()||this.vDomRowHeight,initialized=row.initialized,fillableSpace>=rowHeight?(this.styleRow(row,index),table.insertBefore(row.getElement(),table.firstChild),row.initialized&&row.heightInitialized||addedRows.push(row),row.initialize(),initialized||(rowHeight=row.getElement().offsetHeight)>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*rowHeight),fillableSpace-=rowHeight,paddingAdjust+=rowHeight,this.vDomTop--,index--,i++):working=!1):working=!1}else working=!1;for(var _i3=0,_addedRows=addedRows;_i3<_addedRows.length;_i3++){_addedRows[_i3].clearCellHeight()}this._quickNormalizeRowHeight(addedRows),paddingAdjust&&(this.vDomTopPad-=paddingAdjust,this.vDomTopPad<0&&(this.vDomTopPad=index*this.vDomRowHeight),index<1&&(this.vDomTopPad=0),table.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop-=paddingAdjust)}},{key:"_removeTopRow",value:function(rows,fillableSpace){for(var removableRows=[],paddingAdjust=0,i=0,working=!0;working;){var row=rows[this.vDomTop],rowHeight=void 0;row&&i<this.vDomMaxRenderChain&&fillableSpace>=(rowHeight=row.getHeight()||this.vDomRowHeight)?(this.vDomTop++,fillableSpace-=rowHeight,paddingAdjust+=rowHeight,removableRows.push(row),i++):working=!1}for(var _i4=0,_removableRows=removableRows;_i4<_removableRows.length;_i4++){var rowEl=_removableRows[_i4].getElement();rowEl.parentNode&&rowEl.parentNode.removeChild(rowEl)}paddingAdjust&&(this.vDomTopPad+=paddingAdjust,this.tableElement.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop+=this.vDomTop?paddingAdjust:paddingAdjust+this.vDomWindowBuffer)}},{key:"_addBottomRow",value:function(rows,fillableSpace){for(var table=this.tableElement,addedRows=[],paddingAdjust=0,index=this.vDomBottom+1,i=0,working=!0;working;){var row=rows[index],rowHeight=void 0,initialized=void 0;row&&i<this.vDomMaxRenderChain?(rowHeight=row.getHeight()||this.vDomRowHeight,initialized=row.initialized,fillableSpace>=rowHeight?(this.styleRow(row,index),table.appendChild(row.getElement()),row.initialized&&row.heightInitialized||addedRows.push(row),row.initialize(),initialized||(rowHeight=row.getElement().offsetHeight)>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*rowHeight),fillableSpace-=rowHeight,paddingAdjust+=rowHeight,this.vDomBottom++,index++,i++):working=!1):working=!1}for(var _i5=0,_addedRows2=addedRows;_i5<_addedRows2.length;_i5++){_addedRows2[_i5].clearCellHeight()}this._quickNormalizeRowHeight(addedRows),paddingAdjust&&(this.vDomBottomPad-=paddingAdjust,(this.vDomBottomPad<0||index==rows.length-1)&&(this.vDomBottomPad=0),table.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom+=paddingAdjust)}},{key:"_removeBottomRow",value:function(rows,fillableSpace){for(var removableRows=[],paddingAdjust=0,i=0,working=!0;working;){var row=rows[this.vDomBottom],rowHeight=void 0;row&&i<this.vDomMaxRenderChain&&fillableSpace>=(rowHeight=row.getHeight()||this.vDomRowHeight)?(this.vDomBottom--,fillableSpace-=rowHeight,paddingAdjust+=rowHeight,removableRows.push(row),i++):working=!1}for(var _i6=0,_removableRows2=removableRows;_i6<_removableRows2.length;_i6++){var rowEl=_removableRows2[_i6].getElement();rowEl.parentNode&&rowEl.parentNode.removeChild(rowEl)}paddingAdjust&&(this.vDomBottomPad+=paddingAdjust,this.vDomBottomPad<0&&(this.vDomBottomPad=0),this.tableElement.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom-=paddingAdjust)}},{key:"_quickNormalizeRowHeight",value:function(rows){var _step4,_iterator4=_createForOfIteratorHelper(rows);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){_step4.value.calcHeight()}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}var _step5,_iterator5=_createForOfIteratorHelper(rows);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){_step5.value.setCellHeight()}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}}]),VirtualDomVertical}(Renderer),RowManager=function(_CoreFeature8){_inherits(RowManager,_CoreFeature8);var _super47=_createSuper(RowManager);function RowManager(table){var _this183;return _classCallCheck(this,RowManager),(_this183=_super47.call(this,table)).element=_this183.createHolderElement(),_this183.tableElement=_this183.createTableElement(),_this183.heightFixer=_this183.createTableElement(),_this183.placeholder=null,_this183.placeholderContents=null,_this183.firstRender=!1,_this183.renderMode="virtual",_this183.fixedHeight=!1,_this183.rows=[],_this183.activeRowsPipeline=[],_this183.activeRows=[],_this183.activeRowsCount=0,_this183.displayRows=[],_this183.displayRowsCount=0,_this183.scrollTop=0,_this183.scrollLeft=0,_this183.redrawBlock=!1,_this183.redrawBlockRestoreConfig=!1,_this183.redrawBlockRenderInPosition=!1,_this183.dataPipeline=[],_this183.displayPipeline=[],_this183.scrollbarWidth=0,_this183.renderer=null,_this183}return _createClass(RowManager,[{key:"createHolderElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-tableholder"),el.setAttribute("tabindex",0),el}},{key:"createTableElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-table"),el.setAttribute("role","rowgroup"),el}},{key:"initializePlaceholder",value:function(){if("string"==typeof this.table.options.placeholder){var el=document.createElement("div");el.classList.add("tabulator-placeholder");var contents=document.createElement("div");contents.classList.add("tabulator-placeholder-contents"),contents.innerHTML=this.table.options.placeholder,el.appendChild(contents),this.placeholderContents=contents,this.placeholder=el}}},{key:"getElement",value:function(){return this.element}},{key:"getTableElement",value:function(){return this.tableElement}},{key:"initialize",value:function(){var _this184=this;this.initializePlaceholder(),this.initializeRenderer(),this.element.appendChild(this.tableElement),this.firstRender=!0,this.element.addEventListener("scroll",(function(){var left=_this184.element.scrollLeft,leftDir=_this184.scrollLeft>left,top=_this184.element.scrollTop,topDir=_this184.scrollTop>top;_this184.scrollLeft!=left&&(_this184.scrollLeft=left,_this184.dispatch("scroll-horizontal",left,leftDir),_this184.dispatchExternal("scrollHorizontal",left,leftDir),_this184._positionPlaceholder()),_this184.scrollTop!=top&&(_this184.scrollTop=top,_this184.renderer.scrollRows(top,topDir),_this184.dispatch("scroll-vertical",top,topDir),_this184.dispatchExternal("scrollVertical",top,topDir))}))}},{key:"findRow",value:function(subject){var _this185=this;return"object"!=_typeof(subject)?void 0!==subject&&(this.rows.find((function(row){return row.data[_this185.table.options.index]==subject}))||!1):subject instanceof Row?subject:subject instanceof RowComponent?subject._getSelf()||!1:"undefined"!=typeof HTMLElement&&subject instanceof HTMLElement&&this.rows.find((function(row){return row.getElement()===subject}))||!1}},{key:"getRowFromDataObject",value:function(data){return this.rows.find((function(row){return row.data===data}))||!1}},{key:"getRowFromPosition",value:function(position){return this.getDisplayRows().find((function(row){return row.getPosition()===position&&row.isDisplayed()}))}},{key:"scrollToRow",value:function(row,position,ifVisible){return this.renderer.scrollToRowPosition(row,position,ifVisible)}},{key:"setData",value:function(data,renderInPosition,columnsChanged){var _this186=this;return new Promise((function(resolve,reject){renderInPosition&&_this186.getDisplayRows().length?_this186.table.options.pagination?_this186._setDataActual(data,!0):_this186.reRenderInPosition((function(){_this186._setDataActual(data)})):(_this186.table.options.autoColumns&&columnsChanged&&_this186.table.initialized&&_this186.table.columnManager.generateColumnsFromRowData(data),_this186.resetScroll(),_this186._setDataActual(data)),resolve()}))}},{key:"_setDataActual",value:function(data,renderInPosition){var _this187=this;this.dispatchExternal("dataProcessing",data),this._wipeElements(),Array.isArray(data)?(this.dispatch("data-processing",data),data.forEach((function(def,i){if(def&&"object"===_typeof(def)){var row=new Row(def,_this187);_this187.rows.push(row)}else console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:",def)})),this.refreshActiveData(!1,!1,renderInPosition),this.dispatch("data-processed",data),this.dispatchExternal("dataProcessed",data)):console.error("Data Loading Error - Unable to process data due to invalid data type \nExpecting: array \nReceived: ",_typeof(data),"\nData:     ",data)}},{key:"_wipeElements",value:function(){this.dispatch("rows-wipe"),this.rows.forEach((function(row){row.wipe()})),this.rows=[],this.activeRows=[],this.activeRowsPipeline=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.adjustTableSize()}},{key:"deleteRow",value:function(row,blockRedraw){var allIndex=this.rows.indexOf(row),activeIndex=this.activeRows.indexOf(row);activeIndex>-1&&this.activeRows.splice(activeIndex,1),allIndex>-1&&this.rows.splice(allIndex,1),this.setActiveRows(this.activeRows),this.displayRowIterator((function(rows){var displayIndex=rows.indexOf(row);displayIndex>-1&&rows.splice(displayIndex,1)})),blockRedraw||this.reRenderInPosition(),this.regenerateRowPositions(),this.dispatchExternal("rowDeleted",row.getComponent()),this.displayRowsCount||this._showPlaceholder(),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.getData())}},{key:"addRow",value:function(data,pos,index,blockRedraw){return this.addRowActual(data,pos,index,blockRedraw)}},{key:"addRows",value:function(data,pos,index){var _this188=this,rows=[];return new Promise((function(resolve,reject){pos=_this188.findAddRowPos(pos),Array.isArray(data)||(data=[data]),(void 0===index&&pos||void 0!==index&&!pos)&&data.reverse(),data.forEach((function(item,i){var row=_this188.addRow(item,pos,index,!0);rows.push(row),_this188.dispatch("row-added",row,data,pos,index)})),_this188.refreshActiveData(!1,!1,!0),_this188.regenerateRowPositions(),rows.length&&_this188._clearPlaceholder(),resolve(rows)}))}},{key:"findAddRowPos",value:function(pos){return void 0===pos&&(pos=this.table.options.addRowPos),"pos"===pos&&(pos=!0),"bottom"===pos&&(pos=!1),pos}},{key:"addRowActual",value:function(data,pos,index,blockRedraw){var activeIndex,chainResult,row=data instanceof Row?data:new Row(data||{},this),top=this.findAddRowPos(pos),allIndex=-1;return index||(chainResult=this.chain("row-adding-position",[row,top],null,{index:index,top:top}),index=chainResult.index,top=chainResult.top),void 0!==index&&(index=this.findRow(index)),(index=this.chain("row-adding-index",[row,index,top],null,index))&&(allIndex=this.rows.indexOf(index)),index&&allIndex>-1?(activeIndex=this.activeRows.indexOf(index),this.displayRowIterator((function(rows){var displayIndex=rows.indexOf(index);displayIndex>-1&&rows.splice(top?displayIndex:displayIndex+1,0,row)})),activeIndex>-1&&this.activeRows.splice(top?activeIndex:activeIndex+1,0,row),this.rows.splice(top?allIndex:allIndex+1,0,row)):top?(this.displayRowIterator((function(rows){rows.unshift(row)})),this.activeRows.unshift(row),this.rows.unshift(row)):(this.displayRowIterator((function(rows){rows.push(row)})),this.activeRows.push(row),this.rows.push(row)),this.setActiveRows(this.activeRows),this.dispatchExternal("rowAdded",row.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),blockRedraw||this.reRenderInPosition(),row}},{key:"moveRow",value:function(from,to,after){this.dispatch("row-move",from,to,after),this.moveRowActual(from,to,after),this.regenerateRowPositions(),this.dispatch("row-moved",from,to,after),this.dispatchExternal("rowMoved",from.getComponent())}},{key:"moveRowActual",value:function(from,to,after){var _this189=this;this.moveRowInArray(this.rows,from,to,after),this.moveRowInArray(this.activeRows,from,to,after),this.displayRowIterator((function(rows){_this189.moveRowInArray(rows,from,to,after)})),this.dispatch("row-moving",from,to,after)}},{key:"moveRowInArray",value:function(rows,from,to,after){var fromIndex,toIndex,end;if(from!==to&&((fromIndex=rows.indexOf(from))>-1&&(rows.splice(fromIndex,1),(toIndex=rows.indexOf(to))>-1?after?rows.splice(toIndex+1,0,from):rows.splice(toIndex,0,from):rows.splice(fromIndex,0,from)),rows===this.getDisplayRows())){end=toIndex>fromIndex?toIndex:fromIndex+1;for(var i=fromIndex<toIndex?fromIndex:toIndex;i<=end;i++)rows[i]&&this.styleRow(rows[i],i)}}},{key:"clearData",value:function(){this.setData([])}},{key:"getRowIndex",value:function(row){return this.findRowIndex(row,this.rows)}},{key:"getDisplayRowIndex",value:function(row){var index=this.getDisplayRows().indexOf(row);return index>-1&&index}},{key:"nextDisplayRow",value:function(row,rowOnly){var index=this.getDisplayRowIndex(row),nextRow=!1;return!1!==index&&index<this.displayRowsCount-1&&(nextRow=this.getDisplayRows()[index+1]),!nextRow||nextRow instanceof Row&&"row"==nextRow.type?nextRow:this.nextDisplayRow(nextRow,rowOnly)}},{key:"prevDisplayRow",value:function(row,rowOnly){var index=this.getDisplayRowIndex(row),prevRow=!1;return index&&(prevRow=this.getDisplayRows()[index-1]),!rowOnly||!prevRow||prevRow instanceof Row&&"row"==prevRow.type?prevRow:this.prevDisplayRow(prevRow,rowOnly)}},{key:"findRowIndex",value:function(row,list){var rowIndex;return!!((row=this.findRow(row))&&(rowIndex=list.indexOf(row))>-1)&&rowIndex}},{key:"getData",value:function(active,transform){var output=[];return this.getRows(active).forEach((function(row){"row"==row.type&&output.push(row.getData(transform||"data"))})),output}},{key:"getComponents",value:function(active){var output=[];return this.getRows(active).forEach((function(row){output.push(row.getComponent())})),output}},{key:"getDataCount",value:function(active){return this.getRows(active).length}},{key:"scrollHorizontal",value:function(left){this.scrollLeft=left,this.element.scrollLeft=left,this.dispatch("scroll-horizontal",left)}},{key:"registerDataPipelineHandler",value:function(handler,priority){void 0!==priority?(this.dataPipeline.push({handler:handler,priority:priority}),this.dataPipeline.sort((function(a,b){return a.priority-b.priority}))):console.error("Data pipeline handlers must have a priority in order to be registered")}},{key:"registerDisplayPipelineHandler",value:function(handler,priority){void 0!==priority?(this.displayPipeline.push({handler:handler,priority:priority}),this.displayPipeline.sort((function(a,b){return a.priority-b.priority}))):console.error("Display pipeline handlers must have a priority in order to be registered")}},{key:"refreshActiveData",value:function(handler,skipStage,renderInPosition){var table=this.table,stage="",index=0,cascadeOrder=["all","dataPipeline","display","displayPipeline","end"];if(!this.table.destroyed){if("function"==typeof handler)if((index=this.dataPipeline.findIndex((function(item){return item.handler===handler})))>-1)stage="dataPipeline",skipStage&&(index==this.dataPipeline.length-1?stage="display":index++);else{if(!((index=this.displayPipeline.findIndex((function(item){return item.handler===handler})))>-1))return void console.error("Unable to refresh data, invalid handler provided",handler);stage="displayPipeline",skipStage&&(index==this.displayPipeline.length-1?stage="end":index++)}else stage=handler||"all",index=0;if(this.redrawBlock)return void((!this.redrawBlockRestoreConfig||this.redrawBlockRestoreConfig&&(this.redrawBlockRestoreConfig.stage===stage&&index<this.redrawBlockRestoreConfig.index||cascadeOrder.indexOf(stage)<cascadeOrder.indexOf(this.redrawBlockRestoreConfig.stage)))&&(this.redrawBlockRestoreConfig={handler:handler,skipStage:skipStage,renderInPosition:renderInPosition,stage:stage,index:index}));Helpers.elVisible(this.element)?renderInPosition?this.reRenderInPosition(this.refreshPipelines.bind(this,handler,stage,index,renderInPosition)):(this.refreshPipelines(handler,stage,index,renderInPosition),handler||this.table.columnManager.renderer.renderColumns(),this.renderTable(),table.options.layoutColumnsOnNewData&&this.table.columnManager.redraw(!0)):this.refreshPipelines(handler,stage,index,renderInPosition),this.dispatch("data-refreshed")}}},{key:"refreshPipelines",value:function(handler,stage,index,renderInPosition){switch(this.dispatch("data-refreshing"),handler||(this.activeRowsPipeline[0]=this.rows.slice(0)),stage){case"all":case"dataPipeline":for(var i=index;i<this.dataPipeline.length;i++){var result=this.dataPipeline[i].handler(this.activeRowsPipeline[i].slice(0));this.activeRowsPipeline[i+1]=result||this.activeRowsPipeline[i].slice(0)}this.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]);case"display":index=0,this.resetDisplayRows();case"displayPipeline":for(var _i7=index;_i7<this.displayPipeline.length;_i7++){var _result=this.displayPipeline[_i7].handler((_i7?this.getDisplayRows(_i7-1):this.activeRows).slice(0),renderInPosition);this.setDisplayRows(_result||this.getDisplayRows(_i7-1).slice(0),_i7)}case"end":this.regenerateRowPositions()}this.getDisplayRows().length&&this._clearPlaceholder()}},{key:"regenerateRowPositions",value:function(){var rows=this.getDisplayRows(),index=1;rows.forEach((function(row){"row"===row.type&&(row.setPosition(index),index++)}))}},{key:"setActiveRows",value:function(activeRows){this.activeRows=activeRows,this.activeRowsCount=this.activeRows.length}},{key:"resetDisplayRows",value:function(){this.displayRows=[],this.displayRows.push(this.activeRows.slice(0)),this.displayRowsCount=this.displayRows[0].length}},{key:"setDisplayRows",value:function(displayRows,index){this.displayRows[index]=displayRows,index==this.displayRows.length-1&&(this.displayRowsCount=this.displayRows[this.displayRows.length-1].length)}},{key:"getDisplayRows",value:function(index){return void 0===index?this.displayRows.length?this.displayRows[this.displayRows.length-1]:[]:this.displayRows[index]||[]}},{key:"getVisibleRows",value:function(chain,viewable){var rows=Object.assign([],this.renderer.visibleRows(!viewable));return chain&&(rows=this.chain("rows-visible",[viewable],rows,rows)),rows}},{key:"displayRowIterator",value:function(callback){this.activeRowsPipeline.forEach(callback),this.displayRows.forEach(callback),this.displayRowsCount=this.displayRows[this.displayRows.length-1].length}},{key:"getRows",value:function(type){var rows=[];if(type&&!0!==type)switch(type){case"active":rows=this.activeRows;break;case"display":rows=this.table.rowManager.getDisplayRows();break;case"visible":rows=this.getVisibleRows(!1,!0)}else rows=this.chain("rows-retrieve",type,null,this.rows)||this.rows;return rows}},{key:"reRenderInPosition",value:function(callback){this.redrawBlock?callback?callback():this.redrawBlockRenderInPosition=!0:(this.dispatchExternal("renderStarted"),this.renderer.rerenderRows(callback),this.fixedHeight||this.adjustTableSize(),this.scrollBarCheck(),this.dispatchExternal("renderComplete"))}},{key:"scrollBarCheck",value:function(){var scrollbarWidth=0;this.element.scrollHeight>this.element.clientHeight&&(scrollbarWidth=this.element.offsetWidth-this.element.clientWidth),scrollbarWidth!==this.scrollbarWidth&&(this.scrollbarWidth=scrollbarWidth,this.dispatch("scrollbar-vertical",scrollbarWidth))}},{key:"initializeRenderer",value:function(){var renderClass,renderers={virtual:VirtualDomVertical,basic:BasicVertical};(renderClass="string"==typeof this.table.options.renderVertical?renderers[this.table.options.renderVertical]:this.table.options.renderVertical)?(this.renderMode=this.table.options.renderVertical,this.renderer=new renderClass(this.table,this.element,this.tableElement),this.renderer.initialize(),this.table.element.clientHeight||this.table.options.height?this.fixedHeight=!0:this.fixedHeight=!1):console.error("Unable to find matching renderer:",this.table.options.renderVertical)}},{key:"getRenderMode",value:function(){return this.renderMode}},{key:"renderTable",value:function(){this.dispatchExternal("renderStarted"),this.element.scrollTop=0,this._clearTable(),this.displayRowsCount?(this.renderer.renderRows(),this.firstRender&&(this.firstRender=!1,this.layoutRefresh(!0))):this.renderEmptyScroll(),this.fixedHeight||this.adjustTableSize(),this.dispatch("table-layout"),this.displayRowsCount||this._showPlaceholder(),this.scrollBarCheck(),this.dispatchExternal("renderComplete")}},{key:"renderEmptyScroll",value:function(){this.placeholder?this.tableElement.style.display="none":this.tableElement.style.minWidth=this.table.columnManager.getWidth()+"px"}},{key:"_clearTable",value:function(){this._clearPlaceholder(),this.scrollTop=0,this.scrollLeft=0,this.renderer.clearRows()}},{key:"_showPlaceholder",value:function(){this.placeholder&&(this.placeholder.setAttribute("tabulator-render-mode",this.renderMode),this.getElement().appendChild(this.placeholder),this._positionPlaceholder())}},{key:"_clearPlaceholder",value:function(){this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.tableElement.style.minWidth=""}},{key:"_positionPlaceholder",value:function(){this.placeholder&&this.placeholder.parentNode&&(this.placeholder.style.width=this.table.columnManager.getWidth()+"px",this.placeholderContents.style.width=this.table.rowManager.element.clientWidth+"px",this.placeholderContents.style.marginLeft=this.scrollLeft+"px")}},{key:"styleRow",value:function(row,index){var rowEl=row.getElement();index%2?(rowEl.classList.add("tabulator-row-even"),rowEl.classList.remove("tabulator-row-odd")):(rowEl.classList.add("tabulator-row-odd"),rowEl.classList.remove("tabulator-row-even"))}},{key:"normalizeHeight",value:function(){this.activeRows.forEach((function(row){row.normalizeHeight()}))}},{key:"adjustTableSize",value:function(){var minHeight,initialHeight=this.element.clientHeight;if("fill"===this.renderer.verticalFillMode){var otherHeight=Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height+(this.table.footerManager&&this.table.footerManager.active&&!this.table.footerManager.external?this.table.footerManager.getElement().getBoundingClientRect().height:0));this.fixedHeight?(minHeight=isNaN(this.table.options.minHeight)?this.table.options.minHeight:this.table.options.minHeight+"px",this.element.style.minHeight=minHeight||"calc(100% - "+otherHeight+"px)",this.element.style.height="calc(100% - "+otherHeight+"px)",this.element.style.maxHeight="calc(100% - "+otherHeight+"px)"):(this.element.style.height="",this.element.style.height=this.table.element.clientHeight-otherHeight+"px",this.element.scrollTop=this.scrollTop),this.renderer.resize(),this.fixedHeight||initialHeight==this.element.clientHeight||(this.subscribed("table-resize")?this.dispatch("table-resize"):this.redraw()),this.scrollBarCheck()}this._positionPlaceholder()}},{key:"reinitialize",value:function(){this.rows.forEach((function(row){row.reinitialize(!0)}))}},{key:"blockRedraw",value:function(){this.redrawBlock=!0,this.redrawBlockRestoreConfig=!1}},{key:"restoreRedraw",value:function(){this.redrawBlock=!1,this.redrawBlockRestoreConfig?(this.refreshActiveData(this.redrawBlockRestoreConfig.handler,this.redrawBlockRestoreConfig.skipStage,this.redrawBlockRestoreConfig.renderInPosition),this.redrawBlockRestoreConfig=!1):this.redrawBlockRenderInPosition&&this.reRenderInPosition(),this.redrawBlockRenderInPosition=!1}},{key:"redraw",value:function(force){var left=this.scrollLeft;this.adjustTableSize(),this.table.tableWidth=this.table.element.clientWidth,force?this.renderTable():(this.reRenderInPosition(),this.scrollHorizontal(left))}},{key:"resetScroll",value:function(){if(this.element.scrollLeft=0,this.element.scrollTop=0,"ie"===this.table.browser){var event=document.createEvent("Event");event.initEvent("scroll",!1,!0),this.element.dispatchEvent(event)}else this.element.dispatchEvent(new Event("scroll"))}}]),RowManager}(CoreFeature),FooterManager=function(_CoreFeature9){_inherits(FooterManager,_CoreFeature9);var _super48=_createSuper(FooterManager);function FooterManager(table){var _this190;return _classCallCheck(this,FooterManager),(_this190=_super48.call(this,table)).active=!1,_this190.element=_this190.createElement(),_this190.containerElement=_this190.createContainerElement(),_this190.external=!1,_this190}return _createClass(FooterManager,[{key:"initialize",value:function(){this.initializeElement()}},{key:"createElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-footer"),el}},{key:"createContainerElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-footer-contents"),this.element.appendChild(el),el}},{key:"initializeElement",value:function(){if(this.table.options.footerElement)if("string"===_typeof(this.table.options.footerElement))"<"===this.table.options.footerElement[0]?this.containerElement.innerHTML=this.table.options.footerElement:(this.external=!0,this.containerElement=document.querySelector(this.table.options.footerElement));else this.element=this.table.options.footerElement}},{key:"getElement",value:function(){return this.element}},{key:"append",value:function(element){this.activate(),this.containerElement.appendChild(element),this.table.rowManager.adjustTableSize()}},{key:"prepend",value:function(element){this.activate(),this.element.insertBefore(element,this.element.firstChild),this.table.rowManager.adjustTableSize()}},{key:"remove",value:function(element){element.parentNode.removeChild(element),this.deactivate()}},{key:"deactivate",value:function(force){this.element.firstChild&&!force||(this.external||this.element.parentNode.removeChild(this.element),this.active=!1)}},{key:"activate",value:function(){this.active||(this.active=!0,this.external||(this.table.element.appendChild(this.getElement()),this.table.element.style.display=""))}},{key:"redraw",value:function(){this.dispatch("footer-redraw")}}]),FooterManager}(CoreFeature),InteractionManager=function(_CoreFeature10){_inherits(InteractionManager,_CoreFeature10);var _super49=_createSuper(InteractionManager);function InteractionManager(table){var _this191;return _classCallCheck(this,InteractionManager),(_this191=_super49.call(this,table)).el=null,_this191.abortClasses=["tabulator-headers","tabulator-table"],_this191.previousTargets={},_this191.listeners=["click","dblclick","contextmenu","mouseenter","mouseleave","mouseover","mouseout","mousemove","mouseup","mousedown","touchstart","touchend"],_this191.componentMap={"tabulator-cell":"cell","tabulator-row":"row","tabulator-group":"group","tabulator-col":"column"},_this191.pseudoTrackers={row:{subscriber:null,target:null},cell:{subscriber:null,target:null},group:{subscriber:null,target:null},column:{subscriber:null,target:null}},_this191.pseudoTracking=!1,_this191}return _createClass(InteractionManager,[{key:"initialize",value:function(){this.el=this.table.element,this.buildListenerMap(),this.bindSubscriptionWatchers()}},{key:"buildListenerMap",value:function(){var listenerMap={};this.listeners.forEach((function(listener){listenerMap[listener]={handler:null,components:[]}})),this.listeners=listenerMap}},{key:"bindPseudoEvents",value:function(){var _this192=this;Object.keys(this.pseudoTrackers).forEach((function(key){_this192.pseudoTrackers[key].subscriber=_this192.pseudoMouseEnter.bind(_this192,key),_this192.subscribe(key+"-mouseover",_this192.pseudoTrackers[key].subscriber)})),this.pseudoTracking=!0}},{key:"pseudoMouseEnter",value:function(key,e,target){this.pseudoTrackers[key].target!==target&&(this.pseudoTrackers[key].target&&this.dispatch(key+"-mouseleave",e,this.pseudoTrackers[key].target),this.pseudoMouseLeave(key,e),this.pseudoTrackers[key].target=target,this.dispatch(key+"-mouseenter",e,target))}},{key:"pseudoMouseLeave",value:function(key,e){var _this193=this,leaveList=Object.keys(this.pseudoTrackers),linkedKeys={row:["cell"],cell:["row"]};(leaveList=leaveList.filter((function(item){var links=linkedKeys[key];return item!==key&&(!links||links&&!links.includes(item))}))).forEach((function(key){var target=_this193.pseudoTrackers[key].target;_this193.pseudoTrackers[key].target&&(_this193.dispatch(key+"-mouseleave",e,target),_this193.pseudoTrackers[key].target=null)}))}},{key:"bindSubscriptionWatchers",value:function(){for(var listeners=Object.keys(this.listeners),_i8=0,_components=Object.values(this.componentMap);_i8<_components.length;_i8++){var _step6,comp=_components[_i8],_iterator6=_createForOfIteratorHelper(listeners);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var listener=_step6.value,key=comp+"-"+listener;this.subscriptionChange(key,this.subscriptionChanged.bind(this,comp,listener))}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}this.subscribe("table-destroy",this.clearWatchers.bind(this))}},{key:"subscriptionChanged",value:function(component,key,added){var listener=this.listeners[key].components,index=listener.indexOf(component),changed=!1;added?-1===index&&(listener.push(component),changed=!0):this.subscribed(component+"-"+key)||index>-1&&(listener.splice(index,1),changed=!0),"mouseenter"!==key&&"mouseleave"!==key||this.pseudoTracking||this.bindPseudoEvents(),changed&&this.updateEventListeners()}},{key:"updateEventListeners",value:function(){for(var key in this.listeners){var listener=this.listeners[key];listener.components.length?listener.handler||(listener.handler=this.track.bind(this,key),this.el.addEventListener(key,listener.handler)):listener.handler&&(this.el.removeEventListener(key,listener.handler),listener.handler=null)}}},{key:"track",value:function(type,e){var path=e.composedPath&&e.composedPath()||e.path,targets=this.findTargets(path);targets=this.bindComponents(type,targets),this.triggerEvents(type,e,targets),!this.pseudoTracking||"mouseover"!=type&&"mouseleave"!=type||Object.keys(targets).length||this.pseudoMouseLeave("none",e)}},{key:"findTargets",value:function(path){var _step7,_this194=this,targets={},componentMap=Object.keys(this.componentMap),_iterator7=_createForOfIteratorHelper(path);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var el=_step7.value,classList=el.classList?_toConsumableArray(el.classList):[];if(classList.filter((function(item){return _this194.abortClasses.includes(item)})).length)break;var _step8,_iterator8=_createForOfIteratorHelper(classList.filter((function(item){return componentMap.includes(item)})));try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var target=_step8.value;targets[this.componentMap[target]]||(targets[this.componentMap[target]]=el)}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}return targets.group&&targets.group===targets.row&&delete targets.row,targets}},{key:"bindComponents",value:function(type,targets){var _step9,_this195=this,keys=Object.keys(targets).reverse(),listener=this.listeners[type],matches={},targetMatches={},_iterator9=_createForOfIteratorHelper(keys);try{var _loop7=function(){var key=_step9.value,component=void 0,target=targets[key],previousTarget=_this195.previousTargets[key];if(previousTarget&&previousTarget.target===target)component=previousTarget.component;else switch(key){case"row":case"group":if(listener.components.includes("row")||listener.components.includes("cell")||listener.components.includes("group"))component=_this195.table.rowManager.getVisibleRows(!0).find((function(row){return row.getElement()===target})),targets.row&&targets.row.parentNode&&targets.row.parentNode.closest(".tabulator-row")&&(targets[key]=!1);break;case"column":listener.components.includes("column")&&(component=_this195.table.columnManager.findColumn(target));break;case"cell":listener.components.includes("cell")&&(matches.row instanceof Row?component=matches.row.findCell(target):targets.row&&console.warn("Event Target Lookup Error - The row this cell is attached to cannot be found, has the table been reinitialized without being destroyed first?"))}component&&(matches[key]=component,targetMatches[key]={target:target,component:component})};for(_iterator9.s();!(_step9=_iterator9.n()).done;)_loop7()}catch(err){_iterator9.e(err)}finally{_iterator9.f()}return this.previousTargets=targetMatches,matches}},{key:"triggerEvents",value:function(type,e,targets){var listener=this.listeners[type];for(var key in targets)targets[key]&&listener.components.includes(key)&&this.dispatch(key+"-"+type,e,targets[key])}},{key:"clearWatchers",value:function(){for(var key in this.listeners){var listener=this.listeners[key];listener.handler&&(this.el.removeEventListener(key,listener.handler),listener.handler=null)}}}]),InteractionManager}(CoreFeature),ComponentFunctionBinder=function(){function ComponentFunctionBinder(table){_classCallCheck(this,ComponentFunctionBinder),this.table=table,this.bindings={}}return _createClass(ComponentFunctionBinder,[{key:"bind",value:function(type,funcName,handler){this.bindings[type]||(this.bindings[type]={}),this.bindings[type][funcName]?console.warn("Unable to bind component handler, a matching function name is already bound",type,funcName,handler):this.bindings[type][funcName]=handler}},{key:"handle",value:function(type,component,name){if(this.bindings[type]&&this.bindings[type][name]&&"function"==typeof this.bindings[type][name].bind)return this.bindings[type][name].bind(null,component);"then"===name||"string"!=typeof name||name.startsWith("_")||this.table.options.debugInvalidComponentFuncs&&console.error("The "+type+" component does not have a "+name+" function, have you checked that you have the correct Tabulator module installed?")}}]),ComponentFunctionBinder}(),DataLoader=function(_CoreFeature11){_inherits(DataLoader,_CoreFeature11);var _super50=_createSuper(DataLoader);function DataLoader(table){var _this196;return _classCallCheck(this,DataLoader),(_this196=_super50.call(this,table)).requestOrder=0,_this196.loading=!1,_this196}return _createClass(DataLoader,[{key:"initialize",value:function(){}},{key:"load",value:function(data,params,config,replace,silent,columnsChanged){var _this197=this,requestNo=++this.requestOrder;return this.dispatchExternal("dataLoading",data),!data||0!=data.indexOf("{")&&0!=data.indexOf("[")||(data=JSON.parse(data)),this.confirm("data-loading",[data,params,config,silent])?(this.loading=!0,silent||this.alertLoader(),params=this.chain("data-params",[data,config,silent],params||{},params||{}),params=this.mapParams(params,this.table.options.dataSendParams),this.chain("data-load",[data,params,config,silent],!1,Promise.resolve([])).then((function(response){Array.isArray(response)||"object"!=_typeof(response)||(response=_this197.mapParams(response,_this197.objectInvert(_this197.table.options.dataReceiveParams)));var rowData=_this197.chain("data-loaded",response,null,response);requestNo==_this197.requestOrder?(_this197.clearAlert(),!1!==rowData&&(_this197.dispatchExternal("dataLoaded",rowData),_this197.table.rowManager.setData(rowData,replace,void 0===columnsChanged?!replace:columnsChanged))):console.warn("Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made")})).catch((function(error){console.error("Data Load Error: ",error),_this197.dispatchExternal("dataLoadError",error),silent||_this197.alertError(),setTimeout((function(){_this197.clearAlert()}),_this197.table.options.dataLoaderErrorTimeout)})).finally((function(){_this197.loading=!1}))):(this.dispatchExternal("dataLoaded",data),data||(data=[]),this.table.rowManager.setData(data,replace,void 0===columnsChanged?!replace:columnsChanged),Promise.resolve())}},{key:"mapParams",value:function(params,map){var output={};for(var key in params)output[map.hasOwnProperty(key)?map[key]:key]=params[key];return output}},{key:"objectInvert",value:function(obj){var output={};for(var key in obj)output[obj[key]]=key;return output}},{key:"blockActiveLoad",value:function(){this.requestOrder++}},{key:"alertLoader",value:function(){("function"==typeof this.table.options.dataLoader?this.table.options.dataLoader():this.table.options.dataLoader)&&this.table.alertManager.alert(this.table.options.dataLoaderLoading||this.langText("data|loading"))}},{key:"alertError",value:function(){this.table.alertManager.alert(this.table.options.dataLoaderError||this.langText("data|error"),"error")}},{key:"clearAlert",value:function(){this.table.alertManager.clear()}}]),DataLoader}(CoreFeature),ExternalEventBus=function(){function ExternalEventBus(table,optionsList,debug){_classCallCheck(this,ExternalEventBus),this.table=table,this.events={},this.optionsList=optionsList||{},this.subscriptionNotifiers={},this.dispatch=debug?this._debugDispatch.bind(this):this._dispatch.bind(this),this.debug=debug}return _createClass(ExternalEventBus,[{key:"subscriptionChange",value:function(key,callback){this.subscriptionNotifiers[key]||(this.subscriptionNotifiers[key]=[]),this.subscriptionNotifiers[key].push(callback),this.subscribed(key)&&this._notifySubscriptionChange(key,!0)}},{key:"subscribe",value:function(key,callback){this.events[key]||(this.events[key]=[]),this.events[key].push(callback),this._notifySubscriptionChange(key,!0)}},{key:"unsubscribe",value:function(key,callback){var index;if(this.events[key]){if(callback){if(!((index=this.events[key].findIndex((function(item){return item===callback})))>-1))return void console.warn("Cannot remove event, no matching event found:",key,callback);this.events[key].splice(index,1)}else delete this.events[key];this._notifySubscriptionChange(key,!1)}else console.warn("Cannot remove event, no events set on:",key)}},{key:"subscribed",value:function(key){return this.events[key]&&this.events[key].length}},{key:"_notifySubscriptionChange",value:function(key,subscribed){var notifiers=this.subscriptionNotifiers[key];notifiers&&notifiers.forEach((function(callback){callback(subscribed)}))}},{key:"_dispatch",value:function(){var result,_this198=this,args=Array.from(arguments),key=args.shift();return this.events[key]&&this.events[key].forEach((function(callback,i){var callResult=callback.apply(_this198.table,args);i||(result=callResult)})),result}},{key:"_debugDispatch",value:function(){var _console,args=Array.from(arguments),key=args[0];(args[0]="ExternalEvent:"+args[0],!0===this.debug||this.debug.includes(key))&&(_console=console).log.apply(_console,_toConsumableArray(args));return this._dispatch.apply(this,arguments)}}]),ExternalEventBus}(),InternalEventBus=function(){function InternalEventBus(debug){_classCallCheck(this,InternalEventBus),this.events={},this.subscriptionNotifiers={},this.dispatch=debug?this._debugDispatch.bind(this):this._dispatch.bind(this),this.chain=debug?this._debugChain.bind(this):this._chain.bind(this),this.confirm=debug?this._debugConfirm.bind(this):this._confirm.bind(this),this.debug=debug}return _createClass(InternalEventBus,[{key:"subscriptionChange",value:function(key,callback){this.subscriptionNotifiers[key]||(this.subscriptionNotifiers[key]=[]),this.subscriptionNotifiers[key].push(callback),this.subscribed(key)&&this._notifySubscriptionChange(key,!0)}},{key:"subscribe",value:function(key,callback){var priority=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;this.events[key]||(this.events[key]=[]),this.events[key].push({callback:callback,priority:priority}),this.events[key].sort((function(a,b){return a.priority-b.priority})),this._notifySubscriptionChange(key,!0)}},{key:"unsubscribe",value:function(key,callback){var index;if(this.events[key]){if(callback){if(!((index=this.events[key].findIndex((function(item){return item.callback===callback})))>-1))return void console.warn("Cannot remove event, no matching event found:",key,callback);this.events[key].splice(index,1)}this._notifySubscriptionChange(key,!1)}else console.warn("Cannot remove event, no events set on:",key)}},{key:"subscribed",value:function(key){return this.events[key]&&this.events[key].length}},{key:"_chain",value:function(key,args,initialValue,fallback){var _this199=this,value=initialValue;return Array.isArray(args)||(args=[args]),this.subscribed(key)?(this.events[key].forEach((function(subscriber,i){value=subscriber.callback.apply(_this199,args.concat([value]))})),value):"function"==typeof fallback?fallback():fallback}},{key:"_confirm",value:function(key,args){var _this200=this,confirmed=!1;return Array.isArray(args)||(args=[args]),this.subscribed(key)&&this.events[key].forEach((function(subscriber,i){subscriber.callback.apply(_this200,args)&&(confirmed=!0)})),confirmed}},{key:"_notifySubscriptionChange",value:function(key,subscribed){var notifiers=this.subscriptionNotifiers[key];notifiers&&notifiers.forEach((function(callback){callback(subscribed)}))}},{key:"_dispatch",value:function(){var _this201=this,args=Array.from(arguments),key=args.shift();this.events[key]&&this.events[key].forEach((function(subscriber){subscriber.callback.apply(_this201,args)}))}},{key:"_debugDispatch",value:function(){var _console2,args=Array.from(arguments),key=args[0];(args[0]="InternalEvent:"+key,!0===this.debug||this.debug.includes(key))&&(_console2=console).log.apply(_console2,_toConsumableArray(args));return this._dispatch.apply(this,arguments)}},{key:"_debugChain",value:function(){var _console3,args=Array.from(arguments),key=args[0];(args[0]="InternalEvent:"+key,!0===this.debug||this.debug.includes(key))&&(_console3=console).log.apply(_console3,_toConsumableArray(args));return this._chain.apply(this,arguments)}},{key:"_debugConfirm",value:function(){var _console4,args=Array.from(arguments),key=args[0];(args[0]="InternalEvent:"+key,!0===this.debug||this.debug.includes(key))&&(_console4=console).log.apply(_console4,_toConsumableArray(args));return this._confirm.apply(this,arguments)}}]),InternalEventBus}(),DeprecationAdvisor=function(_CoreFeature12){_inherits(DeprecationAdvisor,_CoreFeature12);var _super51=_createSuper(DeprecationAdvisor);function DeprecationAdvisor(table){return _classCallCheck(this,DeprecationAdvisor),_super51.call(this,table)}return _createClass(DeprecationAdvisor,[{key:"_warnUser",value:function(){var _console5;this.options("debugDeprecation")&&(_console5=console).warn.apply(_console5,arguments)}},{key:"check",value:function(oldOption,newOption){var msg="";return void 0===this.options(oldOption)||(msg="Deprecated Setup Option - Use of the %c"+oldOption+"%c option is now deprecated",newOption?(msg=msg+", Please use the %c"+newOption+"%c option instead",this._warnUser(msg,"font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;")):this._warnUser(msg,"font-weight: bold;","font-weight: normal;"),!1)}},{key:"checkMsg",value:function(oldOption,msg){return void 0===this.options(oldOption)||(this._warnUser("%cDeprecated Setup Option - Use of the %c"+oldOption+" %c option is now deprecated, "+msg,"font-weight: normal;","font-weight: bold;","font-weight: normal;"),!1)}},{key:"msg",value:function(_msg){this._warnUser(_msg)}}]),DeprecationAdvisor}(CoreFeature),TableRegistry=function(){function TableRegistry(){_classCallCheck(this,TableRegistry)}return _createClass(TableRegistry,null,[{key:"register",value:function(table){TableRegistry.tables.push(table)}},{key:"deregister",value:function(table){var index=TableRegistry.tables.indexOf(table);index>-1&&TableRegistry.tables.splice(index,1)}},{key:"lookupTable",value:function(query,silent){var matches,match,results=[];if("string"==typeof query){if((matches=document.querySelectorAll(query)).length)for(var i=0;i<matches.length;i++)(match=TableRegistry.matchElement(matches[i]))&&results.push(match)}else"undefined"!=typeof HTMLElement&&query instanceof HTMLElement||query instanceof Tabulator?(match=TableRegistry.matchElement(query))&&results.push(match):Array.isArray(query)?query.forEach((function(item){results=results.concat(TableRegistry.lookupTable(item))})):silent||console.warn("Table Connection Error - Invalid Selector",query);return results}},{key:"matchElement",value:function(element){return TableRegistry.tables.find((function(table){return element instanceof Tabulator?table===element:table.element===element}))}}]),TableRegistry}();function fitDataGeneral(columns,forced){columns.forEach((function(column){column.reinitializeWidth()})),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}TableRegistry.tables=[];var defaultModes={fitData:function(columns,forced){forced&&this.table.columnManager.renderer.reinitializeColumnWidths(columns),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitDataFill:fitDataGeneral,fitDataTable:fitDataGeneral,fitDataStretch:function(columns,forced){var _this202=this,colsWidth=0,tableWidth=this.table.rowManager.element.clientWidth,gap=0,lastCol=!1;columns.forEach((function(column,i){column.widthFixed||column.reinitializeWidth(),(_this202.table.options.responsiveLayout?column.modules.responsive.visible:column.visible)&&(lastCol=column),column.visible&&(colsWidth+=column.getWidth())})),lastCol?(gap=tableWidth-colsWidth+lastCol.getWidth(),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&(lastCol.setWidth(0),this.table.modules.responsiveLayout.update()),gap>0?lastCol.setWidth(gap):lastCol.reinitializeWidth()):this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitColumns:function(columns,forced){var flexColWidth,overflowWidth,totalWidth=this.table.rowManager.element.getBoundingClientRect().width,fixedWidth=0,flexWidth=0,flexGrowUnits=0,flexColumns=[],fixedShrinkColumns=[],flexShrinkUnits=0,gapFill=0;function calcWidth(width){return"string"==typeof width?width.indexOf("%")>-1?totalWidth/100*parseInt(width):parseInt(width):width}function scaleColumns(columns,freeSpace,colWidth,shrinkCols){var oversizeCols=[],oversizeSpace=0,remainingSpace=0,nextColWidth=0,remainingFlexGrowUnits=flexGrowUnits,gap=0,changeUnits=0,undersizeCols=[];function calcGrow(col){return colWidth*(col.column.definition.widthGrow||1)}function calcShrink(col){return calcWidth(col.width)-colWidth*(col.column.definition.widthShrink||0)}return columns.forEach((function(col,i){var width=shrinkCols?calcShrink(col):calcGrow(col);col.column.minWidth>=width?oversizeCols.push(col):col.column.maxWidth&&col.column.maxWidth<width?(col.width=col.column.maxWidth,freeSpace-=col.column.maxWidth,(remainingFlexGrowUnits-=shrinkCols?col.column.definition.widthShrink||1:col.column.definition.widthGrow||1)&&(colWidth=Math.floor(freeSpace/remainingFlexGrowUnits))):(undersizeCols.push(col),changeUnits+=shrinkCols?col.column.definition.widthShrink||1:col.column.definition.widthGrow||1)})),oversizeCols.length?(oversizeCols.forEach((function(col){oversizeSpace+=shrinkCols?col.width-col.column.minWidth:col.column.minWidth,col.width=col.column.minWidth})),remainingSpace=freeSpace-oversizeSpace,nextColWidth=changeUnits?Math.floor(remainingSpace/changeUnits):remainingSpace,gap=scaleColumns(undersizeCols,remainingSpace,nextColWidth,shrinkCols)):(gap=changeUnits?freeSpace-Math.floor(freeSpace/changeUnits)*changeUnits:freeSpace,undersizeCols.forEach((function(column){column.width=shrinkCols?calcShrink(column):calcGrow(column)}))),gap}this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(totalWidth-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),columns.forEach((function(column){var width,minWidth,colWidth;column.visible&&(width=column.definition.width,minWidth=parseInt(column.minWidth),width?(colWidth=calcWidth(width),fixedWidth+=colWidth>minWidth?colWidth:minWidth,column.definition.widthShrink&&(fixedShrinkColumns.push({column:column,width:colWidth>minWidth?colWidth:minWidth}),flexShrinkUnits+=column.definition.widthShrink)):(flexColumns.push({column:column,width:0}),flexGrowUnits+=column.definition.widthGrow||1))})),flexWidth=totalWidth-fixedWidth,flexColWidth=Math.floor(flexWidth/flexGrowUnits),gapFill=scaleColumns(flexColumns,flexWidth,flexColWidth,!1),flexColumns.length&&gapFill>0&&(flexColumns[flexColumns.length-1].width+=gapFill),flexColumns.forEach((function(col){flexWidth-=col.width})),(overflowWidth=Math.abs(gapFill)+flexWidth)>0&&flexShrinkUnits&&(gapFill=scaleColumns(fixedShrinkColumns,overflowWidth,Math.floor(overflowWidth/flexShrinkUnits),!0)),gapFill&&fixedShrinkColumns.length&&(fixedShrinkColumns[fixedShrinkColumns.length-1].width-=gapFill),flexColumns.forEach((function(col){col.column.setWidth(col.width)})),fixedShrinkColumns.forEach((function(col){col.column.setWidth(col.width)}))}},Layout=function(_Module36){_inherits(Layout,_Module36);var _super52=_createSuper(Layout);function Layout(table){var _this203;return _classCallCheck(this,Layout),(_this203=_super52.call(this,table,"layout")).mode=null,_this203.registerTableOption("layout","fitData"),_this203.registerTableOption("layoutColumnsOnNewData",!1),_this203.registerColumnOption("widthGrow"),_this203.registerColumnOption("widthShrink"),_this203}return _createClass(Layout,[{key:"initialize",value:function(){var layout=this.table.options.layout;Layout.modes[layout]?this.mode=layout:(console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : "+layout),this.mode="fitData"),this.table.element.setAttribute("tabulator-layout",this.mode)}},{key:"getMode",value:function(){return this.mode}},{key:"layout",value:function(dataChanged){this.dispatch("layout-refreshing"),Layout.modes[this.mode].call(this,this.table.columnManager.columnsByIndex,dataChanged),this.dispatch("layout-refreshed")}}]),Layout}(Module);Layout.moduleName="layout",Layout.modes=defaultModes;var Localize=function(_Module37){_inherits(Localize,_Module37);var _super53=_createSuper(Localize);function Localize(table){var _this204;return _classCallCheck(this,Localize),(_this204=_super53.call(this,table)).locale="default",_this204.lang=!1,_this204.bindings={},_this204.langList={},_this204.registerTableOption("locale",!1),_this204.registerTableOption("langs",{}),_this204}return _createClass(Localize,[{key:"initialize",value:function(){for(var locale in this.langList=Helpers.deepClone(Localize.langs),!1!==this.table.options.columnDefaults.headerFilterPlaceholder&&this.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder),this.table.options.langs)this.installLang(locale,this.table.options.langs[locale]);this.setLocale(this.table.options.locale),this.registerTableFunction("setLocale",this.setLocale.bind(this)),this.registerTableFunction("getLocale",this.getLocale.bind(this)),this.registerTableFunction("getLang",this.getLang.bind(this))}},{key:"setHeaderFilterPlaceholder",value:function(placeholder){this.langList.default.headerFilters.default=placeholder}},{key:"setHeaderFilterColumnPlaceholder",value:function(column,placeholder){this.langList.default.headerFilters.columns[column]=placeholder,this.lang&&!this.lang.headerFilters.columns[column]&&(this.lang.headerFilters.columns[column]=placeholder)}},{key:"installLang",value:function(locale,lang){this.langList[locale]?this._setLangProp(this.langList[locale],lang):this.langList[locale]=lang}},{key:"_setLangProp",value:function(lang,values){for(var key in values)lang[key]&&"object"==_typeof(lang[key])?this._setLangProp(lang[key],values[key]):lang[key]=values[key]}},{key:"setLocale",value:function(desiredLocale){if(!0===(desiredLocale=desiredLocale||"default")&&navigator.language&&(desiredLocale=navigator.language.toLowerCase()),desiredLocale&&!this.langList[desiredLocale]){var prefix=desiredLocale.split("-")[0];this.langList[prefix]?(console.warn("Localization Error - Exact matching locale not found, using closest match: ",desiredLocale,prefix),desiredLocale=prefix):(console.warn("Localization Error - Matching locale not found, using default: ",desiredLocale),desiredLocale="default")}this.locale=desiredLocale,this.lang=Helpers.deepClone(this.langList.default||{}),"default"!=desiredLocale&&function traverseLang(trans,path){for(var prop in trans)"object"==_typeof(trans[prop])?(path[prop]||(path[prop]={}),traverseLang(trans[prop],path[prop])):path[prop]=trans[prop]}(this.langList[desiredLocale],this.lang),this.dispatchExternal("localized",this.locale,this.lang),this._executeBindings()}},{key:"getLocale",value:function(locale){return this.locale}},{key:"getLang",value:function(locale){return locale?this.langList[locale]:this.lang}},{key:"getText",value:function(path,value){var pathArray=(value?path+"|"+value:path).split("|");return this._getLangElement(pathArray,this.locale)||""}},{key:"_getLangElement",value:function(path,locale){var root=this.lang;return path.forEach((function(level){var rootPath;root&&(rootPath=root[level],root=void 0!==rootPath&&rootPath)})),root}},{key:"bind",value:function(path,callback){this.bindings[path]||(this.bindings[path]=[]),this.bindings[path].push(callback),callback(this.getText(path),this.lang)}},{key:"_executeBindings",value:function(){var _this205=this,_loop8=function(path){_this205.bindings[path].forEach((function(binding){binding(_this205.getText(path),_this205.lang)}))};for(var path in this.bindings)_loop8(path)}}]),Localize}(Module);Localize.moduleName="localize",Localize.langs={default:{groups:{item:"item",items:"items"},columns:{},data:{loading:"Loading",error:"Error"},pagination:{page_size:"Page Size",page_title:"Show Page",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page",all:"All",counter:{showing:"Showing",of:"of",rows:"rows",pages:"pages"}},headerFilters:{default:"filter column...",columns:{}}}};var Comms=function(_Module38){_inherits(Comms,_Module38);var _super54=_createSuper(Comms);function Comms(table){return _classCallCheck(this,Comms),_super54.call(this,table)}return _createClass(Comms,[{key:"initialize",value:function(){this.registerTableFunction("tableComms",this.receive.bind(this))}},{key:"getConnections",value:function(selectors){var _this206=this,connections=[];return TableRegistry.lookupTable(selectors).forEach((function(con){_this206.table!==con&&connections.push(con)})),connections}},{key:"send",value:function(selectors,module,action,data){var _this207=this,connections=this.getConnections(selectors);connections.forEach((function(connection){connection.tableComms(_this207.table.element,module,action,data)})),!connections.length&&selectors&&console.warn("Table Connection Error - No tables matching selector found",selectors)}},{key:"receive",value:function(table,module,action,data){if(this.table.modExists(module))return this.table.modules[module].commsReceived(table,action,data);console.warn("Inter-table Comms Error - no such module:",module)}}]),Comms}(Module);Comms.moduleName="comms";var coreModules=Object.freeze({__proto__:null,LayoutModule:Layout,LocalizeModule:Localize,CommsModule:Comms}),ModuleBinder=function(){function ModuleBinder(tabulator,modules){_classCallCheck(this,ModuleBinder),this.bindStaticFunctionality(tabulator),this.bindModules(tabulator,coreModules,!0),modules&&this.bindModules(tabulator,modules)}return _createClass(ModuleBinder,[{key:"bindStaticFunctionality",value:function(tabulator){tabulator.moduleBindings={},tabulator.extendModule=function(name,property,values){if(tabulator.moduleBindings[name]){var source=tabulator.moduleBindings[name][property];if(source)if("object"==_typeof(values))for(var key in values)source[key]=values[key];else console.warn("Module Error - Invalid value type, it must be an object");else console.warn("Module Error - property does not exist:",property)}else console.warn("Module Error - module does not exist:",name)},tabulator.registerModule=function(modules){Array.isArray(modules)||(modules=[modules]),modules.forEach((function(mod){tabulator.registerModuleBinding(mod)}))},tabulator.registerModuleBinding=function(mod){tabulator.moduleBindings[mod.moduleName]=mod},tabulator.findTable=function(query){var results=TableRegistry.lookupTable(query,!0);return!(Array.isArray(results)&&!results.length)&&results},tabulator.prototype.bindModules=function(){var orderedStartMods=[],orderedEndMods=[],unOrderedMods=[];for(var name in this.modules={},tabulator.moduleBindings){var mod=tabulator.moduleBindings[name],module=new mod(this);this.modules[name]=module,mod.prototype.moduleCore?this.modulesCore.push(module):mod.moduleInitOrder?mod.moduleInitOrder<0?orderedStartMods.push(module):orderedEndMods.push(module):unOrderedMods.push(module)}orderedStartMods.sort((function(a,b){return a.moduleInitOrder>b.moduleInitOrder?1:-1})),orderedEndMods.sort((function(a,b){return a.moduleInitOrder>b.moduleInitOrder?1:-1})),this.modulesRegular=orderedStartMods.concat(unOrderedMods.concat(orderedEndMods))}}},{key:"bindModules",value:function(tabulator,modules,core){var mods=Object.values(modules);core&&mods.forEach((function(mod){mod.prototype.moduleCore=!0})),tabulator.registerModule(mods)}}]),ModuleBinder}(),Alert=function(_CoreFeature13){_inherits(Alert,_CoreFeature13);var _super55=_createSuper(Alert);function Alert(table){var _this208;return _classCallCheck(this,Alert),(_this208=_super55.call(this,table)).element=_this208._createAlertElement(),_this208.msgElement=_this208._createMsgElement(),_this208.type=null,_this208.element.appendChild(_this208.msgElement),_this208}return _createClass(Alert,[{key:"_createAlertElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-alert"),el}},{key:"_createMsgElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-alert-msg"),el.setAttribute("role","alert"),el}},{key:"_typeClass",value:function(){return"tabulator-alert-state-"+this.type}},{key:"alert",value:function(content){var type=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"msg";if(content){for(this.clear(),this.type=type;this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.add(this._typeClass()),"function"==typeof content&&(content=content()),content instanceof HTMLElement?this.msgElement.appendChild(content):this.msgElement.innerHTML=content,this.table.element.appendChild(this.element)}}},{key:"clear",value:function(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.msgElement.classList.remove(this._typeClass())}}]),Alert}(CoreFeature),Tabulator=function(){function Tabulator(element,options){var _this209=this;_classCallCheck(this,Tabulator),this.options={},this.columnManager=null,this.rowManager=null,this.footerManager=null,this.alertManager=null,this.vdomHoz=null,this.externalEvents=null,this.eventBus=null,this.interactionMonitor=!1,this.browser="",this.browserSlow=!1,this.browserMobile=!1,this.rtl=!1,this.originalElement=null,this.componentFunctionBinder=new ComponentFunctionBinder(this),this.dataLoader=!1,this.modules={},this.modulesCore=[],this.modulesRegular=[],this.deprecationAdvisor=new DeprecationAdvisor(this),this.optionsList=new OptionsList(this,"table constructor"),this.initialized=!1,this.destroyed=!1,this.initializeElement(element)&&(this.initializeCoreSystems(options),setTimeout((function(){_this209._create()}))),TableRegistry.register(this)}return _createClass(Tabulator,[{key:"initializeElement",value:function(element){return"undefined"!=typeof HTMLElement&&element instanceof HTMLElement?(this.element=element,!0):"string"==typeof element?(this.element=document.querySelector(element),!!this.element||(console.error("Tabulator Creation Error - no element found matching selector: ",element),!1)):(console.error("Tabulator Creation Error - Invalid element provided:",element),!1)}},{key:"initializeCoreSystems",value:function(options){this.columnManager=new ColumnManager(this),this.rowManager=new RowManager(this),this.footerManager=new FooterManager(this),this.dataLoader=new DataLoader(this),this.alertManager=new Alert(this),this.bindModules(),this.options=this.optionsList.generate(Tabulator.defaultOptions,options),this._clearObjectPointers(),this._mapDeprecatedFunctionality(),this.externalEvents=new ExternalEventBus(this,this.options,this.options.debugEventsExternal),this.eventBus=new InternalEventBus(this.options.debugEventsInternal),this.interactionMonitor=new InteractionManager(this),this.dataLoader.initialize(),this.footerManager.initialize()}},{key:"_mapDeprecatedFunctionality",value:function(){}},{key:"_clearSelection",value:function(){this.element.classList.add("tabulator-block-select"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this.element.classList.remove("tabulator-block-select")}},{key:"_create",value:function(){this.externalEvents.dispatch("tableBuilding"),this.eventBus.dispatch("table-building"),this._rtlCheck(),this._buildElement(),this._initializeTable(),this._loadInitialData(),this.initialized=!0,this.externalEvents.dispatch("tableBuilt")}},{key:"_rtlCheck",value:function(){var style=window.getComputedStyle(this.element);switch(this.options.textDirection){case"auto":if("rtl"!==style.direction)break;case"rtl":this.element.classList.add("tabulator-rtl"),this.rtl=!0;break;case"ltr":this.element.classList.add("tabulator-ltr");default:this.rtl=!1}}},{key:"_clearObjectPointers",value:function(){this.options.columns=this.options.columns.slice(0),Array.isArray(this.options.data)&&!this.options.reactiveData&&(this.options.data=this.options.data.slice(0))}},{key:"_buildElement",value:function(){var newElement,element=this.element,options=this.options;if("TABLE"===element.tagName){this.originalElement=this.element,newElement=document.createElement("div");var attributes=element.attributes;for(var i in attributes)"object"==_typeof(attributes[i])&&newElement.setAttribute(attributes[i].name,attributes[i].value);element.parentNode.replaceChild(newElement,element),this.element=element=newElement}for(element.classList.add("tabulator"),element.setAttribute("role","grid");element.firstChild;)element.removeChild(element.firstChild);options.height&&(options.height=isNaN(options.height)?options.height:options.height+"px",element.style.height=options.height),!1!==options.minHeight&&(options.minHeight=isNaN(options.minHeight)?options.minHeight:options.minHeight+"px",element.style.minHeight=options.minHeight),!1!==options.maxHeight&&(options.maxHeight=isNaN(options.maxHeight)?options.maxHeight:options.maxHeight+"px",element.style.maxHeight=options.maxHeight)}},{key:"_initializeTable",value:function(){var element=this.element,options=this.options;this.interactionMonitor.initialize(),this.columnManager.initialize(),this.rowManager.initialize(),this._detectBrowser(),this.modulesCore.forEach((function(mod){mod.initialize()})),element.appendChild(this.columnManager.getElement()),element.appendChild(this.rowManager.getElement()),options.footerElement&&this.footerManager.activate(),options.autoColumns&&options.data&&this.columnManager.generateColumnsFromRowData(this.options.data),this.modulesRegular.forEach((function(mod){mod.initialize()})),this.columnManager.setColumns(options.columns),this.eventBus.dispatch("table-built")}},{key:"_loadInitialData",value:function(){this.dataLoader.load(this.options.data)}},{key:"destroy",value:function(){var element=this.element;for(this.destroyed=!0,TableRegistry.deregister(this),this.eventBus.dispatch("table-destroy"),this.rowManager.rows.forEach((function(row){row.wipe()})),this.rowManager.rows=[],this.rowManager.activeRows=[],this.rowManager.displayRows=[];element.firstChild;)element.removeChild(element.firstChild);element.classList.remove("tabulator"),this.externalEvents.dispatch("tableDestroyed")}},{key:"_detectBrowser",value:function(){var ua=navigator.userAgent||navigator.vendor||window.opera;ua.indexOf("Trident")>-1?(this.browser="ie",this.browserSlow=!0):ua.indexOf("Edge")>-1?(this.browser="edge",this.browserSlow=!0):ua.indexOf("Firefox")>-1?(this.browser="firefox",this.browserSlow=!1):(this.browser="other",this.browserSlow=!1),this.browserMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(ua)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(ua.slice(0,4))}},{key:"initGuard",value:function(func,msg){var stack,line;return this.options.debugInitialization&&!this.initialized&&(func||(func=" "==(line="Error"==(stack=(new Error).stack.split("\n"))[0]?stack[2]:stack[1])[0]?line.trim().split(" ")[1].split(".")[1]:line.trim().split("@")[0]),console.warn("Table Not Initialized - Calling the "+func+" function before the table is initialized may result in inconsistent behavior, Please wait for the `tableBuilt` event before calling this function."+(msg?" "+msg:""))),this.initialized}},{key:"blockRedraw",value:function(){this.initGuard(),this.eventBus.dispatch("redraw-blocking"),this.rowManager.blockRedraw(),this.columnManager.blockRedraw(),this.eventBus.dispatch("redraw-blocked")}},{key:"restoreRedraw",value:function(){this.initGuard(),this.eventBus.dispatch("redraw-restoring"),this.rowManager.restoreRedraw(),this.columnManager.restoreRedraw(),this.eventBus.dispatch("redraw-restored")}},{key:"setData",value:function(data,params,config){return this.initGuard(!1,"To set initial data please use the 'data' property in the table constructor."),this.dataLoader.load(data,params,config,!1)}},{key:"clearData",value:function(){this.initGuard(),this.dataLoader.blockActiveLoad(),this.rowManager.clearData()}},{key:"getData",value:function(active){return this.rowManager.getData(active)}},{key:"getDataCount",value:function(active){return this.rowManager.getDataCount(active)}},{key:"replaceData",value:function(data,params,config){return this.initGuard(),this.dataLoader.load(data,params,config,!0,!0)}},{key:"updateData",value:function(data){var _this210=this,responses=0;return this.initGuard(),new Promise((function(resolve,reject){_this210.dataLoader.blockActiveLoad(),"string"==typeof data&&(data=JSON.parse(data)),data&&data.length>0?data.forEach((function(item){var row=_this210.rowManager.findRow(item[_this210.options.index]);row&&(responses++,row.updateData(item).then((function(){--responses||resolve()})))})):(console.warn("Update Error - No data provided"),reject("Update Error - No data provided"))}))}},{key:"addData",value:function(data,pos,index){var _this211=this;return this.initGuard(),new Promise((function(resolve,reject){_this211.dataLoader.blockActiveLoad(),"string"==typeof data&&(data=JSON.parse(data)),data?_this211.rowManager.addRows(data,pos,index).then((function(rows){var output=[];rows.forEach((function(row){output.push(row.getComponent())})),resolve(output)})):(console.warn("Update Error - No data provided"),reject("Update Error - No data provided"))}))}},{key:"updateOrAddData",value:function(data){var _this212=this,rows=[],responses=0;return this.initGuard(),new Promise((function(resolve,reject){_this212.dataLoader.blockActiveLoad(),"string"==typeof data&&(data=JSON.parse(data)),data&&data.length>0?data.forEach((function(item){var row=_this212.rowManager.findRow(item[_this212.options.index]);responses++,row?row.updateData(item).then((function(){responses--,rows.push(row.getComponent()),responses||resolve(rows)})):_this212.rowManager.addRows(item).then((function(newRows){responses--,rows.push(newRows[0].getComponent()),responses||resolve(rows)}))})):(console.warn("Update Error - No data provided"),reject("Update Error - No data provided"))}))}},{key:"getRow",value:function(index){var row=this.rowManager.findRow(index);return row?row.getComponent():(console.warn("Find Error - No matching row found:",index),!1)}},{key:"getRowFromPosition",value:function(position){var row=this.rowManager.getRowFromPosition(position);return row?row.getComponent():(console.warn("Find Error - No matching row found:",position),!1)}},{key:"deleteRow",value:function(index){var _this213=this,foundRows=[];this.initGuard(),Array.isArray(index)||(index=[index]);var _step10,_iterator10=_createForOfIteratorHelper(index);try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var item=_step10.value,row=this.rowManager.findRow(item,!0);if(!row)return console.error("Delete Error - No matching row found:",item),Promise.reject("Delete Error - No matching row found");foundRows.push(row)}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}return foundRows.sort((function(a,b){return _this213.rowManager.rows.indexOf(a)>_this213.rowManager.rows.indexOf(b)?1:-1})),foundRows.forEach((function(row){row.delete()})),this.rowManager.reRenderInPosition(),Promise.resolve()}},{key:"addRow",value:function(data,pos,index){return this.initGuard(),"string"==typeof data&&(data=JSON.parse(data)),this.rowManager.addRows(data,pos,index).then((function(rows){return rows[0].getComponent()}))}},{key:"updateOrAddRow",value:function(index,data){var row=this.rowManager.findRow(index);return this.initGuard(),"string"==typeof data&&(data=JSON.parse(data)),row?row.updateData(data).then((function(){return row.getComponent()})):this.rowManager.addRows(data).then((function(rows){return rows[0].getComponent()}))}},{key:"updateRow",value:function(index,data){var row=this.rowManager.findRow(index);return this.initGuard(),"string"==typeof data&&(data=JSON.parse(data)),row?row.updateData(data).then((function(){return Promise.resolve(row.getComponent())})):(console.warn("Update Error - No matching row found:",index),Promise.reject("Update Error - No matching row found"))}},{key:"scrollToRow",value:function(index,position,ifVisible){var row=this.rowManager.findRow(index);return row?this.rowManager.scrollToRow(row,position,ifVisible):(console.warn("Scroll Error - No matching row found:",index),Promise.reject("Scroll Error - No matching row found"))}},{key:"moveRow",value:function(from,to,after){var fromRow=this.rowManager.findRow(from);this.initGuard(),fromRow?fromRow.moveToRow(to,after):console.warn("Move Error - No matching row found:",from)}},{key:"getRows",value:function(active){return this.rowManager.getComponents(active)}},{key:"getRowPosition",value:function(index){var row=this.rowManager.findRow(index);return row?row.getPosition():(console.warn("Position Error - No matching row found:",index),!1)}},{key:"setColumns",value:function(definition){this.initGuard(!1,"To set initial columns please use the 'columns' property in the table constructor"),this.columnManager.setColumns(definition)}},{key:"getColumns",value:function(structured){return this.columnManager.getComponents(structured)}},{key:"getColumn",value:function(field){var column=this.columnManager.findColumn(field);return column?column.getComponent():(console.warn("Find Error - No matching column found:",field),!1)}},{key:"getColumnDefinitions",value:function(){return this.columnManager.getDefinitionTree()}},{key:"showColumn",value:function(field){var column=this.columnManager.findColumn(field);if(this.initGuard(),!column)return console.warn("Column Show Error - No matching column found:",field),!1;column.show()}},{key:"hideColumn",value:function(field){var column=this.columnManager.findColumn(field);if(this.initGuard(),!column)return console.warn("Column Hide Error - No matching column found:",field),!1;column.hide()}},{key:"toggleColumn",value:function(field){var column=this.columnManager.findColumn(field);if(this.initGuard(),!column)return console.warn("Column Visibility Toggle Error - No matching column found:",field),!1;column.visible?column.hide():column.show()}},{key:"addColumn",value:function(definition,before,field){var column=this.columnManager.findColumn(field);return this.initGuard(),this.columnManager.addColumn(definition,before,column).then((function(column){return column.getComponent()}))}},{key:"deleteColumn",value:function(field){var column=this.columnManager.findColumn(field);return this.initGuard(),column?column.delete():(console.warn("Column Delete Error - No matching column found:",field),Promise.reject())}},{key:"updateColumnDefinition",value:function(field,definition){var column=this.columnManager.findColumn(field);return this.initGuard(),column?column.updateDefinition(definition):(console.warn("Column Update Error - No matching column found:",field),Promise.reject())}},{key:"moveColumn",value:function(from,to,after){var fromColumn=this.columnManager.findColumn(from),toColumn=this.columnManager.findColumn(to);this.initGuard(),fromColumn?toColumn?this.columnManager.moveColumn(fromColumn,toColumn,after):console.warn("Move Error - No matching column found:",toColumn):console.warn("Move Error - No matching column found:",from)}},{key:"scrollToColumn",value:function(field,position,ifVisible){var _this214=this;return new Promise((function(resolve,reject){var column=_this214.columnManager.findColumn(field);return column?_this214.columnManager.scrollToColumn(column,position,ifVisible):(console.warn("Scroll Error - No matching column found:",field),Promise.reject("Scroll Error - No matching column found"))}))}},{key:"redraw",value:function(force){this.initGuard(),this.columnManager.redraw(force),this.rowManager.redraw(force)}},{key:"setHeight",value:function(height){this.options.height=isNaN(height)?height:height+"px",this.element.style.height=this.options.height,this.rowManager.initializeRenderer(),this.rowManager.redraw()}},{key:"on",value:function(key,callback){this.externalEvents.subscribe(key,callback)}},{key:"off",value:function(key,callback){this.externalEvents.unsubscribe(key,callback)}},{key:"dispatchEvent",value:function(){var _this$externalEvents,args=Array.from(arguments);args.shift(),(_this$externalEvents=this.externalEvents).dispatch.apply(_this$externalEvents,arguments)}},{key:"alert",value:function(contents,type){this.initGuard(),this.alertManager.alert(contents,type)}},{key:"clearAlert",value:function(){this.initGuard(),this.alertManager.clear()}},{key:"modExists",value:function(plugin,required){return!!this.modules[plugin]||(required&&console.error("Tabulator Module Not Installed: "+plugin),!1)}},{key:"module",value:function(key){var mod=this.modules[key];return mod||console.error("Tabulator module not installed: "+key),mod}}]),Tabulator}();_exports.Tabulator=Tabulator,Tabulator.defaultOptions={debugEventsExternal:!1,debugEventsInternal:!1,debugInvalidOptions:!0,debugInvalidComponentFuncs:!0,debugInitialization:!0,debugDeprecation:!0,height:!1,minHeight:!1,maxHeight:!1,columnHeaderVertAlign:"top",popupContainer:!1,columns:[],columnDefaults:{},data:!1,autoColumns:!1,autoColumnsDefinitions:!1,nestedFieldSeparator:".",footerElement:!1,index:"id",textDirection:"auto",addRowPos:"bottom",headerVisible:!0,renderVertical:"virtual",renderHorizontal:"basic",renderVerticalBuffer:0,scrollToRowPosition:"top",scrollToRowIfVisible:!0,scrollToColumnPosition:"left",scrollToColumnIfVisible:!0,rowFormatter:!1,rowFormatterPrint:null,rowFormatterClipboard:null,rowFormatterHtmlOutput:null,rowHeight:null,placeholder:!1,dataLoader:!0,dataLoaderLoading:!1,dataLoaderError:!1,dataLoaderErrorTimeout:3e3,dataSendParams:{},dataReceiveParams:{}},new ModuleBinder(Tabulator);var TabulatorFull=function(_Tabulator){_inherits(TabulatorFull,_Tabulator);var _super56=_createSuper(TabulatorFull);function TabulatorFull(){return _classCallCheck(this,TabulatorFull),_super56.apply(this,arguments)}return _createClass(TabulatorFull)}(Tabulator);_exports.TabulatorFull=TabulatorFull,new ModuleBinder(TabulatorFull,modules);var PseudoRow=function(){function PseudoRow(type){_classCallCheck(this,PseudoRow),this.type=type,this.element=this._createElement()}return _createClass(PseudoRow,[{key:"_createElement",value:function(){var el=document.createElement("div");return el.classList.add("tabulator-row"),el}},{key:"getElement",value:function(){return this.element}},{key:"getComponent",value:function(){return!1}},{key:"getData",value:function(){return{}}},{key:"getHeight",value:function(){return this.element.outerHeight}},{key:"initialize",value:function(){}},{key:"reinitialize",value:function(){}},{key:"normalizeHeight",value:function(){}},{key:"generateCells",value:function(){}},{key:"reinitializeHeight",value:function(){}},{key:"calcHeight",value:function(){}},{key:"setCellHeight",value:function(){}},{key:"clearCellHeight",value:function(){}}]),PseudoRow}();_exports.PseudoRow=PseudoRow}));

//# sourceMappingURL=tabulator.min.js.map