define("qtype_formulas/tabulator",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.ValidateModule=_exports.TooltipModule=_exports.TabulatorFull=_exports.Tabulator=_exports.SortModule=_exports.SelectRowModule=_exports.RowComponent=_exports.ResponsiveLayoutModule=_exports.ResizeTableModule=_exports.ResizeRowsModule=_exports.ResizeColumnsModule=_exports.Renderer=_exports.ReactiveDataModule=_exports.PseudoRow=_exports.PrintModule=_exports.PopupModule=_exports.PersistenceModule=_exports.PageModule=_exports.MutatorModule=_exports.MoveRowsModule=_exports.MoveColumnsModule=_exports.Module=_exports.MenuModule=_exports.KeybindingsModule=_exports.InteractionModule=_exports.ImportModule=_exports.HtmlTableImportModule=_exports.HistoryModule=_exports.GroupRowsModule=_exports.GroupComponent=_exports.FrozenRowsModule=_exports.FrozenColumnsModule=_exports.FormatModule=_exports.FilterModule=_exports.ExportModule=_exports.EditModule=_exports.DownloadModule=_exports.DataTreeModule=_exports.ColumnComponent=_exports.ColumnCalcsModule=_exports.ClipboardModule=_exports.CellComponent=_exports.CalcComponent=_exports.AjaxModule=_exports.AccessorModule=void 0;class CoreFeature{constructor(table){this.table=table}reloadData(data,silent,columnsChanged){return this.table.dataLoader.load(data,void 0,void 0,void 0,silent,columnsChanged)}langText(){return this.table.modules.localize.getText(...arguments)}langBind(){return this.table.modules.localize.bind(...arguments)}langLocale(){return this.table.modules.localize.getLocale(...arguments)}commsConnections(){return this.table.modules.comms.getConnections(...arguments)}commsSend(){return this.table.modules.comms.send(...arguments)}layoutMode(){return this.table.modules.layout.getMode()}layoutRefresh(force){return this.table.modules.layout.layout(force)}subscribe(){return this.table.eventBus.subscribe(...arguments)}unsubscribe(){return this.table.eventBus.unsubscribe(...arguments)}subscribed(key){return this.table.eventBus.subscribed(key)}subscriptionChange(){return this.table.eventBus.subscriptionChange(...arguments)}dispatch(){return this.table.eventBus.dispatch(...arguments)}chain(){return this.table.eventBus.chain(...arguments)}confirm(){return this.table.eventBus.confirm(...arguments)}dispatchExternal(){return this.table.externalEvents.dispatch(...arguments)}subscribedExternal(key){return this.table.externalEvents.subscribed(key)}subscriptionChangeExternal(){return this.table.externalEvents.subscriptionChange(...arguments)}options(key){return this.table.options[key]}setOption(key,value){return void 0!==value&&(this.table.options[key]=value),this.table.options[key]}deprecationCheck(oldOption,newOption){return this.table.deprecationAdvisor.check(oldOption,newOption)}deprecationCheckMsg(oldOption,msg){return this.table.deprecationAdvisor.checkMsg(oldOption,msg)}deprecationMsg(msg){return this.table.deprecationAdvisor.msg(msg)}module(key){return this.table.module(key)}}class Helpers{static elVisible(el){return!(el.offsetWidth<=0&&el.offsetHeight<=0)}static elOffset(el){var box=el.getBoundingClientRect();return{top:box.top+window.pageYOffset-document.documentElement.clientTop,left:box.left+window.pageXOffset-document.documentElement.clientLeft}}static deepClone(obj,clone){let list=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];var objectProto={}.__proto__,arrayProto=[].__proto__;for(var i in clone||(clone=Object.assign(Array.isArray(obj)?[]:{},obj)),obj){let match,copy,subject=obj[i];null==subject||"object"!=typeof subject||subject.__proto__!==objectProto&&subject.__proto__!==arrayProto||(match=list.findIndex((item=>item.subject===subject)),match>-1?clone[i]=list[match].copy:(copy=Object.assign(Array.isArray(subject)?[]:{},subject),list.unshift({subject:subject,copy:copy}),clone[i]=this.deepClone(subject,copy,list)))}return clone}}class Popup extends CoreFeature{constructor(table,element,parent){super(table),this.element=element,this.container=this._lookupContainer(),this.parent=parent,this.reversedX=!1,this.childPopup=null,this.blurable=!1,this.blurCallback=null,this.blurEventsBound=!1,this.renderedCallback=null,this.visible=!1,this.hideable=!0,this.element.classList.add("tabulator-popup-container"),this.blurEvent=this.hide.bind(this,!1),this.escEvent=this._escapeCheck.bind(this),this.destroyBinding=this.tableDestroyed,this.destroyed=!1}tableDestroyed(){this.destroyed=!0,this.hide(!0)}_lookupContainer(){var container=this.table.options.popupContainer;return"string"==typeof container?(container=document.querySelector(container))||console.warn("Menu Error - no container element found matching selector:",this.table.options.popupContainer,"(defaulting to document body)"):!0===container&&(container=this.table.element),container&&!this._checkContainerIsParent(container)&&(container=!1,console.warn("Menu Error - container element does not contain this table:",this.table.options.popupContainer,"(defaulting to document body)")),container||(container=document.body),container}_checkContainerIsParent(container){let element=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.table.element;return container===element||!!element.parentNode&&this._checkContainerIsParent(container,element.parentNode)}renderCallback(callback){this.renderedCallback=callback}containerEventCoords(e){var touch=!(e instanceof MouseEvent),x=touch?e.touches[0].pageX:e.pageX,y=touch?e.touches[0].pageY:e.pageY;if(this.container!==document.body){let parentOffset=Helpers.elOffset(this.container);x-=parentOffset.left,y-=parentOffset.top}return{x:x,y:y}}elementPositionCoords(element){let position=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right";var containerOffset,x,y,offset=Helpers.elOffset(element);switch(this.container!==document.body&&(containerOffset=Helpers.elOffset(this.container),offset.left-=containerOffset.left,offset.top-=containerOffset.top),position){case"right":x=offset.left+element.offsetWidth,y=offset.top-1;break;case"bottom":x=offset.left,y=offset.top+element.offsetHeight;break;case"left":x=offset.left,y=offset.top-1;break;case"top":x=offset.left,y=offset.top;break;case"center":x=offset.left+element.offsetWidth/2,y=offset.top+element.offsetHeight/2}return{x:x,y:y,offset:offset}}show(origin,position){var x,y,parentEl,parentOffset,coords;return this.destroyed||this.table.destroyed||(origin instanceof HTMLElement?(parentEl=origin,parentOffset=(coords=this.elementPositionCoords(origin,position)).offset,x=coords.x,y=coords.y):"number"==typeof origin?(parentOffset={top:0,left:0},x=origin,y=position):(x=(coords=this.containerEventCoords(origin)).x,y=coords.y,this.reversedX=!1),this.element.style.top=y+"px",this.element.style.left=x+"px",this.container.appendChild(this.element),"function"==typeof this.renderedCallback&&this.renderedCallback(),this._fitToScreen(x,y,parentEl,parentOffset,position),this.visible=!0,this.subscribe("table-destroy",this.destroyBinding),this.element.addEventListener("mousedown",(e=>{e.stopPropagation()}))),this}_fitToScreen(x,y,parentEl,parentOffset,position){var scrollTop=this.container===document.body?document.documentElement.scrollTop:this.container.scrollTop;if((x+this.element.offsetWidth>=this.container.offsetWidth||this.reversedX)&&(this.element.style.left="",this.element.style.right=parentEl?this.container.offsetWidth-parentOffset.left+"px":this.container.offsetWidth-x+"px",this.reversedX=!0),y+this.element.offsetHeight>Math.max(this.container.offsetHeight,scrollTop?this.container.scrollHeight:0))if(parentEl)if("bottom"===position)this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight-parentEl.offsetHeight-1+"px";else this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight+parentEl.offsetHeight+1+"px";else this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight+"px"}isVisible(){return this.visible}hideOnBlur(callback){return this.blurable=!0,this.visible&&(setTimeout((()=>{this.visible&&(this.table.rowManager.element.addEventListener("scroll",this.blurEvent),this.subscribe("cell-editing",this.blurEvent),document.body.addEventListener("click",this.blurEvent),document.body.addEventListener("contextmenu",this.blurEvent),document.body.addEventListener("mousedown",this.blurEvent),window.addEventListener("resize",this.blurEvent),document.body.addEventListener("keydown",this.escEvent),this.blurEventsBound=!0)}),100),this.blurCallback=callback),this}_escapeCheck(e){27==e.keyCode&&this.hide()}blockHide(){this.hideable=!1}restoreHide(){this.hideable=!0}hide(){let silent=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.visible&&this.hideable&&(this.blurable&&this.blurEventsBound&&(document.body.removeEventListener("keydown",this.escEvent),document.body.removeEventListener("click",this.blurEvent),document.body.removeEventListener("contextmenu",this.blurEvent),document.body.removeEventListener("mousedown",this.blurEvent),window.removeEventListener("resize",this.blurEvent),this.table.rowManager.element.removeEventListener("scroll",this.blurEvent),this.unsubscribe("cell-editing",this.blurEvent),this.blurEventsBound=!1),this.childPopup&&this.childPopup.hide(),this.parent&&(this.parent.childPopup=null),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.visible=!1,this.blurCallback&&!silent&&this.blurCallback(),this.unsubscribe("table-destroy",this.destroyBinding)),this}child(element){return this.childPopup&&this.childPopup.hide(),this.childPopup=new Popup(this.table,element,this),this.childPopup}}class Module extends CoreFeature{constructor(table,name){super(table),this._handler=null}initialize(){}registerTableOption(key,value){this.table.optionsList.register(key,value)}registerColumnOption(key,value){this.table.columnManager.optionsList.register(key,value)}registerTableFunction(name,func){var _this=this;void 0===this.table[name]?this.table[name]=function(){return _this.table.initGuard(name),func(...arguments)}:console.warn("Unable to bind table function, name already in use",name)}registerComponentFunction(component,func,handler){return this.table.componentFunctionBinder.bind(component,func,handler)}registerDataHandler(handler,priority){this.table.rowManager.registerDataPipelineHandler(handler,priority),this._handler=handler}registerDisplayHandler(handler,priority){this.table.rowManager.registerDisplayPipelineHandler(handler,priority),this._handler=handler}displayRows(adjust){var lookupIndex,index=this.table.rowManager.displayRows.length-1;if(this._handler&&(lookupIndex=this.table.rowManager.displayPipeline.findIndex((item=>item.handler===this._handler)))>-1&&(index=lookupIndex),adjust&&(index+=adjust),this._handler)return index>-1?this.table.rowManager.getDisplayRows(index):this.activeRows()}activeRows(){return this.table.rowManager.activeRows}refreshData(renderInPosition,handler){handler||(handler=this._handler),handler&&this.table.rowManager.refreshActiveData(handler,!1,renderInPosition)}footerAppend(element){return this.table.footerManager.append(element)}footerPrepend(element){return this.table.footerManager.prepend(element)}footerRemove(element){return this.table.footerManager.remove(element)}popup(menuEl,menuContainer){return new Popup(this.table,menuEl,menuContainer)}alert(content,type){return this.table.alertManager.alert(content,type)}clearAlert(){return this.table.alertManager.clear()}}_exports.Module=Module;class Accessor extends Module{constructor(table){super(table),this.allowedTypes=["","data","download","clipboard","print","htmlOutput"],this.registerColumnOption("accessor"),this.registerColumnOption("accessorParams"),this.registerColumnOption("accessorData"),this.registerColumnOption("accessorDataParams"),this.registerColumnOption("accessorDownload"),this.registerColumnOption("accessorDownloadParams"),this.registerColumnOption("accessorClipboard"),this.registerColumnOption("accessorClipboardParams"),this.registerColumnOption("accessorPrint"),this.registerColumnOption("accessorPrintParams"),this.registerColumnOption("accessorHtmlOutput"),this.registerColumnOption("accessorHtmlOutputParams")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-retrieve",this.transformRow.bind(this))}initializeColumn(column){var match=!1,config={};this.allowedTypes.forEach((type=>{var accessor,key="accessor"+(type.charAt(0).toUpperCase()+type.slice(1));column.definition[key]&&(accessor=this.lookupAccessor(column.definition[key]))&&(match=!0,config[key]={accessor:accessor,params:column.definition[key+"Params"]||{}})})),match&&(column.modules.accessor=config)}lookupAccessor(value){var accessor=!1;switch(typeof value){case"string":Accessor.accessors[value]?accessor=Accessor.accessors[value]:console.warn("Accessor Error - No such accessor found, ignoring: ",value);break;case"function":accessor=value}return accessor}transformRow(row,type){var key="accessor"+(type.charAt(0).toUpperCase()+type.slice(1)),rowComponent=row.getComponent(),data=Helpers.deepClone(row.data||{});return this.table.columnManager.traverse((function(column){var value,accessor,params,colComponent;column.modules.accessor&&(accessor=column.modules.accessor[key]||column.modules.accessor.accessor||!1)&&"undefined"!=(value=column.getFieldValue(data))&&(colComponent=column.getComponent(),params="function"==typeof accessor.params?accessor.params(value,data,type,colComponent,rowComponent):accessor.params,column.setFieldValue(data,accessor.accessor(value,data,type,params,colComponent,rowComponent)))})),data}}_exports.AccessorModule=Accessor,Accessor.moduleName="accessor",Accessor.accessors={};function generateParamsList(data,prefix){var output=[];if(prefix=prefix||"",Array.isArray(data))data.forEach(((item,i)=>{output=output.concat(generateParamsList(item,prefix?prefix+"["+i+"]":i))}));else if("object"==typeof data)for(var key in data)output=output.concat(generateParamsList(data[key],prefix?prefix+"["+key+"]":key));else output.push({key:prefix,value:data});return output}function serializeParams(params){var output=generateParamsList(params),encoded=[];return output.forEach((function(item){encoded.push(encodeURIComponent(item.key)+"="+encodeURIComponent(item.value))})),encoded.join("&")}function urlBuilder(url,config,params){return url&&params&&Object.keys(params).length&&(config.method&&"get"!=config.method.toLowerCase()||(config.method="get",url+=(url.includes("?")?"&":"?")+serializeParams(params))),url}function generateParamsList$1(data,prefix){var output=[];if(prefix=prefix||"",Array.isArray(data))data.forEach(((item,i)=>{output=output.concat(generateParamsList$1(item,prefix?prefix+"["+i+"]":i))}));else if("object"==typeof data)for(var key in data)output=output.concat(generateParamsList$1(data[key],prefix?prefix+"["+key+"]":key));else output.push({key:prefix,value:data});return output}var defaultContentTypeFormatters={json:{headers:{"Content-Type":"application/json"},body:function(url,config,params){return JSON.stringify(params)}},form:{headers:{},body:function(url,config,params){var output=generateParamsList$1(params),form=new FormData;return output.forEach((function(item){form.append(item.key,item.value)})),form}}};class Ajax extends Module{constructor(table){super(table),this.config={},this.url="",this.urlGenerator=!1,this.params=!1,this.loaderPromise=!1,this.registerTableOption("ajaxURL",!1),this.registerTableOption("ajaxURLGenerator",!1),this.registerTableOption("ajaxParams",{}),this.registerTableOption("ajaxConfig","get"),this.registerTableOption("ajaxContentType","form"),this.registerTableOption("ajaxRequestFunc",!1),this.registerTableOption("ajaxRequesting",(function(){})),this.registerTableOption("ajaxResponse",!1),this.contentTypeFormatters=Ajax.contentTypeFormatters}initialize(){this.loaderPromise=this.table.options.ajaxRequestFunc||Ajax.defaultLoaderPromise,this.urlGenerator=this.table.options.ajaxURLGenerator||Ajax.defaultURLGenerator,this.table.options.ajaxURL&&this.setUrl(this.table.options.ajaxURL),this.setDefaultConfig(this.table.options.ajaxConfig),this.registerTableFunction("getAjaxUrl",this.getUrl.bind(this)),this.subscribe("data-loading",this.requestDataCheck.bind(this)),this.subscribe("data-params",this.requestParams.bind(this)),this.subscribe("data-load",this.requestData.bind(this))}requestParams(data,config,silent,params){var ajaxParams=this.table.options.ajaxParams;return ajaxParams&&("function"==typeof ajaxParams&&(ajaxParams=ajaxParams.call(this.table)),params=Object.assign(params,ajaxParams)),params}requestDataCheck(data,params,config,silent){return!((data||!this.url)&&"string"!=typeof data)}requestData(url,params,config,silent,previousData){var ajaxConfig;return!previousData&&this.requestDataCheck(url)?(url&&this.setUrl(url),ajaxConfig=this.generateConfig(config),this.sendRequest(this.url,params,ajaxConfig)):previousData}setDefaultConfig(){let config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=Object.assign({},Ajax.defaultConfig),"string"==typeof config?this.config.method=config:Object.assign(this.config,config)}generateConfig(){let config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var ajaxConfig=Object.assign({},this.config);return"string"==typeof config?ajaxConfig.method=config:Object.assign(ajaxConfig,config),ajaxConfig}setUrl(url){this.url=url}getUrl(){return this.url}sendRequest(url,params,config){return!1!==this.table.options.ajaxRequesting.call(this.table,url,params)?this.loaderPromise(url,config,params).then((data=>(this.table.options.ajaxResponse&&(data=this.table.options.ajaxResponse.call(this.table,url,params,data)),data))):Promise.reject()}}_exports.AjaxModule=Ajax,Ajax.moduleName="ajax",Ajax.defaultConfig={method:"GET"},Ajax.defaultURLGenerator=urlBuilder,Ajax.defaultLoaderPromise=function(url,config,params){var contentType;return new Promise(((resolve,reject)=>{if(url=this.urlGenerator.call(this.table,url,config,params),"GET"!=config.method.toUpperCase())if(contentType="object"==typeof this.table.options.ajaxContentType?this.table.options.ajaxContentType:this.contentTypeFormatters[this.table.options.ajaxContentType]){for(var key in contentType.headers)config.headers||(config.headers={}),void 0===config.headers[key]&&(config.headers[key]=contentType.headers[key]);config.body=contentType.body.call(this,url,config,params)}else console.warn("Ajax Error - Invalid ajaxContentType value:",this.table.options.ajaxContentType);url?(void 0===config.headers&&(config.headers={}),void 0===config.headers.Accept&&(config.headers.Accept="application/json"),void 0===config.headers["X-Requested-With"]&&(config.headers["X-Requested-With"]="XMLHttpRequest"),void 0===config.mode&&(config.mode="cors"),"cors"==config.mode?(void 0===config.headers.Origin&&(config.headers.Origin=window.location.origin),void 0===config.credentials&&(config.credentials="same-origin")):void 0===config.credentials&&(config.credentials="include"),fetch(url,config).then((response=>{response.ok?response.json().then((data=>{resolve(data)})).catch((error=>{reject(error),console.warn("Ajax Load Error - Invalid JSON returned",error)})):(console.error("Ajax Load Error - Connection Error: "+response.status,response.statusText),reject(response))})).catch((error=>{console.error("Ajax Load Error - Connection Error: ",error),reject(error)}))):(console.warn("Ajax Load Error - No URL Set"),resolve([]))}))},Ajax.contentTypeFormatters=defaultContentTypeFormatters;class Clipboard extends Module{constructor(table){super(table),this.mode=!0,this.pasteParser=function(){},this.pasteAction=function(){},this.customSelection=!1,this.rowRange=!1,this.blocked=!0,this.registerTableOption("clipboard",!1),this.registerTableOption("clipboardCopyStyled",!0),this.registerTableOption("clipboardCopyConfig",!1),this.registerTableOption("clipboardCopyFormatter",!1),this.registerTableOption("clipboardCopyRowRange","active"),this.registerTableOption("clipboardPasteParser","table"),this.registerTableOption("clipboardPasteAction","insert"),this.registerColumnOption("clipboard"),this.registerColumnOption("titleClipboard")}initialize(){this.mode=this.table.options.clipboard,this.rowRange=this.table.options.clipboardCopyRowRange,!0!==this.mode&&"copy"!==this.mode||this.table.element.addEventListener("copy",(e=>{var plain,html,list;this.blocked||(e.preventDefault(),this.customSelection?(plain=this.customSelection,this.table.options.clipboardCopyFormatter&&(plain=this.table.options.clipboardCopyFormatter("plain",plain))):(list=this.table.modules.export.generateExportList(this.table.options.clipboardCopyConfig,this.table.options.clipboardCopyStyled,this.rowRange,"clipboard"),plain=(html=this.table.modules.export.generateHTMLTable(list))?this.generatePlainContent(list):"",this.table.options.clipboardCopyFormatter&&(plain=this.table.options.clipboardCopyFormatter("plain",plain),html=this.table.options.clipboardCopyFormatter("html",html))),window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",plain):e.clipboardData&&e.clipboardData.setData?(e.clipboardData.setData("text/plain",plain),html&&e.clipboardData.setData("text/html",html)):e.originalEvent&&e.originalEvent.clipboardData.setData&&(e.originalEvent.clipboardData.setData("text/plain",plain),html&&e.originalEvent.clipboardData.setData("text/html",html)),this.dispatchExternal("clipboardCopied",plain,html),this.reset())})),!0!==this.mode&&"paste"!==this.mode||this.table.element.addEventListener("paste",(e=>{this.paste(e)})),this.setPasteParser(this.table.options.clipboardPasteParser),this.setPasteAction(this.table.options.clipboardPasteAction),this.registerTableFunction("copyToClipboard",this.copy.bind(this))}reset(){this.blocked=!0,this.customSelection=!1}generatePlainContent(list){var output=[];return list.forEach((row=>{var rowData=[];row.columns.forEach((col=>{var value="";if(col)if("group"===row.type&&(col.value=col.component.getKey()),null===col.value)value="";else switch(typeof col.value){case"object":value=JSON.stringify(col.value);break;case"undefined":value="";break;default:value=col.value}rowData.push(value)})),output.push(rowData.join("\t"))})),output.join("\n")}copy(range,internal){var sel,textRange;this.blocked=!1,this.customSelection=!1,!0!==this.mode&&"copy"!==this.mode||(this.rowRange=range||this.table.options.clipboardCopyRowRange,void 0!==window.getSelection&&void 0!==document.createRange?((range=document.createRange()).selectNodeContents(this.table.element),(sel=window.getSelection()).toString()&&internal&&(this.customSelection=sel.toString()),sel.removeAllRanges(),sel.addRange(range)):void 0!==document.selection&&void 0!==document.body.createTextRange&&((textRange=document.body.createTextRange()).moveToElementText(this.table.element),textRange.select()),document.execCommand("copy"),sel&&sel.removeAllRanges())}setPasteAction(action){switch(typeof action){case"string":this.pasteAction=Clipboard.pasteActions[action],this.pasteAction||console.warn("Clipboard Error - No such paste action found:",action);break;case"function":this.pasteAction=action}}setPasteParser(parser){switch(typeof parser){case"string":this.pasteParser=Clipboard.pasteParsers[parser],this.pasteParser||console.warn("Clipboard Error - No such paste parser found:",parser);break;case"function":this.pasteParser=parser}}paste(e){var data,rowData,rows;this.checkPaseOrigin(e)&&(data=this.getPasteData(e),(rowData=this.pasteParser.call(this,data))?(e.preventDefault(),this.table.modExists("mutator")&&(rowData=this.mutateData(rowData)),rows=this.pasteAction.call(this,rowData),this.dispatchExternal("clipboardPasted",data,rowData,rows)):this.dispatchExternal("clipboardPasteError",data))}mutateData(data){var output=[];return Array.isArray(data)?data.forEach((row=>{output.push(this.table.modules.mutator.transformRow(row,"clipboard"))})):output=data,output}checkPaseOrigin(e){var valid=!0;return("DIV"!=e.target.tagName||this.table.modules.edit.currentCell)&&(valid=!1),valid}getPasteData(e){var data;return window.clipboardData&&window.clipboardData.getData?data=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?data=e.clipboardData.getData("text/plain"):e.originalEvent&&e.originalEvent.clipboardData.getData&&(data=e.originalEvent.clipboardData.getData("text/plain")),data}}_exports.ClipboardModule=Clipboard,Clipboard.moduleName="clipboard",Clipboard.pasteActions={replace:function(rows){return this.table.setData(rows)},update:function(rows){return this.table.updateOrAddData(rows)},insert:function(rows){return this.table.addData(rows)}},Clipboard.pasteParsers={table:function(clipboard){var data=[],headerFindSuccess=!0,columns=this.table.columnManager.columns,columnMap=[],rows=[];return(clipboard=clipboard.split("\n")).forEach((function(row){data.push(row.split("\t"))})),!(!data.length||1===data.length&&data[0].length<2)&&(data[0].forEach((function(value){var column=columns.find((function(column){return value&&column.definition.title&&value.trim()&&column.definition.title.trim()===value.trim()}));column?columnMap.push(column):headerFindSuccess=!1})),headerFindSuccess||(headerFindSuccess=!0,columnMap=[],data[0].forEach((function(value){var column=columns.find((function(column){return value&&column.field&&value.trim()&&column.field.trim()===value.trim()}));column?columnMap.push(column):headerFindSuccess=!1})),headerFindSuccess||(columnMap=this.table.columnManager.columnsByIndex)),headerFindSuccess&&data.shift(),data.forEach((function(item){var row={};item.forEach((function(value,i){columnMap[i]&&(row[columnMap[i].field]=value)})),rows.push(row)})),rows)}};class CalcComponent{constructor(row){return this._row=row,new Proxy(this,{get:function(target,name,receiver){return void 0!==target[name]?target[name]:target._row.table.componentFunctionBinder.handle("row",target._row,name)}})}getData(transform){return this._row.getData(transform)}getElement(){return this._row.getElement()}getTable(){return this._row.table}getCells(){var cells=[];return this._row.getCells().forEach((function(cell){cells.push(cell.getComponent())})),cells}getCell(column){var cell=this._row.getCell(column);return!!cell&&cell.getComponent()}_getSelf(){return this._row}}_exports.CalcComponent=CalcComponent;class CellComponent{constructor(cell){return this._cell=cell,new Proxy(this,{get:function(target,name,receiver){return void 0!==target[name]?target[name]:target._cell.table.componentFunctionBinder.handle("cell",target._cell,name)}})}getValue(){return this._cell.getValue()}getOldValue(){return this._cell.getOldValue()}getInitialValue(){return this._cell.initialValue}getElement(){return this._cell.getElement()}getRow(){return this._cell.row.getComponent()}getData(){return this._cell.row.getData()}getField(){return this._cell.column.getField()}getColumn(){return this._cell.column.getComponent()}setValue(value,mutate){void 0===mutate&&(mutate=!0),this._cell.setValue(value,mutate)}restoreOldValue(){this._cell.setValueActual(this._cell.getOldValue())}restoreInitialValue(){this._cell.setValueActual(this._cell.initialValue)}checkHeight(){this._cell.checkHeight()}getTable(){return this._cell.table}_getSelf(){return this._cell}}_exports.CellComponent=CellComponent;class Cell extends CoreFeature{constructor(column,row){super(column.table),this.table=column.table,this.column=column,this.row=row,this.element=null,this.value=null,this.initialValue,this.oldValue=null,this.modules={},this.height=null,this.width=null,this.minWidth=null,this.component=null,this.loaded=!1,this.build()}build(){this.generateElement(),this.setWidth(),this._configureCell(),this.setValueActual(this.column.getFieldValue(this.row.data)),this.initialValue=this.value}generateElement(){this.element=document.createElement("div"),this.element.className="tabulator-cell",this.element.setAttribute("role","gridcell")}_configureCell(){var element=this.element,field=this.column.getField();(element.style.textAlign=this.column.hozAlign,this.column.vertAlign&&(element.style.display="inline-flex",element.style.alignItems={top:"flex-start",bottom:"flex-end",middle:"center"}[this.column.vertAlign]||"",this.column.hozAlign&&(element.style.justifyContent={left:"flex-start",right:"flex-end",center:"center"}[this.column.hozAlign]||"")),field&&element.setAttribute("tabulator-field",field),this.column.definition.cssClass)&&this.column.definition.cssClass.split(" ").forEach((className=>{element.classList.add(className)}));this.dispatch("cell-init",this),this.column.visible||this.hide()}_generateContents(){var val;switch(typeof(val=this.chain("cell-format",this,null,(()=>this.element.innerHTML=this.value)))){case"object":if(val instanceof Node){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(val)}else this.element.innerHTML="",null!=val&&console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",val);break;case"undefined":this.element.innerHTML="";break;default:this.element.innerHTML=val}}cellRendered(){this.dispatch("cell-rendered",this)}getElement(containerOnly){return this.loaded||(this.loaded=!0,containerOnly||this.layoutElement()),this.element}getValue(){return this.value}getOldValue(){return this.oldValue}setValue(value,mutate,force){this.setValueProcessData(value,mutate,force)&&(this.dispatch("cell-value-updated",this),this.cellRendered(),this.column.definition.cellEdited&&this.column.definition.cellEdited.call(this.table,this.getComponent()),this.dispatchExternal("cellEdited",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()))}setValueProcessData(value,mutate,force){var changed=!1;return(this.value!==value||force)&&(changed=!0,mutate&&(value=this.chain("cell-value-changing",[this,value],null,value))),this.setValueActual(value),changed&&this.dispatch("cell-value-changed",this),changed}setValueActual(value){this.oldValue=this.value,this.value=value,this.dispatch("cell-value-save-before",this),this.column.setFieldValue(this.row.data,value),this.dispatch("cell-value-save-after",this),this.loaded&&this.layoutElement()}layoutElement(){this._generateContents(),this.dispatch("cell-layout",this)}setWidth(){this.width=this.column.width,this.element.style.width=this.column.widthStyled}clearWidth(){this.width="",this.element.style.width=""}getWidth(){return this.width||this.element.offsetWidth}setMinWidth(){this.minWidth=this.column.minWidth,this.element.style.minWidth=this.column.minWidthStyled}setMaxWidth(){this.maxWidth=this.column.maxWidth,this.element.style.maxWidth=this.column.maxWidthStyled}checkHeight(){this.row.reinitializeHeight()}clearHeight(){this.element.style.height="",this.height=null,this.dispatch("cell-height",this,"")}setHeight(){this.height=this.row.height,this.element.style.height=this.row.heightStyled,this.dispatch("cell-height",this,this.row.heightStyled)}getHeight(){return this.height||this.element.offsetHeight}show(){this.element.style.display=this.column.vertAlign?"inline-flex":""}hide(){this.element.style.display="none"}delete(){this.dispatch("cell-delete",this),!this.table.rowManager.redrawBlock&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.column.deleteCell(this),this.row.deleteCell(this),this.calcs={}}getIndex(){return this.row.getCellIndex(this)}getComponent(){return this.component||(this.component=new CellComponent(this)),this.component}}class ColumnComponent{constructor(column){return this._column=column,this.type="ColumnComponent",new Proxy(this,{get:function(target,name,receiver){return void 0!==target[name]?target[name]:target._column.table.componentFunctionBinder.handle("column",target._column,name)}})}getElement(){return this._column.getElement()}getDefinition(){return this._column.getDefinition()}getField(){return this._column.getField()}getTitleDownload(){return this._column.getTitleDownload()}getCells(){var cells=[];return this._column.cells.forEach((function(cell){cells.push(cell.getComponent())})),cells}isVisible(){return this._column.visible}show(){this._column.isGroup?this._column.columns.forEach((function(column){column.show()})):this._column.show()}hide(){this._column.isGroup?this._column.columns.forEach((function(column){column.hide()})):this._column.hide()}toggle(){this._column.visible?this.hide():this.show()}delete(){return this._column.delete()}getSubColumns(){var output=[];return this._column.columns.length&&this._column.columns.forEach((function(column){output.push(column.getComponent())})),output}getParentColumn(){return this._column.parent instanceof Column&&this._column.parent.getComponent()}_getSelf(){return this._column}scrollTo(){return this._column.table.columnManager.scrollToColumn(this._column)}getTable(){return this._column.table}move(to,after){var toColumn=this._column.table.columnManager.findColumn(to);toColumn?this._column.table.columnManager.moveColumn(this._column,toColumn,after):console.warn("Move Error - No matching column found:",toColumn)}getNextColumn(){var nextCol=this._column.nextColumn();return!!nextCol&&nextCol.getComponent()}getPrevColumn(){var prevCol=this._column.prevColumn();return!!prevCol&&prevCol.getComponent()}updateDefinition(updates){return this._column.updateDefinition(updates)}getWidth(){return this._column.getWidth()}setWidth(width){var result;return result=!0===width?this._column.reinitializeWidth(!0):this._column.setWidth(width),this._column.table.columnManager.rerenderColumns(!0),result}}_exports.ColumnComponent=ColumnComponent;var defaultColumnOptions={title:void 0,field:void 0,columns:void 0,visible:void 0,hozAlign:void 0,vertAlign:void 0,width:void 0,minWidth:40,maxWidth:void 0,maxInitialWidth:void 0,cssClass:void 0,variableHeight:void 0,headerVertical:void 0,headerHozAlign:void 0,headerWordWrap:!1,editableTitle:void 0};class Column extends CoreFeature{constructor(def,parent){super(parent.table),this.definition=def,this.parent=parent,this.type="column",this.columns=[],this.cells=[],this.element=this.createElement(),this.contentElement=!1,this.titleHolderElement=!1,this.titleElement=!1,this.groupElement=this.createGroupElement(),this.isGroup=!1,this.hozAlign="",this.vertAlign="",this.field="",this.fieldStructure="",this.getFieldValue="",this.setFieldValue="",this.titleDownload=null,this.titleFormatterRendered=!1,this.mapDefinitions(),this.setField(this.definition.field),this.modules={},this.width=null,this.widthStyled="",this.maxWidth=null,this.maxWidthStyled="",this.maxInitialWidth=null,this.minWidth=null,this.minWidthStyled="",this.widthFixed=!1,this.visible=!0,this.component=null,this.definition.columns?(this.isGroup=!0,this.definition.columns.forEach(((def,i)=>{var newCol=new Column(def,this);this.attachColumn(newCol)})),this.checkColumnVisibility()):parent.registerColumnField(this),this._initialize()}createElement(){var el=document.createElement("div");switch(el.classList.add("tabulator-col"),el.setAttribute("role","columnheader"),el.setAttribute("aria-sort","none"),this.table.options.columnHeaderVertAlign){case"middle":el.style.justifyContent="center";break;case"bottom":el.style.justifyContent="flex-end"}return el}createGroupElement(){var el=document.createElement("div");return el.classList.add("tabulator-col-group-cols"),el}mapDefinitions(){var defaults=this.table.options.columnDefaults;if(defaults)for(let key in defaults)void 0===this.definition[key]&&(this.definition[key]=defaults[key]);this.definition=this.table.columnManager.optionsList.generate(Column.defaultOptionList,this.definition)}checkDefinition(){Object.keys(this.definition).forEach((key=>{-1===Column.defaultOptionList.indexOf(key)&&console.warn("Invalid column definition option in '"+(this.field||this.definition.title)+"' column:",key)}))}setField(field){this.field=field,this.fieldStructure=field?this.table.options.nestedFieldSeparator?field.split(this.table.options.nestedFieldSeparator):[field]:[],this.getFieldValue=this.fieldStructure.length>1?this._getNestedData:this._getFlatData,this.setFieldValue=this.fieldStructure.length>1?this._setNestedData:this._setFlatData}registerColumnPosition(column){this.parent.registerColumnPosition(column)}registerColumnField(column){this.parent.registerColumnField(column)}reRegisterPosition(){this.isGroup?this.columns.forEach((function(column){column.reRegisterPosition()})):this.registerColumnPosition(this)}_initialize(){for(var def=this.definition;this.element.firstChild;)this.element.removeChild(this.element.firstChild);def.headerVertical&&(this.element.classList.add("tabulator-col-vertical"),"flip"===def.headerVertical&&this.element.classList.add("tabulator-col-vertical-flip")),this.contentElement=this._buildColumnHeaderContent(),this.element.appendChild(this.contentElement),this.isGroup?this._buildGroupHeader():this._buildColumnHeader(),this.dispatch("column-init",this)}_buildColumnHeader(){var def=this.definition;(this.dispatch("column-layout",this),void 0!==def.visible&&(def.visible?this.show(!0):this.hide(!0)),def.cssClass)&&def.cssClass.split(" ").forEach((className=>{this.element.classList.add(className)}));def.field&&this.element.setAttribute("tabulator-field",def.field),this.setMinWidth(parseInt(def.minWidth)),def.maxInitialWidth&&(this.maxInitialWidth=parseInt(def.maxInitialWidth)),def.maxWidth&&this.setMaxWidth(parseInt(def.maxWidth)),this.reinitializeWidth(),this.hozAlign=this.definition.hozAlign,this.vertAlign=this.definition.vertAlign,this.titleElement.style.textAlign=this.definition.headerHozAlign}_buildColumnHeaderContent(){var contentElement=document.createElement("div");return contentElement.classList.add("tabulator-col-content"),this.titleHolderElement=document.createElement("div"),this.titleHolderElement.classList.add("tabulator-col-title-holder"),contentElement.appendChild(this.titleHolderElement),this.titleElement=this._buildColumnHeaderTitle(),this.titleHolderElement.appendChild(this.titleElement),contentElement}_buildColumnHeaderTitle(){var def=this.definition,titleHolderElement=document.createElement("div");if(titleHolderElement.classList.add("tabulator-col-title"),def.headerWordWrap&&titleHolderElement.classList.add("tabulator-col-title-wrap"),def.editableTitle){var titleElement=document.createElement("input");titleElement.classList.add("tabulator-title-editor"),titleElement.addEventListener("click",(e=>{e.stopPropagation(),titleElement.focus()})),titleElement.addEventListener("change",(()=>{def.title=titleElement.value,this.dispatchExternal("columnTitleChanged",this.getComponent())})),titleHolderElement.appendChild(titleElement),def.field?this.langBind("columns|"+def.field,(text=>{titleElement.value=text||def.title||"&nbsp;"})):titleElement.value=def.title||"&nbsp;"}else def.field?this.langBind("columns|"+def.field,(text=>{this._formatColumnHeaderTitle(titleHolderElement,text||def.title||"&nbsp;")})):this._formatColumnHeaderTitle(titleHolderElement,def.title||"&nbsp;");return titleHolderElement}_formatColumnHeaderTitle(el,title){var contents=this.chain("column-format",[this,title,el],null,(()=>title));switch(typeof contents){case"object":contents instanceof Node?el.appendChild(contents):(el.innerHTML="",console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",contents));break;case"undefined":el.innerHTML="";break;default:el.innerHTML=contents}}_buildGroupHeader(){(this.element.classList.add("tabulator-col-group"),this.element.setAttribute("role","columngroup"),this.element.setAttribute("aria-title",this.definition.title),this.definition.cssClass)&&this.definition.cssClass.split(" ").forEach((className=>{this.element.classList.add(className)}));this.titleElement.style.textAlign=this.definition.headerHozAlign,this.element.appendChild(this.groupElement)}_getFlatData(data){return data[this.field]}_getNestedData(data){var output,dataObj=data,structure=this.fieldStructure,length=structure.length;for(let i=0;i<length&&(output=dataObj=dataObj[structure[i]],dataObj);i++);return output}_setFlatData(data,value){this.field&&(data[this.field]=value)}_setNestedData(data,value){var dataObj=data,structure=this.fieldStructure,length=structure.length;for(let i=0;i<length;i++)if(i==length-1)dataObj[structure[i]]=value;else{if(!dataObj[structure[i]]){if(void 0===value)break;dataObj[structure[i]]={}}dataObj=dataObj[structure[i]]}}attachColumn(column){this.groupElement?(this.columns.push(column),this.groupElement.appendChild(column.getElement()),column.columnRendered()):console.warn("Column Warning - Column being attached to another column instead of column group")}verticalAlign(alignment,height){var parentHeight=this.parent.isGroup?this.parent.getGroupElement().clientHeight:height||this.parent.getHeadersElement().clientHeight;this.element.style.height=parentHeight+"px",this.dispatch("column-height",this,this.element.style.height),this.isGroup&&(this.groupElement.style.minHeight=parentHeight-this.contentElement.offsetHeight+"px"),this.columns.forEach((function(column){column.verticalAlign(alignment)}))}clearVerticalAlign(){this.element.style.paddingTop="",this.element.style.height="",this.element.style.minHeight="",this.groupElement.style.minHeight="",this.columns.forEach((function(column){column.clearVerticalAlign()})),this.dispatch("column-height",this,"")}getElement(){return this.element}getGroupElement(){return this.groupElement}getField(){return this.field}getTitleDownload(){return this.titleDownload}getFirstColumn(){return this.isGroup?!!this.columns.length&&this.columns[0].getFirstColumn():this}getLastColumn(){return this.isGroup?!!this.columns.length&&this.columns[this.columns.length-1].getLastColumn():this}getColumns(traverse){var columns=[];return traverse?this.columns.forEach((column=>{columns.push(column),columns=columns.concat(column.getColumns(!0))})):columns=this.columns,columns}getCells(){return this.cells}getTopColumn(){return this.parent.isGroup?this.parent.getTopColumn():this}getDefinition(updateBranches){var colDefs=[];return this.isGroup&&updateBranches&&(this.columns.forEach((function(column){colDefs.push(column.getDefinition(!0))})),this.definition.columns=colDefs),this.definition}checkColumnVisibility(){var visible=!1;this.columns.forEach((function(column){column.visible&&(visible=!0)})),visible?(this.show(),this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1)):this.hide()}show(silent,responsiveToggle){this.visible||(this.visible=!0,this.element.style.display="",this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach((function(cell){cell.show()})),this.isGroup||null!==this.width||this.reinitializeWidth(),this.table.columnManager.verticalAlignHeaders(),this.dispatch("column-show",this,responsiveToggle),silent||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!0),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}hide(silent,responsiveToggle){this.visible&&(this.visible=!1,this.element.style.display="none",this.table.columnManager.verticalAlignHeaders(),this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach((function(cell){cell.hide()})),this.dispatch("column-hide",this,responsiveToggle),silent||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}matchChildWidths(){var childWidth=0;this.contentElement&&this.columns.length&&(this.columns.forEach((function(column){column.visible&&(childWidth+=column.getWidth())})),this.contentElement.style.maxWidth=childWidth-1+"px",this.parent.isGroup&&this.parent.matchChildWidths())}removeChild(child){var index=this.columns.indexOf(child);index>-1&&this.columns.splice(index,1),this.columns.length||this.delete()}setWidth(width){this.widthFixed=!0,this.setWidthActual(width)}setWidthActual(width){isNaN(width)&&(width=Math.floor(this.table.element.clientWidth/100*parseInt(width))),width=Math.max(this.minWidth,width),this.maxWidth&&(width=Math.min(this.maxWidth,width)),this.width=width,this.widthStyled=width?width+"px":"",this.element.style.width=this.widthStyled,this.isGroup||this.cells.forEach((function(cell){cell.setWidth()})),this.parent.isGroup&&this.parent.matchChildWidths(),this.dispatch("column-width",this)}checkCellHeights(){var rows=[];this.cells.forEach((function(cell){cell.row.heightInitialized&&(null!==cell.row.getElement().offsetParent?(rows.push(cell.row),cell.row.clearCellHeight()):cell.row.heightInitialized=!1)})),rows.forEach((function(row){row.calcHeight()})),rows.forEach((function(row){row.setCellHeight()}))}getWidth(){var width=0;return this.isGroup?this.columns.forEach((function(column){column.visible&&(width+=column.getWidth())})):width=this.width,width}getLeftOffset(){var offset=this.element.offsetLeft;return this.parent.isGroup&&(offset+=this.parent.getLeftOffset()),offset}getHeight(){return Math.ceil(this.element.getBoundingClientRect().height)}setMinWidth(minWidth){this.maxWidth&&minWidth>this.maxWidth&&(minWidth=this.maxWidth,console.warn("the minWidth ("+minWidth+"px) for column '"+this.field+"' cannot be bigger that its maxWidth ("+this.maxWidthStyled+")")),this.minWidth=minWidth,this.minWidthStyled=minWidth?minWidth+"px":"",this.element.style.minWidth=this.minWidthStyled,this.cells.forEach((function(cell){cell.setMinWidth()}))}setMaxWidth(maxWidth){this.minWidth&&maxWidth<this.minWidth&&(maxWidth=this.minWidth,console.warn("the maxWidth ("+maxWidth+"px) for column '"+this.field+"' cannot be smaller that its minWidth ("+this.minWidthStyled+")")),this.maxWidth=maxWidth,this.maxWidthStyled=maxWidth?maxWidth+"px":"",this.element.style.maxWidth=this.maxWidthStyled,this.cells.forEach((function(cell){cell.setMaxWidth()}))}delete(){return new Promise(((resolve,reject)=>{this.isGroup&&this.columns.forEach((function(column){column.delete()})),this.dispatch("column-delete",this);var cellCount=this.cells.length;for(let i=0;i<cellCount;i++)this.cells[0].delete();this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.contentElement=!1,this.titleElement=!1,this.groupElement=!1,this.parent.isGroup&&this.parent.removeChild(this),this.table.columnManager.deregisterColumn(this),this.table.columnManager.rerenderColumns(!0),resolve()}))}columnRendered(){this.titleFormatterRendered&&this.titleFormatterRendered(),this.dispatch("column-rendered",this)}generateCell(row){var cell=new Cell(this,row);return this.cells.push(cell),cell}nextColumn(){var index=this.table.columnManager.findColumnIndex(this);return index>-1&&this._nextVisibleColumn(index+1)}_nextVisibleColumn(index){var column=this.table.columnManager.getColumnByIndex(index);return!column||column.visible?column:this._nextVisibleColumn(index+1)}prevColumn(){var index=this.table.columnManager.findColumnIndex(this);return index>-1&&this._prevVisibleColumn(index-1)}_prevVisibleColumn(index){var column=this.table.columnManager.getColumnByIndex(index);return!column||column.visible?column:this._prevVisibleColumn(index-1)}reinitializeWidth(force){this.widthFixed=!1,void 0===this.definition.width||force||this.setWidth(this.definition.width),this.dispatch("column-width-fit-before",this),this.fitToData(force),this.dispatch("column-width-fit-after",this)}fitToData(force){if(!this.isGroup){this.widthFixed||(this.element.style.width="",this.cells.forEach((cell=>{cell.clearWidth()})));var maxWidth=this.element.offsetWidth;if((!this.width||!this.widthFixed)&&(this.cells.forEach((cell=>{var width=cell.getWidth();width>maxWidth&&(maxWidth=width)})),maxWidth)){var setTo=maxWidth+1;this.maxInitialWidth&&!force&&(setTo=Math.min(setTo,this.maxInitialWidth)),this.setWidthActual(setTo)}}}updateDefinition(updates){var definition;return this.isGroup||this.parent.isGroup?(console.error("Column Update Error - The updateDefinition function is only available on ungrouped columns"),Promise.reject("Column Update Error - The updateDefinition function is only available on columns, not column groups")):(definition=Object.assign({},this.getDefinition()),definition=Object.assign(definition,updates),this.table.columnManager.addColumn(definition,!1,this).then((column=>(definition.field==this.field&&(this.field=!1),this.delete().then((()=>column.getComponent()))))))}deleteCell(cell){var index=this.cells.indexOf(cell);index>-1&&this.cells.splice(index,1)}getComponent(){return this.component||(this.component=new ColumnComponent(this)),this.component}}Column.defaultOptionList=defaultColumnOptions;class RowComponent{constructor(row){return this._row=row,new Proxy(this,{get:function(target,name,receiver){return void 0!==target[name]?target[name]:target._row.table.componentFunctionBinder.handle("row",target._row,name)}})}getData(transform){return this._row.getData(transform)}getElement(){return this._row.getElement()}getCells(){var cells=[];return this._row.getCells().forEach((function(cell){cells.push(cell.getComponent())})),cells}getCell(column){var cell=this._row.getCell(column);return!!cell&&cell.getComponent()}getIndex(){return this._row.getData("data")[this._row.table.options.index]}getPosition(){return this._row.getPosition()}watchPosition(callback){return this._row.watchPosition(callback)}delete(){return this._row.delete()}scrollTo(){return this._row.table.rowManager.scrollToRow(this._row)}move(to,after){this._row.moveToRow(to,after)}update(data){return this._row.updateData(data)}normalizeHeight(){this._row.normalizeHeight(!0)}_getSelf(){return this._row}reformat(){return this._row.reinitialize()}getTable(){return this._row.table}getNextRow(){var row=this._row.nextRow();return row?row.getComponent():row}getPrevRow(){var row=this._row.prevRow();return row?row.getComponent():row}}_exports.RowComponent=RowComponent;class Row extends CoreFeature{constructor(data,parent){let type=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"row";super(parent.table),this.parent=parent,this.data={},this.type=type,this.element=!1,this.modules={},this.cells=[],this.height=0,this.heightStyled="",this.manualHeight=!1,this.outerHeight=0,this.initialized=!1,this.heightInitialized=!1,this.position=0,this.positionWatchers=[],this.component=null,this.created=!1,this.setData(data)}create(){this.created||(this.created=!0,this.generateElement())}createElement(){var el=document.createElement("div");el.classList.add("tabulator-row"),el.setAttribute("role","row"),this.element=el}getElement(){return this.create(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}generateElement(){this.createElement(),this.dispatch("row-init",this)}generateCells(){this.cells=this.table.columnManager.generateCells(this)}initialize(force){if(this.create(),!this.initialized||force){for(this.deleteCells();this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.dispatch("row-layout-before",this),this.generateCells(),this.initialized=!0,this.table.columnManager.renderer.renderRowCells(this),force&&this.normalizeHeight(),this.dispatch("row-layout",this),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent()),this.dispatch("row-layout-after",this)}else this.table.columnManager.renderer.rerenderRowCells(this)}reinitializeHeight(){this.heightInitialized=!1,this.element&&null!==this.element.offsetParent&&this.normalizeHeight(!0)}deinitialize(){this.initialized=!1}deinitializeHeight(){this.heightInitialized=!1}reinitialize(children){this.initialized=!1,this.heightInitialized=!1,this.manualHeight||(this.height=0,this.heightStyled=""),this.element&&null!==this.element.offsetParent&&this.initialize(!0),this.dispatch("row-relayout",this)}calcHeight(force){var minHeight,maxHeight=0;this.table.options.rowHeight?this.height=this.table.options.rowHeight:(minHeight=this.table.options.resizableRows?this.element.clientHeight:0,this.cells.forEach((function(cell){var height=cell.getHeight();height>maxHeight&&(maxHeight=height)})),this.height=force?Math.max(maxHeight,minHeight):this.manualHeight?this.height:Math.max(maxHeight,minHeight)),this.heightStyled=this.height?this.height+"px":"",this.outerHeight=this.element.offsetHeight}setCellHeight(){this.cells.forEach((function(cell){cell.setHeight()})),this.heightInitialized=!0}clearCellHeight(){this.cells.forEach((function(cell){cell.clearHeight()}))}normalizeHeight(force){force&&!this.table.options.rowHeight&&this.clearCellHeight(),this.calcHeight(force),this.setCellHeight()}setHeight(height,force){(this.height!=height||force)&&(this.manualHeight=!0,this.height=height,this.heightStyled=height?height+"px":"",this.setCellHeight(),this.outerHeight=this.element.offsetHeight)}getHeight(){return this.outerHeight}getWidth(){return this.element.offsetWidth}deleteCell(cell){var index=this.cells.indexOf(cell);index>-1&&this.cells.splice(index,1)}setData(data){this.data=this.chain("row-data-init-before",[this,data],void 0,data),this.dispatch("row-data-init-after",this)}updateData(updatedData){var newRowData,visible=this.element&&Helpers.elVisible(this.element),tempData={};return new Promise(((resolve,reject)=>{"string"==typeof updatedData&&(updatedData=JSON.parse(updatedData)),this.dispatch("row-data-save-before",this),this.subscribed("row-data-changing")&&(tempData=Object.assign(tempData,this.data),tempData=Object.assign(tempData,updatedData)),newRowData=this.chain("row-data-changing",[this,tempData,updatedData],null,updatedData);for(let attrname in newRowData)this.data[attrname]=newRowData[attrname];this.dispatch("row-data-save-after",this);for(let attrname in updatedData){this.table.columnManager.getColumnsByFieldRoot(attrname).forEach((column=>{let cell=this.getCell(column.getField());if(cell){let value=column.getFieldValue(newRowData);cell.getValue()!==value&&(cell.setValueProcessData(value),visible&&cell.cellRendered())}}))}visible?(this.normalizeHeight(!0),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent())):(this.initialized=!1,this.height=0,this.heightStyled=""),this.dispatch("row-data-changed",this,visible,updatedData),this.dispatchExternal("rowUpdated",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),resolve()}))}getData(transform){return transform?this.chain("row-data-retrieve",[this,transform],null,this.data):this.data}getCell(column){return column=this.table.columnManager.findColumn(column),this.initialized||this.generateCells(),this.cells.find((function(cell){return cell.column===column}))}getCellIndex(findCell){return this.cells.findIndex((function(cell){return cell===findCell}))}findCell(subject){return this.cells.find((cell=>cell.element===subject))}getCells(){return this.initialized||this.generateCells(),this.cells}nextRow(){return this.table.rowManager.nextDisplayRow(this,!0)||!1}prevRow(){return this.table.rowManager.prevDisplayRow(this,!0)||!1}moveToRow(to,before){var toRow=this.table.rowManager.findRow(to);toRow?(this.table.rowManager.moveRowActual(this,toRow,!before),this.table.rowManager.refreshActiveData("display",!1,!0)):console.warn("Move Error - No matching row found:",to)}delete(){return this.dispatch("row-delete",this),this.deleteActual(),Promise.resolve()}deleteActual(blockRedraw){this.detachModules(),this.table.rowManager.deleteRow(this,blockRedraw),this.deleteCells(),this.initialized=!1,this.heightInitialized=!1,this.element=!1,this.dispatch("row-deleted",this)}detachModules(){this.dispatch("row-deleting",this)}deleteCells(){var cellCount=this.cells.length;for(let i=0;i<cellCount;i++)this.cells[0].delete()}wipe(){if(this.detachModules(),this.deleteCells(),this.element){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.parentNode&&this.element.parentNode.removeChild(this.element)}this.element=!1,this.modules={}}isDisplayed(){return this.table.rowManager.getDisplayRows().includes(this)}getPosition(){return!!this.isDisplayed()&&this.position}setPosition(position){position!=this.position&&(this.position=position,this.positionWatchers.forEach((callback=>{callback(this.position)})))}watchPosition(callback){this.positionWatchers.push(callback),callback(this.position)}getGroup(){return this.modules.group||!1}getComponent(){return this.component||(this.component=new RowComponent(this)),this.component}}var defaultCalculations={avg:function(values,data,calcParams){var output=0,precision=void 0!==calcParams.precision?calcParams.precision:2;return values.length&&(output=values.reduce((function(sum,value){return Number(sum)+Number(value)})),output/=values.length,output=!1!==precision?output.toFixed(precision):output),parseFloat(output).toString()},max:function(values,data,calcParams){var output=null,precision=void 0!==calcParams.precision&&calcParams.precision;return values.forEach((function(value){((value=Number(value))>output||null===output)&&(output=value)})),null!==output?!1!==precision?output.toFixed(precision):output:""},min:function(values,data,calcParams){var output=null,precision=void 0!==calcParams.precision&&calcParams.precision;return values.forEach((function(value){((value=Number(value))<output||null===output)&&(output=value)})),null!==output?!1!==precision?output.toFixed(precision):output:""},sum:function(values,data,calcParams){var output=0,precision=void 0!==calcParams.precision&&calcParams.precision;return values.length&&values.forEach((function(value){value=Number(value),output+=isNaN(value)?0:Number(value)})),!1!==precision?output.toFixed(precision):output},concat:function(values,data,calcParams){var output=0;return values.length&&(output=values.reduce((function(sum,value){return String(sum)+String(value)}))),output},count:function(values,data,calcParams){var output=0;return values.length&&values.forEach((function(value){value&&output++})),output}};class ColumnCalcs extends Module{constructor(table){super(table),this.topCalcs=[],this.botCalcs=[],this.genColumn=!1,this.topElement=this.createElement(),this.botElement=this.createElement(),this.topRow=!1,this.botRow=!1,this.topInitialized=!1,this.botInitialized=!1,this.blocked=!1,this.recalcAfterBlock=!1,this.registerTableOption("columnCalcs",!0),this.registerColumnOption("topCalc"),this.registerColumnOption("topCalcParams"),this.registerColumnOption("topCalcFormatter"),this.registerColumnOption("topCalcFormatterParams"),this.registerColumnOption("bottomCalc"),this.registerColumnOption("bottomCalcParams"),this.registerColumnOption("bottomCalcFormatter"),this.registerColumnOption("bottomCalcFormatterParams")}createElement(){var el=document.createElement("div");return el.classList.add("tabulator-calcs-holder"),el}initialize(){this.genColumn=new Column({field:"value"},this),this.subscribe("cell-value-changed",this.cellValueChanged.bind(this)),this.subscribe("column-init",this.initializeColumnCheck.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("column-moved",this.recalcActiveRows.bind(this)),this.subscribe("column-add",this.recalcActiveRows.bind(this)),this.subscribe("data-refreshed",this.recalcActiveRowsRefresh.bind(this)),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this)),this.subscribe("redraw-blocked",this.blockRedraw.bind(this)),this.subscribe("redraw-restored",this.restoreRedraw.bind(this)),this.registerTableFunction("getCalcResults",this.getResults.bind(this)),this.registerTableFunction("recalc",this.userRecalc.bind(this))}tableRedraw(force){this.recalc(this.table.rowManager.activeRows),force&&this.redraw()}blockRedraw(){this.blocked=!0,this.recalcAfterBlock=!1}restoreRedraw(){this.blocked=!1,this.recalcAfterBlock&&(this.recalcAfterBlock=!1,this.recalcActiveRowsRefresh())}userRecalc(){this.recalc(this.table.rowManager.activeRows)}blockCheck(){return this.blocked&&(this.recalcAfterBlock=!0),this.blocked}visibleRows(viewable,rows){return this.topRow&&rows.unshift(this.topRow),this.botRow&&rows.push(this.botRow),rows}rowsUpdated(row){this.table.options.groupBy?this.recalcRowGroup(row):this.recalcActiveRows()}recalcActiveRowsRefresh(){this.table.options.groupBy&&this.table.options.dataTreeStartExpanded&&this.table.options.dataTree?this.recalcAll():this.recalcActiveRows()}recalcActiveRows(){this.recalc(this.table.rowManager.activeRows)}cellValueChanged(cell){(cell.column.definition.topCalc||cell.column.definition.bottomCalc)&&(this.table.options.groupBy?("table"!=this.table.options.columnCalcs&&"both"!=this.table.options.columnCalcs||this.recalcActiveRows(),"table"!=this.table.options.columnCalcs&&this.recalcRowGroup(cell.row)):this.recalcActiveRows())}initializeColumnCheck(column){(column.definition.topCalc||column.definition.bottomCalc)&&this.initializeColumn(column)}initializeColumn(column){var def=column.definition,config={topCalcParams:def.topCalcParams||{},botCalcParams:def.bottomCalcParams||{}};if(def.topCalc){switch(typeof def.topCalc){case"string":ColumnCalcs.calculations[def.topCalc]?config.topCalc=ColumnCalcs.calculations[def.topCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",def.topCalc);break;case"function":config.topCalc=def.topCalc}config.topCalc&&(column.modules.columnCalcs=config,this.topCalcs.push(column),"group"!=this.table.options.columnCalcs&&this.initializeTopRow())}if(def.bottomCalc){switch(typeof def.bottomCalc){case"string":ColumnCalcs.calculations[def.bottomCalc]?config.botCalc=ColumnCalcs.calculations[def.bottomCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",def.bottomCalc);break;case"function":config.botCalc=def.bottomCalc}config.botCalc&&(column.modules.columnCalcs=config,this.botCalcs.push(column),"group"!=this.table.options.columnCalcs&&this.initializeBottomRow())}}registerColumnField(){}removeCalcs(){var changed=!1;this.topInitialized&&(this.topInitialized=!1,this.topElement.parentNode.removeChild(this.topElement),changed=!0),this.botInitialized&&(this.botInitialized=!1,this.footerRemove(this.botElement),changed=!0),changed&&this.table.rowManager.adjustTableSize()}reinitializeCalcs(){this.topCalcs.length&&this.initializeTopRow(),this.botCalcs.length&&this.initializeBottomRow()}initializeTopRow(){this.topInitialized||(this.table.columnManager.getContentsElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling),this.topInitialized=!0)}initializeBottomRow(){this.botInitialized||(this.footerPrepend(this.botElement),this.botInitialized=!0)}scrollHorizontal(left){this.botInitialized&&this.botRow&&(this.botElement.scrollLeft=left)}recalc(rows){var data,row;if(!this.blockCheck()&&(this.topInitialized||this.botInitialized)){if(data=this.rowsToData(rows),this.topInitialized){for(this.topRow&&this.topRow.deleteCells(),row=this.generateRow("top",data),this.topRow=row;this.topElement.firstChild;)this.topElement.removeChild(this.topElement.firstChild);this.topElement.appendChild(row.getElement()),row.initialize(!0)}if(this.botInitialized){for(this.botRow&&this.botRow.deleteCells(),row=this.generateRow("bottom",data),this.botRow=row;this.botElement.firstChild;)this.botElement.removeChild(this.botElement.firstChild);this.botElement.appendChild(row.getElement()),row.initialize(!0)}this.table.rowManager.adjustTableSize(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()}}recalcRowGroup(row){this.recalcGroup(this.table.modules.groupRows.getRowGroup(row))}recalcAll(){(this.topCalcs.length||this.botCalcs.length)&&("group"!==this.table.options.columnCalcs&&this.recalcActiveRows(),this.table.options.groupBy&&"table"!==this.table.options.columnCalcs&&this.table.modules.groupRows.getChildGroups().forEach((group=>{this.recalcGroup(group)})))}recalcGroup(group){var data,rowData;this.blockCheck()||group&&group.calcs&&(group.calcs.bottom&&(data=this.rowsToData(group.rows),rowData=this.generateRowData("bottom",data),group.calcs.bottom.updateData(rowData),group.calcs.bottom.reinitialize()),group.calcs.top&&(data=this.rowsToData(group.rows),rowData=this.generateRowData("top",data),group.calcs.top.updateData(rowData),group.calcs.top.reinitialize()))}generateTopRow(rows){return this.generateRow("top",this.rowsToData(rows))}generateBottomRow(rows){return this.generateRow("bottom",this.rowsToData(rows))}rowsToData(rows){var data=[];return rows.forEach((row=>{if(data.push(row.getData()),this.table.options.dataTree&&this.table.options.dataTreeChildColumnCalcs&&row.modules.dataTree&&row.modules.dataTree.open){var children=this.rowsToData(this.table.modules.dataTree.getFilteredTreeChildren(row));data=data.concat(children)}})),data}generateRow(pos,data){var row,rowData=this.generateRowData(pos,data);return this.table.modExists("mutator")&&this.table.modules.mutator.disable(),row=new Row(rowData,this,"calc"),this.table.modExists("mutator")&&this.table.modules.mutator.enable(),row.getElement().classList.add("tabulator-calcs","tabulator-calcs-"+pos),row.component=!1,row.getComponent=()=>(row.component||(row.component=new CalcComponent(row)),row.component),row.generateCells=()=>{var cells=[];this.table.columnManager.columnsByIndex.forEach((column=>{this.genColumn.setField(column.getField()),this.genColumn.hozAlign=column.hozAlign,column.definition[pos+"CalcFormatter"]&&this.table.modExists("format")?this.genColumn.modules.format={formatter:this.table.modules.format.getFormatter(column.definition[pos+"CalcFormatter"]),params:column.definition[pos+"CalcFormatterParams"]||{}}:this.genColumn.modules.format={formatter:this.table.modules.format.getFormatter("plaintext"),params:{}},this.genColumn.definition.cssClass=column.definition.cssClass;var cell=new Cell(this.genColumn,row);cell.getElement(),cell.column=column,cell.setWidth(),column.cells.push(cell),cells.push(cell),column.visible||cell.hide()})),row.cells=cells},row}generateRowData(pos,data){var params,paramKey,rowData={},calcs="top"==pos?this.topCalcs:this.botCalcs,type="top"==pos?"topCalc":"botCalc";return calcs.forEach((function(column){var values=[];column.modules.columnCalcs&&column.modules.columnCalcs[type]&&(data.forEach((function(item){values.push(column.getFieldValue(item))})),paramKey=type+"Params",params="function"==typeof column.modules.columnCalcs[paramKey]?column.modules.columnCalcs[paramKey](values,data):column.modules.columnCalcs[paramKey],column.setFieldValue(rowData,column.modules.columnCalcs[type](values,data,params)))})),rowData}hasTopCalcs(){return!!this.topCalcs.length}hasBottomCalcs(){return!!this.botCalcs.length}redraw(){this.topRow&&this.topRow.normalizeHeight(!0),this.botRow&&this.botRow.normalizeHeight(!0)}getResults(){var results={};return this.table.options.groupBy&&this.table.modExists("groupRows")?this.table.modules.groupRows.getGroups(!0).forEach((group=>{results[group.getKey()]=this.getGroupResults(group)})):results={top:this.topRow?this.topRow.getData():{},bottom:this.botRow?this.botRow.getData():{}},results}getGroupResults(group){var groupObj=group._getSelf(),subGroups=group.getSubGroups(),subGroupResults={};return subGroups.forEach((subgroup=>{subGroupResults[subgroup.getKey()]=this.getGroupResults(subgroup)})),{top:groupObj.calcs.top?groupObj.calcs.top.getData():{},bottom:groupObj.calcs.bottom?groupObj.calcs.bottom.getData():{},groups:subGroupResults}}adjustForScrollbar(width){this.botRow&&(this.table.rtl?this.botElement.style.paddingLeft=width+"px":this.botElement.style.paddingRight=width+"px")}}_exports.ColumnCalcsModule=ColumnCalcs,ColumnCalcs.moduleName="columnCalcs",ColumnCalcs.calculations=defaultCalculations;class DataTree extends Module{constructor(table){super(table),this.indent=10,this.field="",this.collapseEl=null,this.expandEl=null,this.branchEl=null,this.elementField=!1,this.startOpen=function(){},this.registerTableOption("dataTree",!1),this.registerTableOption("dataTreeFilter",!0),this.registerTableOption("dataTreeSort",!0),this.registerTableOption("dataTreeElementColumn",!1),this.registerTableOption("dataTreeBranchElement",!0),this.registerTableOption("dataTreeChildIndent",9),this.registerTableOption("dataTreeChildField","_children"),this.registerTableOption("dataTreeCollapseElement",!1),this.registerTableOption("dataTreeExpandElement",!1),this.registerTableOption("dataTreeStartExpanded",!1),this.registerTableOption("dataTreeChildColumnCalcs",!1),this.registerTableOption("dataTreeSelectPropagate",!1),this.registerComponentFunction("row","treeCollapse",this.collapseRow.bind(this)),this.registerComponentFunction("row","treeExpand",this.expandRow.bind(this)),this.registerComponentFunction("row","treeToggle",this.toggleRow.bind(this)),this.registerComponentFunction("row","getTreeParent",this.getTreeParent.bind(this)),this.registerComponentFunction("row","getTreeChildren",this.getRowChildren.bind(this)),this.registerComponentFunction("row","addTreeChild",this.addTreeChildRow.bind(this)),this.registerComponentFunction("row","isTreeExpanded",this.isRowExpanded.bind(this))}initialize(){if(this.table.options.dataTree){var dummyEl=null,options=this.table.options;switch(this.field=options.dataTreeChildField,this.indent=options.dataTreeChildIndent,this.options("movableRows")&&console.warn("The movableRows option is not available with dataTree enabled, moving of child rows could result in unpredictable behavior"),options.dataTreeBranchElement&&(!0===options.dataTreeBranchElement?(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch")):"string"==typeof options.dataTreeBranchElement?((dummyEl=document.createElement("div")).innerHTML=options.dataTreeBranchElement,this.branchEl=dummyEl.firstChild):this.branchEl=options.dataTreeBranchElement),options.dataTreeCollapseElement?"string"==typeof options.dataTreeCollapseElement?((dummyEl=document.createElement("div")).innerHTML=options.dataTreeCollapseElement,this.collapseEl=dummyEl.firstChild):this.collapseEl=options.dataTreeCollapseElement:(this.collapseEl=document.createElement("div"),this.collapseEl.classList.add("tabulator-data-tree-control"),this.collapseEl.tabIndex=0,this.collapseEl.innerHTML="<div class='tabulator-data-tree-control-collapse'></div>"),options.dataTreeExpandElement?"string"==typeof options.dataTreeExpandElement?((dummyEl=document.createElement("div")).innerHTML=options.dataTreeExpandElement,this.expandEl=dummyEl.firstChild):this.expandEl=options.dataTreeExpandElement:(this.expandEl=document.createElement("div"),this.expandEl.classList.add("tabulator-data-tree-control"),this.expandEl.tabIndex=0,this.expandEl.innerHTML="<div class='tabulator-data-tree-control-expand'></div>"),typeof options.dataTreeStartExpanded){case"boolean":this.startOpen=function(row,index){return options.dataTreeStartExpanded};break;case"function":this.startOpen=options.dataTreeStartExpanded;break;default:this.startOpen=function(row,index){return options.dataTreeStartExpanded[index]}}this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("row-deleted",this.rowDelete.bind(this),0),this.subscribe("row-data-changed",this.rowDataChanged.bind(this),10),this.subscribe("cell-value-updated",this.cellValueChanged.bind(this)),this.subscribe("edit-cancelled",this.cellValueChanged.bind(this)),this.subscribe("column-moving-rows",this.columnMoving.bind(this)),this.subscribe("table-built",this.initializeElementField.bind(this)),this.subscribe("table-redrawing",this.tableRedrawing.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),30)}}tableRedrawing(force){force&&this.table.rowManager.getRows().forEach((row=>{this.reinitializeRowChildren(row)}))}initializeElementField(){var firstCol=this.table.columnManager.getFirstVisibleColumn();this.elementField=this.table.options.dataTreeElementColumn||!!firstCol&&firstCol.field}getRowChildren(row){return this.getTreeChildren(row,!0)}columnMoving(){var rows=[];return this.table.rowManager.rows.forEach((row=>{rows=rows.concat(this.getTreeChildren(row,!1,!0))})),rows}rowDataChanged(row,visible,updatedData){this.redrawNeeded(updatedData)&&(this.initializeRow(row),visible&&(this.layoutRow(row),this.refreshData(!0)))}cellValueChanged(cell){cell.column.getField()===this.elementField&&this.layoutRow(cell.row)}initializeRow(row){var childArray=row.getData()[this.field],isArray=Array.isArray(childArray),children=isArray||!isArray&&"object"==typeof childArray&&null!==childArray;!children&&row.modules.dataTree&&row.modules.dataTree.branchEl&&row.modules.dataTree.branchEl.parentNode.removeChild(row.modules.dataTree.branchEl),!children&&row.modules.dataTree&&row.modules.dataTree.controlEl&&row.modules.dataTree.controlEl.parentNode.removeChild(row.modules.dataTree.controlEl),row.modules.dataTree={index:row.modules.dataTree?row.modules.dataTree.index:0,open:!!children&&(row.modules.dataTree?row.modules.dataTree.open:this.startOpen(row.getComponent(),0)),controlEl:!(!row.modules.dataTree||!children)&&row.modules.dataTree.controlEl,branchEl:!(!row.modules.dataTree||!children)&&row.modules.dataTree.branchEl,parent:!!row.modules.dataTree&&row.modules.dataTree.parent,children:children}}reinitializeRowChildren(row){this.getTreeChildren(row,!1,!0).forEach((function(child){child.reinitialize(!0)}))}layoutRow(row){var el=(this.elementField?row.getCell(this.elementField):row.getCells()[0]).getElement(),config=row.modules.dataTree;config.branchEl&&(config.branchEl.parentNode&&config.branchEl.parentNode.removeChild(config.branchEl),config.branchEl=!1),config.controlEl&&(config.controlEl.parentNode&&config.controlEl.parentNode.removeChild(config.controlEl),config.controlEl=!1),this.generateControlElement(row,el),row.getElement().classList.add("tabulator-tree-level-"+config.index),config.index&&(this.branchEl?(config.branchEl=this.branchEl.cloneNode(!0),el.insertBefore(config.branchEl,el.firstChild),this.table.rtl?config.branchEl.style.marginRight=(config.branchEl.offsetWidth+config.branchEl.style.marginLeft)*(config.index-1)+config.index*this.indent+"px":config.branchEl.style.marginLeft=(config.branchEl.offsetWidth+config.branchEl.style.marginRight)*(config.index-1)+config.index*this.indent+"px"):this.table.rtl?el.style.paddingRight=parseInt(window.getComputedStyle(el,null).getPropertyValue("padding-right"))+config.index*this.indent+"px":el.style.paddingLeft=parseInt(window.getComputedStyle(el,null).getPropertyValue("padding-left"))+config.index*this.indent+"px")}generateControlElement(row,el){var config=row.modules.dataTree,oldControl=config.controlEl;el=el||row.getCells()[0].getElement(),!1!==config.children&&(config.open?(config.controlEl=this.collapseEl.cloneNode(!0),config.controlEl.addEventListener("click",(e=>{e.stopPropagation(),this.collapseRow(row)}))):(config.controlEl=this.expandEl.cloneNode(!0),config.controlEl.addEventListener("click",(e=>{e.stopPropagation(),this.expandRow(row)}))),config.controlEl.addEventListener("mousedown",(e=>{e.stopPropagation()})),oldControl&&oldControl.parentNode===el?oldControl.parentNode.replaceChild(config.controlEl,oldControl):el.insertBefore(config.controlEl,el.firstChild))}getRows(rows){var output=[];return rows.forEach(((row,i)=>{var config;output.push(row),row instanceof Row&&(row.create(),(config=row.modules.dataTree.children).index||!1===config.children||this.getChildren(row).forEach((child=>{child.create(),output.push(child)})))})),output}getChildren(row,allChildren){var config=row.modules.dataTree,children=[],output=[];return!1!==config.children&&(config.open||allChildren)&&(Array.isArray(config.children)||(config.children=this.generateChildren(row)),children=this.table.modExists("filter")&&this.table.options.dataTreeFilter?this.table.modules.filter.filter(config.children):config.children,this.table.modExists("sort")&&this.table.options.dataTreeSort&&this.table.modules.sort.sort(children),children.forEach((child=>{output.push(child),this.getChildren(child).forEach((sub=>{output.push(sub)}))}))),output}generateChildren(row){var children=[],childArray=row.getData()[this.field];return Array.isArray(childArray)||(childArray=[childArray]),childArray.forEach((childData=>{var childRow=new Row(childData||{},this.table.rowManager);childRow.create(),childRow.modules.dataTree.index=row.modules.dataTree.index+1,childRow.modules.dataTree.parent=row,childRow.modules.dataTree.children&&(childRow.modules.dataTree.open=this.startOpen(childRow.getComponent(),childRow.modules.dataTree.index)),children.push(childRow)})),children}expandRow(row,silent){var config=row.modules.dataTree;!1!==config.children&&(config.open=!0,row.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowExpanded",row.getComponent(),row.modules.dataTree.index))}collapseRow(row){var config=row.modules.dataTree;!1!==config.children&&(config.open=!1,row.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowCollapsed",row.getComponent(),row.modules.dataTree.index))}toggleRow(row){var config=row.modules.dataTree;!1!==config.children&&(config.open?this.collapseRow(row):this.expandRow(row))}isRowExpanded(row){return row.modules.dataTree.open}getTreeParent(row){return!!row.modules.dataTree.parent&&row.modules.dataTree.parent.getComponent()}getTreeParentRoot(row){return row.modules.dataTree&&row.modules.dataTree.parent?this.getTreeParentRoot(row.modules.dataTree.parent):row}getFilteredTreeChildren(row){var config=row.modules.dataTree,output=[];return config.children&&(Array.isArray(config.children)||(config.children=this.generateChildren(row)),(this.table.modExists("filter")&&this.table.options.dataTreeFilter?this.table.modules.filter.filter(config.children):config.children).forEach((childRow=>{childRow instanceof Row&&output.push(childRow)}))),output}rowDelete(row){var childIndex,parent=row.modules.dataTree.parent;parent&&(!1!==(childIndex=this.findChildIndex(row,parent))&&parent.data[this.field].splice(childIndex,1),parent.data[this.field].length||delete parent.data[this.field],this.initializeRow(parent),this.layoutRow(parent)),this.refreshData(!0)}addTreeChildRow(row,data,top,index){var childIndex=!1;"string"==typeof data&&(data=JSON.parse(data)),Array.isArray(row.data[this.field])||(row.data[this.field]=[],row.modules.dataTree.open=this.startOpen(row.getComponent(),row.modules.dataTree.index)),void 0!==index&&!1!==(childIndex=this.findChildIndex(index,row))&&row.data[this.field].splice(top?childIndex:childIndex+1,0,data),!1===childIndex&&(top?row.data[this.field].unshift(data):row.data[this.field].push(data)),this.initializeRow(row),this.layoutRow(row),this.refreshData(!0)}findChildIndex(subject,parent){var match=!1;return"object"==typeof subject?subject instanceof Row?match=subject.data:subject instanceof RowComponent?match=subject._getSelf().data:"undefined"!=typeof HTMLElement&&subject instanceof HTMLElement?parent.modules.dataTree&&(match=parent.modules.dataTree.children.find((childRow=>childRow instanceof Row&&childRow.element===subject)))&&(match=match.data):null===subject&&(match=!1):match=void 0!==subject&&parent.data[this.field].find((row=>row.data[this.table.options.index]==subject)),match&&(Array.isArray(parent.data[this.field])&&(match=parent.data[this.field].indexOf(match)),-1==match&&(match=!1)),match}getTreeChildren(row,component,recurse){var config=row.modules.dataTree,output=[];return config.children&&(Array.isArray(config.children)||(config.children=this.generateChildren(row)),config.children.forEach((childRow=>{childRow instanceof Row&&(output.push(component?childRow.getComponent():childRow),recurse&&(output=output.concat(this.getTreeChildren(childRow,component,recurse))))}))),output}getChildField(){return this.field}redrawNeeded(data){return!!this.field&&void 0!==data[this.field]||!!this.elementField&&void 0!==data[this.elementField]}}_exports.DataTreeModule=DataTree,DataTree.moduleName="dataTree";var defaultDownloaders={csv:function(list){let options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},setFileContents=arguments.length>2?arguments[2]:void 0;var delimiter=options.delimiter?options.delimiter:",",fileContents=[],headers=[];list.forEach((row=>{var item=[];switch(row.type){case"group":console.warn("Download Warning - CSV downloader cannot process row groups");break;case"calc":console.warn("Download Warning - CSV downloader cannot process column calculations");break;case"header":row.columns.forEach(((col,i)=>{col&&1===col.depth&&(headers[i]=void 0===col.value||null===col.value?"":'"'+String(col.value).split('"').join('""')+'"')}));break;case"row":row.columns.forEach((col=>{if(col){switch(typeof col.value){case"object":col.value=null!==col.value?JSON.stringify(col.value):"";break;case"undefined":col.value=""}item.push('"'+String(col.value).split('"').join('""')+'"')}})),fileContents.push(item.join(delimiter))}})),headers.length&&fileContents.unshift(headers.join(delimiter)),fileContents=fileContents.join("\n"),options.bom&&(fileContents="\ufeff"+fileContents),setFileContents(fileContents,"text/csv")},json:function(list,options,setFileContents){var fileContents=[];list.forEach((row=>{var item={};switch(row.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":row.columns.forEach((col=>{col&&(item[col.component.getTitleDownload()||col.component.getField()]=col.value)})),fileContents.push(item)}})),setFileContents(fileContents=JSON.stringify(fileContents,null,"\t"),"application/json")},jsonLines:function(list,options,setFileContents){const fileContents=[];list.forEach((row=>{const item={};switch(row.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":row.columns.forEach((col=>{col&&(item[col.component.getTitleDownload()||col.component.getField()]=col.value)})),fileContents.push(JSON.stringify(item))}})),setFileContents(fileContents.join("\n"),"application/x-ndjson")},pdf:function(list){let options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},setFileContents=arguments.length>2?arguments[2]:void 0;var header=[],body=[],autoTableParams={},rowGroupStyles=options.rowGroupStyles||{fontStyle:"bold",fontSize:12,cellPadding:6,fillColor:220},rowCalcStyles=options.rowCalcStyles||{fontStyle:"bold",fontSize:10,cellPadding:4,fillColor:232},jsPDFParams=options.jsPDF||{},title=options.title?options.title:"";function parseRow(row,styles){var rowData=[];return row.columns.forEach((col=>{var cell;if(col){switch(typeof col.value){case"object":col.value=null!==col.value?JSON.stringify(col.value):"";break;case"undefined":col.value=""}cell={content:col.value,colSpan:col.width,rowSpan:col.height},styles&&(cell.styles=styles),rowData.push(cell)}})),rowData}jsPDFParams.orientation||(jsPDFParams.orientation=options.orientation||"landscape"),jsPDFParams.unit||(jsPDFParams.unit="pt"),list.forEach((row=>{switch(row.type){case"header":header.push(parseRow(row));break;case"group":body.push(parseRow(row,rowGroupStyles));break;case"calc":body.push(parseRow(row,rowCalcStyles));break;case"row":body.push(parseRow(row))}}));var doc=new jspdf.jsPDF(jsPDFParams);options.autoTable&&(autoTableParams="function"==typeof options.autoTable?options.autoTable(doc)||{}:options.autoTable),title&&(autoTableParams.didDrawPage=function(data){doc.text(title,40,30)}),autoTableParams.head=header,autoTableParams.body=body,doc.autoTable(autoTableParams),options.documentProcessing&&options.documentProcessing(doc),setFileContents(doc.output("arraybuffer"),"application/pdf")},xlsx:function(list,options,setFileContents){var sheetName=options.sheetName||"Sheet1",workbook=XLSX.utils.book_new(),tableFeatures=new CoreFeature(this),compression=!("compress"in options)||options.compress;function generateSheet(){var rows=[],merges=[],worksheet={},range={s:{c:0,r:0},e:{c:list[0]?list[0].columns.reduce(((a,b)=>a+(b&&b.width?b.width:1)),0):0,r:list.length}};return list.forEach(((row,i)=>{var rowData=[];row.columns.forEach((function(col,j){col?(rowData.push(col.value instanceof Date||"object"!=typeof col.value?col.value:JSON.stringify(col.value)),(col.width>1||col.height>-1)&&(col.height>1||col.width>1)&&merges.push({s:{r:i,c:j},e:{r:i+col.height-1,c:j+col.width-1}})):rowData.push("")})),rows.push(rowData)})),XLSX.utils.sheet_add_aoa(worksheet,rows),worksheet["!ref"]=XLSX.utils.encode_range(range),merges.length&&(worksheet["!merges"]=merges),worksheet}if(workbook.SheetNames=[],workbook.Sheets={},options.sheetOnly)setFileContents(generateSheet());else{if(options.sheets)for(var sheet in options.sheets)!0===options.sheets[sheet]?(workbook.SheetNames.push(sheet),workbook.Sheets[sheet]=generateSheet()):(workbook.SheetNames.push(sheet),tableFeatures.commsSend(options.sheets[sheet],"download","intercept",{type:"xlsx",options:{sheetOnly:!0},active:this.active,intercept:function(data){workbook.Sheets[sheet]=data}}));else workbook.SheetNames.push(sheetName),workbook.Sheets[sheetName]=generateSheet();options.documentProcessing&&(workbook=options.documentProcessing(workbook)),setFileContents(function(s){for(var buf=new ArrayBuffer(s.length),view=new Uint8Array(buf),i=0;i!=s.length;++i)view[i]=255&s.charCodeAt(i);return buf}(XLSX.write(workbook,{bookType:"xlsx",bookSST:!0,type:"binary",compression:compression})),"application/octet-stream")}},html:function(list,options,setFileContents){this.modExists("export",!0)&&setFileContents(this.modules.export.generateHTMLTable(list),"text/html")}};class Download extends Module{constructor(table){super(table),this.registerTableOption("downloadEncoder",(function(data,mimeType){return new Blob([data],{type:mimeType})})),this.registerTableOption("downloadReady",void 0),this.registerTableOption("downloadConfig",{}),this.registerTableOption("downloadRowRange","active"),this.registerColumnOption("download"),this.registerColumnOption("titleDownload")}initialize(){this.deprecatedOptionsCheck(),this.registerTableFunction("download",this.download.bind(this)),this.registerTableFunction("downloadToTab",this.downloadToTab.bind(this))}deprecatedOptionsCheck(){this.deprecationCheck("downloadReady","downloadEncoder")}downloadToTab(type,filename,options,active){this.download(type,filename,options,active,!0)}download(type,filename,options,range,interceptCallback){var downloadFunc=!1;if("function"==typeof type?downloadFunc=type:Download.downloaders[type]?downloadFunc=Download.downloaders[type]:console.warn("Download Error - No such download type found: ",type),downloadFunc){var list=this.generateExportList(range);downloadFunc.call(this.table,list,options||{},function(data,mime){interceptCallback?!0===interceptCallback?this.triggerDownload(data,mime,type,filename,!0):interceptCallback(data):this.triggerDownload(data,mime,type,filename)}.bind(this))}}generateExportList(range){var list=this.table.modules.export.generateExportList(this.table.options.downloadConfig,!1,range||this.table.options.downloadRowRange,"download"),groupHeader=this.table.options.groupHeaderDownload;return groupHeader&&!Array.isArray(groupHeader)&&(groupHeader=[groupHeader]),list.forEach((row=>{var group;"group"===row.type&&(group=row.columns[0],groupHeader&&groupHeader[row.indent]&&(group.value=groupHeader[row.indent](group.value,row.component._group.getRowCount(),row.component._group.getData(),row.component)))})),list}triggerDownload(data,mime,type,filename,newTab){var element=document.createElement("a"),blob=this.table.options.downloadEncoder(data,mime);blob&&(newTab?window.open(window.URL.createObjectURL(blob)):(filename=filename||"Tabulator."+("function"==typeof type?"txt":type),navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(blob,filename):(element.setAttribute("href",window.URL.createObjectURL(blob)),element.setAttribute("download",filename),element.style.display="none",document.body.appendChild(element),element.click(),document.body.removeChild(element))),this.dispatchExternal("downloadComplete"))}commsReceived(table,action,data){if("intercept"===action)this.download(data.type,"",data.options,data.active,data.intercept)}}function maskInput(el,options){var mask=options.mask,maskLetter=void 0!==options.maskLetterChar?options.maskLetterChar:"A",maskNumber=void 0!==options.maskNumberChar?options.maskNumberChar:"9",maskWildcard=void 0!==options.maskWildcardChar?options.maskWildcardChar:"*";function fillSymbols(index){var symbol=mask[index];void 0!==symbol&&symbol!==maskWildcard&&symbol!==maskLetter&&symbol!==maskNumber&&(el.value=el.value+""+symbol,fillSymbols(index+1))}el.addEventListener("keydown",(e=>{var index=el.value.length,char=e.key;if(e.keyCode>46){if(index>=mask.length)return e.preventDefault(),e.stopPropagation(),!1;switch(mask[index]){case maskLetter:if(char.toUpperCase()==char.toLowerCase())return e.preventDefault(),e.stopPropagation(),!1;break;case maskNumber:if(isNaN(char))return e.preventDefault(),e.stopPropagation(),!1;break;case maskWildcard:break;default:if(char!==mask[index])return e.preventDefault(),e.stopPropagation(),!1}}})),el.addEventListener("keyup",(e=>{e.keyCode>46&&options.maskAutoFill&&fillSymbols(el.value.length)})),el.placeholder||(el.placeholder=mask),options.maskAutoFill&&fillSymbols(el.value.length)}_exports.DownloadModule=Download,Download.moduleName="download",Download.downloaders=defaultDownloaders;class Edit{constructor(editor,cell,onRendered,success,cancel,editorParams){this.edit=editor,this.table=editor.table,this.cell=cell,this.params=this._initializeParams(editorParams),this.data=[],this.displayItems=[],this.currentItems=[],this.focusedItem=null,this.input=this._createInputElement(),this.listEl=this._createListElement(),this.initialValues=null,this.isFilter=!cell._getSelf,this.filterTimeout=null,this.filtered=!1,this.typing=!1,this.values=[],this.popup=null,this.listIteration=0,this.lastAction="",this.filterTerm="",this.blurable=!0,this.actions={success:success,cancel:cancel},this._deprecatedOptionsCheck(),this._initializeValue(),onRendered(this._onRendered.bind(this))}_deprecatedOptionsCheck(){this.params.listItemFormatter&&this.cell.getTable().deprecationAdvisor.msg("The listItemFormatter editor param has been deprecated, please see the latest editor documentation for updated options"),this.params.sortValuesList&&this.cell.getTable().deprecationAdvisor.msg("The sortValuesList editor param has been deprecated, please see the latest editor documentation for updated options"),this.params.searchFunc&&this.cell.getTable().deprecationAdvisor.msg("The searchFunc editor param has been deprecated, please see the latest editor documentation for updated options"),this.params.searchingPlaceholder&&this.cell.getTable().deprecationAdvisor.msg("The searchingPlaceholder editor param has been deprecated, please see the latest editor documentation for updated options")}_initializeValue(){var initialValue=this.cell.getValue();void 0===initialValue&&void 0!==this.params.defaultValue&&(initialValue=this.params.defaultValue),this.initialValues=this.params.multiselect?initialValue:[initialValue],this.isFilter&&(this.input.value=this.initialValues?this.initialValues.join(","):"",this.headerFilterInitialListGen())}_onRendered(){var cellEl=this.cell.getElement();function clickStop(e){e.stopPropagation()}this.input.style.height="100%",this.input.focus({preventScroll:!0}),cellEl.addEventListener("click",clickStop),setTimeout((()=>{cellEl.removeEventListener("click",clickStop)}),1e3),this.input.addEventListener("mousedown",this._preventPopupBlur.bind(this))}_createListElement(){var listEl=document.createElement("div");return listEl.classList.add("tabulator-edit-list"),listEl.addEventListener("mousedown",this._preventBlur.bind(this)),listEl.addEventListener("keydown",this._inputKeyDown.bind(this)),listEl}_setListWidth(){var element=this.isFilter?this.input:this.cell.getElement();this.listEl.style.minWidth=element.offsetWidth+"px",this.params.maxWidth&&(!0===this.params.maxWidth?this.listEl.style.maxWidth=element.offsetWidth+"px":"number"==typeof this.params.maxWidth?this.listEl.style.maxWidth=this.params.maxWidth+"px":this.listEl.style.maxWidth=this.params.maxWidth)}_createInputElement(){var attribs=this.params.elementAttributes,input=document.createElement("input");if(input.setAttribute("type",this.params.clearable?"search":"text"),input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",this.params.autocomplete||(input.style.cursor="default",input.style.caretColor="transparent"),attribs&&"object"==typeof attribs)for(let key in attribs)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+attribs["+"+key])):input.setAttribute(key,attribs[key]);return this.params.mask&&maskInput(input,this.params),this._bindInputEvents(input),input}_initializeParams(params){var valueCheck,valueKeys=["values","valuesURL","valuesLookup"];return(params=Object.assign({},params)).verticalNavigation=params.verticalNavigation||"editor",params.placeholderLoading=void 0===params.placeholderLoading?"Searching ...":params.placeholderLoading,params.placeholderEmpty=void 0===params.placeholderEmpty?"No Results Found":params.placeholderEmpty,params.filterDelay=void 0===params.filterDelay?300:params.filterDelay,params.emptyValue=Object.keys(params).includes("emptyValue")?params.emptyValue:"",(valueCheck=Object.keys(params).filter((key=>valueKeys.includes(key))).length)?valueCheck>1&&console.warn("list editor config error - only one of the values, valuesURL, or valuesLookup options can be set on the same editor"):console.warn("list editor config error - either the values, valuesURL, or valuesLookup option must be set"),params.autocomplete?params.multiselect&&(params.multiselect=!1,console.warn("list editor config error - multiselect option is not available when autocomplete is enabled")):(params.freetext&&(params.freetext=!1,console.warn("list editor config error - freetext option is only available when autocomplete is enabled")),params.filterFunc&&(params.filterFunc=!1,console.warn("list editor config error - filterFunc option is only available when autocomplete is enabled")),params.filterRemote&&(params.filterRemote=!1,console.warn("list editor config error - filterRemote option is only available when autocomplete is enabled")),params.mask&&(params.mask=!1,console.warn("list editor config error - mask option is only available when autocomplete is enabled")),params.allowEmpty&&(params.allowEmpty=!1,console.warn("list editor config error - allowEmpty option is only available when autocomplete is enabled")),params.listOnEmpty&&(params.listOnEmpty=!1,console.warn("list editor config error - listOnEmpty option is only available when autocomplete is enabled"))),params.filterRemote&&"function"!=typeof params.valuesLookup&&!params.valuesURL&&(params.filterRemote=!1,console.warn("list editor config error - filterRemote option should only be used when values list is populated from a remote source")),params}_bindInputEvents(input){input.addEventListener("focus",this._inputFocus.bind(this)),input.addEventListener("click",this._inputClick.bind(this)),input.addEventListener("blur",this._inputBlur.bind(this)),input.addEventListener("keydown",this._inputKeyDown.bind(this)),input.addEventListener("search",this._inputSearch.bind(this)),this.params.autocomplete&&input.addEventListener("keyup",this._inputKeyUp.bind(this))}_inputFocus(e){this.rebuildOptionsList()}_filter(){this.params.filterRemote?(clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout((()=>{this.rebuildOptionsList()}),this.params.filterDelay)):this._filterList()}_inputClick(e){e.stopPropagation()}_inputBlur(e){this.blurable&&(this.popup?this.popup.hide():this._resolveValue(!0))}_inputSearch(){this._clearChoices()}_inputKeyDown(e){switch(e.keyCode){case 38:this._keyUp(e);break;case 40:this._keyDown(e);break;case 37:case 39:this._keySide(e);break;case 13:this._keyEnter();break;case 27:this._keyEsc();break;case 36:case 35:this._keyHomeEnd(e);break;case 9:break;default:this._keySelectLetter(e)}}_inputKeyUp(e){switch(e.keyCode){case 38:case 37:case 39:case 40:case 13:case 27:break;default:this._keyAutoCompLetter(e)}}_preventPopupBlur(){this.popup&&this.popup.blockHide(),setTimeout((()=>{this.popup&&this.popup.restoreHide()}),10)}_preventBlur(){this.blurable=!1,setTimeout((()=>{this.blurable=!0}),10)}_keyUp(e){var index=this.displayItems.indexOf(this.focusedItem);("editor"==this.params.verticalNavigation||"hybrid"==this.params.verticalNavigation&&index)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),index>0&&this._focusItem(this.displayItems[index-1]))}_keyDown(e){var index=this.displayItems.indexOf(this.focusedItem);("editor"==this.params.verticalNavigation||"hybrid"==this.params.verticalNavigation&&index<this.displayItems.length-1)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),index<this.displayItems.length-1&&(-1==index?this._focusItem(this.displayItems[0]):this._focusItem(this.displayItems[index+1])))}_keySide(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}_keyEnter(e){this.params.autocomplete&&"typing"===this.lastAction?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem)}_keyEsc(e){this._cancel()}_keyHomeEnd(e){this.params.autocomplete&&e.stopImmediatePropagation()}_keySelectLetter(e){this.params.autocomplete||(e.preventDefault(),e.keyCode>=38&&e.keyCode<=90&&this._scrollToValue(e.keyCode))}_keyAutoCompLetter(e){this._filter(),this.lastAction="typing",this.typing=!0}_scrollToValue(char){clearTimeout(this.filterTimeout);var character=String.fromCharCode(char).toLowerCase();this.filterTerm+=character.toLowerCase();var match=this.displayItems.find((item=>void 0!==item.label&&item.label.toLowerCase().startsWith(this.filterTerm)));match&&this._focusItem(match),this.filterTimeout=setTimeout((()=>{this.filterTerm=""}),800)}_focusItem(item){this.lastAction="focus",this.focusedItem&&this.focusedItem.element&&this.focusedItem.element.classList.remove("focused"),this.focusedItem=item,item&&item.element&&(item.element.classList.add("focused"),item.element.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}headerFilterInitialListGen(){this._generateOptions(!0)}rebuildOptionsList(){this._generateOptions().then(this._sortOptions.bind(this)).then(this._buildList.bind(this)).then(this._showList.bind(this)).catch((e=>{Number.isInteger(e)||console.error("List generation error",e)}))}_filterList(){this._buildList(this._filterOptions()),this._showList()}_generateOptions(silent){var values=[],iteration=++this.listIteration;return this.filtered=!1,this.params.values?values=this.params.values:this.params.valuesURL?values=this._ajaxRequest(this.params.valuesURL,this.input.value):"function"==typeof this.params.valuesLookup?values=this.params.valuesLookup(this.cell,this.input.value):this.params.valuesLookup&&(values=this._uniqueColumnValues(this.params.valuesLookupField)),values instanceof Promise?(silent||this._addPlaceholder(this.params.placeholderLoading),values.then().then((responseValues=>this.listIteration===iteration?this._parseList(responseValues):Promise.reject(iteration)))):Promise.resolve(this._parseList(values))}_addPlaceholder(contents){var placeholder=document.createElement("div");"function"==typeof contents&&(contents=contents(this.cell.getComponent(),this.listEl)),contents&&(this._clearList(),contents instanceof HTMLElement?placeholder=contents:(placeholder.classList.add("tabulator-edit-list-placeholder"),placeholder.innerHTML=contents),this.listEl.appendChild(placeholder),this._showList())}_ajaxRequest(url,term){return url=urlBuilder(url,{},this.params.filterRemote?{term:term}:{}),fetch(url).then((response=>response.ok?response.json().catch((error=>(console.warn("List Ajax Load Error - Invalid JSON returned",error),Promise.reject(error)))):(console.error("List Ajax Load Error - Connection Error: "+response.status,response.statusText),Promise.reject(response)))).catch((error=>(console.error("List Ajax Load Error - Connection Error: ",error),Promise.reject(error))))}_uniqueColumnValues(field){var column,output={},data=this.table.getData(this.params.valuesLookup);return(column=field?this.table.columnManager.getColumnByField(field):this.cell.getColumn()._getSelf())?data.forEach((row=>{var val=column.getFieldValue(row);null!=val&&""!==val&&(output[val]=!0)})):(console.warn("unable to find matching column to create select lookup list:",field),output=[]),Object.keys(output)}_parseList(inputValues){var data=[];return Array.isArray(inputValues)||(inputValues=Object.entries(inputValues).map((_ref=>{let[key,value]=_ref;return{label:value,value:key}}))),inputValues.forEach((value=>{"object"!=typeof value&&(value={label:value,value:value}),this._parseListItem(value,data,0)})),!this.currentItems.length&&this.params.freetext&&(this.input.value=this.initialValues,this.typing=!0,this.lastAction="typing"),this.data=data,data}_parseListItem(option,data,level){var item={};option.options?item=this._parseListGroup(option,level+1):(item={label:option.label,value:option.value,itemParams:option.itemParams,elementAttributes:option.elementAttributes,element:!1,selected:!1,visible:!0,level:level,original:option},this.initialValues&&this.initialValues.indexOf(option.value)>-1&&this._chooseItem(item,!0)),data.push(item)}_parseListGroup(option,level){var item={label:option.label,group:!0,itemParams:option.itemParams,elementAttributes:option.elementAttributes,element:!1,visible:!0,level:level,options:[],original:option};return option.options.forEach((child=>{this._parseListItem(child,item.options,level)})),item}_sortOptions(options){var sorter;return this.params.sort&&(sorter="function"==typeof this.params.sort?this.params.sort:this._defaultSortFunction.bind(this),this._sortGroup(sorter,options)),options}_sortGroup(sorter,options){options.sort(((a,b)=>sorter(a.label,b.label,a.value,b.value,a.original,b.original))),options.forEach((option=>{option.group&&this._sortGroup(sorter,option.options)}))}_defaultSortFunction(as,bs){var a,b,a1,b1,L,i=0,rx=/(\d+)|(\D+)/g,rd=/\d/,emptyAlign=0;if("desc"===this.params.sort&&([as,bs]=[bs,as]),as||0===as){if(bs||0===bs){if(isFinite(as)&&isFinite(bs))return as-bs;if((a=String(as).toLowerCase())===(b=String(bs).toLowerCase()))return 0;if(!rd.test(a)||!rd.test(b))return a>b?1:-1;for(a=a.match(rx),b=b.match(rx),L=a.length>b.length?b.length:a.length;i<L;)if((a1=a[i])!==(b1=b[i++]))return isFinite(a1)&&isFinite(b1)?("0"===a1.charAt(0)&&(a1="."+a1),"0"===b1.charAt(0)&&(b1="."+b1),a1-b1):a1>b1?1:-1;return a.length>b.length}emptyAlign=1}else emptyAlign=bs||0===bs?-1:0;return emptyAlign}_filterOptions(){var filterFunc=this.params.filterFunc||this._defaultFilterFunc,term=this.input.value;return term?(this.filtered=!0,this.data.forEach((item=>{this._filterItem(filterFunc,term,item)}))):this.filtered=!1,this.data}_filterItem(func,term,item){var matches=!1;return item.group?(item.options.forEach((option=>{this._filterItem(func,term,option)&&(matches=!0)})),item.visible=matches):item.visible=func(term,item.label,item.value,item.original),item.visible}_defaultFilterFunc(term,label,value,item){return term=String(term).toLowerCase(),null!=label&&(String(label).toLowerCase().indexOf(term)>-1||String(value).toLowerCase().indexOf(term)>-1)}_clearList(){for(;this.listEl.firstChild;)this.listEl.removeChild(this.listEl.firstChild);this.displayItems=[]}_buildList(data){this._clearList(),data.forEach((option=>{this._buildItem(option)})),this.displayItems.length||this._addPlaceholder(this.params.placeholderEmpty)}_buildItem(item){var contents,el=item.element;if(!this.filtered||item.visible){if(!el){if((el=document.createElement("div")).tabIndex=0,(contents=this.params.itemFormatter?this.params.itemFormatter(item.label,item.value,item.original,el):item.label)instanceof HTMLElement?el.appendChild(contents):el.innerHTML=contents,item.group?el.classList.add("tabulator-edit-list-group"):el.classList.add("tabulator-edit-list-item"),el.classList.add("tabulator-edit-list-group-level-"+item.level),item.elementAttributes&&"object"==typeof item.elementAttributes)for(let key in item.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),el.setAttribute(key,this.input.getAttribute(key)+item.elementAttributes["+"+key])):el.setAttribute(key,item.elementAttributes[key]);item.group?el.addEventListener("click",this._groupClick.bind(this,item)):el.addEventListener("click",this._itemClick.bind(this,item)),el.addEventListener("mousedown",this._preventBlur.bind(this)),item.element=el}this._styleItem(item),this.listEl.appendChild(el),item.group?item.options.forEach((option=>{this._buildItem(option)})):this.displayItems.push(item)}}_showList(){var startVis=this.popup&&this.popup.isVisible();if(this.input.parentNode){if(this.params.autocomplete&&""===this.input.value&&!this.params.listOnEmpty)return void(this.popup&&this.popup.hide(!0));this._setListWidth(),this.popup||(this.popup=this.edit.popup(this.listEl)),this.popup.show(this.cell.getElement(),"bottom"),startVis||setTimeout((()=>{this.popup.hideOnBlur(this._resolveValue.bind(this,!0))}),10)}}_styleItem(item){item&&item.element&&(item.selected?item.element.classList.add("active"):item.element.classList.remove("active"))}_itemClick(item,e){e.stopPropagation(),this._chooseItem(item)}_groupClick(item,e){e.stopPropagation()}_cancel(){this.popup.hide(!0),this.actions.cancel()}_clearChoices(){this.typing=!0,this.currentItems.forEach((item=>{item.selected=!1,this._styleItem(item)})),this.currentItems=[],this.focusedItem=null}_chooseItem(item,silent){var index;this.typing=!1,this.params.multiselect?((index=this.currentItems.indexOf(item))>-1?(this.currentItems.splice(index,1),item.selected=!1):(this.currentItems.push(item),item.selected=!0),this.input.value=this.currentItems.map((item=>item.label)).join(","),this._styleItem(item)):(this.currentItems=[item],item.selected=!0,this.input.value=item.label,this._styleItem(item),silent||this._resolveValue()),this._focusItem(item)}_resolveValue(blur){var output,initialValue;if(this.popup&&this.popup.hide(!0),this.params.multiselect)output=this.currentItems.map((item=>item.value));else if(blur&&this.params.autocomplete&&this.typing){if(!(this.params.freetext||this.params.allowEmpty&&""===this.input.value))return void this.actions.cancel();output=this.input.value}else output=this.currentItems[0]?this.currentItems[0].value:null==(initialValue=this.initialValues[0])||""===initialValue?initialValue:this.params.emptyValue;""===output&&(output=this.params.emptyValue),this.actions.success(output),this.isFilter&&(this.initialValues=output&&!Array.isArray(output)?[output]:output,this.currentItems=[])}}var defaultEditors={input:function(cell,onRendered,success,cancel,editorParams){var cellValue=cell.getValue(),input=document.createElement("input");if(input.setAttribute("type",editorParams.search?"search":"text"),input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==typeof editorParams.elementAttributes)for(let key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(e){null==cellValue&&""!==input.value||input.value!==cellValue?success(input.value)&&(cellValue=input.value):cancel()}return input.value=void 0!==cellValue?cellValue:"",onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%",editorParams.selectContents&&input.select()})),input.addEventListener("change",onChange),input.addEventListener("blur",onChange),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel();break;case 35:case 36:e.stopPropagation()}})),editorParams.mask&&maskInput(input,editorParams),input},textarea:function(cell,onRendered,success,cancel,editorParams){var cellValue=cell.getValue(),vertNav=editorParams.verticalNavigation||"hybrid",value=String(null!=cellValue?cellValue:""),input=document.createElement("textarea"),scrollHeight=0;if(input.style.display="block",input.style.padding="2px",input.style.height="100%",input.style.width="100%",input.style.boxSizing="border-box",input.style.whiteSpace="pre-wrap",input.style.resize="none",editorParams.elementAttributes&&"object"==typeof editorParams.elementAttributes)for(let key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(e){null==cellValue&&""!==input.value||input.value!==cellValue?(success(input.value)&&(cellValue=input.value),setTimeout((function(){cell.getRow().normalizeHeight()}),300)):cancel()}return input.value=value,onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%",input.scrollHeight,input.style.height=input.scrollHeight+"px",cell.getRow().normalizeHeight(),editorParams.selectContents&&input.select()})),input.addEventListener("change",onChange),input.addEventListener("blur",onChange),input.addEventListener("keyup",(function(){input.style.height="";var heightNow=input.scrollHeight;input.style.height=heightNow+"px",heightNow!=scrollHeight&&(scrollHeight=heightNow,cell.getRow().normalizeHeight())})),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:e.shiftKey&&editorParams.shiftEnterSubmit&&onChange();break;case 27:cancel();break;case 38:("editor"==vertNav||"hybrid"==vertNav&&input.selectionStart)&&(e.stopImmediatePropagation(),e.stopPropagation());break;case 40:("editor"==vertNav||"hybrid"==vertNav&&input.selectionStart!==input.value.length)&&(e.stopImmediatePropagation(),e.stopPropagation());break;case 35:case 36:e.stopPropagation()}})),editorParams.mask&&maskInput(input,editorParams),input},number:function(cell,onRendered,success,cancel,editorParams){var cellValue=cell.getValue(),vertNav=editorParams.verticalNavigation||"editor",input=document.createElement("input");if(input.setAttribute("type","number"),void 0!==editorParams.max&&input.setAttribute("max",editorParams.max),void 0!==editorParams.min&&input.setAttribute("min",editorParams.min),void 0!==editorParams.step&&input.setAttribute("step",editorParams.step),input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==typeof editorParams.elementAttributes)for(let key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);input.value=cellValue;var blurFunc=function(e){onChange()};function onChange(){var value=input.value;isNaN(value)||""===value||(value=Number(value)),value!==cellValue?success(value)&&(cellValue=value):cancel()}return onRendered((function(){input.removeEventListener("blur",blurFunc),input.focus({preventScroll:!0}),input.style.height="100%",input.addEventListener("blur",blurFunc),editorParams.selectContents&&input.select()})),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel();break;case 38:case 40:"editor"==vertNav&&(e.stopImmediatePropagation(),e.stopPropagation());break;case 35:case 36:e.stopPropagation()}})),editorParams.mask&&maskInput(input,editorParams),input},range:function(cell,onRendered,success,cancel,editorParams){var cellValue=cell.getValue(),input=document.createElement("input");if(input.setAttribute("type","range"),void 0!==editorParams.max&&input.setAttribute("max",editorParams.max),void 0!==editorParams.min&&input.setAttribute("min",editorParams.min),void 0!==editorParams.step&&input.setAttribute("step",editorParams.step),input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==typeof editorParams.elementAttributes)for(let key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(){var value=input.value;isNaN(value)||""===value||(value=Number(value)),value!=cellValue?success(value)&&(cellValue=value):cancel()}return input.value=cellValue,onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%"})),input.addEventListener("blur",(function(e){onChange()})),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel()}})),input},date:function(cell,onRendered,success,cancel,editorParams){var inputFormat=editorParams.format,DT=inputFormat?window.DateTime||luxon.DateTime:null,cellValue=cell.getValue(),input=document.createElement("input");function convertDate(value){return(DT.isDateTime(value)?value:"iso"===inputFormat?DT.fromISO(String(value)):DT.fromFormat(String(value),inputFormat)).toFormat("yyyy-MM-dd")}if(input.type="date",input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.max&&input.setAttribute("max",inputFormat?convertDate(editorParams.max):editorParams.max),editorParams.min&&input.setAttribute("min",inputFormat?convertDate(editorParams.min):editorParams.min),editorParams.elementAttributes&&"object"==typeof editorParams.elementAttributes)for(let key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(e){var value=input.value;null==cellValue&&""!==value||value!==cellValue?(value&&inputFormat&&(value=DT.fromFormat(String(value),"yyyy-MM-dd").toFormat(inputFormat)),success(value)&&(cellValue=input.value)):cancel()}return cellValue=void 0!==cellValue?cellValue:"",inputFormat&&(DT?cellValue=convertDate(cellValue):console.error("Editor Error - 'date' editor 'inputFormat' param is dependant on luxon.js")),input.value=cellValue,onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%",editorParams.selectContents&&input.select()})),input.addEventListener("change",onChange),input.addEventListener("blur",onChange),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel();break;case 35:case 36:e.stopPropagation()}})),input},time:function(cell,onRendered,success,cancel,editorParams){var newDatetime,inputFormat=editorParams.format,DT=inputFormat?window.DateTime||luxon.DateTime:null,cellValue=cell.getValue(),input=document.createElement("input");if(input.type="time",input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==typeof editorParams.elementAttributes)for(let key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(e){var value=input.value;null==cellValue&&""!==value||value!==cellValue?(value&&inputFormat&&(value=DT.fromFormat(String(value),"hh:mm").toFormat(inputFormat)),success(value)&&(cellValue=input.value)):cancel()}return cellValue=void 0!==cellValue?cellValue:"",inputFormat&&(DT?(newDatetime=DT.isDateTime(cellValue)?cellValue:"iso"===inputFormat?DT.fromISO(String(cellValue)):DT.fromFormat(String(cellValue),inputFormat),cellValue=newDatetime.toFormat("hh:mm")):console.error("Editor Error - 'date' editor 'inputFormat' param is dependant on luxon.js")),input.value=cellValue,onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%",editorParams.selectContents&&input.select()})),input.addEventListener("change",onChange),input.addEventListener("blur",onChange),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel();break;case 35:case 36:e.stopPropagation()}})),input},datetime:function(cell,onRendered,success,cancel,editorParams){var newDatetime,inputFormat=editorParams.format,DT=inputFormat?window.DateTime||luxon.DateTime:null,cellValue=cell.getValue(),input=document.createElement("input");if(input.type="datetime-local",input.style.padding="4px",input.style.width="100%",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==typeof editorParams.elementAttributes)for(let key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function onChange(e){var value=input.value;null==cellValue&&""!==value||value!==cellValue?(value&&inputFormat&&(value=DT.fromISO(String(value)).toFormat(inputFormat)),success(value)&&(cellValue=input.value)):cancel()}return cellValue=void 0!==cellValue?cellValue:"",inputFormat&&(DT?(newDatetime=DT.isDateTime(cellValue)?cellValue:"iso"===inputFormat?DT.fromISO(String(cellValue)):DT.fromFormat(String(cellValue),inputFormat),cellValue=newDatetime.toFormat("yyyy-MM-dd")+"T"+newDatetime.toFormat("hh:mm")):console.error("Editor Error - 'date' editor 'inputFormat' param is dependant on luxon.js")),input.value=cellValue,onRendered((function(){input.focus({preventScroll:!0}),input.style.height="100%",editorParams.selectContents&&input.select()})),input.addEventListener("change",onChange),input.addEventListener("blur",onChange),input.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:onChange();break;case 27:cancel();break;case 35:case 36:e.stopPropagation()}})),input},select:function(cell,onRendered,success,cancel,editorParams){return this.deprecationMsg("The select editor has been deprecated, please use the new list editor"),new Edit(this,cell,onRendered,success,cancel,editorParams).input},list:function(cell,onRendered,success,cancel,editorParams){return new Edit(this,cell,onRendered,success,cancel,editorParams).input},autocomplete:function(cell,onRendered,success,cancel,editorParams){return this.deprecationMsg("The autocomplete editor has been deprecated, please use the new list editor with the 'autocomplete' editorParam"),editorParams.autocomplete=!0,new Edit(this,cell,onRendered,success,cancel,editorParams).input},star:function(cell,onRendered,success,cancel,editorParams){var self=this,element=cell.getElement(),value=cell.getValue(),maxStars=element.getElementsByTagName("svg").length||5,size=element.getElementsByTagName("svg")[0]?element.getElementsByTagName("svg")[0].getAttribute("width"):14,stars=[],starsHolder=document.createElement("div"),star=document.createElementNS("http://www.w3.org/2000/svg","svg");function starChange(val){stars.forEach((function(star,i){i<val?("ie"==self.table.browser?star.setAttribute("class","tabulator-star-active"):star.classList.replace("tabulator-star-inactive","tabulator-star-active"),star.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):("ie"==self.table.browser?star.setAttribute("class","tabulator-star-inactive"):star.classList.replace("tabulator-star-active","tabulator-star-inactive"),star.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')}))}function buildStar(i){var starHolder=document.createElement("span"),nextStar=star.cloneNode(!0);stars.push(nextStar),starHolder.addEventListener("mouseenter",(function(e){e.stopPropagation(),e.stopImmediatePropagation(),starChange(i)})),starHolder.addEventListener("mousemove",(function(e){e.stopPropagation(),e.stopImmediatePropagation()})),starHolder.addEventListener("click",(function(e){e.stopPropagation(),e.stopImmediatePropagation(),success(i),element.blur()})),starHolder.appendChild(nextStar),starsHolder.appendChild(starHolder)}function changeValue(val){value=val,starChange(val)}if(element.style.whiteSpace="nowrap",element.style.overflow="hidden",element.style.textOverflow="ellipsis",starsHolder.style.verticalAlign="middle",starsHolder.style.display="inline-block",starsHolder.style.padding="4px",star.setAttribute("width",size),star.setAttribute("height",size),star.setAttribute("viewBox","0 0 512 512"),star.setAttribute("xml:space","preserve"),star.style.padding="0 1px",editorParams.elementAttributes&&"object"==typeof editorParams.elementAttributes)for(let key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),starsHolder.setAttribute(key,starsHolder.getAttribute(key)+editorParams.elementAttributes["+"+key])):starsHolder.setAttribute(key,editorParams.elementAttributes[key]);for(var i=1;i<=maxStars;i++)buildStar(i);return starChange(value=Math.min(parseInt(value),maxStars)),starsHolder.addEventListener("mousemove",(function(e){starChange(0)})),starsHolder.addEventListener("click",(function(e){success(0)})),element.addEventListener("blur",(function(e){cancel()})),element.addEventListener("keydown",(function(e){switch(e.keyCode){case 39:changeValue(value+1);break;case 37:changeValue(value-1);break;case 13:success(value);break;case 27:cancel()}})),starsHolder},progress:function(cell,onRendered,success,cancel,editorParams){var mouseDrag,mouseDragWidth,element=cell.getElement(),max=void 0===editorParams.max?element.getElementsByTagName("div")[0]&&element.getElementsByTagName("div")[0].getAttribute("max")||100:editorParams.max,min=void 0===editorParams.min?element.getElementsByTagName("div")[0]&&element.getElementsByTagName("div")[0].getAttribute("min")||0:editorParams.min,percent=(max-min)/100,value=cell.getValue()||0,handle=document.createElement("div"),bar=document.createElement("div");function updateValue(){var style=window.getComputedStyle(element,null),calcVal=percent*Math.round(bar.offsetWidth/((element.clientWidth-parseInt(style.getPropertyValue("padding-left"))-parseInt(style.getPropertyValue("padding-right")))/100))+min;success(calcVal),element.setAttribute("aria-valuenow",calcVal),element.setAttribute("aria-label",value)}if(handle.style.position="absolute",handle.style.right="0",handle.style.top="0",handle.style.bottom="0",handle.style.width="5px",handle.classList.add("tabulator-progress-handle"),bar.style.display="inline-block",bar.style.position="relative",bar.style.height="100%",bar.style.backgroundColor="#488CE9",bar.style.maxWidth="100%",bar.style.minWidth="0%",editorParams.elementAttributes&&"object"==typeof editorParams.elementAttributes)for(let key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),bar.setAttribute(key,bar.getAttribute(key)+editorParams.elementAttributes["+"+key])):bar.setAttribute(key,editorParams.elementAttributes[key]);return element.style.padding="4px 4px",value=Math.min(parseFloat(value),max),value=Math.max(parseFloat(value),min),value=Math.round((value-min)/percent),bar.style.width=value+"%",element.setAttribute("aria-valuemin",min),element.setAttribute("aria-valuemax",max),bar.appendChild(handle),handle.addEventListener("mousedown",(function(e){mouseDrag=e.screenX,mouseDragWidth=bar.offsetWidth})),handle.addEventListener("mouseover",(function(){handle.style.cursor="ew-resize"})),element.addEventListener("mousemove",(function(e){mouseDrag&&(bar.style.width=mouseDragWidth+e.screenX-mouseDrag+"px")})),element.addEventListener("mouseup",(function(e){mouseDrag&&(e.stopPropagation(),e.stopImmediatePropagation(),mouseDrag=!1,mouseDragWidth=!1,updateValue())})),element.addEventListener("keydown",(function(e){switch(e.keyCode){case 39:e.preventDefault(),bar.style.width=bar.clientWidth+element.clientWidth/100+"px";break;case 37:e.preventDefault(),bar.style.width=bar.clientWidth-element.clientWidth/100+"px";break;case 9:case 13:updateValue();break;case 27:cancel()}})),element.addEventListener("blur",(function(){cancel()})),bar},tickCross:function(cell,onRendered,success,cancel,editorParams){var value=cell.getValue(),input=document.createElement("input"),tristate=editorParams.tristate,indetermValue=void 0===editorParams.indeterminateValue?null:editorParams.indeterminateValue,indetermState=!1,trueValueSet=Object.keys(editorParams).includes("trueValue"),falseValueSet=Object.keys(editorParams).includes("falseValue");if(input.setAttribute("type","checkbox"),input.style.marginTop="5px",input.style.boxSizing="border-box",editorParams.elementAttributes&&"object"==typeof editorParams.elementAttributes)for(let key in editorParams.elementAttributes)"+"==key.charAt(0)?(key=key.slice(1),input.setAttribute(key,input.getAttribute(key)+editorParams.elementAttributes["+"+key])):input.setAttribute(key,editorParams.elementAttributes[key]);function setValue(blur){var checkedValue=input.checked;return trueValueSet&&checkedValue?checkedValue=editorParams.trueValue:falseValueSet&&!checkedValue&&(checkedValue=editorParams.falseValue),tristate?blur?indetermState?indetermValue:checkedValue:input.checked&&!indetermState?(input.checked=!1,input.indeterminate=!0,indetermState=!0,indetermValue):(indetermState=!1,checkedValue):checkedValue}return input.value=value,!tristate||void 0!==value&&value!==indetermValue&&""!==value||(indetermState=!0,input.indeterminate=!0),"firefox"!=this.table.browser&&onRendered((function(){input.focus({preventScroll:!0})})),input.checked=trueValueSet?value===editorParams.trueValue:!0===value||"true"===value||"True"===value||1===value,onRendered((function(){input.focus()})),input.addEventListener("change",(function(e){success(setValue())})),input.addEventListener("blur",(function(e){success(setValue(!0))})),input.addEventListener("keydown",(function(e){13==e.keyCode&&success(setValue()),27==e.keyCode&&cancel()})),input}};class Edit$1 extends Module{constructor(table){super(table),this.currentCell=!1,this.mouseClick=!1,this.recursionBlock=!1,this.invalidEdit=!1,this.editedCells=[],this.editors=Edit$1.editors,this.registerColumnOption("editable"),this.registerColumnOption("editor"),this.registerColumnOption("editorParams"),this.registerColumnOption("cellEditing"),this.registerColumnOption("cellEdited"),this.registerColumnOption("cellEditCancelled"),this.registerTableFunction("getEditedCells",this.getEditedCells.bind(this)),this.registerTableFunction("clearCellEdited",this.clearCellEdited.bind(this)),this.registerTableFunction("navigatePrev",this.navigatePrev.bind(this)),this.registerTableFunction("navigateNext",this.navigateNext.bind(this)),this.registerTableFunction("navigateLeft",this.navigateLeft.bind(this)),this.registerTableFunction("navigateRight",this.navigateRight.bind(this)),this.registerTableFunction("navigateUp",this.navigateUp.bind(this)),this.registerTableFunction("navigateDown",this.navigateDown.bind(this)),this.registerComponentFunction("cell","isEdited",this.cellIsEdited.bind(this)),this.registerComponentFunction("cell","clearEdited",this.clearEdited.bind(this)),this.registerComponentFunction("cell","edit",this.editCell.bind(this)),this.registerComponentFunction("cell","cancelEdit",this.cellCancelEdit.bind(this)),this.registerComponentFunction("cell","navigatePrev",this.navigatePrev.bind(this)),this.registerComponentFunction("cell","navigateNext",this.navigateNext.bind(this)),this.registerComponentFunction("cell","navigateLeft",this.navigateLeft.bind(this)),this.registerComponentFunction("cell","navigateRight",this.navigateRight.bind(this)),this.registerComponentFunction("cell","navigateUp",this.navigateUp.bind(this)),this.registerComponentFunction("cell","navigateDown",this.navigateDown.bind(this))}initialize(){this.subscribe("cell-init",this.bindEditor.bind(this)),this.subscribe("cell-delete",this.clearEdited.bind(this)),this.subscribe("cell-value-changed",this.updateCellClass.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("column-delete",this.columnDeleteCheck.bind(this)),this.subscribe("row-deleting",this.rowDeleteCheck.bind(this)),this.subscribe("row-layout",this.rowEditableCheck.bind(this)),this.subscribe("data-refreshing",this.cancelEdit.bind(this)),this.subscribe("keybinding-nav-prev",this.navigatePrev.bind(this,void 0)),this.subscribe("keybinding-nav-next",this.keybindingNavigateNext.bind(this)),this.subscribe("keybinding-nav-left",this.navigateLeft.bind(this,void 0)),this.subscribe("keybinding-nav-right",this.navigateRight.bind(this,void 0)),this.subscribe("keybinding-nav-up",this.navigateUp.bind(this,void 0)),this.subscribe("keybinding-nav-down",this.navigateDown.bind(this,void 0))}keybindingNavigateNext(e){var cell=this.currentCell,newRow=this.options("tabEndNewRow");cell&&(this.navigateNext(cell,e)||newRow&&(cell.getElement().firstChild.blur(),(newRow=!0===newRow?this.table.addRow({}):"function"==typeof newRow?this.table.addRow(newRow(cell.row.getComponent())):this.table.addRow(Object.assign({},newRow))).then((()=>{setTimeout((()=>{cell.getComponent().navigateNext()}))}))))}cellIsEdited(cell){return!!cell.modules.edit&&cell.modules.edit.edited}cellCancelEdit(cell){cell===this.currentCell?this.table.modules.edit.cancelEdit():console.warn("Cancel Editor Error - This cell is not currently being edited ")}updateCellClass(cell){this.allowEdit(cell)?cell.getElement().classList.add("tabulator-editable"):cell.getElement().classList.remove("tabulator-editable")}clearCellEdited(cells){cells||(cells=this.table.modules.edit.getEditedCells()),Array.isArray(cells)||(cells=[cells]),cells.forEach((cell=>{this.table.modules.edit.clearEdited(cell._getSelf())}))}navigatePrev(){let cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;var nextCell,prevRow;if(cell){if(e&&e.preventDefault(),nextCell=this.navigateLeft())return!0;if((prevRow=this.table.rowManager.prevDisplayRow(cell.row,!0))&&(nextCell=this.findPrevEditableCell(prevRow,prevRow.cells.length)))return nextCell.getComponent().edit(),!0}return!1}navigateNext(){let cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;var nextCell,nextRow;if(cell){if(e&&e.preventDefault(),nextCell=this.navigateRight())return!0;if((nextRow=this.table.rowManager.nextDisplayRow(cell.row,!0))&&(nextCell=this.findNextEditableCell(nextRow,-1)))return nextCell.getComponent().edit(),!0}return!1}navigateLeft(){let cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;var index,nextCell;return!!(cell&&(e&&e.preventDefault(),index=cell.getIndex(),nextCell=this.findPrevEditableCell(cell.row,index)))&&(nextCell.getComponent().edit(),!0)}navigateRight(){let cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;var index,nextCell;return!!(cell&&(e&&e.preventDefault(),index=cell.getIndex(),nextCell=this.findNextEditableCell(cell.row,index)))&&(nextCell.getComponent().edit(),!0)}navigateUp(){let cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;var index,nextRow;return!!(cell&&(e&&e.preventDefault(),index=cell.getIndex(),nextRow=this.table.rowManager.prevDisplayRow(cell.row,!0)))&&(nextRow.cells[index].getComponent().edit(),!0)}navigateDown(){let cell=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,e=arguments.length>1?arguments[1]:void 0;var index,nextRow;return!!(cell&&(e&&e.preventDefault(),index=cell.getIndex(),nextRow=this.table.rowManager.nextDisplayRow(cell.row,!0)))&&(nextRow.cells[index].getComponent().edit(),!0)}findNextEditableCell(row,index){var nextCell=!1;if(index<row.cells.length-1)for(var i=index+1;i<row.cells.length;i++){let cell=row.cells[i];if(cell.column.modules.edit&&Helpers.elVisible(cell.getElement())){if(this.allowEdit(cell)){nextCell=cell;break}}}return nextCell}findPrevEditableCell(row,index){var prevCell=!1;if(index>0)for(var i=index-1;i>=0;i--){let cell=row.cells[i];if(cell.column.modules.edit&&Helpers.elVisible(cell.getElement())){if(this.allowEdit(cell)){prevCell=cell;break}}}return prevCell}initializeColumnCheck(column){void 0!==column.definition.editor&&this.initializeColumn(column)}columnDeleteCheck(column){this.currentCell&&this.currentCell.column===column&&this.cancelEdit()}rowDeleteCheck(row){this.currentCell&&this.currentCell.row===row&&this.cancelEdit()}rowEditableCheck(row){row.getCells().forEach((cell=>{cell.column.modules.edit&&"function"==typeof cell.column.modules.edit.check&&this.updateCellClass(cell)}))}initializeColumn(column){var config={editor:!1,blocked:!1,check:column.definition.editable,params:column.definition.editorParams||{}};switch(typeof column.definition.editor){case"string":this.editors[column.definition.editor]?config.editor=this.editors[column.definition.editor]:console.warn("Editor Error - No such editor found: ",column.definition.editor);break;case"function":config.editor=column.definition.editor;break;case"boolean":!0===column.definition.editor&&("function"!=typeof column.definition.formatter?this.editors[column.definition.formatter]?config.editor=this.editors[column.definition.formatter]:config.editor=this.editors.input:console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",column.definition.formatter))}config.editor&&(column.modules.edit=config)}getCurrentCell(){return!!this.currentCell&&this.currentCell.getComponent()}clearEditor(cancel){var cellEl,cell=this.currentCell;if(this.invalidEdit=!1,cell){for(this.currentCell=!1,cellEl=cell.getElement(),this.dispatch("edit-editor-clear",cell,cancel),cellEl.classList.remove("tabulator-editing");cellEl.firstChild;)cellEl.removeChild(cellEl.firstChild);cell.row.getElement().classList.remove("tabulator-editing"),cell.table.element.classList.remove("tabulator-editing")}}cancelEdit(){if(this.currentCell){var cell=this.currentCell,component=this.currentCell.getComponent();this.clearEditor(!0),cell.setValueActual(cell.getValue()),cell.cellRendered(),("textarea"==cell.column.definition.editor||cell.column.definition.variableHeight)&&cell.row.normalizeHeight(!0),cell.column.definition.cellEditCancelled&&cell.column.definition.cellEditCancelled.call(this.table,component),this.dispatch("edit-cancelled",cell),this.dispatchExternal("cellEditCancelled",component)}}bindEditor(cell){if(cell.column.modules.edit){var self=this,element=cell.getElement(!0);this.updateCellClass(cell),element.setAttribute("tabindex",0),element.addEventListener("click",(function(e){element.classList.contains("tabulator-editing")||element.focus({preventScroll:!0})})),element.addEventListener("mousedown",(function(e){2===e.button?e.preventDefault():self.mouseClick=!0})),element.addEventListener("focus",(function(e){self.recursionBlock||self.edit(cell,e,!1)}))}}focusCellNoEvent(cell,block){this.recursionBlock=!0,block&&"ie"===this.table.browser||cell.getElement().focus({preventScroll:!0}),this.recursionBlock=!1}editCell(cell,forceEdit){this.focusCellNoEvent(cell),this.edit(cell,!1,forceEdit)}focusScrollAdjust(cell){if("virtual"==this.table.rowManager.getRenderMode()){var topEdge=this.table.rowManager.element.scrollTop,bottomEdge=this.table.rowManager.element.clientHeight+this.table.rowManager.element.scrollTop,rowEl=cell.row.getElement();rowEl.offsetTop<topEdge?this.table.rowManager.element.scrollTop-=topEdge-rowEl.offsetTop:rowEl.offsetTop+rowEl.offsetHeight>bottomEdge&&(this.table.rowManager.element.scrollTop+=rowEl.offsetTop+rowEl.offsetHeight-bottomEdge);var leftEdge=this.table.rowManager.element.scrollLeft,rightEdge=this.table.rowManager.element.clientWidth+this.table.rowManager.element.scrollLeft,cellEl=cell.getElement();this.table.modExists("frozenColumns")&&(leftEdge+=parseInt(this.table.modules.frozenColumns.leftMargin),rightEdge-=parseInt(this.table.modules.frozenColumns.rightMargin)),"virtual"===this.table.options.renderHorizontal&&(leftEdge-=parseInt(this.table.columnManager.renderer.vDomPadLeft),rightEdge-=parseInt(this.table.columnManager.renderer.vDomPadLeft)),cellEl.offsetLeft<leftEdge?this.table.rowManager.element.scrollLeft-=leftEdge-cellEl.offsetLeft:cellEl.offsetLeft+cellEl.offsetWidth>rightEdge&&(this.table.rowManager.element.scrollLeft+=cellEl.offsetLeft+cellEl.offsetWidth-rightEdge)}}allowEdit(cell){var check=!!cell.column.modules.edit;if(cell.column.modules.edit)switch(typeof cell.column.modules.edit.check){case"function":cell.row.initialized&&(check=cell.column.modules.edit.check(cell.getComponent()));break;case"string":check=!!cell.row.data[cell.column.modules.edit.check];break;case"boolean":check=cell.column.modules.edit.check}return check}edit(cell,e,forceEdit){var cellEditor,component,params,self=this,rendered=function(){},element=cell.getElement();if(!this.currentCell){if(cell.column.modules.edit.blocked)return this.mouseClick=!1,element.blur(),!1;if(e&&e.stopPropagation(),this.allowEdit(cell)||forceEdit){if(self.cancelEdit(),self.currentCell=cell,this.focusScrollAdjust(cell),component=cell.getComponent(),this.mouseClick&&(this.mouseClick=!1,cell.column.definition.cellClick&&cell.column.definition.cellClick.call(this.table,e,component)),cell.column.definition.cellEditing&&cell.column.definition.cellEditing.call(this.table,component),this.dispatch("cell-editing",cell),this.dispatchExternal("cellEditing",component),params="function"==typeof cell.column.modules.edit.params?cell.column.modules.edit.params(component):cell.column.modules.edit.params,!1===(cellEditor=cell.column.modules.edit.editor.call(self,component,(function(callback){rendered=callback}),(function(value){if(self.currentCell===cell){var valid=self.chain("edit-success",[cell,value],!0,!0);return!0===valid||"highlight"===self.table.options.validationMode?(self.clearEditor(),cell.modules.edit||(cell.modules.edit={}),cell.modules.edit.edited=!0,-1==self.editedCells.indexOf(cell)&&self.editedCells.push(cell),cell.setValue(value,!0),!0===valid):(self.invalidEdit=!0,self.focusCellNoEvent(cell,!0),rendered(),!1)}}),(function(){self.currentCell===cell&&self.cancelEdit()}),params)))return element.blur(),!1;if(!(cellEditor instanceof Node))return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:",cellEditor),element.blur(),!1;for(element.classList.add("tabulator-editing"),cell.row.getElement().classList.add("tabulator-editing"),cell.table.element.classList.add("tabulator-editing");element.firstChild;)element.removeChild(element.firstChild);element.appendChild(cellEditor),rendered();for(var children=element.children,i=0;i<children.length;i++)children[i].addEventListener("click",(function(e){e.stopPropagation()}));return!0}return this.mouseClick=!1,element.blur(),!1}this.invalidEdit||this.cancelEdit()}getEditedCells(){var output=[];return this.editedCells.forEach((cell=>{output.push(cell.getComponent())})),output}clearEdited(cell){var editIndex;cell.modules.edit&&cell.modules.edit.edited&&(cell.modules.edit.edited=!1,this.dispatch("edit-edited-clear",cell)),(editIndex=this.editedCells.indexOf(cell))>-1&&this.editedCells.splice(editIndex,1)}}_exports.EditModule=Edit$1,Edit$1.moduleName="edit",Edit$1.editors=defaultEditors;class ExportRow{constructor(type,columns,component,indent){this.type=type,this.columns=columns,this.component=component||!1,this.indent=indent||0}}class ExportColumn{constructor(value,component,width,height,depth){this.value=value,this.component=component||!1,this.width=width,this.height=height,this.depth=depth}}class Export extends Module{constructor(table){super(table),this.config={},this.cloneTableStyle=!0,this.colVisProp="",this.registerTableOption("htmlOutputConfig",!1),this.registerColumnOption("htmlOutput"),this.registerColumnOption("titleHtmlOutput")}initialize(){this.registerTableFunction("getHtml",this.getHtml.bind(this))}generateExportList(config,style,range,colVisProp){this.cloneTableStyle=style,this.config=config||{},this.colVisProp=colVisProp;var headers=!1!==this.config.columnHeaders?this.headersToExportRows(this.generateColumnGroupHeaders()):[],body=this.bodyToExportRows(this.rowLookup(range));return headers.concat(body)}generateTable(config,style,range,colVisProp){var list=this.generateExportList(config,style,range,colVisProp);return this.generateTableElement(list)}rowLookup(range){var rows=[];if("function"==typeof range)range.call(this.table).forEach((row=>{(row=this.table.rowManager.findRow(row))&&rows.push(row)}));else switch(range){case!0:case"visible":rows=this.table.rowManager.getVisibleRows(!1,!0);break;case"all":rows=this.table.rowManager.rows;break;case"selected":rows=this.table.modules.selectRow.selectedRows;break;default:rows=this.table.options.pagination?this.table.rowManager.getDisplayRows(this.table.rowManager.displayRows.length-2):this.table.rowManager.getDisplayRows()}return Object.assign([],rows)}generateColumnGroupHeaders(){var output=[];return(!1!==this.config.columnGroups?this.table.columnManager.columns:this.table.columnManager.columnsByIndex).forEach((column=>{var colData=this.processColumnGroup(column);colData&&output.push(colData)})),output}processColumnGroup(column){var subGroups=column.columns,maxDepth=0,groupData={title:column.definition["title"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))]||column.definition.title,column:column,depth:1};if(subGroups.length){if(groupData.subGroups=[],groupData.width=0,subGroups.forEach((subGroup=>{var subGroupData=this.processColumnGroup(subGroup);subGroupData&&(groupData.width+=subGroupData.width,groupData.subGroups.push(subGroupData),subGroupData.depth>maxDepth&&(maxDepth=subGroupData.depth))})),groupData.depth+=maxDepth,!groupData.width)return!1}else{if(!this.columnVisCheck(column))return!1;groupData.width=1}return groupData}columnVisCheck(column){var visProp=column.definition[this.colVisProp];return"function"==typeof visProp&&(visProp=visProp.call(this.table,column.getComponent())),!1!==visProp&&(column.visible||!column.visible&&visProp)}headersToExportRows(columns){var headers=[],headerDepth=0,exportRows=[];function parseColumnGroup(column,level){var depth=headerDepth-level;if(void 0===headers[level]&&(headers[level]=[]),column.height=column.subGroups?1:depth-column.depth+1,headers[level].push(column),column.height>1)for(let i=1;i<column.height;i++)void 0===headers[level+i]&&(headers[level+i]=[]),headers[level+i].push(!1);if(column.width>1)for(let i=1;i<column.width;i++)headers[level].push(!1);column.subGroups&&column.subGroups.forEach((function(subGroup){parseColumnGroup(subGroup,level+1)}))}return columns.forEach((function(column){column.depth>headerDepth&&(headerDepth=column.depth)})),columns.forEach((function(column){parseColumnGroup(column,0)})),headers.forEach((header=>{var columns=[];header.forEach((col=>{if(col){let title=void 0===col.title?"":col.title;columns.push(new ExportColumn(title,col.column.getComponent(),col.width,col.height,col.depth))}else columns.push(null)})),exportRows.push(new ExportRow("header",columns))})),exportRows}bodyToExportRows(rows){var columns=[],exportRows=[];return this.table.columnManager.columnsByIndex.forEach((column=>{this.columnVisCheck(column)&&columns.push(column.getComponent())})),!1!==this.config.columnCalcs&&this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&rows.unshift(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&rows.push(this.table.modules.columnCalcs.botRow)),(rows=rows.filter((row=>{switch(row.type){case"group":return!1!==this.config.rowGroups;case"calc":return!1!==this.config.columnCalcs;case"row":return!(this.table.options.dataTree&&!1===this.config.dataTree&&row.modules.dataTree.parent)}return!0}))).forEach(((row,i)=>{var rowData=row.getData(this.colVisProp),exportCols=[],indent=0;switch(row.type){case"group":indent=row.level,exportCols.push(new ExportColumn(row.key,row.getComponent(),columns.length,1));break;case"calc":case"row":columns.forEach((col=>{exportCols.push(new ExportColumn(col._column.getFieldValue(rowData),col,1,1))})),this.table.options.dataTree&&!1!==this.config.dataTree&&(indent=row.modules.dataTree.index)}exportRows.push(new ExportRow(row.type,exportCols,row.getComponent(),indent))})),exportRows}generateTableElement(list){var table=document.createElement("table"),headerEl=document.createElement("thead"),bodyEl=document.createElement("tbody"),styles=this.lookupTableStyles(),rowFormatter=this.table.options["rowFormatter"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))],setup={};return setup.rowFormatter=null!==rowFormatter?rowFormatter:this.table.options.rowFormatter,this.table.options.dataTree&&!1!==this.config.dataTree&&this.table.modExists("columnCalcs")&&(setup.treeElementField=this.table.modules.dataTree.elementField),setup.groupHeader=this.table.options["groupHeader"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))],setup.groupHeader&&!Array.isArray(setup.groupHeader)&&(setup.groupHeader=[setup.groupHeader]),table.classList.add("tabulator-print-table"),this.mapElementStyles(this.table.columnManager.getHeadersElement(),headerEl,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),list.length>1e3&&console.warn("It may take a long time to render an HTML table with more than 1000 rows"),list.forEach(((row,i)=>{let rowEl;switch(row.type){case"header":headerEl.appendChild(this.generateHeaderElement(row,setup,styles));break;case"group":bodyEl.appendChild(this.generateGroupElement(row,setup,styles));break;case"calc":bodyEl.appendChild(this.generateCalcElement(row,setup,styles));break;case"row":rowEl=this.generateRowElement(row,setup,styles),this.mapElementStyles(i%2&&styles.evenRow?styles.evenRow:styles.oddRow,rowEl,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),bodyEl.appendChild(rowEl)}})),headerEl.innerHTML&&table.appendChild(headerEl),table.appendChild(bodyEl),this.mapElementStyles(this.table.element,table,["border-top","border-left","border-right","border-bottom"]),table}lookupTableStyles(){var styles={};return this.cloneTableStyle&&window.getComputedStyle&&(styles.oddRow=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),styles.evenRow=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),styles.calcRow=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),styles.firstRow=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),styles.firstGroup=this.table.element.getElementsByClassName("tabulator-group")[0],styles.firstRow&&(styles.styleCells=styles.firstRow.getElementsByClassName("tabulator-cell"),styles.firstCell=styles.styleCells[0],styles.lastCell=styles.styleCells[styles.styleCells.length-1])),styles}generateHeaderElement(row,setup,styles){var rowEl=document.createElement("tr");return row.columns.forEach((column=>{if(column){var cellEl=document.createElement("th"),classNames=column.component._column.definition.cssClass?column.component._column.definition.cssClass.split(" "):[];cellEl.colSpan=column.width,cellEl.rowSpan=column.height,cellEl.innerHTML=column.value,this.cloneTableStyle&&(cellEl.style.boxSizing="border-box"),classNames.forEach((function(className){cellEl.classList.add(className)})),this.mapElementStyles(column.component.getElement(),cellEl,["text-align","border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),this.mapElementStyles(column.component._column.contentElement,cellEl,["padding-top","padding-left","padding-right","padding-bottom"]),column.component._column.visible?this.mapElementStyles(column.component.getElement(),cellEl,["width"]):column.component._column.definition.width&&(cellEl.style.width=column.component._column.definition.width+"px"),column.component._column.parent&&this.mapElementStyles(column.component._column.parent.groupElement,cellEl,["border-top"]),rowEl.appendChild(cellEl)}})),rowEl}generateGroupElement(row,setup,styles){var rowEl=document.createElement("tr"),cellEl=document.createElement("td"),group=row.columns[0];return rowEl.classList.add("tabulator-print-table-row"),setup.groupHeader&&setup.groupHeader[row.indent]?group.value=setup.groupHeader[row.indent](group.value,row.component._group.getRowCount(),row.component._group.getData(),row.component):!1!==setup.groupHeader&&(group.value=row.component._group.generator(group.value,row.component._group.getRowCount(),row.component._group.getData(),row.component)),cellEl.colSpan=group.width,cellEl.innerHTML=group.value,rowEl.classList.add("tabulator-print-table-group"),rowEl.classList.add("tabulator-group-level-"+row.indent),group.component.isVisible()&&rowEl.classList.add("tabulator-group-visible"),this.mapElementStyles(styles.firstGroup,rowEl,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),this.mapElementStyles(styles.firstGroup,cellEl,["padding-top","padding-left","padding-right","padding-bottom"]),rowEl.appendChild(cellEl),rowEl}generateCalcElement(row,setup,styles){var rowEl=this.generateRowElement(row,setup,styles);return rowEl.classList.add("tabulator-print-table-calcs"),this.mapElementStyles(styles.calcRow,rowEl,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),rowEl}generateRowElement(row,setup,styles){var rowEl=document.createElement("tr");return rowEl.classList.add("tabulator-print-table-row"),row.columns.forEach(((col,i)=>{if(col){var cellStyle,cellEl=document.createElement("td"),column=col.component._column,index=this.table.columnManager.findColumnIndex(column),value=col.value,cellWrapper={modules:{},getValue:function(){return value},getField:function(){return column.definition.field},getElement:function(){return cellEl},getColumn:function(){return column.getComponent()},getData:function(){return row.component.getData()},getRow:function(){return row.component},getComponent:function(){return cellWrapper},column:column};if((column.definition.cssClass?column.definition.cssClass.split(" "):[]).forEach((function(className){cellEl.classList.add(className)})),this.table.modExists("format")&&!1!==this.config.formatCells)value=this.table.modules.format.formatExportValue(cellWrapper,this.colVisProp);else switch(typeof value){case"object":value=null!==value?JSON.stringify(value):"";break;case"undefined":value=""}value instanceof Node?cellEl.appendChild(value):cellEl.innerHTML=value,(cellStyle=styles.styleCells&&styles.styleCells[index]?styles.styleCells[index]:styles.firstCell)&&(this.mapElementStyles(cellStyle,cellEl,["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","text-align"]),column.definition.align&&(cellEl.style.textAlign=column.definition.align)),this.table.options.dataTree&&!1!==this.config.dataTree&&(setup.treeElementField&&setup.treeElementField==column.field||!setup.treeElementField&&0==i)&&(row.component._row.modules.dataTree.controlEl&&cellEl.insertBefore(row.component._row.modules.dataTree.controlEl.cloneNode(!0),cellEl.firstChild),row.component._row.modules.dataTree.branchEl&&cellEl.insertBefore(row.component._row.modules.dataTree.branchEl.cloneNode(!0),cellEl.firstChild)),rowEl.appendChild(cellEl),cellWrapper.modules.format&&cellWrapper.modules.format.renderedCallback&&cellWrapper.modules.format.renderedCallback(),setup.rowFormatter&&!1!==this.config.formatCells&&setup.rowFormatter(row.component)}})),rowEl}generateHTMLTable(list){var holder=document.createElement("div");return holder.appendChild(this.generateTableElement(list)),holder.innerHTML}getHtml(visible,style,config,colVisProp){var list=this.generateExportList(config||this.table.options.htmlOutputConfig,style,visible,colVisProp||"htmlOutput");return this.generateHTMLTable(list)}mapElementStyles(from,to,props){if(this.cloneTableStyle&&from&&to){var lookup={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var fromStyle=window.getComputedStyle(from);props.forEach((function(prop){to.style[lookup[prop]]=fromStyle.getPropertyValue(prop)}))}}}}_exports.ExportModule=Export,Export.moduleName="export";var defaultFilters={"=":function(filterVal,rowVal,rowData,filterParams){return rowVal==filterVal},"<":function(filterVal,rowVal,rowData,filterParams){return rowVal<filterVal},"<=":function(filterVal,rowVal,rowData,filterParams){return rowVal<=filterVal},">":function(filterVal,rowVal,rowData,filterParams){return rowVal>filterVal},">=":function(filterVal,rowVal,rowData,filterParams){return rowVal>=filterVal},"!=":function(filterVal,rowVal,rowData,filterParams){return rowVal!=filterVal},regex:function(filterVal,rowVal,rowData,filterParams){return"string"==typeof filterVal&&(filterVal=new RegExp(filterVal)),filterVal.test(rowVal)},like:function(filterVal,rowVal,rowData,filterParams){return null==filterVal?rowVal===filterVal:null!=rowVal&&String(rowVal).toLowerCase().indexOf(filterVal.toLowerCase())>-1},keywords:function(filterVal,rowVal,rowData,filterParams){var keywords=filterVal.toLowerCase().split(void 0===filterParams.separator?" ":filterParams.separator),value=String(null==rowVal?"":rowVal).toLowerCase(),matches=[];return keywords.forEach((keyword=>{value.includes(keyword)&&matches.push(!0)})),filterParams.matchAll?matches.length===keywords.length:!!matches.length},starts:function(filterVal,rowVal,rowData,filterParams){return null==filterVal?rowVal===filterVal:null!=rowVal&&String(rowVal).toLowerCase().startsWith(filterVal.toLowerCase())},ends:function(filterVal,rowVal,rowData,filterParams){return null==filterVal?rowVal===filterVal:null!=rowVal&&String(rowVal).toLowerCase().endsWith(filterVal.toLowerCase())},in:function(filterVal,rowVal,rowData,filterParams){return Array.isArray(filterVal)?!filterVal.length||filterVal.indexOf(rowVal)>-1:(console.warn("Filter Error - filter value is not an array:",filterVal),!1)}};class Filter extends Module{constructor(table){super(table),this.filterList=[],this.headerFilters={},this.headerFilterColumns=[],this.prevHeaderFilterChangeCheck="",this.prevHeaderFilterChangeCheck="{}",this.changed=!1,this.tableInitialized=!1,this.registerTableOption("filterMode","local"),this.registerTableOption("initialFilter",!1),this.registerTableOption("initialHeaderFilter",!1),this.registerTableOption("headerFilterLiveFilterDelay",300),this.registerColumnOption("headerFilter"),this.registerColumnOption("headerFilterPlaceholder"),this.registerColumnOption("headerFilterParams"),this.registerColumnOption("headerFilterEmptyCheck"),this.registerColumnOption("headerFilterFunc"),this.registerColumnOption("headerFilterFuncParams"),this.registerColumnOption("headerFilterLiveFilter"),this.registerTableFunction("searchRows",this.searchRows.bind(this)),this.registerTableFunction("searchData",this.searchData.bind(this)),this.registerTableFunction("setFilter",this.userSetFilter.bind(this)),this.registerTableFunction("refreshFilter",this.userRefreshFilter.bind(this)),this.registerTableFunction("addFilter",this.userAddFilter.bind(this)),this.registerTableFunction("getFilters",this.getFilters.bind(this)),this.registerTableFunction("setHeaderFilterFocus",this.userSetHeaderFilterFocus.bind(this)),this.registerTableFunction("getHeaderFilterValue",this.userGetHeaderFilterValue.bind(this)),this.registerTableFunction("setHeaderFilterValue",this.userSetHeaderFilterValue.bind(this)),this.registerTableFunction("getHeaderFilters",this.getHeaderFilters.bind(this)),this.registerTableFunction("removeFilter",this.userRemoveFilter.bind(this)),this.registerTableFunction("clearFilter",this.userClearFilter.bind(this)),this.registerTableFunction("clearHeaderFilter",this.userClearHeaderFilter.bind(this)),this.registerComponentFunction("column","headerFilterFocus",this.setHeaderFilterFocus.bind(this)),this.registerComponentFunction("column","reloadHeaderFilter",this.reloadHeaderFilter.bind(this)),this.registerComponentFunction("column","getHeaderFilterValue",this.getHeaderFilterValue.bind(this)),this.registerComponentFunction("column","setHeaderFilterValue",this.setHeaderFilterValue.bind(this))}initialize(){this.subscribe("column-init",this.initializeColumnHeaderFilter.bind(this)),this.subscribe("column-width-fit-before",this.hideHeaderFilterElements.bind(this)),this.subscribe("column-width-fit-after",this.showHeaderFilterElements.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),"remote"===this.table.options.filterMode&&this.subscribe("data-params",this.remoteFilterParams.bind(this)),this.registerDataHandler(this.filter.bind(this),10)}tableBuilt(){this.table.options.initialFilter&&this.setFilter(this.table.options.initialFilter),this.table.options.initialHeaderFilter&&this.table.options.initialHeaderFilter.forEach((item=>{var column=this.table.columnManager.findColumn(item.field);if(!column)return console.warn("Column Filter Error - No matching column found:",item.field),!1;this.setHeaderFilterValue(column,item.value)})),this.tableInitialized=!0}remoteFilterParams(data,config,silent,params){return params.filter=this.getFilters(!0,!0),params}userSetFilter(field,type,value,params){this.setFilter(field,type,value,params),this.refreshFilter()}userRefreshFilter(){this.refreshFilter()}userAddFilter(field,type,value,params){this.addFilter(field,type,value,params),this.refreshFilter()}userSetHeaderFilterFocus(field){var column=this.table.columnManager.findColumn(field);if(!column)return console.warn("Column Filter Focus Error - No matching column found:",field),!1;this.setHeaderFilterFocus(column)}userGetHeaderFilterValue(field){var column=this.table.columnManager.findColumn(field);if(column)return this.getHeaderFilterValue(column);console.warn("Column Filter Error - No matching column found:",field)}userSetHeaderFilterValue(field,value){var column=this.table.columnManager.findColumn(field);if(!column)return console.warn("Column Filter Error - No matching column found:",field),!1;this.setHeaderFilterValue(column,value)}userRemoveFilter(field,type,value){this.removeFilter(field,type,value),this.refreshFilter()}userClearFilter(all){this.clearFilter(all),this.refreshFilter()}userClearHeaderFilter(){this.clearHeaderFilter(),this.refreshFilter()}searchRows(field,type,value){return this.search("rows",field,type,value)}searchData(field,type,value){return this.search("data",field,type,value)}initializeColumnHeaderFilter(column){var def=column.definition;def.headerFilter&&(void 0!==def.headerFilterPlaceholder&&def.field&&this.module("localize").setHeaderFilterColumnPlaceholder(def.field,def.headerFilterPlaceholder),this.initializeColumn(column))}initializeColumn(column,value){var self=this,field=column.getField();column.modules.filter={success:function(value){var filterFunc,filterType="input"==column.modules.filter.tagType&&"text"==column.modules.filter.attrType||"textarea"==column.modules.filter.tagType?"partial":"match",type="",filterChangeCheck="";if(void 0===column.modules.filter.prevSuccess||column.modules.filter.prevSuccess!==value){if(column.modules.filter.prevSuccess=value,column.modules.filter.emptyFunc(value))delete self.headerFilters[field];else{switch(column.modules.filter.value=value,typeof column.definition.headerFilterFunc){case"string":Filter.filters[column.definition.headerFilterFunc]?(type=column.definition.headerFilterFunc,filterFunc=function(data){var params=column.definition.headerFilterFuncParams||{},fieldVal=column.getFieldValue(data);return params="function"==typeof params?params(value,fieldVal,data):params,Filter.filters[column.definition.headerFilterFunc](value,fieldVal,data,params)}):console.warn("Header Filter Error - Matching filter function not found: ",column.definition.headerFilterFunc);break;case"function":type=filterFunc=function(data){var params=column.definition.headerFilterFuncParams||{},fieldVal=column.getFieldValue(data);return params="function"==typeof params?params(value,fieldVal,data):params,column.definition.headerFilterFunc(value,fieldVal,data,params)}}if(!filterFunc)if("partial"===filterType)filterFunc=function(data){var colVal=column.getFieldValue(data);return null!=colVal&&String(colVal).toLowerCase().indexOf(String(value).toLowerCase())>-1},type="like";else filterFunc=function(data){return column.getFieldValue(data)==value},type="=";self.headerFilters[field]={value:value,func:filterFunc,type:type}}column.modules.filter.value=value,filterChangeCheck=JSON.stringify(self.headerFilters),self.prevHeaderFilterChangeCheck!==filterChangeCheck&&(self.prevHeaderFilterChangeCheck=filterChangeCheck,self.trackChanges(),self.refreshFilter())}return!0},attrType:!1,tagType:!1,emptyFunc:!1},this.generateHeaderFilterElement(column)}generateHeaderFilterElement(column,initialValue,reinitialize){var filterElement,editor,editorElement,cellWrapper,typingTimer,searchTrigger,params,self=this,success=column.modules.filter.success,field=column.getField();if(column.modules.filter.value=initialValue,column.modules.filter.headerElement&&column.modules.filter.headerElement.parentNode&&column.contentElement.removeChild(column.modules.filter.headerElement.parentNode),field){switch(column.modules.filter.emptyFunc=column.definition.headerFilterEmptyCheck||function(value){return!value&&0!==value},(filterElement=document.createElement("div")).classList.add("tabulator-header-filter"),typeof column.definition.headerFilter){case"string":self.table.modules.edit.editors[column.definition.headerFilter]?(editor=self.table.modules.edit.editors[column.definition.headerFilter],"tick"!==column.definition.headerFilter&&"tickCross"!==column.definition.headerFilter||column.definition.headerFilterEmptyCheck||(column.modules.filter.emptyFunc=function(value){return!0!==value&&!1!==value})):console.warn("Filter Error - Cannot build header filter, No such editor found: ",column.definition.editor);break;case"function":editor=column.definition.headerFilter;break;case"boolean":column.modules.edit&&column.modules.edit.editor?editor=column.modules.edit.editor:column.definition.formatter&&self.table.modules.edit.editors[column.definition.formatter]?(editor=self.table.modules.edit.editors[column.definition.formatter],"tick"!==column.definition.formatter&&"tickCross"!==column.definition.formatter||column.definition.headerFilterEmptyCheck||(column.modules.filter.emptyFunc=function(value){return!0!==value&&!1!==value})):editor=self.table.modules.edit.editors.input}if(editor){if(cellWrapper={getValue:function(){return void 0!==initialValue?initialValue:""},getField:function(){return column.definition.field},getElement:function(){return filterElement},getColumn:function(){return column.getComponent()},getTable:()=>this.table,getRow:function(){return{normalizeHeight:function(){}}}},params="function"==typeof(params=column.definition.headerFilterParams||{})?params.call(self.table,cellWrapper):params,!(editorElement=editor.call(this.table.modules.edit,cellWrapper,(function(){}),success,(function(){}),params)))return void console.warn("Filter Error - Cannot add filter to "+field+" column, editor returned a value of false");if(!(editorElement instanceof Node))return void console.warn("Filter Error - Cannot add filter to "+field+" column, editor should return an instance of Node, the editor returned:",editorElement);self.langBind("headerFilters|columns|"+column.definition.field,(function(value){editorElement.setAttribute("placeholder",void 0!==value&&value?value:self.langText("headerFilters|default"))})),editorElement.addEventListener("click",(function(e){e.stopPropagation(),editorElement.focus()})),editorElement.addEventListener("focus",(e=>{var left=this.table.columnManager.contentsElement.scrollLeft;left!==this.table.rowManager.element.scrollLeft&&(this.table.rowManager.scrollHorizontal(left),this.table.columnManager.scrollHorizontal(left))})),typingTimer=!1,searchTrigger=function(e){typingTimer&&clearTimeout(typingTimer),typingTimer=setTimeout((function(){success(editorElement.value)}),self.table.options.headerFilterLiveFilterDelay)},column.modules.filter.headerElement=editorElement,column.modules.filter.attrType=editorElement.hasAttribute("type")?editorElement.getAttribute("type").toLowerCase():"",column.modules.filter.tagType=editorElement.tagName.toLowerCase(),!1!==column.definition.headerFilterLiveFilter&&("autocomplete"!==column.definition.headerFilter&&"tickCross"!==column.definition.headerFilter&&("autocomplete"!==column.definition.editor&&"tickCross"!==column.definition.editor||!0!==column.definition.headerFilter)&&(editorElement.addEventListener("keyup",searchTrigger),editorElement.addEventListener("search",searchTrigger),"number"==column.modules.filter.attrType&&editorElement.addEventListener("change",(function(e){success(editorElement.value)})),"text"==column.modules.filter.attrType&&"ie"!==this.table.browser&&editorElement.setAttribute("type","search")),"input"!=column.modules.filter.tagType&&"select"!=column.modules.filter.tagType&&"textarea"!=column.modules.filter.tagType||editorElement.addEventListener("mousedown",(function(e){e.stopPropagation()}))),filterElement.appendChild(editorElement),column.contentElement.appendChild(filterElement),reinitialize||self.headerFilterColumns.push(column)}}else console.warn("Filter Error - Cannot add header filter, column has no field set:",column.definition.title)}hideHeaderFilterElements(){this.headerFilterColumns.forEach((function(column){column.modules.filter&&column.modules.filter.headerElement&&(column.modules.filter.headerElement.style.display="none")}))}showHeaderFilterElements(){this.headerFilterColumns.forEach((function(column){column.modules.filter&&column.modules.filter.headerElement&&(column.modules.filter.headerElement.style.display="")}))}setHeaderFilterFocus(column){column.modules.filter&&column.modules.filter.headerElement?column.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",column.getField())}getHeaderFilterValue(column){if(column.modules.filter&&column.modules.filter.headerElement)return column.modules.filter.value;console.warn("Column Filter Error - No header filter set on column:",column.getField())}setHeaderFilterValue(column,value){column&&(column.modules.filter&&column.modules.filter.headerElement?(this.generateHeaderFilterElement(column,value,!0),column.modules.filter.success(value)):console.warn("Column Filter Error - No header filter set on column:",column.getField()))}reloadHeaderFilter(column){column&&(column.modules.filter&&column.modules.filter.headerElement?this.generateHeaderFilterElement(column,column.modules.filter.value,!0):console.warn("Column Filter Error - No header filter set on column:",column.getField()))}refreshFilter(){this.tableInitialized&&("remote"===this.table.options.filterMode?this.reloadData(null,!1,!1):this.refreshData(!0))}trackChanges(){this.changed=!0,this.dispatch("filter-changed")}hasChanged(){var changed=this.changed;return this.changed=!1,changed}setFilter(field,type,value,params){this.filterList=[],Array.isArray(field)||(field=[{field:field,type:type,value:value,params:params}]),this.addFilter(field)}addFilter(field,type,value,params){var changed=!1;Array.isArray(field)||(field=[{field:field,type:type,value:value,params:params}]),field.forEach((filter=>{(filter=this.findFilter(filter))&&(this.filterList.push(filter),changed=!0)})),changed&&this.trackChanges()}findFilter(filter){var column;if(Array.isArray(filter))return this.findSubFilters(filter);var filterFunc=!1;return"function"==typeof filter.field?filterFunc=function(data){return filter.field(data,filter.type||{})}:Filter.filters[filter.type]?filterFunc=(column=this.table.columnManager.getColumnByField(filter.field))?function(data){return Filter.filters[filter.type](filter.value,column.getFieldValue(data),data,filter.params||{})}:function(data){return Filter.filters[filter.type](filter.value,data[filter.field],data,filter.params||{})}:console.warn("Filter Error - No such filter type found, ignoring: ",filter.type),filter.func=filterFunc,!!filter.func&&filter}findSubFilters(filters){var output=[];return filters.forEach((filter=>{(filter=this.findFilter(filter))&&output.push(filter)})),!!output.length&&output}getFilters(all,ajax){var output=[];return all&&(output=this.getHeaderFilters()),ajax&&output.forEach((function(item){"function"==typeof item.type&&(item.type="function")})),output=output.concat(this.filtersToArray(this.filterList,ajax))}filtersToArray(filterList,ajax){var output=[];return filterList.forEach((filter=>{var item;Array.isArray(filter)?output.push(this.filtersToArray(filter,ajax)):(item={field:filter.field,type:filter.type,value:filter.value},ajax&&"function"==typeof item.type&&(item.type="function"),output.push(item))})),output}getHeaderFilters(){var output=[];for(var key in this.headerFilters)output.push({field:key,type:this.headerFilters[key].type,value:this.headerFilters[key].value});return output}removeFilter(field,type,value){Array.isArray(field)||(field=[{field:field,type:type,value:value}]),field.forEach((filter=>{var index=-1;(index="object"==typeof filter.field?this.filterList.findIndex((element=>filter===element)):this.filterList.findIndex((element=>filter.field===element.field&&filter.type===element.type&&filter.value===element.value)))>-1?this.filterList.splice(index,1):console.warn("Filter Error - No matching filter type found, ignoring: ",filter.type)})),this.trackChanges()}clearFilter(all){this.filterList=[],all&&this.clearHeaderFilter(),this.trackChanges()}clearHeaderFilter(){this.headerFilters={},this.prevHeaderFilterChangeCheck="{}",this.headerFilterColumns.forEach((column=>{void 0!==column.modules.filter.value&&delete column.modules.filter.value,column.modules.filter.prevSuccess=void 0,this.reloadHeaderFilter(column)})),this.trackChanges()}search(searchType,field,type,value){var activeRows=[],filterList=[];return Array.isArray(field)||(field=[{field:field,type:type,value:value}]),field.forEach((filter=>{(filter=this.findFilter(filter))&&filterList.push(filter)})),this.table.rowManager.rows.forEach((row=>{var match=!0;filterList.forEach((filter=>{this.filterRecurse(filter,row.getData())||(match=!1)})),match&&activeRows.push("data"===searchType?row.getData("data"):row.getComponent())})),activeRows}filter(rowList,filters){var activeRows=[],activeRowComponents=[];return this.subscribedExternal("dataFiltering")&&this.dispatchExternal("dataFiltering",this.getFilters(!0)),"remote"!==this.table.options.filterMode&&(this.filterList.length||Object.keys(this.headerFilters).length)?rowList.forEach((row=>{this.filterRow(row)&&activeRows.push(row)})):activeRows=rowList.slice(0),this.subscribedExternal("dataFiltered")&&(activeRows.forEach((row=>{activeRowComponents.push(row.getComponent())})),this.dispatchExternal("dataFiltered",this.getFilters(!0),activeRowComponents)),activeRows}filterRow(row,filters){var match=!0,data=row.getData();for(var field in this.filterList.forEach((filter=>{this.filterRecurse(filter,data)||(match=!1)})),this.headerFilters)this.headerFilters[field].func(data)||(match=!1);return match}filterRecurse(filter,data){var match=!1;return Array.isArray(filter)?filter.forEach((subFilter=>{this.filterRecurse(subFilter,data)&&(match=!0)})):match=filter.func(data),match}}_exports.FilterModule=Filter,Filter.moduleName="filter",Filter.filters=defaultFilters;var defaultFormatters={plaintext:function(cell,formatterParams,onRendered){return this.emptyToSpace(this.sanitizeHTML(cell.getValue()))},html:function(cell,formatterParams,onRendered){return cell.getValue()},textarea:function(cell,formatterParams,onRendered){return cell.getElement().style.whiteSpace="pre-wrap",this.emptyToSpace(this.sanitizeHTML(cell.getValue()))},money:function(cell,formatterParams,onRendered){var number,integer,decimal,rgx,floatVal=parseFloat(cell.getValue()),sign="",decimalSym=formatterParams.decimal||".",thousandSym=formatterParams.thousand||",",negativeSign=formatterParams.negativeSign||"-",symbol=formatterParams.symbol||"",after=!!formatterParams.symbolAfter,precision=void 0!==formatterParams.precision?formatterParams.precision:2;if(isNaN(floatVal))return this.emptyToSpace(this.sanitizeHTML(cell.getValue()));if(floatVal<0&&(floatVal=Math.abs(floatVal),sign=negativeSign),number=!1!==precision?floatVal.toFixed(precision):floatVal,integer=(number=String(number).split("."))[0],decimal=number.length>1?decimalSym+number[1]:"",!1!==formatterParams.thousand)for(rgx=/(\d+)(\d{3})/;rgx.test(integer);)integer=integer.replace(rgx,"$1"+thousandSym+"$2");return after?sign+integer+decimal+symbol:sign+symbol+integer+decimal},link:function(cell,formatterParams,onRendered){var data,value=cell.getValue(),urlPrefix=formatterParams.urlPrefix||"",download=formatterParams.download,label=value,el=document.createElement("a");if(formatterParams.labelField&&(data=cell.getData(),label=function labelTraverse(path,data){var value=data[path.shift()];return path.length&&"object"==typeof value?labelTraverse(path,value):value}(formatterParams.labelField.split(this.table.options.nestedFieldSeparator),data)),formatterParams.label)switch(typeof formatterParams.label){case"string":label=formatterParams.label;break;case"function":label=formatterParams.label(cell)}if(label){if(formatterParams.urlField&&(value=(data=cell.getData())[formatterParams.urlField]),formatterParams.url)switch(typeof formatterParams.url){case"string":value=formatterParams.url;break;case"function":value=formatterParams.url(cell)}return el.setAttribute("href",urlPrefix+value),formatterParams.target&&el.setAttribute("target",formatterParams.target),formatterParams.download&&(download="function"==typeof download?download(cell):!0===download?"":download,el.setAttribute("download",download)),el.innerHTML=this.emptyToSpace(this.sanitizeHTML(label)),el}return"&nbsp;"},image:function(cell,formatterParams,onRendered){var el=document.createElement("img"),src=cell.getValue();switch(formatterParams.urlPrefix&&(src=formatterParams.urlPrefix+cell.getValue()),formatterParams.urlSuffix&&(src+=formatterParams.urlSuffix),el.setAttribute("src",src),typeof formatterParams.height){case"number":el.style.height=formatterParams.height+"px";break;case"string":el.style.height=formatterParams.height}switch(typeof formatterParams.width){case"number":el.style.width=formatterParams.width+"px";break;case"string":el.style.width=formatterParams.width}return el.addEventListener("load",(function(){cell.getRow().normalizeHeight()})),el},tickCross:function(cell,formatterParams,onRendered){var value=cell.getValue(),element=cell.getElement(),empty=formatterParams.allowEmpty,truthy=formatterParams.allowTruthy,trueValueSet=Object.keys(formatterParams).includes("trueValue"),tick=void 0!==formatterParams.tickElement?formatterParams.tickElement:'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>',cross=void 0!==formatterParams.crossElement?formatterParams.crossElement:'<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';return trueValueSet&&value===formatterParams.trueValue||!trueValueSet&&(truthy&&value||!0===value||"true"===value||"True"===value||1===value||"1"===value)?(element.setAttribute("aria-checked",!0),tick||""):!empty||"null"!==value&&""!==value&&null!=value?(element.setAttribute("aria-checked",!1),cross||""):(element.setAttribute("aria-checked","mixed"),"")},datetime:function(cell,formatterParams,onRendered){var newDatetime,DT=window.DateTime||luxon.DateTime,inputFormat=formatterParams.inputFormat||"yyyy-MM-dd HH:mm:ss",outputFormat=formatterParams.outputFormat||"dd/MM/yyyy HH:mm:ss",invalid=void 0!==formatterParams.invalidPlaceholder?formatterParams.invalidPlaceholder:"",value=cell.getValue();if(void 0!==DT)return(newDatetime=DT.isDateTime(value)?value:"iso"===inputFormat?DT.fromISO(String(value)):DT.fromFormat(String(value),inputFormat)).isValid?(formatterParams.timezone&&(newDatetime=newDatetime.setZone(formatterParams.timezone)),newDatetime.toFormat(outputFormat)):!0!==invalid&&value?"function"==typeof invalid?invalid(value):invalid:value;console.error("Format Error - 'datetime' formatter is dependant on luxon.js")},datetimediff:function(cell,formatterParams,onRendered){var newDatetime,DT=window.DateTime||luxon.DateTime,inputFormat=formatterParams.inputFormat||"yyyy-MM-dd HH:mm:ss",invalid=void 0!==formatterParams.invalidPlaceholder?formatterParams.invalidPlaceholder:"",suffix=void 0!==formatterParams.suffix&&formatterParams.suffix,unit=void 0!==formatterParams.unit?formatterParams.unit:"days",humanize=void 0!==formatterParams.humanize&&formatterParams.humanize,date=void 0!==formatterParams.date?formatterParams.date:DT.now(),value=cell.getValue();if(void 0!==DT)return(newDatetime=DT.isDateTime(value)?value:"iso"===inputFormat?DT.fromISO(String(value)):DT.fromFormat(String(value),inputFormat)).isValid?humanize?newDatetime.diff(date,unit).toHuman()+(suffix?" "+suffix:""):parseInt(newDatetime.diff(date,unit)[unit])+(suffix?" "+suffix:""):!0===invalid?value:"function"==typeof invalid?invalid(value):invalid;console.error("Format Error - 'datetimediff' formatter is dependant on luxon.js")},lookup:function(cell,formatterParams,onRendered){var value=cell.getValue();return void 0===formatterParams[value]?(console.warn("Missing display value for "+value),value):formatterParams[value]},star:function(cell,formatterParams,onRendered){var value=cell.getValue(),element=cell.getElement(),maxStars=formatterParams&&formatterParams.stars?formatterParams.stars:5,stars=document.createElement("span"),star=document.createElementNS("http://www.w3.org/2000/svg","svg");stars.style.verticalAlign="middle",star.setAttribute("width","14"),star.setAttribute("height","14"),star.setAttribute("viewBox","0 0 512 512"),star.setAttribute("xml:space","preserve"),star.style.padding="0 1px",value=value&&!isNaN(value)?parseInt(value):0,value=Math.max(0,Math.min(value,maxStars));for(var i=1;i<=maxStars;i++){var nextStar=star.cloneNode(!0);nextStar.innerHTML=i<=value?'<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>':'<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>',stars.appendChild(nextStar)}return element.style.whiteSpace="nowrap",element.style.overflow="hidden",element.style.textOverflow="ellipsis",element.setAttribute("aria-label",value),stars},traffic:function(cell,formatterParams,onRendered){var percent,percentValue,value=this.sanitizeHTML(cell.getValue())||0,el=document.createElement("span"),max=formatterParams&&formatterParams.max?formatterParams.max:100,min=formatterParams&&formatterParams.min?formatterParams.min:0,colors=formatterParams&&void 0!==formatterParams.color?formatterParams.color:["red","orange","green"],color="#666666";if(!isNaN(value)&&void 0!==cell.getValue()){switch(el.classList.add("tabulator-traffic-light"),percentValue=parseFloat(value)<=max?parseFloat(value):max,percentValue=parseFloat(percentValue)>=min?parseFloat(percentValue):min,percent=(max-min)/100,percentValue=Math.round((percentValue-min)/percent),typeof colors){case"string":color=colors;break;case"function":color=colors(value);break;case"object":if(Array.isArray(colors)){var unit=100/colors.length,index=Math.floor(percentValue/unit);index=Math.min(index,colors.length-1),color=colors[index=Math.max(index,0)];break}}return el.style.backgroundColor=color,el}},progress:function(cell){let formatterParams=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},onRendered=arguments.length>2?arguments[2]:void 0;var percent,percentValue,color,legend,legendColor,value=this.sanitizeHTML(cell.getValue())||0,element=cell.getElement(),max=formatterParams.max?formatterParams.max:100,min=formatterParams.min?formatterParams.min:0,legendAlign=formatterParams.legendAlign?formatterParams.legendAlign:"center";switch(percentValue=parseFloat(value)<=max?parseFloat(value):max,percentValue=parseFloat(percentValue)>=min?parseFloat(percentValue):min,percent=(max-min)/100,percentValue=Math.round((percentValue-min)/percent),typeof formatterParams.color){case"string":color=formatterParams.color;break;case"function":color=formatterParams.color(value);break;case"object":if(Array.isArray(formatterParams.color)){let unit=100/formatterParams.color.length,index=Math.floor(percentValue/unit);index=Math.min(index,formatterParams.color.length-1),index=Math.max(index,0),color=formatterParams.color[index];break}default:color="#2DC214"}switch(typeof formatterParams.legend){case"string":legend=formatterParams.legend;break;case"function":legend=formatterParams.legend(value);break;case"boolean":legend=value;break;default:legend=!1}switch(typeof formatterParams.legendColor){case"string":legendColor=formatterParams.legendColor;break;case"function":legendColor=formatterParams.legendColor(value);break;case"object":if(Array.isArray(formatterParams.legendColor)){let unit=100/formatterParams.legendColor.length,index=Math.floor(percentValue/unit);index=Math.min(index,formatterParams.legendColor.length-1),index=Math.max(index,0),legendColor=formatterParams.legendColor[index]}break;default:legendColor="#000"}element.style.minWidth="30px",element.style.position="relative",element.setAttribute("aria-label",percentValue);var barEl=document.createElement("div");barEl.style.display="inline-block",barEl.style.width=percentValue+"%",barEl.style.backgroundColor=color,barEl.style.height="100%",barEl.setAttribute("data-max",max),barEl.setAttribute("data-min",min);var barContainer=document.createElement("div");if(barContainer.style.position="relative",barContainer.style.width="100%",barContainer.style.height="100%",legend){var legendEl=document.createElement("div");legendEl.style.position="absolute",legendEl.style.top=0,legendEl.style.left=0,legendEl.style.textAlign=legendAlign,legendEl.style.width="100%",legendEl.style.color=legendColor,legendEl.innerHTML=legend}return onRendered((function(){if(!(cell instanceof CellComponent)){var holderEl=document.createElement("div");holderEl.style.position="absolute",holderEl.style.top="4px",holderEl.style.bottom="4px",holderEl.style.left="4px",holderEl.style.right="4px",element.appendChild(holderEl),element=holderEl}element.appendChild(barContainer),barContainer.appendChild(barEl),legend&&barContainer.appendChild(legendEl)})),""},color:function(cell,formatterParams,onRendered){return cell.getElement().style.backgroundColor=this.sanitizeHTML(cell.getValue()),""},buttonTick:function(cell,formatterParams,onRendered){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>'},buttonCross:function(cell,formatterParams,onRendered){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>'},rownum:function(cell,formatterParams,onRendered){var content=document.createElement("span");return cell.getRow().watchPosition((position=>{content.innerText=position})),content},handle:function(cell,formatterParams,onRendered){return cell.getElement().classList.add("tabulator-row-handle"),"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>"},responsiveCollapse:function(cell,formatterParams,onRendered){var el=document.createElement("div"),config=cell.getRow()._row.modules.responsiveLayout;function toggleList(isOpen){var collapseEl=config.element;config.open=isOpen,collapseEl&&(config.open?(el.classList.add("open"),collapseEl.style.display=""):(el.classList.remove("open"),collapseEl.style.display="none"))}return el.classList.add("tabulator-responsive-collapse-toggle"),el.innerHTML='<svg class=\'tabulator-responsive-collapse-toggle-open\' viewbox="0 0 24 24">\n  <line x1="7" y1="12" x2="17" y2="12" fill="none" stroke-width="3" stroke-linecap="round" />\n  <line y1="7" x1="12" y2="17" x2="12" fill="none" stroke-width="3" stroke-linecap="round" />\n</svg>\n\n<svg class=\'tabulator-responsive-collapse-toggle-close\' viewbox="0 0 24 24">\n  <line x1="7" y1="12" x2="17" y2="12"  fill="none" stroke-width="3" stroke-linecap="round" />\n</svg>',cell.getElement().classList.add("tabulator-row-handle"),el.addEventListener("click",(function(e){e.stopImmediatePropagation(),toggleList(!config.open),cell.getTable().rowManager.adjustTableSize()})),toggleList(config.open),el},rowSelection:function(cell,formatterParams,onRendered){var checkbox=document.createElement("input"),blocked=!1;if(checkbox.type="checkbox",checkbox.setAttribute("aria-label","Select Row"),this.table.modExists("selectRow",!0))if(checkbox.addEventListener("click",(e=>{e.stopPropagation()})),"function"==typeof cell.getRow){var row=cell.getRow();row instanceof RowComponent?(checkbox.addEventListener("change",(e=>{"click"===this.table.options.selectableRangeMode&&blocked?blocked=!1:row.toggleSelect()})),"click"===this.table.options.selectableRangeMode&&checkbox.addEventListener("click",(e=>{blocked=!0,this.table.modules.selectRow.handleComplexRowClick(row._row,e)})),checkbox.checked=row.isSelected&&row.isSelected(),this.table.modules.selectRow.registerRowSelectCheckbox(row,checkbox)):checkbox=""}else checkbox.addEventListener("change",(e=>{this.table.modules.selectRow.selectedRows.length?this.table.deselectRow():this.table.selectRow(formatterParams.rowRange)})),this.table.modules.selectRow.registerHeaderSelectCheckbox(checkbox);return checkbox}};class Format extends Module{constructor(table){super(table),this.registerColumnOption("formatter"),this.registerColumnOption("formatterParams"),this.registerColumnOption("formatterPrint"),this.registerColumnOption("formatterPrintParams"),this.registerColumnOption("formatterClipboard"),this.registerColumnOption("formatterClipboardParams"),this.registerColumnOption("formatterHtmlOutput"),this.registerColumnOption("formatterHtmlOutputParams"),this.registerColumnOption("titleFormatter"),this.registerColumnOption("titleFormatterParams")}initialize(){this.subscribe("cell-format",this.formatValue.bind(this)),this.subscribe("cell-rendered",this.cellRendered.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-format",this.formatHeader.bind(this))}initializeColumn(column){column.modules.format=this.lookupFormatter(column,""),void 0!==column.definition.formatterPrint&&(column.modules.format.print=this.lookupFormatter(column,"Print")),void 0!==column.definition.formatterClipboard&&(column.modules.format.clipboard=this.lookupFormatter(column,"Clipboard")),void 0!==column.definition.formatterHtmlOutput&&(column.modules.format.htmlOutput=this.lookupFormatter(column,"HtmlOutput"))}lookupFormatter(column,type){var config={params:column.definition["formatter"+type+"Params"]||{}},formatter=column.definition["formatter"+type];switch(typeof formatter){case"string":Format.formatters[formatter]?config.formatter=Format.formatters[formatter]:(console.warn("Formatter Error - No such formatter found: ",formatter),config.formatter=Format.formatters.plaintext);break;case"function":config.formatter=formatter;break;default:config.formatter=Format.formatters.plaintext}return config}cellRendered(cell){cell.modules.format&&cell.modules.format.renderedCallback&&!cell.modules.format.rendered&&(cell.modules.format.renderedCallback(),cell.modules.format.rendered=!0)}formatHeader(column,title,el){var formatter,params,onRendered,mockCell;return column.definition.titleFormatter?(formatter=this.getFormatter(column.definition.titleFormatter),onRendered=callback=>{column.titleFormatterRendered=callback},mockCell={getValue:function(){return title},getElement:function(){return el},getColumn:function(){return column.getComponent()},getTable:()=>this.table},params="function"==typeof(params=column.definition.titleFormatterParams||{})?params():params,formatter.call(this,mockCell,params,onRendered)):title}formatValue(cell){var component=cell.getComponent(),params="function"==typeof cell.column.modules.format.params?cell.column.modules.format.params(component):cell.column.modules.format.params;return cell.column.modules.format.formatter.call(this,component,params,(function(callback){cell.modules.format||(cell.modules.format={}),cell.modules.format.renderedCallback=callback,cell.modules.format.rendered=!1}))}formatExportValue(cell,type){var params,formatter=cell.column.modules.format[type];if(formatter){function onRendered(callback){cell.modules.format||(cell.modules.format={}),cell.modules.format.renderedCallback=callback,cell.modules.format.rendered=!1}return params="function"==typeof formatter.params?formatter.params(cell.getComponent()):formatter.params,formatter.formatter.call(this,cell.getComponent(),params,onRendered)}return this.formatValue(cell)}sanitizeHTML(value){if(value){var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(value).replace(/[&<>"'`=/]/g,(function(s){return entityMap[s]}))}return value}emptyToSpace(value){return null==value||""===value?"&nbsp;":value}getFormatter(formatter){switch(typeof formatter){case"string":Format.formatters[formatter]?formatter=Format.formatters[formatter]:(console.warn("Formatter Error - No such formatter found: ",formatter),formatter=Format.formatters.plaintext);break;case"function":break;default:formatter=Format.formatters.plaintext}return formatter}}_exports.FormatModule=Format,Format.moduleName="format",Format.formatters=defaultFormatters;class FrozenColumns extends Module{constructor(table){super(table),this.leftColumns=[],this.rightColumns=[],this.initializationMode="left",this.active=!1,this.blocked=!0,this.registerColumnOption("frozen")}reset(){this.initializationMode="left",this.leftColumns=[],this.rightColumns=[],this.active=!1}initialize(){this.subscribe("cell-layout",this.layoutCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-width",this.layout.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("table-layout",this.layout.bind(this)),this.subscribe("columns-loading",this.reset.bind(this)),this.subscribe("column-add",this.reinitializeColumns.bind(this)),this.subscribe("column-delete",this.reinitializeColumns.bind(this)),this.subscribe("table-redraw",this.layout.bind(this)),this.subscribe("layout-refreshing",this.blockLayout.bind(this)),this.subscribe("layout-refreshed",this.unblockLayout.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this))}blockLayout(){this.blocked=!0}unblockLayout(){this.blocked=!1}layoutCell(cell){this.layoutElement(cell.element,cell.column)}reinitializeColumns(){this.reset(),this.table.columnManager.columnsByIndex.forEach((column=>{this.initializeColumn(column)}))}initializeColumn(column){var config={margin:0,edge:!1};column.isGroup||(this.frozenCheck(column)?(config.position=this.initializationMode,"left"==this.initializationMode?this.leftColumns.push(column):this.rightColumns.unshift(column),this.active=!0,column.modules.frozen=config):this.initializationMode="right")}frozenCheck(column){return column.parent.isGroup&&column.definition.frozen&&console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"),column.parent.isGroup?this.frozenCheck(column.parent):column.definition.frozen}layoutCalcRows(){this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&this.table.modules.columnCalcs.topRow&&this.layoutRow(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&this.table.modules.columnCalcs.botRow&&this.layoutRow(this.table.modules.columnCalcs.botRow),this.table.modExists("groupRows")&&this.layoutGroupCalcs(this.table.modules.groupRows.getGroups()))}layoutGroupCalcs(groups){groups.forEach((group=>{group.calcs.top&&this.layoutRow(group.calcs.top),group.calcs.bottom&&this.layoutRow(group.calcs.bottom),group.groupList&&group.groupList.length&&this.layoutGroupCalcs(group.groupList)}))}layoutColumnPosition(allCells){var leftParents=[],leftMargin=0,rightMargin=0;this.leftColumns.forEach(((column,i)=>{if(column.modules.frozen.marginValue=leftMargin,column.modules.frozen.margin=column.modules.frozen.marginValue+"px",column.visible&&(leftMargin+=column.getWidth()),i==this.leftColumns.length-1?column.modules.frozen.edge=!0:column.modules.frozen.edge=!1,column.parent.isGroup){var parentEl=this.getColGroupParentElement(column);leftParents.includes(parentEl)||(this.layoutElement(parentEl,column),leftParents.push(parentEl)),column.modules.frozen.edge&&parentEl.classList.add("tabulator-frozen-"+column.modules.frozen.position)}else this.layoutElement(column.getElement(),column);allCells&&column.cells.forEach((cell=>{this.layoutElement(cell.getElement(!0),column)}))})),this.rightColumns.forEach(((column,i)=>{column.modules.frozen.marginValue=rightMargin,column.modules.frozen.margin=column.modules.frozen.marginValue+"px",column.visible&&(rightMargin+=column.getWidth()),i==this.rightColumns.length-1?column.modules.frozen.edge=!0:column.modules.frozen.edge=!1,column.parent.isGroup?this.layoutElement(this.getColGroupParentElement(column),column):this.layoutElement(column.getElement(),column),allCells&&column.cells.forEach((cell=>{this.layoutElement(cell.getElement(!0),column)}))}))}getColGroupParentElement(column){return column.parent.isGroup?this.getColGroupParentElement(column.parent):column.getElement()}layout(){this.active&&!this.blocked&&(this.layoutColumnPosition(),this.reinitializeRows(),this.layoutCalcRows())}reinitializeRows(){var visibleRows=this.table.rowManager.getVisibleRows(!0);this.table.rowManager.getRows().filter((row=>!visibleRows.includes(row))).forEach((row=>{row.deinitialize()})),visibleRows.forEach((row=>{"row"===row.type&&this.layoutRow(row)}))}layoutRow(row){"fitDataFill"===this.table.options.layout&&this.rightColumns.length&&(this.table.rowManager.getTableElement().style.minWidth="calc(100% - "+this.rightMargin+")"),this.leftColumns.forEach((column=>{var cell=row.getCell(column);cell&&this.layoutElement(cell.getElement(!0),column)})),this.rightColumns.forEach((column=>{var cell=row.getCell(column);cell&&this.layoutElement(cell.getElement(!0),column)}))}layoutElement(element,column){var position;column.modules.frozen&&(element.style.position="sticky",position=this.table.rtl?"left"===column.modules.frozen.position?"right":"left":column.modules.frozen.position,element.style[position]=column.modules.frozen.margin,element.classList.add("tabulator-frozen"),column.modules.frozen.edge&&element.classList.add("tabulator-frozen-"+column.modules.frozen.position))}adjustForScrollbar(width){this.rightColumns.length&&(this.table.columnManager.getContentsElement().style.width="calc(100% - "+width+"px)")}_calcSpace(columns,index){var width=0;for(let i=0;i<index;i++)columns[i].visible&&(width+=columns[i].getWidth());return width}}_exports.FrozenColumnsModule=FrozenColumns,FrozenColumns.moduleName="frozenColumns";class FrozenRows extends Module{constructor(table){super(table),this.topElement=document.createElement("div"),this.rows=[],this.registerComponentFunction("row","freeze",this.freezeRow.bind(this)),this.registerComponentFunction("row","unfreeze",this.unfreezeRow.bind(this)),this.registerComponentFunction("row","isFrozen",this.isRowFrozen.bind(this)),this.registerTableOption("frozenRowsField","id"),this.registerTableOption("frozenRows",!1)}initialize(){this.rows=[],this.topElement.classList.add("tabulator-frozen-rows-holder"),this.table.columnManager.getContentsElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling),this.subscribe("row-deleting",this.detachRow.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),10),this.table.options.frozenRows&&(this.subscribe("data-processed",this.initializeRows.bind(this)),this.subscribe("row-added",this.initializeRow.bind(this)))}initializeRows(){this.table.rowManager.getRows().forEach((row=>{this.initializeRow(row)}))}initializeRow(row){var frozenRows=this.table.options.frozenRows,rowType=typeof frozenRows;"number"===rowType?row.getPosition()&&row.getPosition()+this.rows.length<=frozenRows&&this.freezeRow(row):"function"===rowType?frozenRows.call(this.table,row.getComponent())&&this.freezeRow(row):Array.isArray(frozenRows)&&frozenRows.includes(row.data[this.options("frozenRowsField")])&&this.freezeRow(row)}isRowFrozen(row){return this.rows.indexOf(row)>-1}isFrozen(){return!!this.rows.length}visibleRows(viewable,rows){return this.rows.forEach((row=>{rows.push(row)})),rows}getRows(rows){var output=rows.slice(0);return this.rows.forEach((function(row){var index=output.indexOf(row);index>-1&&output.splice(index,1)})),output}freezeRow(row){row.modules.frozen?console.warn("Freeze Error - Row is already frozen"):(row.modules.frozen=!0,this.topElement.appendChild(row.getElement()),row.initialize(),row.normalizeHeight(),this.rows.push(row),this.refreshData(!1,"display"),this.table.rowManager.adjustTableSize(),this.styleRows())}unfreezeRow(row){row.modules.frozen?(row.modules.frozen=!1,this.detachRow(row),this.table.rowManager.adjustTableSize(),this.refreshData(!1,"display"),this.rows.length&&this.styleRows()):console.warn("Freeze Error - Row is already unfrozen")}detachRow(row){var index=this.rows.indexOf(row);if(index>-1){var rowEl=row.getElement();rowEl.parentNode&&rowEl.parentNode.removeChild(rowEl),this.rows.splice(index,1)}}styleRows(row){this.rows.forEach(((row,i)=>{this.table.rowManager.styleRow(row,i)}))}}_exports.FrozenRowsModule=FrozenRows,FrozenRows.moduleName="frozenRows";class GroupComponent{constructor(group){return this._group=group,this.type="GroupComponent",new Proxy(this,{get:function(target,name,receiver){return void 0!==target[name]?target[name]:target._group.groupManager.table.componentFunctionBinder.handle("row",target._group,name)}})}getKey(){return this._group.key}getField(){return this._group.field}getElement(){return this._group.element}getRows(){return this._group.getRows(!0)}getSubGroups(){return this._group.getSubGroups(!0)}getParentGroup(){return!!this._group.parent&&this._group.parent.getComponent()}isVisible(){return this._group.visible}show(){this._group.show()}hide(){this._group.hide()}toggle(){this._group.toggleVisibility()}_getSelf(){return this._group}getTable(){return this._group.groupManager.table}}_exports.GroupComponent=GroupComponent;class Group{constructor(groupManager,parent,level,key,field,generator,oldGroup){this.groupManager=groupManager,this.parent=parent,this.key=key,this.level=level,this.field=field,this.hasSubGroups=level<groupManager.groupIDLookups.length-1,this.addRow=this.hasSubGroups?this._addRowToGroup:this._addRow,this.type="group",this.old=oldGroup,this.rows=[],this.groups=[],this.groupList=[],this.generator=generator,this.element=!1,this.elementContents=!1,this.height=0,this.outerHeight=0,this.initialized=!1,this.calcs={},this.initialized=!1,this.modules={},this.arrowElement=!1,this.visible=oldGroup?oldGroup.visible:void 0!==groupManager.startOpen[level]?groupManager.startOpen[level]:groupManager.startOpen[0],this.component=null,this.createElements(),this.addBindings(),this.createValueGroups()}wipe(elementsOnly){elementsOnly||(this.groupList.length?this.groupList.forEach((function(group){group.wipe()})):this.rows.forEach((row=>{row.modules&&delete row.modules.group}))),this.element=!1,this.arrowElement=!1,this.elementContents=!1}createElements(){var arrow=document.createElement("div");arrow.classList.add("tabulator-arrow"),this.element=document.createElement("div"),this.element.classList.add("tabulator-row"),this.element.classList.add("tabulator-group"),this.element.classList.add("tabulator-group-level-"+this.level),this.element.setAttribute("role","rowgroup"),this.arrowElement=document.createElement("div"),this.arrowElement.classList.add("tabulator-group-toggle"),this.arrowElement.appendChild(arrow),!1!==this.groupManager.table.options.movableRows&&this.groupManager.table.modExists("moveRow")&&this.groupManager.table.modules.moveRow.initializeGroupHeader(this)}createValueGroups(){var level=this.level+1;this.groupManager.allowedValues&&this.groupManager.allowedValues[level]&&this.groupManager.allowedValues[level].forEach((value=>{this._createGroup(value,level)}))}addBindings(){this.groupManager.table.options.groupToggleElement&&("arrow"==this.groupManager.table.options.groupToggleElement?this.arrowElement:this.element).addEventListener("click",(e=>{e.stopPropagation(),e.stopImmediatePropagation(),this.toggleVisibility()}))}_createGroup(groupID,level){var groupKey=level+"_"+groupID,group=new Group(this.groupManager,this,level,groupID,this.groupManager.groupIDLookups[level].field,this.groupManager.headerGenerator[level]||this.groupManager.headerGenerator[0],!!this.old&&this.old.groups[groupKey]);this.groups[groupKey]=group,this.groupList.push(group)}_addRowToGroup(row){var level=this.level+1;if(this.hasSubGroups){var groupID=this.groupManager.groupIDLookups[level].func(row.getData()),groupKey=level+"_"+groupID;this.groupManager.allowedValues&&this.groupManager.allowedValues[level]?this.groups[groupKey]&&this.groups[groupKey].addRow(row):(this.groups[groupKey]||this._createGroup(groupID,level),this.groups[groupKey].addRow(row))}}_addRow(row){this.rows.push(row),row.modules.group=this}insertRow(row,to,after){var data=this.conformRowData({});row.updateData(data);var toIndex=this.rows.indexOf(to);toIndex>-1?after?this.rows.splice(toIndex+1,0,row):this.rows.splice(toIndex,0,row):after?this.rows.push(row):this.rows.unshift(row),row.modules.group=this,this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this),this.groupManager.updateGroupRows(!0)}scrollHeader(left){this.arrowElement&&(this.arrowElement.style.marginLeft=left,this.groupList.forEach((function(child){child.scrollHeader(left)})))}getRowIndex(row){}conformRowData(data){return this.field?data[this.field]=this.key:console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"),this.parent&&(data=this.parent.conformRowData(data)),data}removeRow(row){var index=this.rows.indexOf(row),el=row.getElement();index>-1&&this.rows.splice(index,1),this.groupManager.table.options.groupValues||this.rows.length?(el.parentNode&&el.parentNode.removeChild(el),this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this)):(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this),this.groupManager.updateGroupRows(!0))}removeGroup(group){var index,groupKey=group.level+"_"+group.key;this.groups[groupKey]&&(delete this.groups[groupKey],(index=this.groupList.indexOf(group))>-1&&this.groupList.splice(index,1),this.groupList.length||(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this)))}getHeadersAndRows(){var output=[];return output.push(this),this._visSet(),this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.visible?this.groupList.length?this.groupList.forEach((function(group){output=output.concat(group.getHeadersAndRows())})):("table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),output.push(this.calcs.top)),output=output.concat(this.rows),"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),output.push(this.calcs.bottom))):this.groupList.length||"table"==this.groupManager.table.options.columnCalcs||this.groupManager.table.modExists("columnCalcs")&&(this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),output.push(this.calcs.top)),this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),output.push(this.calcs.bottom))),output}getData(visible,transform){var output=[];return this._visSet(),(!visible||visible&&this.visible)&&this.rows.forEach((row=>{output.push(row.getData(transform||"data"))})),output}getRowCount(){var count=0;return this.groupList.length?this.groupList.forEach((group=>{count+=group.getRowCount()})):count=this.rows.length,count}toggleVisibility(){this.visible?this.hide():this.show()}hide(){this.visible=!1,"basic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination||(this.element.classList.remove("tabulator-group-visible"),this.groupList.length?this.groupList.forEach((group=>{group.getHeadersAndRows().forEach((row=>{row.detachElement()}))})):this.rows.forEach((row=>{var rowEl=row.getElement();rowEl.parentNode.removeChild(rowEl)}))),this.groupManager.updateGroupRows(!0),this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!1)}show(){if(this.visible=!0,"basic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination)this.groupManager.updateGroupRows(!0);else{this.element.classList.add("tabulator-group-visible");var prev=this.generateElement();this.groupList.length?this.groupList.forEach((group=>{group.getHeadersAndRows().forEach((row=>{var rowEl=row.getElement();prev.parentNode.insertBefore(rowEl,prev.nextSibling),row.initialize(),prev=rowEl}))})):this.rows.forEach((row=>{var rowEl=row.getElement();prev.parentNode.insertBefore(rowEl,prev.nextSibling),row.initialize(),prev=rowEl})),this.groupManager.updateGroupRows(!0)}this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!0)}_visSet(){var data=[];"function"==typeof this.visible&&(this.rows.forEach((function(row){data.push(row.getData())})),this.visible=this.visible(this.key,this.getRowCount(),data,this.getComponent()))}getRowGroup(row){var match=!1;return this.groupList.length?this.groupList.forEach((function(group){var result=group.getRowGroup(row);result&&(match=result)})):this.rows.find((function(item){return item===row}))&&(match=this),match}getSubGroups(component){var output=[];return this.groupList.forEach((function(child){output.push(component?child.getComponent():child)})),output}getRows(component){var output=[];return this.rows.forEach((function(row){output.push(component?row.getComponent():row)})),output}generateGroupHeaderContents(){var data=[];for(this.rows.forEach((function(row){data.push(row.getData())})),this.elementContents=this.generator(this.key,this.getRowCount(),data,this.getComponent());this.element.firstChild;)this.element.removeChild(this.element.firstChild);"string"==typeof this.elementContents?this.element.innerHTML=this.elementContents:this.element.appendChild(this.elementContents),this.element.insertBefore(this.arrowElement,this.element.firstChild)}getPath(){let path=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return path.unshift(this.key),this.parent&&this.parent.getPath(path),path}getElement(){return this.elementContents?this.element:this.generateElement()}generateElement(){this.addBindings=!1,this._visSet(),this.visible?this.element.classList.add("tabulator-group-visible"):this.element.classList.remove("tabulator-group-visible");for(var i=0;i<this.element.childNodes.length;++i)this.element.childNodes[i].parentNode.removeChild(this.element.childNodes[i]);return this.generateGroupHeaderContents(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}normalizeHeight(){this.setHeight(this.element.clientHeight)}initialize(force){this.initialized&&!force||(this.normalizeHeight(),this.initialized=!0)}reinitialize(){this.initialized=!1,this.height=0,Helpers.elVisible(this.element)&&this.initialize(!0)}setHeight(height){this.height!=height&&(this.height=height,this.outerHeight=this.element.offsetHeight)}getHeight(){return this.outerHeight}getGroup(){return this}reinitializeHeight(){}calcHeight(){}setCellHeight(){}clearCellHeight(){}deinitializeHeight(){}getComponent(){return this.component||(this.component=new GroupComponent(this)),this.component}}class GroupRows extends Module{constructor(table){super(table),this.groupIDLookups=!1,this.startOpen=[function(){return!1}],this.headerGenerator=[function(){return""}],this.groupList=[],this.allowedValues=!1,this.groups={},this.displayHandler=this.getRows.bind(this),this.registerTableOption("groupBy",!1),this.registerTableOption("groupStartOpen",!0),this.registerTableOption("groupValues",!1),this.registerTableOption("groupUpdateOnCellEdit",!1),this.registerTableOption("groupHeader",!1),this.registerTableOption("groupHeaderPrint",null),this.registerTableOption("groupHeaderClipboard",null),this.registerTableOption("groupHeaderHtmlOutput",null),this.registerTableOption("groupHeaderDownload",null),this.registerTableOption("groupToggleElement","arrow"),this.registerTableOption("groupClosedShowCalcs",!1),this.registerTableFunction("setGroupBy",this.setGroupBy.bind(this)),this.registerTableFunction("setGroupValues",this.setGroupValues.bind(this)),this.registerTableFunction("setGroupStartOpen",this.setGroupStartOpen.bind(this)),this.registerTableFunction("setGroupHeader",this.setGroupHeader.bind(this)),this.registerTableFunction("getGroups",this.userGetGroups.bind(this)),this.registerTableFunction("getGroupedData",this.userGetGroupedData.bind(this)),this.registerComponentFunction("row","getGroup",this.rowGetGroup.bind(this))}initialize(){this.table.options.groupBy&&(this.table.options.groupUpdateOnCellEdit&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("row-data-changed",this.reassignRowToGroup.bind(this),0)),this.subscribe("table-built",this.configureGroupSetup.bind(this)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHeaders.bind(this)),this.subscribe("rows-wipe",this.wipe.bind(this)),this.subscribe("rows-added",this.rowsUpdated.bind(this)),this.subscribe("row-moving",this.rowMoving.bind(this)),this.subscribe("row-adding-index",this.rowAddingIndex.bind(this)),this.subscribe("rows-sample",this.rowSample.bind(this)),this.subscribe("render-virtual-fill",this.virtualRenderFill.bind(this)),this.registerDisplayHandler(this.displayHandler,20),this.initialized=!0)}configureGroupSetup(){if(this.table.options.groupBy){var groupBy=this.table.options.groupBy,startOpen=this.table.options.groupStartOpen,groupHeader=this.table.options.groupHeader;if(this.allowedValues=this.table.options.groupValues,Array.isArray(groupBy)&&Array.isArray(groupHeader)&&groupBy.length>groupHeader.length&&console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"),this.headerGenerator=[function(){return""}],this.startOpen=[function(){return!1}],this.langBind("groups|item",((langValue,lang)=>{this.headerGenerator[0]=(value,count,data)=>(void 0===value?"":value)+"<span>("+count+" "+(1===count?langValue:lang.groups.items)+")</span>"})),this.groupIDLookups=[],groupBy)this.table.modExists("columnCalcs")&&"table"!=this.table.options.columnCalcs&&"both"!=this.table.options.columnCalcs&&this.table.modules.columnCalcs.removeCalcs();else if(this.table.modExists("columnCalcs")&&"group"!=this.table.options.columnCalcs)this.table.columnManager.getRealColumns().forEach((col=>{col.definition.topCalc&&this.table.modules.columnCalcs.initializeTopRow(),col.definition.bottomCalc&&this.table.modules.columnCalcs.initializeBottomRow()}));Array.isArray(groupBy)||(groupBy=[groupBy]),groupBy.forEach(((group,i)=>{var lookupFunc,column;lookupFunc="function"==typeof group?group:(column=this.table.columnManager.getColumnByField(group))?function(data){return column.getFieldValue(data)}:function(data){return data[group]},this.groupIDLookups.push({field:"function"!=typeof group&&group,func:lookupFunc,values:!!this.allowedValues&&this.allowedValues[i]})})),startOpen&&(Array.isArray(startOpen)||(startOpen=[startOpen]),startOpen.forEach((level=>{})),this.startOpen=startOpen),groupHeader&&(this.headerGenerator=Array.isArray(groupHeader)?groupHeader:[groupHeader])}else this.groupList=[],this.groups={}}rowSample(rows,prevValue){if(this.table.options.groupBy){var group=this.getGroups(!1)[0];prevValue.push(group.getRows(!1)[0])}return prevValue}virtualRenderFill(){var el=this.table.rowManager.tableElement,rows=this.table.rowManager.getVisibleRows();if(!this.table.options.groupBy)return rows;rows=rows.filter((row=>"group"!==row.type)),el.style.minWidth=rows.length?"":this.table.columnManager.getWidth()+"px"}rowAddingIndex(row,index,top){if(this.table.options.groupBy){this.assignRowToGroup(row);var groupRows=row.modules.group.rows;return groupRows.length>1&&(!index||index&&-1==groupRows.indexOf(index)?top?groupRows[0]!==row&&(index=groupRows[0],this.table.rowManager.moveRowInArray(row.modules.group.rows,row,index,!top)):groupRows[groupRows.length-1]!==row&&(index=groupRows[groupRows.length-1],this.table.rowManager.moveRowInArray(row.modules.group.rows,row,index,!top)):this.table.rowManager.moveRowInArray(row.modules.group.rows,row,index,!top)),index}}trackChanges(){this.dispatch("group-changed")}setGroupBy(groups){this.table.options.groupBy=groups,this.initialized||this.initialize(),this.configureGroupSetup(),!groups&&this.table.modExists("columnCalcs")&&!0===this.table.options.columnCalcs&&this.table.modules.columnCalcs.reinitializeCalcs(),this.refreshData(),this.trackChanges()}setGroupValues(groupValues){this.table.options.groupValues=groupValues,this.configureGroupSetup(),this.refreshData(),this.trackChanges()}setGroupStartOpen(values){this.table.options.groupStartOpen=values,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}setGroupHeader(values){this.table.options.groupHeader=values,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}userGetGroups(values){return this.getGroups(!0)}userGetGroupedData(){return this.table.options.groupBy?this.getGroupedData():this.getData()}rowGetGroup(row){return!!row.modules.group&&row.modules.group.getComponent()}rowMoving(from,to,after){if(this.table.options.groupBy){!after&&to instanceof Group&&(to=this.table.rowManager.prevDisplayRow(from)||to);var toGroup=to instanceof Group?to:to.modules.group,fromGroup=from instanceof Group?from:from.modules.group;toGroup===fromGroup?this.table.rowManager.moveRowInArray(toGroup.rows,from,to,after):(fromGroup&&fromGroup.removeRow(from),toGroup.insertRow(from,to,after))}}rowDeleting(row){this.table.options.groupBy&&row.modules.group&&row.modules.group.removeRow(row)}rowsUpdated(row){this.table.options.groupBy&&this.updateGroupRows(!0)}cellUpdated(cell){this.table.options.groupBy&&this.reassignRowToGroup(cell.row)}getRows(rows){return this.table.options.groupBy&&this.groupIDLookups.length?(this.dispatchExternal("dataGrouping"),this.generateGroups(rows),this.subscribedExternal("dataGrouped")&&this.dispatchExternal("dataGrouped",this.getGroups(!0)),this.updateGroupRows()):rows.slice(0)}getGroups(component){var groupComponents=[];return this.groupList.forEach((function(group){groupComponents.push(component?group.getComponent():group)})),groupComponents}getChildGroups(group){var groupComponents=[];return group||(group=this),group.groupList.forEach((child=>{child.groupList.length?groupComponents=groupComponents.concat(this.getChildGroups(child)):groupComponents.push(child)})),groupComponents}wipe(){this.table.options.groupBy&&(this.groupList.forEach((function(group){group.wipe()})),this.groupList=[],this.groups={})}pullGroupListData(groupList){var groupListData=[];return groupList.forEach((group=>{var groupHeader={level:0,rowCount:0,headerContent:""},childData=[];group.hasSubGroups?(childData=this.pullGroupListData(group.groupList),groupHeader.level=group.level,groupHeader.rowCount=childData.length-group.groupList.length,groupHeader.headerContent=group.generator(group.key,groupHeader.rowCount,group.rows,group),groupListData.push(groupHeader),groupListData=groupListData.concat(childData)):(groupHeader.level=group.level,groupHeader.headerContent=group.generator(group.key,group.rows.length,group.rows,group),groupHeader.rowCount=group.getRows().length,groupListData.push(groupHeader),group.getRows().forEach((row=>{groupListData.push(row.getData("data"))})))})),groupListData}getGroupedData(){return this.pullGroupListData(this.groupList)}getRowGroup(row){var match=!1;return this.options("dataTree")&&(row=this.table.modules.dataTree.getTreeParentRoot(row)),this.groupList.forEach((group=>{var result=group.getRowGroup(row);result&&(match=result)})),match}countGroups(){return this.groupList.length}generateGroups(rows){var oldGroups=this.groups;this.groups={},this.groupList=[],this.allowedValues&&this.allowedValues[0]?(this.allowedValues[0].forEach((value=>{this.createGroup(value,0,oldGroups)})),rows.forEach((row=>{this.assignRowToExistingGroup(row,oldGroups)}))):rows.forEach((row=>{this.assignRowToGroup(row,oldGroups)})),Object.values(oldGroups).forEach((group=>{group.wipe(!0)}))}createGroup(groupID,level,oldGroups){var group,groupKey=level+"_"+groupID;oldGroups=oldGroups||[],group=new Group(this,!1,level,groupID,this.groupIDLookups[0].field,this.headerGenerator[0],oldGroups[groupKey]),this.groups[groupKey]=group,this.groupList.push(group)}assignRowToExistingGroup(row,oldGroups){var groupKey="0_"+this.groupIDLookups[0].func(row.getData());this.groups[groupKey]&&this.groups[groupKey].addRow(row)}assignRowToGroup(row,oldGroups){var groupID=this.groupIDLookups[0].func(row.getData()),newGroupNeeded=!this.groups["0_"+groupID];return newGroupNeeded&&this.createGroup(groupID,0,oldGroups),this.groups["0_"+groupID].addRow(row),!newGroupNeeded}reassignRowToGroup(row){if("row"===row.type){var oldRowGroup=row.modules.group,oldGroupPath=oldRowGroup.getPath(),newGroupPath=this.getExpectedPath(row);oldGroupPath.length==newGroupPath.length&&oldGroupPath.every(((element,index)=>element===newGroupPath[index]))||(oldRowGroup.removeRow(row),this.assignRowToGroup(row,this.groups),this.refreshData(!0))}}getExpectedPath(row){var groupPath=[],rowData=row.getData();return this.groupIDLookups.forEach((groupId=>{groupPath.push(groupId.func(rowData))})),groupPath}updateGroupRows(force){var output=[];return this.groupList.forEach((group=>{output=output.concat(group.getHeadersAndRows())})),force&&this.refreshData(!0,this.displayHandler),output}scrollHeaders(left){this.table.options.groupBy&&("virtual"===this.table.options.renderHorizontal&&(left-=this.table.columnManager.renderer.vDomPadLeft),left+="px",this.groupList.forEach((group=>{group.scrollHeader(left)})))}removeGroup(group){var index,groupKey=group.level+"_"+group.key;this.groups[groupKey]&&(delete this.groups[groupKey],(index=this.groupList.indexOf(group))>-1&&this.groupList.splice(index,1))}checkBasicModeGroupHeaderWidth(){var element=this.table.rowManager.tableElement,onlyGroupHeaders=!0;this.table.rowManager.getDisplayRows().forEach(((row,index)=>{this.table.rowManager.styleRow(row,index),element.appendChild(row.getElement()),row.initialize(!0),"group"!==row.type&&(onlyGroupHeaders=!1)})),element.style.minWidth=onlyGroupHeaders?this.table.columnManager.getWidth()+"px":""}}_exports.GroupRowsModule=GroupRows,GroupRows.moduleName="groupRows";class History extends Module{constructor(table){super(table),this.history=[],this.index=-1,this.registerTableOption("history",!1)}initialize(){this.table.options.history&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("cell-delete",this.clearComponentHistory.bind(this)),this.subscribe("row-delete",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clear.bind(this)),this.subscribe("row-added",this.rowAdded.bind(this)),this.subscribe("row-move",this.rowMoved.bind(this))),this.registerTableFunction("undo",this.undo.bind(this)),this.registerTableFunction("redo",this.redo.bind(this)),this.registerTableFunction("getHistoryUndoSize",this.getHistoryUndoSize.bind(this)),this.registerTableFunction("getHistoryRedoSize",this.getHistoryRedoSize.bind(this)),this.registerTableFunction("clearHistory",this.clear.bind(this))}rowMoved(from,to,after){this.action("rowMove",from,{posFrom:from.getPosition(),posTo:to.getPosition(),to:to,after:after})}rowAdded(row,data,pos,index){this.action("rowAdd",row,{data:data,pos:pos,index:index})}rowDeleted(row){var index,rows;this.table.options.groupBy?(index=(rows=row.getComponent().getGroup()._getSelf().rows).indexOf(row))&&(index=rows[index-1]):(index=row.table.rowManager.getRowIndex(row))&&(index=row.table.rowManager.rows[index-1]),this.action("rowDelete",row,{data:row.getData(),pos:!index,index:index})}cellUpdated(cell){this.action("cellEdit",cell,{oldValue:cell.oldValue,newValue:cell.value})}clear(){this.history=[],this.index=-1}action(type,component,data){this.history=this.history.slice(0,this.index+1),this.history.push({type:type,component:component,data:data}),this.index++}getHistoryUndoSize(){return this.index+1}getHistoryRedoSize(){return this.history.length-(this.index+1)}clearComponentHistory(component){var index=this.history.findIndex((function(item){return item.component===component}));index>-1&&(this.history.splice(index,1),index<=this.index&&this.index--,this.clearComponentHistory(component))}undo(){if(this.index>-1){let action=this.history[this.index];return History.undoers[action.type].call(this,action),this.index--,this.dispatchExternal("historyUndo",action.type,action.component.getComponent(),action.data),!0}return console.warn("History Undo Error - No more history to undo"),!1}redo(){if(this.history.length-1>this.index){this.index++;let action=this.history[this.index];return History.redoers[action.type].call(this,action),this.dispatchExternal("historyRedo",action.type,action.component.getComponent(),action.data),!0}return console.warn("History Redo Error - No more history to redo"),!1}_rebindRow(oldRow,newRow){this.history.forEach((function(action){if(action.component instanceof Row)action.component===oldRow&&(action.component=newRow);else if(action.component instanceof Cell&&action.component.row===oldRow){var field=action.component.column.getField();field&&(action.component=newRow.getCell(field))}}))}}_exports.HistoryModule=History,History.moduleName="history",History.undoers={cellEdit:function(action){action.component.setValueProcessData(action.data.oldValue),action.component.cellRendered()},rowAdd:function(action){action.component.deleteActual()},rowDelete:function(action){var newRow=this.table.rowManager.addRowActual(action.data.data,action.data.pos,action.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(action.component,newRow)},rowMove:function(action){this.table.rowManager.moveRowActual(action.component,this.table.rowManager.rows[action.data.posFrom],!action.data.after),this.table.rowManager.redraw()}},History.redoers={cellEdit:function(action){action.component.setValueProcessData(action.data.newValue),action.component.cellRendered()},rowAdd:function(action){var newRow=this.table.rowManager.addRowActual(action.data.data,action.data.pos,action.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(action.component,newRow)},rowDelete:function(action){action.component.deleteActual()},rowMove:function(action){this.table.rowManager.moveRowActual(action.component,this.table.rowManager.rows[action.data.posTo],action.data.after),this.table.rowManager.redraw()}};class HtmlTableImport extends Module{constructor(table){super(table),this.fieldIndex=[],this.hasIndex=!1}initialize(){this.tableElementCheck()}tableElementCheck(){this.table.originalElement&&"TABLE"===this.table.originalElement.tagName&&(this.table.originalElement.childNodes.length?this.parseTable():console.warn("Unable to parse data from empty table tag, Tabulator should be initialized on a div tag unless importing data from a table element."))}parseTable(){var element=this.table.originalElement,options=this.table.options,headers=element.getElementsByTagName("th"),rows=element.getElementsByTagName("tbody")[0],data=[];this.hasIndex=!1,this.dispatchExternal("htmlImporting"),rows=rows?rows.getElementsByTagName("tr"):[],this._extractOptions(element,options),headers.length?this._extractHeaders(headers,rows):this._generateBlankHeaders(headers,rows);for(var index=0;index<rows.length;index++){var cells=rows[index].getElementsByTagName("td"),item={};this.hasIndex||(item[options.index]=index);for(var i=0;i<cells.length;i++){var cell=cells[i];void 0!==this.fieldIndex[i]&&(item[this.fieldIndex[i]]=cell.innerHTML)}data.push(item)}options.data=data,this.dispatchExternal("htmlImported")}_extractOptions(element,options,defaultOptions){var attributes=element.attributes,optionsArr=defaultOptions?Object.keys(defaultOptions):Object.keys(options),optionsList={};for(var index in optionsArr.forEach((item=>{optionsList[item.toLowerCase()]=item})),attributes){var name,attrib=attributes[index];attrib&&"object"==typeof attrib&&attrib.name&&0===attrib.name.indexOf("tabulator-")&&(name=attrib.name.replace("tabulator-",""),void 0!==optionsList[name]&&(options[optionsList[name]]=this._attribValue(attrib.value)))}}_attribValue(value){return"true"===value||"false"!==value&&value}_findCol(title){return this.table.options.columns.find((column=>column.title===title))||!1}_extractHeaders(headers,rows){for(var index=0;index<headers.length;index++){var width,header=headers[index],exists=!1,col=this._findCol(header.textContent);col?exists=!0:col={title:header.textContent.trim()},col.field||(col.field=header.textContent.trim().toLowerCase().replace(" ","_")),(width=header.getAttribute("width"))&&!col.width&&(col.width=width),this._extractOptions(header,col,this.table.columnManager.optionsList.registeredDefaults),this.fieldIndex[index]=col.field,col.field==this.table.options.index&&(this.hasIndex=!0),exists||this.table.options.columns.push(col)}}_generateBlankHeaders(headers,rows){for(var index=0;index<headers.length;index++){var header=headers[index],col={title:"",field:"col"+index};this.fieldIndex[index]=col.field;var width=header.getAttribute("width");width&&(col.width=width),this.table.options.columns.push(col)}}}_exports.HtmlTableImportModule=HtmlTableImport,HtmlTableImport.moduleName="htmlTableImport";var defaultImporters={csv:function(input){var data=[],row=0,col=0,inQuote=!1;for(let index=0;index<input.length;index++){let char=input[index],nextChar=input[index+1];data[row]||(data[row]=[]),data[row][col]||(data[row][col]=""),'"'==char&&inQuote&&'"'==nextChar?(data[row][col]+=char,index++):'"'!=char?","!=char||inQuote?"\r"!=char||"\n"!=nextChar||inQuote?"\r"!=char&&"\n"!=char||inQuote?data[row][col]+=char:(col=0,row++):(col=0,row++,index++):col++:inQuote=!inQuote}return data},json:function(input){try{return JSON.parse(input)}catch(e){return console.warn("JSON Import Error - File contents is invalid JSON",e),Promise.reject()}},array:function(input){return input}};class Import extends Module{constructor(table){super(table),this.registerTableOption("importFormat"),this.registerTableOption("importReader","text")}initialize(){this.registerTableFunction("import",this.importFromFile.bind(this)),this.table.options.importFormat&&(this.subscribe("data-loading",this.loadDataCheck.bind(this),10),this.subscribe("data-load",this.loadData.bind(this),10))}loadDataCheck(data){return this.table.options.importFormat&&("string"==typeof data||Array.isArray(data)&&data.length&&Array.isArray(data))}loadData(data,params,config,silent,previousData){return this.importData(this.lookupImporter(),data).then(this.structureData.bind(this)).catch((err=>(console.error("Import Error:",err||"Unable to import data"),Promise.reject(err))))}lookupImporter(importFormat){var importer;return importFormat||(importFormat=this.table.options.importFormat),(importer="string"==typeof importFormat?Import.importers[importFormat]:importFormat)||console.error("Import Error - Importer not found:",importFormat),importer}importFromFile(importFormat,extension){var importer=this.lookupImporter(importFormat);if(importer)return this.pickFile(extension).then(this.importData.bind(this,importer)).then(this.structureData.bind(this)).then(this.setData.bind(this)).catch((err=>(console.error("Import Error:",err||"Unable to import file"),Promise.reject(err))))}pickFile(extensions){return new Promise(((resolve,reject)=>{var input=document.createElement("input");input.type="file",input.accept=extensions,input.addEventListener("change",(e=>{var file=input.files[0],reader=new FileReader;switch(this.table.options.importReader){case"buffer":reader.readAsArrayBuffer(file);break;case"binary":reader.readAsBinaryString(file);break;case"url":reader.readAsDataURL(file);break;default:reader.readAsText(file)}reader.onload=e=>{resolve(reader.result)},reader.onerror=e=>{console.warn("File Load Error - Unable to read file"),reject()}})),input.click()}))}importData(importer,fileContents){var data=importer.call(this.table,fileContents);return data instanceof Promise?data:data?Promise.resolve(data):Promise.reject()}structureData(parsedData){return Array.isArray(parsedData)&&parsedData.length&&Array.isArray(parsedData[0])?this.table.options.autoColumns?this.structureArrayToObject(parsedData):this.structureArrayToColumns(parsedData):parsedData}structureArrayToObject(parsedData){var columns=parsedData.shift();return parsedData.map((values=>{var row={};return columns.forEach(((key,i)=>{row[key]=values[i]})),row}))}structureArrayToColumns(parsedData){var data=[],columns=this.table.getColumns();return columns[0]&&parsedData[0][0]&&columns[0].getDefinition().title===parsedData[0][0]&&parsedData.shift(),parsedData.forEach((rowData=>{var row={};rowData.forEach(((value,index)=>{var column=columns[index];column&&(row[column.getField()]=value)})),data.push(row)})),data}setData(data){return this.table.setData(data)}}_exports.ImportModule=Import,Import.moduleName="import",Import.importers=defaultImporters;class Interaction extends Module{constructor(table){super(table),this.eventMap={rowClick:"row-click",rowDblClick:"row-dblclick",rowContext:"row-contextmenu",rowMouseEnter:"row-mouseenter",rowMouseLeave:"row-mouseleave",rowMouseOver:"row-mouseover",rowMouseOut:"row-mouseout",rowMouseMove:"row-mousemove",rowMouseDown:"row-mousedown",rowMouseUp:"row-mouseup",rowTap:"row",rowDblTap:"row",rowTapHold:"row",cellClick:"cell-click",cellDblClick:"cell-dblclick",cellContext:"cell-contextmenu",cellMouseEnter:"cell-mouseenter",cellMouseLeave:"cell-mouseleave",cellMouseOver:"cell-mouseover",cellMouseOut:"cell-mouseout",cellMouseMove:"cell-mousemove",cellMouseDown:"cell-mousedown",cellMouseUp:"cell-mouseup",cellTap:"cell",cellDblTap:"cell",cellTapHold:"cell",headerClick:"column-click",headerDblClick:"column-dblclick",headerContext:"column-contextmenu",headerMouseEnter:"column-mouseenter",headerMouseLeave:"column-mouseleave",headerMouseOver:"column-mouseover",headerMouseOut:"column-mouseout",headerMouseMove:"column-mousemove",headerMouseDown:"column-mousedown",headerMouseUp:"column-mouseup",headerTap:"column",headerDblTap:"column",headerTapHold:"column",groupClick:"group-click",groupDblClick:"group-dblclick",groupContext:"group-contextmenu",groupMouseEnter:"group-mouseenter",groupMouseLeave:"group-mouseleave",groupMouseOver:"group-mouseover",groupMouseOut:"group-mouseout",groupMouseMove:"group-mousemove",groupMouseDown:"group-mousedown",groupMouseUp:"group-mouseup",groupTap:"group",groupDblTap:"group",groupTapHold:"group"},this.subscribers={},this.touchSubscribers={},this.columnSubscribers={},this.touchWatchers={row:{tap:null,tapDbl:null,tapHold:null},cell:{tap:null,tapDbl:null,tapHold:null},column:{tap:null,tapDbl:null,tapHold:null},group:{tap:null,tapDbl:null,tapHold:null}},this.registerColumnOption("headerClick"),this.registerColumnOption("headerDblClick"),this.registerColumnOption("headerContext"),this.registerColumnOption("headerMouseEnter"),this.registerColumnOption("headerMouseLeave"),this.registerColumnOption("headerMouseOver"),this.registerColumnOption("headerMouseOut"),this.registerColumnOption("headerMouseMove"),this.registerColumnOption("headerMouseDown"),this.registerColumnOption("headerMouseUp"),this.registerColumnOption("headerTap"),this.registerColumnOption("headerDblTap"),this.registerColumnOption("headerTapHold"),this.registerColumnOption("cellClick"),this.registerColumnOption("cellDblClick"),this.registerColumnOption("cellContext"),this.registerColumnOption("cellMouseEnter"),this.registerColumnOption("cellMouseLeave"),this.registerColumnOption("cellMouseOver"),this.registerColumnOption("cellMouseOut"),this.registerColumnOption("cellMouseMove"),this.registerColumnOption("cellMouseDown"),this.registerColumnOption("cellMouseUp"),this.registerColumnOption("cellTap"),this.registerColumnOption("cellDblTap"),this.registerColumnOption("cellTapHold")}initialize(){this.initializeExternalEvents(),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("cell-dblclick",this.cellContentsSelectionFixer.bind(this))}cellContentsSelectionFixer(e,cell){var range;if(!this.table.modExists("edit")||this.table.modules.edit.currentCell!==cell){e.preventDefault();try{document.selection?((range=document.body.createTextRange()).moveToElementText(cell.getElement()),range.select()):window.getSelection&&((range=document.createRange()).selectNode(cell.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(range))}catch(e){}}}initializeExternalEvents(){for(let key in this.eventMap)this.subscriptionChangeExternal(key,this.subscriptionChanged.bind(this,key))}subscriptionChanged(key,added){added?this.subscribers[key]||(this.eventMap[key].includes("-")?(this.subscribers[key]=this.handle.bind(this,key),this.subscribe(this.eventMap[key],this.subscribers[key])):this.subscribeTouchEvents(key)):this.eventMap[key].includes("-")?!this.subscribers[key]||this.columnSubscribers[key]||this.subscribedExternal(key)||(this.unsubscribe(this.eventMap[key],this.subscribers[key]),delete this.subscribers[key]):this.unsubscribeTouchEvents(key)}subscribeTouchEvents(key){var type=this.eventMap[key];this.touchSubscribers[type+"-touchstart"]||(this.touchSubscribers[type+"-touchstart"]=this.handleTouch.bind(this,type,"start"),this.touchSubscribers[type+"-touchend"]=this.handleTouch.bind(this,type,"end"),this.subscribe(type+"-touchstart",this.touchSubscribers[type+"-touchstart"]),this.subscribe(type+"-touchend",this.touchSubscribers[type+"-touchend"])),this.subscribers[key]=!0}unsubscribeTouchEvents(key){var noTouch=!0,type=this.eventMap[key];if(this.subscribers[key]&&!this.subscribedExternal(key)){delete this.subscribers[key];for(let i in this.eventMap)this.eventMap[i]===type&&this.subscribers[i]&&(noTouch=!1);noTouch&&(this.unsubscribe(type+"-touchstart",this.touchSubscribers[type+"-touchstart"]),this.unsubscribe(type+"-touchend",this.touchSubscribers[type+"-touchend"]),delete this.touchSubscribers[type+"-touchstart"],delete this.touchSubscribers[type+"-touchend"])}}initializeColumn(column){var def=column.definition;for(let key in this.eventMap)def[key]&&(this.subscriptionChanged(key,!0),this.columnSubscribers[key]||(this.columnSubscribers[key]=[]),this.columnSubscribers[key].push(column))}handle(action,e,component){this.dispatchEvent(action,e,component)}handleTouch(type,action,e,component){var watchers=this.touchWatchers[type];switch("column"===type&&(type="header"),action){case"start":watchers.tap=!0,clearTimeout(watchers.tapHold),watchers.tapHold=setTimeout((()=>{clearTimeout(watchers.tapHold),watchers.tapHold=null,watchers.tap=null,clearTimeout(watchers.tapDbl),watchers.tapDbl=null,this.dispatchEvent(type+"TapHold",e,component)}),1e3);break;case"end":watchers.tap&&(watchers.tap=null,this.dispatchEvent(type+"Tap",e,component)),watchers.tapDbl?(clearTimeout(watchers.tapDbl),watchers.tapDbl=null,this.dispatchEvent(type+"DblTap",e,component)):watchers.tapDbl=setTimeout((()=>{clearTimeout(watchers.tapDbl),watchers.tapDbl=null}),300),clearTimeout(watchers.tapHold),watchers.tapHold=null}}dispatchEvent(action,e,component){var callback,componentObj=component.getComponent();this.columnSubscribers[action]&&(component instanceof Cell?callback=component.column.definition[action]:component instanceof Column&&(callback=component.definition[action]),callback&&callback(e,componentObj)),this.dispatchExternal(action,e,componentObj)}}_exports.InteractionModule=Interaction,Interaction.moduleName="interaction";class Keybindings extends Module{constructor(table){super(table),this.watchKeys=null,this.pressedKeys=null,this.keyupBinding=!1,this.keydownBinding=!1,this.registerTableOption("keybindings",{}),this.registerTableOption("tabEndNewRow",!1)}initialize(){var bindings=this.table.options.keybindings,mergedBindings={};this.watchKeys={},this.pressedKeys=[],!1!==bindings&&(Object.assign(mergedBindings,Keybindings.bindings),Object.assign(mergedBindings,bindings),this.mapBindings(mergedBindings),this.bindEvents()),this.subscribe("table-destroy",this.clearBindings.bind(this))}mapBindings(bindings){for(let key in bindings)Keybindings.actions[key]?bindings[key]&&("object"!=typeof bindings[key]&&(bindings[key]=[bindings[key]]),bindings[key].forEach((binding=>{(Array.isArray(binding)?binding:[binding]).forEach((item=>{this.mapBinding(key,item)}))}))):console.warn("Key Binding Error - no such action:",key)}mapBinding(action,symbolsList){var binding={action:Keybindings.actions[action],keys:[],ctrl:!1,shift:!1,meta:!1};symbolsList.toString().toLowerCase().split(" ").join("").split("+").forEach((symbol=>{switch(symbol){case"ctrl":binding.ctrl=!0;break;case"shift":binding.shift=!0;break;case"meta":binding.meta=!0;break;default:symbol=isNaN(symbol)?symbol.toUpperCase().charCodeAt(0):parseInt(symbol),binding.keys.push(symbol),this.watchKeys[symbol]||(this.watchKeys[symbol]=[]),this.watchKeys[symbol].push(binding)}}))}bindEvents(){var self=this;this.keyupBinding=function(e){var code=e.keyCode,bindings=self.watchKeys[code];bindings&&(self.pressedKeys.push(code),bindings.forEach((function(binding){self.checkBinding(e,binding)})))},this.keydownBinding=function(e){var code=e.keyCode;if(self.watchKeys[code]){var index=self.pressedKeys.indexOf(code);index>-1&&self.pressedKeys.splice(index,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)}clearBindings(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)}checkBinding(e,binding){var match=!0;return e.ctrlKey==binding.ctrl&&e.shiftKey==binding.shift&&e.metaKey==binding.meta&&(binding.keys.forEach((key=>{-1==this.pressedKeys.indexOf(key)&&(match=!1)})),match&&binding.action.call(this,e),!0)}}_exports.KeybindingsModule=Keybindings,Keybindings.moduleName="keybindings",Keybindings.bindings={navPrev:"shift + 9",navNext:9,navUp:38,navDown:40,scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35,undo:["ctrl + 90","meta + 90"],redo:["ctrl + 89","meta + 89"],copyToClipboard:["ctrl + 67","meta + 89"]},Keybindings.actions={keyBlock:function(e){e.stopPropagation(),e.preventDefault()},scrollPageUp:function(e){var rowManager=this.table.rowManager,newPos=rowManager.scrollTop-rowManager.element.clientHeight;e.preventDefault(),rowManager.displayRowsCount&&(newPos>=0?rowManager.element.scrollTop=newPos:rowManager.scrollToRow(rowManager.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(e){var rowManager=this.table.rowManager,newPos=rowManager.scrollTop+rowManager.element.clientHeight,scrollMax=rowManager.element.scrollHeight;e.preventDefault(),rowManager.displayRowsCount&&(newPos<=scrollMax?rowManager.element.scrollTop=newPos:rowManager.scrollToRow(rowManager.getDisplayRows()[rowManager.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(e){var rowManager=this.table.rowManager;e.preventDefault(),rowManager.displayRowsCount&&rowManager.scrollToRow(rowManager.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(e){var rowManager=this.table.rowManager;e.preventDefault(),rowManager.displayRowsCount&&rowManager.scrollToRow(rowManager.getDisplayRows()[rowManager.displayRowsCount-1]),this.table.element.focus()},navPrev:function(e){this.dispatch("keybinding-nav-prev",e)},navNext:function(e){this.dispatch("keybinding-nav-next",e)},navLeft:function(e){this.dispatch("keybinding-nav-left",e)},navRight:function(e){this.dispatch("keybinding-nav-right",e)},navUp:function(e){this.dispatch("keybinding-nav-up",e)},navDown:function(e){this.dispatch("keybinding-nav-down",e)},undo:function(e){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(e.preventDefault(),this.table.modules.history.undo()))},redo:function(e){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(e.preventDefault(),this.table.modules.history.redo()))},copyToClipboard:function(e){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}};class Menu extends Module{constructor(table){super(table),this.menuContainer=null,this.nestedMenuBlock=!1,this.currentComponent=null,this.rootPopup=null,this.columnSubscribers={},this.registerTableOption("menuContainer",void 0),this.registerTableOption("rowContextMenu",!1),this.registerTableOption("rowClickMenu",!1),this.registerTableOption("rowDblClickMenu",!1),this.registerTableOption("groupContextMenu",!1),this.registerTableOption("groupClickMenu",!1),this.registerTableOption("groupDblClickMenu",!1),this.registerColumnOption("headerContextMenu"),this.registerColumnOption("headerClickMenu"),this.registerColumnOption("headerDblClickMenu"),this.registerColumnOption("headerMenu"),this.registerColumnOption("headerMenuIcon"),this.registerColumnOption("contextMenu"),this.registerColumnOption("clickMenu"),this.registerColumnOption("dblClickMenu")}initialize(){this.deprecatedOptionsCheck(),this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){this.deprecationCheck("menuContainer","popupContainer")||(this.table.options.popupContainer=this.table.options.menuContainer)}initializeRowWatchers(){this.table.options.rowContextMenu&&(this.subscribe("row-contextmenu",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu)),this.table.on("rowTapHold",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu))),this.table.options.rowClickMenu&&this.subscribe("row-click",this.loadMenuEvent.bind(this,this.table.options.rowClickMenu)),this.table.options.rowDblClickMenu&&this.subscribe("row-dblclick",this.loadMenuEvent.bind(this,this.table.options.rowDblClickMenu))}initializeGroupWatchers(){this.table.options.groupContextMenu&&(this.subscribe("group-contextmenu",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu)),this.table.on("groupTapHold",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu))),this.table.options.groupClickMenu&&this.subscribe("group-click",this.loadMenuEvent.bind(this,this.table.options.groupClickMenu)),this.table.options.groupDblClickMenu&&this.subscribe("group-dblclick",this.loadMenuEvent.bind(this,this.table.options.groupDblClickMenu))}initializeColumn(column){var def=column.definition;def.headerContextMenu&&!this.columnSubscribers.headerContextMenu&&(this.columnSubscribers.headerContextMenu=this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextMenu),this.table.on("headerTapHold",this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"))),def.headerClickMenu&&!this.columnSubscribers.headerClickMenu&&(this.columnSubscribers.headerClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerClickMenu"),this.subscribe("column-click",this.columnSubscribers.headerClickMenu)),def.headerDblClickMenu&&!this.columnSubscribers.headerDblClickMenu&&(this.columnSubscribers.headerDblClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerDblClickMenu"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickMenu)),def.headerMenu&&this.initializeColumnHeaderMenu(column),def.contextMenu&&!this.columnSubscribers.contextMenu&&(this.columnSubscribers.contextMenu=this.loadMenuTableCellEvent.bind(this,"contextMenu"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextMenu),this.table.on("cellTapHold",this.loadMenuTableCellEvent.bind(this,"contextMenu"))),def.clickMenu&&!this.columnSubscribers.clickMenu&&(this.columnSubscribers.clickMenu=this.loadMenuTableCellEvent.bind(this,"clickMenu"),this.subscribe("cell-click",this.columnSubscribers.clickMenu)),def.dblClickMenu&&!this.columnSubscribers.dblClickMenu&&(this.columnSubscribers.dblClickMenu=this.loadMenuTableCellEvent.bind(this,"dblClickMenu"),this.subscribe("cell-dblclick",this.columnSubscribers.dblClickMenu))}initializeColumnHeaderMenu(column){var headerMenuEl,icon=column.definition.headerMenuIcon;(headerMenuEl=document.createElement("span")).classList.add("tabulator-header-popup-button"),icon?("function"==typeof icon&&(icon=icon(column.getComponent())),icon instanceof HTMLElement?headerMenuEl.appendChild(icon):headerMenuEl.innerHTML=icon):headerMenuEl.innerHTML="&vellip;",headerMenuEl.addEventListener("click",(e=>{e.stopPropagation(),e.preventDefault(),this.loadMenuEvent(column.definition.headerMenu,e,column)})),column.titleElement.insertBefore(headerMenuEl,column.titleElement.firstChild)}loadMenuTableCellEvent(option,e,cell){cell._cell&&(cell=cell._cell),cell.column.definition[option]&&this.loadMenuEvent(cell.column.definition[option],e,cell)}loadMenuTableColumnEvent(option,e,column){column._column&&(column=column._column),column.definition[option]&&this.loadMenuEvent(column.definition[option],e,column)}loadMenuEvent(menu,e,component){component._group?component=component._group:component._row&&(component=component._row),menu="function"==typeof menu?menu.call(this.table,e,component.getComponent()):menu,this.loadMenu(e,component,menu)}loadMenu(e,component,menu,parentEl,parentPopup){var popup,touch=!(e instanceof MouseEvent),menuEl=document.createElement("div");if(menuEl.classList.add("tabulator-menu"),touch||e.preventDefault(),menu&&menu.length){if(parentEl)popup=parentPopup.child(menuEl);else{if(this.nestedMenuBlock){if(this.rootPopup)return}else this.nestedMenuBlock=setTimeout((()=>{this.nestedMenuBlock=!1}),100);this.rootPopup&&this.rootPopup.hide(),this.rootPopup=popup=this.popup(menuEl)}menu.forEach((item=>{var itemEl=document.createElement("div"),label=item.label,disabled=item.disabled;item.separator?itemEl.classList.add("tabulator-menu-separator"):(itemEl.classList.add("tabulator-menu-item"),"function"==typeof label&&(label=label.call(this.table,component.getComponent())),label instanceof Node?itemEl.appendChild(label):itemEl.innerHTML=label,"function"==typeof disabled&&(disabled=disabled.call(this.table,component.getComponent())),disabled?(itemEl.classList.add("tabulator-menu-item-disabled"),itemEl.addEventListener("click",(e=>{e.stopPropagation()}))):item.menu&&item.menu.length?itemEl.addEventListener("click",(e=>{e.stopPropagation(),this.loadMenu(e,component,item.menu,itemEl,popup)})):item.action&&itemEl.addEventListener("click",(e=>{item.action(e,component.getComponent())})),item.menu&&item.menu.length&&itemEl.classList.add("tabulator-menu-item-submenu")),menuEl.appendChild(itemEl)})),menuEl.addEventListener("click",(e=>{this.rootPopup&&this.rootPopup.hide()})),popup.show(parentEl||e),popup===this.rootPopup&&(this.rootPopup.hideOnBlur((()=>{this.rootPopup=null,this.currentComponent&&(this.dispatchExternal("menuClosed",this.currentComponent.getComponent()),this.currentComponent=null)})),this.currentComponent=component,this.dispatchExternal("menuOpened",component.getComponent()))}}}_exports.MenuModule=Menu,Menu.moduleName="menu";class MoveColumns extends Module{constructor(table){super(table),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=250,this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.startX=0,this.autoScrollMargin=40,this.autoScrollStep=5,this.autoScrollTimeout=!1,this.touchMove=!1,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.registerTableOption("movableColumns",!1)}createPlaceholderElement(){var el=document.createElement("div");return el.classList.add("tabulator-col"),el.classList.add("tabulator-col-placeholder"),el}initialize(){this.table.options.movableColumns&&this.subscribe("column-init",this.initializeColumn.bind(this))}initializeColumn(column){var colEl,self=this,config={};column.modules.frozen||column.isGroup||(colEl=column.getElement(),config.mousemove=function(e){column.parent===self.moving.parent&&((self.touchMove?e.touches[0].pageX:e.pageX)-Helpers.elOffset(colEl).left+self.table.columnManager.contentsElement.scrollLeft>column.getWidth()/2?self.toCol===column&&self.toColAfter||(colEl.parentNode.insertBefore(self.placeholderElement,colEl.nextSibling),self.moveColumn(column,!0)):(self.toCol!==column||self.toColAfter)&&(colEl.parentNode.insertBefore(self.placeholderElement,colEl),self.moveColumn(column,!1)))}.bind(self),colEl.addEventListener("mousedown",(function(e){self.touchMove=!1,1===e.which&&(self.checkTimeout=setTimeout((function(){self.startMove(e,column)}),self.checkPeriod))})),colEl.addEventListener("mouseup",(function(e){1===e.which&&self.checkTimeout&&clearTimeout(self.checkTimeout)})),self.bindTouchEvents(column)),column.modules.moveColumn=config}bindTouchEvents(column){var nextCol,prevCol,nextColWidth,prevColWidth,nextColWidthLast,prevColWidthLast,colEl=column.getElement(),startXMove=!1;colEl.addEventListener("touchstart",(e=>{this.checkTimeout=setTimeout((()=>{this.touchMove=!0,nextCol=column.nextColumn(),nextColWidth=nextCol?nextCol.getWidth()/2:0,prevCol=column.prevColumn(),prevColWidth=prevCol?prevCol.getWidth()/2:0,nextColWidthLast=0,prevColWidthLast=0,startXMove=!1,this.startMove(e,column)}),this.checkPeriod)}),{passive:!0}),colEl.addEventListener("touchmove",(e=>{var diff,moveToCol;this.moving&&(this.moveHover(e),startXMove||(startXMove=e.touches[0].pageX),(diff=e.touches[0].pageX-startXMove)>0?nextCol&&diff-nextColWidthLast>nextColWidth&&(moveToCol=nextCol)!==column&&(startXMove=e.touches[0].pageX,moveToCol.getElement().parentNode.insertBefore(this.placeholderElement,moveToCol.getElement().nextSibling),this.moveColumn(moveToCol,!0)):prevCol&&-diff-prevColWidthLast>prevColWidth&&(moveToCol=prevCol)!==column&&(startXMove=e.touches[0].pageX,moveToCol.getElement().parentNode.insertBefore(this.placeholderElement,moveToCol.getElement()),this.moveColumn(moveToCol,!1)),moveToCol&&(nextCol=moveToCol.nextColumn(),nextColWidthLast=nextColWidth,nextColWidth=nextCol?nextCol.getWidth()/2:0,prevCol=moveToCol.prevColumn(),prevColWidthLast=prevColWidth,prevColWidth=prevCol?prevCol.getWidth()/2:0))}),{passive:!0}),colEl.addEventListener("touchend",(e=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&this.endMove(e)}))}startMove(e,column){var element=column.getElement(),headerElement=this.table.columnManager.getContentsElement(),headersElement=this.table.columnManager.getHeadersElement();this.moving=column,this.startX=(this.touchMove?e.touches[0].pageX:e.pageX)-Helpers.elOffset(element).left,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=column.getWidth()+"px",this.placeholderElement.style.height=column.getHeight()+"px",element.parentNode.insertBefore(this.placeholderElement,element),element.parentNode.removeChild(element),this.hoverElement=element.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),headerElement.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.bottom=headerElement.clientHeight-headersElement.offsetHeight+"px",this.touchMove||(this._bindMouseMove(),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove)),this.moveHover(e)}_bindMouseMove(){this.table.columnManager.columnsByIndex.forEach((function(column){column.modules.moveColumn.mousemove&&column.getElement().addEventListener("mousemove",column.modules.moveColumn.mousemove)}))}_unbindMouseMove(){this.table.columnManager.columnsByIndex.forEach((function(column){column.modules.moveColumn.mousemove&&column.getElement().removeEventListener("mousemove",column.modules.moveColumn.mousemove)}))}moveColumn(column,after){var movingCells=this.moving.getCells();this.toCol=column,this.toColAfter=after,after?column.getCells().forEach((function(cell,i){var cellEl=cell.getElement(!0);cellEl.parentNode&&movingCells[i]&&cellEl.parentNode.insertBefore(movingCells[i].getElement(),cellEl.nextSibling)})):column.getCells().forEach((function(cell,i){var cellEl=cell.getElement(!0);cellEl.parentNode&&movingCells[i]&&cellEl.parentNode.insertBefore(movingCells[i].getElement(),cellEl)}))}endMove(e){(1===e.which||this.touchMove)&&(this._unbindMouseMove(),this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toCol&&this.table.columnManager.moveColumnActual(this.moving,this.toCol,this.toColAfter),this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.touchMove||(document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove)))}moveHover(e){var scrollPos,columnHolder=this.table.columnManager.getContentsElement(),scrollLeft=columnHolder.scrollLeft,xPos=(this.touchMove?e.touches[0].pageX:e.pageX)-Helpers.elOffset(columnHolder).left+scrollLeft;this.hoverElement.style.left=xPos-this.startX+"px",xPos-scrollLeft<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout((()=>{scrollPos=Math.max(0,scrollLeft-5),this.table.rowManager.getElement().scrollLeft=scrollPos,this.autoScrollTimeout=!1}),1))),scrollLeft+columnHolder.clientWidth-xPos<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout((()=>{scrollPos=Math.min(columnHolder.clientWidth,scrollLeft+5),this.table.rowManager.getElement().scrollLeft=scrollPos,this.autoScrollTimeout=!1}),1)))}}_exports.MoveColumnsModule=MoveColumns,MoveColumns.moduleName="moveColumn";class MoveRows extends Module{constructor(table){super(table),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=150,this.moving=!1,this.toRow=!1,this.toRowAfter=!1,this.hasHandle=!1,this.startY=0,this.startX=0,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.tableRowDropEvent=!1,this.touchMove=!1,this.connection=!1,this.connectionSelectorsTables=!1,this.connectionSelectorsElements=!1,this.connectionElements=[],this.connections=[],this.connectedTable=!1,this.connectedRow=!1,this.registerTableOption("movableRows",!1),this.registerTableOption("movableRowsConnectedTables",!1),this.registerTableOption("movableRowsConnectedElements",!1),this.registerTableOption("movableRowsSender",!1),this.registerTableOption("movableRowsReceiver","insert"),this.registerColumnOption("rowHandle")}createPlaceholderElement(){var el=document.createElement("div");return el.classList.add("tabulator-row"),el.classList.add("tabulator-row-placeholder"),el}initialize(){this.table.options.movableRows&&(this.connectionSelectorsTables=this.table.options.movableRowsConnectedTables,this.connectionSelectorsElements=this.table.options.movableRowsConnectedElements,this.connection=this.connectionSelectorsTables||this.connectionSelectorsElements,this.subscribe("cell-init",this.initializeCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)))}initializeGroupHeader(group){var self=this,config={};config.mouseup=function(e){self.tableRowDrop(e,group)}.bind(self),config.mousemove=function(e){var rowEl;e.pageY-Helpers.elOffset(group.element).top+self.table.rowManager.element.scrollTop>group.getHeight()/2?self.toRow===group&&self.toRowAfter||((rowEl=group.getElement()).parentNode.insertBefore(self.placeholderElement,rowEl.nextSibling),self.moveRow(group,!0)):(self.toRow!==group||self.toRowAfter)&&(rowEl=group.getElement()).previousSibling&&(rowEl.parentNode.insertBefore(self.placeholderElement,rowEl),self.moveRow(group,!1))}.bind(self),group.modules.moveRow=config}initializeRow(row){var rowEl,self=this,config={};config.mouseup=function(e){self.tableRowDrop(e,row)}.bind(self),config.mousemove=function(e){var rowEl=row.getElement();e.pageY-Helpers.elOffset(rowEl).top+self.table.rowManager.element.scrollTop>row.getHeight()/2?self.toRow===row&&self.toRowAfter||(rowEl.parentNode.insertBefore(self.placeholderElement,rowEl.nextSibling),self.moveRow(row,!0)):(self.toRow!==row||self.toRowAfter)&&(rowEl.parentNode.insertBefore(self.placeholderElement,rowEl),self.moveRow(row,!1))}.bind(self),this.hasHandle||((rowEl=row.getElement()).addEventListener("mousedown",(function(e){1===e.which&&(self.checkTimeout=setTimeout((function(){self.startMove(e,row)}),self.checkPeriod))})),rowEl.addEventListener("mouseup",(function(e){1===e.which&&self.checkTimeout&&clearTimeout(self.checkTimeout)})),this.bindTouchEvents(row,row.getElement())),row.modules.moveRow=config}initializeColumn(column){column.definition.rowHandle&&!1!==this.table.options.movableRows&&(this.hasHandle=!0)}initializeCell(cell){if(cell.column.definition.rowHandle&&!1!==this.table.options.movableRows){var self=this,cellEl=cell.getElement(!0);cellEl.addEventListener("mousedown",(function(e){1===e.which&&(self.checkTimeout=setTimeout((function(){self.startMove(e,cell.row)}),self.checkPeriod))})),cellEl.addEventListener("mouseup",(function(e){1===e.which&&self.checkTimeout&&clearTimeout(self.checkTimeout)})),this.bindTouchEvents(cell.row,cellEl)}}bindTouchEvents(row,element){var nextRow,prevRow,nextRowHeight,prevRowHeight,nextRowHeightLast,prevRowHeightLast,startYMove=!1;element.addEventListener("touchstart",(e=>{this.checkTimeout=setTimeout((()=>{this.touchMove=!0,nextRow=row.nextRow(),nextRowHeight=nextRow?nextRow.getHeight()/2:0,prevRow=row.prevRow(),prevRowHeight=prevRow?prevRow.getHeight()/2:0,nextRowHeightLast=0,prevRowHeightLast=0,startYMove=!1,this.startMove(e,row)}),this.checkPeriod)}),{passive:!0}),this.moving,this.toRow,this.toRowAfter,element.addEventListener("touchmove",(e=>{var diff,moveToRow;this.moving&&(e.preventDefault(),this.moveHover(e),startYMove||(startYMove=e.touches[0].pageY),(diff=e.touches[0].pageY-startYMove)>0?nextRow&&diff-nextRowHeightLast>nextRowHeight&&(moveToRow=nextRow)!==row&&(startYMove=e.touches[0].pageY,moveToRow.getElement().parentNode.insertBefore(this.placeholderElement,moveToRow.getElement().nextSibling),this.moveRow(moveToRow,!0)):prevRow&&-diff-prevRowHeightLast>prevRowHeight&&(moveToRow=prevRow)!==row&&(startYMove=e.touches[0].pageY,moveToRow.getElement().parentNode.insertBefore(this.placeholderElement,moveToRow.getElement()),this.moveRow(moveToRow,!1)),moveToRow&&(nextRow=moveToRow.nextRow(),nextRowHeightLast=nextRowHeight,nextRowHeight=nextRow?nextRow.getHeight()/2:0,prevRow=moveToRow.prevRow(),prevRowHeightLast=prevRowHeight,prevRowHeight=prevRow?prevRow.getHeight()/2:0))})),element.addEventListener("touchend",(e=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&(this.endMove(e),this.touchMove=!1)}))}_bindMouseMove(){this.table.rowManager.getDisplayRows().forEach((row=>{("row"===row.type||"group"===row.type)&&row.modules.moveRow&&row.modules.moveRow.mousemove&&row.getElement().addEventListener("mousemove",row.modules.moveRow.mousemove)}))}_unbindMouseMove(){this.table.rowManager.getDisplayRows().forEach((row=>{("row"===row.type||"group"===row.type)&&row.modules.moveRow&&row.modules.moveRow.mousemove&&row.getElement().removeEventListener("mousemove",row.modules.moveRow.mousemove)}))}startMove(e,row){var element=row.getElement();this.setStartPosition(e,row),this.moving=row,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=row.getWidth()+"px",this.placeholderElement.style.height=row.getHeight()+"px",this.connection?(this.table.element.classList.add("tabulator-movingrow-sending"),this.connectToTables(row)):(element.parentNode.insertBefore(this.placeholderElement,element),element.parentNode.removeChild(element)),this.hoverElement=element.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.connection?(document.body.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this.hoverElement.style.width=this.table.element.clientWidth+"px",this.hoverElement.style.whiteSpace="nowrap",this.hoverElement.style.overflow="hidden",this.hoverElement.style.pointerEvents="none"):(this.table.rowManager.getTableElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this._bindMouseMove()),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove),this.dispatchExternal("rowMoving",row.getComponent()),this.moveHover(e)}setStartPosition(e,row){var element,position,pageX=this.touchMove?e.touches[0].pageX:e.pageX,pageY=this.touchMove?e.touches[0].pageY:e.pageY;element=row.getElement(),this.connection?(position=element.getBoundingClientRect(),this.startX=position.left-pageX+window.pageXOffset,this.startY=position.top-pageY+window.pageYOffset):this.startY=pageY-element.getBoundingClientRect().top}endMove(e){e&&1!==e.which&&!this.touchMove||(this._unbindMouseMove(),this.connection||(this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement)),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toRow?this.table.rowManager.moveRow(this.moving,this.toRow,this.toRowAfter):this.dispatchExternal("rowMoveCancelled",this.moving.getComponent()),this.moving=!1,this.toRow=!1,this.toRowAfter=!1,document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove),this.connection&&(this.table.element.classList.remove("tabulator-movingrow-sending"),this.disconnectFromTables()))}moveRow(row,after){this.toRow=row,this.toRowAfter=after}moveHover(e){this.connection?this.moveHoverConnections.call(this,e):this.moveHoverTable.call(this,e)}moveHoverTable(e){var rowHolder=this.table.rowManager.getElement(),scrollTop=rowHolder.scrollTop,yPos=(this.touchMove?e.touches[0].pageY:e.pageY)-rowHolder.getBoundingClientRect().top+scrollTop;this.hoverElement.style.top=Math.min(yPos-this.startY,this.table.rowManager.element.scrollHeight-this.hoverElement.offsetHeight)+"px"}moveHoverConnections(e){this.hoverElement.style.left=this.startX+(this.touchMove?e.touches[0].pageX:e.pageX)+"px",this.hoverElement.style.top=this.startY+(this.touchMove?e.touches[0].pageY:e.pageY)+"px"}elementRowDrop(e,element,row){this.dispatchExternal("movableRowsElementDrop",e,element,!!row&&row.getComponent())}connectToTables(row){var connectionTables;this.connectionSelectorsTables&&(connectionTables=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStart",connectionTables),this.commsSend(this.connectionSelectorsTables,"moveRow","connect",{row:row})),this.connectionSelectorsElements&&(this.connectionElements=[],Array.isArray(this.connectionSelectorsElements)||(this.connectionSelectorsElements=[this.connectionSelectorsElements]),this.connectionSelectorsElements.forEach((query=>{"string"==typeof query?this.connectionElements=this.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(query))):this.connectionElements.push(query)})),this.connectionElements.forEach((element=>{var dropEvent=e=>{this.elementRowDrop(e,element,this.moving)};element.addEventListener("mouseup",dropEvent),element.tabulatorElementDropEvent=dropEvent,element.classList.add("tabulator-movingrow-receiving")})))}disconnectFromTables(){var connectionTables;this.connectionSelectorsTables&&(connectionTables=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStop",connectionTables),this.commsSend(this.connectionSelectorsTables,"moveRow","disconnect")),this.connectionElements.forEach((element=>{element.classList.remove("tabulator-movingrow-receiving"),element.removeEventListener("mouseup",element.tabulatorElementDropEvent),delete element.tabulatorElementDropEvent}))}connect(table,row){return this.connectedTable?(console.warn("Move Row Error - Table cannot accept connection, already connected to table:",this.connectedTable),!1):(this.connectedTable=table,this.connectedRow=row,this.table.element.classList.add("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach((row=>{"row"===row.type&&row.modules.moveRow&&row.modules.moveRow.mouseup&&row.getElement().addEventListener("mouseup",row.modules.moveRow.mouseup)})),this.tableRowDropEvent=this.tableRowDrop.bind(this),this.table.element.addEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStart",row,table),!0)}disconnect(table){table===this.connectedTable?(this.connectedTable=!1,this.connectedRow=!1,this.table.element.classList.remove("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach((row=>{"row"===row.type&&row.modules.moveRow&&row.modules.moveRow.mouseup&&row.getElement().removeEventListener("mouseup",row.modules.moveRow.mouseup)})),this.table.element.removeEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStop",table)):console.warn("Move Row Error - trying to disconnect from non connected table")}dropComplete(table,row,success){var sender=!1;if(success){switch(typeof this.table.options.movableRowsSender){case"string":sender=this.senders[this.table.options.movableRowsSender];break;case"function":sender=this.table.options.movableRowsSender}sender?sender.call(this,this.moving?this.moving.getComponent():void 0,row?row.getComponent():void 0,table):this.table.options.movableRowsSender&&console.warn("Mover Row Error - no matching sender found:",this.table.options.movableRowsSender),this.dispatchExternal("movableRowsSent",this.moving.getComponent(),row?row.getComponent():void 0,table)}else this.dispatchExternal("movableRowsSentFailed",this.moving.getComponent(),row?row.getComponent():void 0,table);this.endMove()}tableRowDrop(e,row){var receiver=!1,success=!1;switch(e.stopImmediatePropagation(),typeof this.table.options.movableRowsReceiver){case"string":receiver=this.receivers[this.table.options.movableRowsReceiver];break;case"function":receiver=this.table.options.movableRowsReceiver}receiver?success=receiver.call(this,this.connectedRow.getComponent(),row?row.getComponent():void 0,this.connectedTable):console.warn("Mover Row Error - no matching receiver found:",this.table.options.movableRowsReceiver),success?this.dispatchExternal("movableRowsReceived",this.connectedRow.getComponent(),row?row.getComponent():void 0,this.connectedTable):this.dispatchExternal("movableRowsReceivedFailed",this.connectedRow.getComponent(),row?row.getComponent():void 0,this.connectedTable),this.commsSend(this.connectedTable,"moveRow","dropcomplete",{row:row,success:success})}commsReceived(table,action,data){switch(action){case"connect":return this.connect(table,data.row);case"disconnect":return this.disconnect(table);case"dropcomplete":return this.dropComplete(table,data.row,data.success)}}}_exports.MoveRowsModule=MoveRows,MoveRows.prototype.receivers={insert:function(fromRow,toRow,fromTable){return this.table.addRow(fromRow.getData(),void 0,toRow),!0},add:function(fromRow,toRow,fromTable){return this.table.addRow(fromRow.getData()),!0},update:function(fromRow,toRow,fromTable){return!!toRow&&(toRow.update(fromRow.getData()),!0)},replace:function(fromRow,toRow,fromTable){return!!toRow&&(this.table.addRow(fromRow.getData(),void 0,toRow),toRow.delete(),!0)}},MoveRows.prototype.senders={delete:function(fromRow,toRow,toTable){fromRow.delete()}},MoveRows.moduleName="moveRow";class Mutator extends Module{constructor(table){super(table),this.allowedTypes=["","data","edit","clipboard"],this.enabled=!0,this.registerColumnOption("mutator"),this.registerColumnOption("mutatorParams"),this.registerColumnOption("mutatorData"),this.registerColumnOption("mutatorDataParams"),this.registerColumnOption("mutatorEdit"),this.registerColumnOption("mutatorEditParams"),this.registerColumnOption("mutatorClipboard"),this.registerColumnOption("mutatorClipboardParams"),this.registerColumnOption("mutateLink")}initialize(){this.subscribe("cell-value-changing",this.transformCell.bind(this)),this.subscribe("cell-value-changed",this.mutateLink.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-init-before",this.rowDataChanged.bind(this)),this.subscribe("row-data-changing",this.rowDataChanged.bind(this))}rowDataChanged(row,tempData,updatedData){return this.transformRow(tempData,"data",updatedData)}initializeColumn(column){var match=!1,config={};this.allowedTypes.forEach((type=>{var mutator,key="mutator"+(type.charAt(0).toUpperCase()+type.slice(1));column.definition[key]&&(mutator=this.lookupMutator(column.definition[key]))&&(match=!0,config[key]={mutator:mutator,params:column.definition[key+"Params"]||{}})})),match&&(column.modules.mutate=config)}lookupMutator(value){var mutator=!1;switch(typeof value){case"string":Mutator.mutators[value]?mutator=Mutator.mutators[value]:console.warn("Mutator Error - No such mutator found, ignoring: ",value);break;case"function":mutator=value}return mutator}transformRow(data,type,updatedData){var value,key="mutator"+(type.charAt(0).toUpperCase()+type.slice(1));return this.enabled&&this.table.columnManager.traverse((column=>{var mutator,params,component;column.modules.mutate&&(mutator=column.modules.mutate[key]||column.modules.mutate.mutator||!1)&&(value=column.getFieldValue(void 0!==updatedData?updatedData:data),"data"!=type&&void 0===value||(component=column.getComponent(),params="function"==typeof mutator.params?mutator.params(value,data,type,component):mutator.params,column.setFieldValue(data,mutator.mutator(value,data,type,params,component))))})),data}transformCell(cell,value){if(cell.column.modules.mutate){var mutator=cell.column.modules.mutate.mutatorEdit||cell.column.modules.mutate.mutator||!1,tempData={};if(mutator)return tempData=Object.assign(tempData,cell.row.getData()),cell.column.setFieldValue(tempData,value),mutator.mutator(value,tempData,"edit",mutator.params,cell.getComponent())}return value}mutateLink(cell){var links=cell.column.definition.mutateLink;links&&(Array.isArray(links)||(links=[links]),links.forEach((link=>{var linkCell=cell.row.getCell(link);linkCell&&linkCell.setValue(linkCell.getValue(),!0,!0)})))}enable(){this.enabled=!0}disable(){this.enabled=!1}}_exports.MutatorModule=Mutator,Mutator.moduleName="mutator",Mutator.mutators={};var defaultPageCounters={rows:function(pageSize,currentRow,currentPage,totalRows,totalPages){var el=document.createElement("span"),showingEl=document.createElement("span"),valueEl=document.createElement("span"),ofEl=document.createElement("span"),totalEl=document.createElement("span"),rowsEl=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",(value=>{showingEl.innerHTML=value})),this.table.modules.localize.langBind("pagination|counter|of",(value=>{ofEl.innerHTML=value})),this.table.modules.localize.langBind("pagination|counter|rows",(value=>{rowsEl.innerHTML=value})),totalRows?(valueEl.innerHTML=" "+currentRow+"-"+Math.min(currentRow+pageSize-1,totalRows)+" ",totalEl.innerHTML=" "+totalRows+" ",el.appendChild(showingEl),el.appendChild(valueEl),el.appendChild(ofEl),el.appendChild(totalEl),el.appendChild(rowsEl)):(valueEl.innerHTML=" 0 ",el.appendChild(showingEl),el.appendChild(valueEl),el.appendChild(rowsEl)),el},pages:function(pageSize,currentRow,currentPage,totalRows,totalPages){var el=document.createElement("span"),showingEl=document.createElement("span"),valueEl=document.createElement("span"),ofEl=document.createElement("span"),totalEl=document.createElement("span"),rowsEl=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",(value=>{showingEl.innerHTML=value})),valueEl.innerHTML=" "+currentPage+" ",this.table.modules.localize.langBind("pagination|counter|of",(value=>{ofEl.innerHTML=value})),totalEl.innerHTML=" "+totalPages+" ",this.table.modules.localize.langBind("pagination|counter|pages",(value=>{rowsEl.innerHTML=value})),el.appendChild(showingEl),el.appendChild(valueEl),el.appendChild(ofEl),el.appendChild(totalEl),el.appendChild(rowsEl),el}};class Page extends Module{constructor(table){super(table),this.mode="local",this.progressiveLoad=!1,this.element=null,this.pageCounterElement=null,this.pageCounter=null,this.size=0,this.page=1,this.count=5,this.max=1,this.remoteRowCountEstimate=null,this.initialLoad=!0,this.dataChanging=!1,this.pageSizes=[],this.registerTableOption("pagination",!1),this.registerTableOption("paginationMode","local"),this.registerTableOption("paginationSize",!1),this.registerTableOption("paginationInitialPage",1),this.registerTableOption("paginationCounter",!1),this.registerTableOption("paginationCounterElement",!1),this.registerTableOption("paginationButtonCount",5),this.registerTableOption("paginationSizeSelector",!1),this.registerTableOption("paginationElement",!1),this.registerTableOption("paginationAddRow","page"),this.registerTableOption("progressiveLoad",!1),this.registerTableOption("progressiveLoadDelay",0),this.registerTableOption("progressiveLoadScrollMargin",0),this.registerTableFunction("setMaxPage",this.setMaxPage.bind(this)),this.registerTableFunction("setPage",this.setPage.bind(this)),this.registerTableFunction("setPageToRow",this.userSetPageToRow.bind(this)),this.registerTableFunction("setPageSize",this.userSetPageSize.bind(this)),this.registerTableFunction("getPageSize",this.getPageSize.bind(this)),this.registerTableFunction("previousPage",this.previousPage.bind(this)),this.registerTableFunction("nextPage",this.nextPage.bind(this)),this.registerTableFunction("getPage",this.getPage.bind(this)),this.registerTableFunction("getPageMax",this.getPageMax.bind(this)),this.registerComponentFunction("row","pageTo",this.setPageToRow.bind(this))}initialize(){this.table.options.pagination?(this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("footer-redraw",this.footerRedraw.bind(this)),"page"==this.table.options.paginationAddRow&&this.subscribe("row-adding-position",this.rowAddingPosition.bind(this)),"remote"===this.table.options.paginationMode&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this))),this.table.options.progressiveLoad&&console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time"),this.registerDisplayHandler(this.restOnRenderBefore.bind(this),40),this.registerDisplayHandler(this.getRows.bind(this),50),this.createElements(),this.initializePageCounter(),this.initializePaginator()):this.table.options.progressiveLoad&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.initializeProgressive(this.table.options.progressiveLoad),"scroll"===this.table.options.progressiveLoad&&this.subscribe("scroll-vertical",this.scrollVertical.bind(this)))}rowAddingPosition(row,top){var index,rowManager=this.table.rowManager,displayRows=rowManager.getDisplayRows();return top?displayRows.length?index=displayRows[0]:rowManager.activeRows.length&&(index=rowManager.activeRows[rowManager.activeRows.length-1],top=!1):displayRows.length&&(index=displayRows[displayRows.length-1],top=!(displayRows.length<this.size)),{index:index,top:top}}calculatePageSizes(){var testElRow,testElCell;this.table.options.paginationSize?this.size=this.table.options.paginationSize:((testElRow=document.createElement("div")).classList.add("tabulator-row"),testElRow.style.visibility="hidden",(testElCell=document.createElement("div")).classList.add("tabulator-cell"),testElCell.innerHTML="Page Row Test",testElRow.appendChild(testElCell),this.table.rowManager.getTableElement().appendChild(testElRow),this.size=Math.floor(this.table.rowManager.getElement().clientHeight/testElRow.offsetHeight),this.table.rowManager.getTableElement().removeChild(testElRow)),this.dispatchExternal("pageSizeChanged",this.size),this.generatePageSizeSelectList()}initialLoadComplete(){this.initialLoad=!1}remotePageParams(data,config,silent,params){return this.initialLoad||(this.progressiveLoad&&!silent||!this.progressiveLoad&&!this.dataChanging)&&this.reset(!0),params.page=this.page,this.size&&(params.size=this.size),params}userSetPageToRow(row){return this.table.options.pagination&&(row=this.rowManager.findRow(row))?this.setPageToRow(row):Promise.reject()}userSetPageSize(size){return!!this.table.options.pagination&&(this.setPageSize(size),this.setPage(1))}scrollVertical(top,dir){var element;dir||this.table.dataLoader.loading||(element=this.table.rowManager.getElement()).scrollHeight-element.clientHeight-top<(this.table.options.progressiveLoadScrollMargin||2*element.clientHeight)&&this.nextPage().catch((()=>{}))}restOnRenderBefore(rows,renderInPosition){return renderInPosition||"local"===this.mode&&this.reset(),rows}rowsUpdated(){this.refreshData(!0,"all")}createElements(){var button;this.element=document.createElement("span"),this.element.classList.add("tabulator-paginator"),this.pagesElement=document.createElement("span"),this.pagesElement.classList.add("tabulator-pages"),(button=document.createElement("button")).classList.add("tabulator-page"),button.setAttribute("type","button"),button.setAttribute("role","button"),button.setAttribute("aria-label",""),button.setAttribute("title",""),this.firstBut=button.cloneNode(!0),this.firstBut.setAttribute("data-page","first"),this.prevBut=button.cloneNode(!0),this.prevBut.setAttribute("data-page","prev"),this.nextBut=button.cloneNode(!0),this.nextBut.setAttribute("data-page","next"),this.lastBut=button.cloneNode(!0),this.lastBut.setAttribute("data-page","last"),this.table.options.paginationSizeSelector&&(this.pageSizeSelect=document.createElement("select"),this.pageSizeSelect.classList.add("tabulator-page-size"))}generatePageSizeSelectList(){var pageSizes=[];if(this.pageSizeSelect){if(Array.isArray(this.table.options.paginationSizeSelector))pageSizes=this.table.options.paginationSizeSelector,this.pageSizes=pageSizes,-1==this.pageSizes.indexOf(this.size)&&pageSizes.unshift(this.size);else if(-1==this.pageSizes.indexOf(this.size)){pageSizes=[];for(let i=1;i<5;i++)pageSizes.push(this.size*i);this.pageSizes=pageSizes}else pageSizes=this.pageSizes;for(;this.pageSizeSelect.firstChild;)this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);pageSizes.forEach((item=>{var itemEl=document.createElement("option");itemEl.value=item,!0===item?this.langBind("pagination|all",(function(value){itemEl.innerHTML=value})):itemEl.innerHTML=item,this.pageSizeSelect.appendChild(itemEl)})),this.pageSizeSelect.value=this.size}}initializePageCounter(){var counter=this.table.options.paginationCounter,pageCounter=null;counter&&((pageCounter="function"==typeof counter?counter:Page.pageCounters[counter])?(this.pageCounter=pageCounter,this.pageCounterElement=document.createElement("span"),this.pageCounterElement.classList.add("tabulator-page-counter")):console.warn("Pagination Error - No such page counter found: ",counter))}initializePaginator(hidden){var pageSelectLabel,paginationCounterHolder;hidden||(this.langBind("pagination|first",(value=>{this.firstBut.innerHTML=value})),this.langBind("pagination|first_title",(value=>{this.firstBut.setAttribute("aria-label",value),this.firstBut.setAttribute("title",value)})),this.langBind("pagination|prev",(value=>{this.prevBut.innerHTML=value})),this.langBind("pagination|prev_title",(value=>{this.prevBut.setAttribute("aria-label",value),this.prevBut.setAttribute("title",value)})),this.langBind("pagination|next",(value=>{this.nextBut.innerHTML=value})),this.langBind("pagination|next_title",(value=>{this.nextBut.setAttribute("aria-label",value),this.nextBut.setAttribute("title",value)})),this.langBind("pagination|last",(value=>{this.lastBut.innerHTML=value})),this.langBind("pagination|last_title",(value=>{this.lastBut.setAttribute("aria-label",value),this.lastBut.setAttribute("title",value)})),this.firstBut.addEventListener("click",(()=>{this.setPage(1)})),this.prevBut.addEventListener("click",(()=>{this.previousPage()})),this.nextBut.addEventListener("click",(()=>{this.nextPage()})),this.lastBut.addEventListener("click",(()=>{this.setPage(this.max)})),this.table.options.paginationElement&&(this.element=this.table.options.paginationElement),this.pageSizeSelect&&(pageSelectLabel=document.createElement("label"),this.langBind("pagination|page_size",(value=>{this.pageSizeSelect.setAttribute("aria-label",value),this.pageSizeSelect.setAttribute("title",value),pageSelectLabel.innerHTML=value})),this.element.appendChild(pageSelectLabel),this.element.appendChild(this.pageSizeSelect),this.pageSizeSelect.addEventListener("change",(e=>{this.setPageSize("true"==this.pageSizeSelect.value||this.pageSizeSelect.value),this.setPage(1)}))),this.element.appendChild(this.firstBut),this.element.appendChild(this.prevBut),this.element.appendChild(this.pagesElement),this.element.appendChild(this.nextBut),this.element.appendChild(this.lastBut),this.table.options.paginationElement||(this.table.options.paginationCounter&&(this.table.options.paginationCounterElement?this.table.options.paginationCounterElement instanceof HTMLElement?this.table.options.paginationCounterElement.appendChild(this.pageCounterElement):"string"==typeof this.table.options.paginationCounterElement&&((paginationCounterHolder=document.querySelector(this.table.options.paginationCounterElement))?paginationCounterHolder.appendChild(this.pageCounterElement):console.warn("Pagination Error - Unable to find element matching paginationCounterElement selector:",this.table.options.paginationCounterElement)):this.footerAppend(this.pageCounterElement)),this.footerAppend(this.element)),this.page=this.table.options.paginationInitialPage,this.count=this.table.options.paginationButtonCount),this.mode=this.table.options.paginationMode}initializeProgressive(mode){this.initializePaginator(!0),this.mode="progressive_"+mode,this.progressiveLoad=!0}trackChanges(){this.dispatch("page-changed")}setMaxRows(rowCount){this.max=rowCount?!0===this.size?1:Math.ceil(rowCount/this.size):1,this.page>this.max&&(this.page=this.max)}reset(force){this.initialLoad||("local"==this.mode||force)&&(this.page=1,this.trackChanges())}setMaxPage(max){max=parseInt(max),this.max=max||1,this.page>this.max&&(this.page=this.max,this.trigger())}setPage(page){switch(page){case"first":return this.setPage(1);case"prev":return this.previousPage();case"next":return this.nextPage();case"last":return this.setPage(this.max)}return(page=parseInt(page))>0&&page<=this.max||"local"!==this.mode?(this.page=page,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Requested page is out of range of 1 - "+this.max+":",page),Promise.reject())}setPageToRow(row){var index=this.displayRows(-1).indexOf(row);if(index>-1){var page=!0===this.size?1:Math.ceil((index+1)/this.size);return this.setPage(page)}return console.warn("Pagination Error - Requested row is not visible"),Promise.reject()}setPageSize(size){!0!==size&&(size=parseInt(size)),size>0&&(this.size=size,this.dispatchExternal("pageSizeChanged",size)),this.pageSizeSelect&&this.generatePageSizeSelectList(),this.trackChanges()}_setPageCounter(totalRows,size,currentRow){var content;if(this.pageCounter)switch("remote"===this.mode&&(size=this.size,currentRow=(this.page-1)*this.size+1,totalRows=this.remoteRowCountEstimate),typeof(content=this.pageCounter.call(this,size,currentRow,this.page,totalRows,this.max))){case"object":if(content instanceof Node){for(;this.pageCounterElement.firstChild;)this.pageCounterElement.removeChild(this.pageCounterElement.firstChild);this.pageCounterElement.appendChild(content)}else this.pageCounterElement.innerHTML="",null!=content&&console.warn("Page Counter Error - Page Counter has returned a type of object, the only valid page counter object return is an instance of Node, the page counter returned:",content);break;case"undefined":this.pageCounterElement.innerHTML="";break;default:this.pageCounterElement.innerHTML=content}}_setPageButtons(){let leftSize=Math.floor((this.count-1)/2),rightSize=Math.ceil((this.count-1)/2),min=this.max-this.page+leftSize+1<this.count?this.max-this.count+1:Math.max(this.page-leftSize,1),max=this.page<=rightSize?Math.min(this.count,this.max):Math.min(this.page+rightSize,this.max);for(;this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);1==this.page?(this.firstBut.disabled=!0,this.prevBut.disabled=!0):(this.firstBut.disabled=!1,this.prevBut.disabled=!1),this.page==this.max?(this.lastBut.disabled=!0,this.nextBut.disabled=!0):(this.lastBut.disabled=!1,this.nextBut.disabled=!1);for(let i=min;i<=max;i++)i>0&&i<=this.max&&this.pagesElement.appendChild(this._generatePageButton(i));this.footerRedraw()}_generatePageButton(page){var button=document.createElement("button");return button.classList.add("tabulator-page"),page==this.page&&button.classList.add("active"),button.setAttribute("type","button"),button.setAttribute("role","button"),this.langBind("pagination|page_title",(value=>{button.setAttribute("aria-label",value+" "+page),button.setAttribute("title",value+" "+page)})),button.setAttribute("data-page",page),button.textContent=page,button.addEventListener("click",(e=>{this.setPage(page)})),button}previousPage(){return this.page>1?(this.page--,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Previous page would be less than page 1:",0),Promise.reject())}nextPage(){return this.page<this.max?(this.page++,this.trackChanges(),this.trigger()):(this.progressiveLoad||console.warn("Pagination Error - Next page would be greater than maximum page of "+this.max+":",this.max+1),Promise.reject())}getPage(){return this.page}getPageMax(){return this.max}getPageSize(size){return this.size}getMode(){return this.mode}getRows(data){var output,start,end,actualStartRow,actualRowPageSize=0,actualRows=data.filter((row=>"row"===row.type));if("local"==this.mode){output=[],this.setMaxRows(data.length),!0===this.size?(start=0,end=data.length):end=(start=this.size*(this.page-1))+parseInt(this.size),this._setPageButtons();for(let i=start;i<end;i++){let row=data[i];row&&(output.push(row),"row"===row.type&&(actualStartRow||(actualStartRow=row),actualRowPageSize++))}return this._setPageCounter(actualRows.length,actualRowPageSize,actualStartRow?actualRows.indexOf(actualStartRow)+1:0),output}return this._setPageButtons(),this._setPageCounter(actualRows.length),data.slice(0)}trigger(){var left;switch(this.mode){case"local":return left=this.table.rowManager.scrollLeft,this.refreshData(),this.table.rowManager.scrollHorizontal(left),this.dispatchExternal("pageLoaded",this.getPage()),Promise.resolve();case"remote":return this.dataChanging=!0,this.reloadData(null).finally((()=>{this.dataChanging=!1}));case"progressive_load":case"progressive_scroll":return this.reloadData(null,!0);default:return console.warn("Pagination Error - no such pagination mode:",this.mode),Promise.reject()}}_parseRemoteData(data){var margin;if(void 0===data.last_page&&console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").last_page||"last_page")+"' property"),data.data){if(this.max=parseInt(data.last_page)||1,this.remoteRowCountEstimate=void 0!==data.last_row?data.last_row:data.last_page*this.size-(this.page==data.last_page?this.size-data.data.length:0),this.progressiveLoad){switch(this.mode){case"progressive_load":1==this.page?this.table.rowManager.setData(data.data,!1,1==this.page):this.table.rowManager.addRows(data.data),this.page<this.max&&setTimeout((()=>{this.nextPage()}),this.table.options.progressiveLoadDelay);break;case"progressive_scroll":data=1===this.page?data.data:this.table.rowManager.getData().concat(data.data),this.table.rowManager.setData(data,1!==this.page,1==this.page),margin=this.table.options.progressiveLoadScrollMargin||2*this.table.rowManager.element.clientHeight,this.table.rowManager.element.scrollHeight<=this.table.rowManager.element.clientHeight+margin&&this.page<this.max&&setTimeout((()=>{this.nextPage()}))}return!1}this.dispatchExternal("pageLoaded",this.getPage())}else console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").data||"data")+"' property");return data.data}footerRedraw(){var footer=this.table.footerManager.containerElement;Math.ceil(footer.clientWidth)-footer.scrollWidth<0?this.pagesElement.style.display="none":(this.pagesElement.style.display="",Math.ceil(footer.clientWidth)-footer.scrollWidth<0&&(this.pagesElement.style.display="none"))}}_exports.PageModule=Page,Page.moduleName="page",Page.pageCounters=defaultPageCounters;var defaultReaders={local:function(id,type){var data=localStorage.getItem(id+"-"+type);return!!data&&JSON.parse(data)},cookie:function(id,type){var end,data,cookie=document.cookie,key=id+"-"+type,cookiePos=cookie.indexOf(key+"=");return cookiePos>-1&&((end=(cookie=cookie.slice(cookiePos)).indexOf(";"))>-1&&(cookie=cookie.slice(0,end)),data=cookie.replace(key+"=","")),!!data&&JSON.parse(data)}},defaultWriters={local:function(id,type,data){localStorage.setItem(id+"-"+type,JSON.stringify(data))},cookie:function(id,type,data){var expireDate=new Date;expireDate.setDate(expireDate.getDate()+1e4),document.cookie=id+"-"+type+"="+JSON.stringify(data)+"; expires="+expireDate.toUTCString()}};class Persistence extends Module{constructor(table){super(table),this.mode="",this.id="",this.defWatcherBlock=!1,this.config={},this.readFunc=!1,this.writeFunc=!1,this.registerTableOption("persistence",!1),this.registerTableOption("persistenceID",""),this.registerTableOption("persistenceMode",!0),this.registerTableOption("persistenceReaderFunc",!1),this.registerTableOption("persistenceWriterFunc",!1)}localStorageTest(){var testKey="_tabulator_test";try{return window.localStorage.setItem(testKey,testKey),window.localStorage.removeItem(testKey),!0}catch(e){return!1}}initialize(){if(this.table.options.persistence){var retrievedData,mode=this.table.options.persistenceMode,id=this.table.options.persistenceID;this.mode=!0!==mode?mode:this.localStorageTest()?"local":"cookie",this.table.options.persistenceReaderFunc?"function"==typeof this.table.options.persistenceReaderFunc?this.readFunc=this.table.options.persistenceReaderFunc:Persistence.readers[this.table.options.persistenceReaderFunc]?this.readFunc=Persistence.readers[this.table.options.persistenceReaderFunc]:console.warn("Persistence Read Error - invalid reader set",this.table.options.persistenceReaderFunc):Persistence.readers[this.mode]?this.readFunc=Persistence.readers[this.mode]:console.warn("Persistence Read Error - invalid reader set",this.mode),this.table.options.persistenceWriterFunc?"function"==typeof this.table.options.persistenceWriterFunc?this.writeFunc=this.table.options.persistenceWriterFunc:Persistence.writers[this.table.options.persistenceWriterFunc]?this.writeFunc=Persistence.writers[this.table.options.persistenceWriterFunc]:console.warn("Persistence Write Error - invalid reader set",this.table.options.persistenceWriterFunc):Persistence.writers[this.mode]?this.writeFunc=Persistence.writers[this.mode]:console.warn("Persistence Write Error - invalid writer set",this.mode),this.id="tabulator-"+(id||this.table.element.getAttribute("id")||""),this.config={sort:!0===this.table.options.persistence||this.table.options.persistence.sort,filter:!0===this.table.options.persistence||this.table.options.persistence.filter,group:!0===this.table.options.persistence||this.table.options.persistence.group,page:!0===this.table.options.persistence||this.table.options.persistence.page,columns:!0===this.table.options.persistence?["title","width","visible"]:this.table.options.persistence.columns},this.config.page&&(retrievedData=this.retrieveData("page"))&&(void 0===retrievedData.paginationSize||!0!==this.config.page&&!this.config.page.size||(this.table.options.paginationSize=retrievedData.paginationSize),void 0===retrievedData.paginationInitialPage||!0!==this.config.page&&!this.config.page.page||(this.table.options.paginationInitialPage=retrievedData.paginationInitialPage)),this.config.group&&(retrievedData=this.retrieveData("group"))&&(void 0===retrievedData.groupBy||!0!==this.config.group&&!this.config.group.groupBy||(this.table.options.groupBy=retrievedData.groupBy),void 0===retrievedData.groupStartOpen||!0!==this.config.group&&!this.config.group.groupStartOpen||(this.table.options.groupStartOpen=retrievedData.groupStartOpen),void 0===retrievedData.groupHeader||!0!==this.config.group&&!this.config.group.groupHeader||(this.table.options.groupHeader=retrievedData.groupHeader)),this.config.columns&&(this.table.options.columns=this.load("columns",this.table.options.columns),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-show",this.save.bind(this,"columns")),this.subscribe("column-hide",this.save.bind(this,"columns")),this.subscribe("column-moved",this.save.bind(this,"columns"))),this.subscribe("table-built",this.tableBuilt.bind(this),0),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("filter-changed",this.eventSave.bind(this,"filter")),this.subscribe("sort-changed",this.eventSave.bind(this,"sort")),this.subscribe("group-changed",this.eventSave.bind(this,"group")),this.subscribe("page-changed",this.eventSave.bind(this,"page")),this.subscribe("column-resized",this.eventSave.bind(this,"columns")),this.subscribe("column-width",this.eventSave.bind(this,"columns")),this.subscribe("layout-refreshed",this.eventSave.bind(this,"columns"))}this.registerTableFunction("getColumnLayout",this.getColumnLayout.bind(this)),this.registerTableFunction("setColumnLayout",this.setColumnLayout.bind(this))}eventSave(type){this.config[type]&&this.save(type)}tableBuilt(){var sorters,filters;this.config.sort&&!1==!(sorters=this.load("sort"))&&(this.table.options.initialSort=sorters),this.config.filter&&!1==!(filters=this.load("filter"))&&(this.table.options.initialFilter=filters)}tableRedraw(force){force&&this.config.columns&&this.save("columns")}getColumnLayout(){return this.parseColumns(this.table.columnManager.getColumns())}setColumnLayout(layout){return this.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns,layout)),!0}initializeColumn(column){var def;this.config.columns&&(this.defWatcherBlock=!0,def=column.getDefinition(),(!0===this.config.columns?Object.keys(def):this.config.columns).forEach((key=>{var props=Object.getOwnPropertyDescriptor(def,key),value=def[key];props&&Object.defineProperty(def,key,{set:newValue=>{value=newValue,this.defWatcherBlock||this.save("columns"),props.set&&props.set(newValue)},get:()=>(props.get&&props.get(),value)})})),this.defWatcherBlock=!1)}load(type,current){var data=this.retrieveData(type);return current&&(data=data?this.mergeDefinition(current,data):current),data}retrieveData(type){return!!this.readFunc&&this.readFunc(this.id,type)}mergeDefinition(oldCols,newCols){var output=[];return(newCols=newCols||[]).forEach(((column,to)=>{var keys,from=this._findColumn(oldCols,column);from&&(!0===this.config.columns||null==this.config.columns?(keys=Object.keys(from)).push("width"):keys=this.config.columns,keys.forEach((key=>{"columns"!==key&&void 0!==column[key]&&(from[key]=column[key])})),from.columns&&(from.columns=this.mergeDefinition(from.columns,column.columns)),output.push(from))})),oldCols.forEach(((column,i)=>{this._findColumn(newCols,column)||(output.length>i?output.splice(i,0,column):output.push(column))})),output}_findColumn(columns,subject){var type=subject.columns?"group":subject.field?"field":"object";return columns.find((function(col){switch(type){case"group":return col.title===subject.title&&col.columns.length===subject.columns.length;case"field":return col.field===subject.field;case"object":return col===subject}}))}save(type){var data={};switch(type){case"columns":data=this.parseColumns(this.table.columnManager.getColumns());break;case"filter":data=this.table.modules.filter.getFilters();break;case"sort":data=this.validateSorters(this.table.modules.sort.getSort());break;case"group":data=this.getGroupConfig();break;case"page":data=this.getPageConfig()}this.writeFunc&&this.writeFunc(this.id,type,data)}validateSorters(data){return data.forEach((function(item){item.column=item.field,delete item.field})),data}getGroupConfig(){var data={};return this.config.group&&((!0===this.config.group||this.config.group.groupBy)&&(data.groupBy=this.table.options.groupBy),(!0===this.config.group||this.config.group.groupStartOpen)&&(data.groupStartOpen=this.table.options.groupStartOpen),(!0===this.config.group||this.config.group.groupHeader)&&(data.groupHeader=this.table.options.groupHeader)),data}getPageConfig(){var data={};return this.config.page&&((!0===this.config.page||this.config.page.size)&&(data.paginationSize=this.table.modules.page.getPageSize()),(!0===this.config.page||this.config.page.page)&&(data.paginationInitialPage=this.table.modules.page.getPage())),data}parseColumns(columns){var definitions=[],excludedKeys=["headerContextMenu","headerMenu","contextMenu","clickMenu"];return columns.forEach((column=>{var keys,defStore={},colDef=column.getDefinition();column.isGroup?(defStore.title=colDef.title,defStore.columns=this.parseColumns(column.getColumns())):(defStore.field=column.getField(),!0===this.config.columns||null==this.config.columns?((keys=Object.keys(colDef)).push("width"),keys.push("visible")):keys=this.config.columns,keys.forEach((key=>{switch(key){case"width":defStore.width=column.getWidth();break;case"visible":defStore.visible=column.visible;break;default:"function"!=typeof colDef[key]&&-1===excludedKeys.indexOf(key)&&(defStore[key]=colDef[key])}}))),definitions.push(defStore)})),definitions}}_exports.PersistenceModule=Persistence,Persistence.moduleName="persistence",Persistence.moduleInitOrder=-10,Persistence.readers=defaultReaders,Persistence.writers=defaultWriters;class Popup$1 extends Module{constructor(table){super(table),this.columnSubscribers={},this.registerTableOption("rowContextPopup",!1),this.registerTableOption("rowClickPopup",!1),this.registerTableOption("rowDblClickPopup",!1),this.registerTableOption("groupContextPopup",!1),this.registerTableOption("groupClickPopup",!1),this.registerTableOption("groupDblClickPopup",!1),this.registerColumnOption("headerContextPopup"),this.registerColumnOption("headerClickPopup"),this.registerColumnOption("headerDblClickPopup"),this.registerColumnOption("headerPopup"),this.registerColumnOption("headerPopupIcon"),this.registerColumnOption("contextPopup"),this.registerColumnOption("clickPopup"),this.registerColumnOption("dblClickPopup"),this.registerComponentFunction("cell","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("column","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("row","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("group","popup",this._componentPopupCall.bind(this))}initialize(){this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}_componentPopupCall(component,contents,position){this.loadPopupEvent(contents,null,component,position)}initializeRowWatchers(){this.table.options.rowContextPopup&&(this.subscribe("row-contextmenu",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup)),this.table.on("rowTapHold",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup))),this.table.options.rowClickPopup&&this.subscribe("row-click",this.loadPopupEvent.bind(this,this.table.options.rowClickPopup)),this.table.options.rowDblClickPopup&&this.subscribe("row-dblclick",this.loadPopupEvent.bind(this,this.table.options.rowDblClickPopup))}initializeGroupWatchers(){this.table.options.groupContextPopup&&(this.subscribe("group-contextmenu",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup)),this.table.on("groupTapHold",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup))),this.table.options.groupClickPopup&&this.subscribe("group-click",this.loadPopupEvent.bind(this,this.table.options.groupClickPopup)),this.table.options.groupDblClickPopup&&this.subscribe("group-dblclick",this.loadPopupEvent.bind(this,this.table.options.groupDblClickPopup))}initializeColumn(column){var def=column.definition;def.headerContextPopup&&!this.columnSubscribers.headerContextPopup&&(this.columnSubscribers.headerContextPopup=this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextPopup),this.table.on("headerTapHold",this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"))),def.headerClickPopup&&!this.columnSubscribers.headerClickPopup&&(this.columnSubscribers.headerClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerClickPopup"),this.subscribe("column-click",this.columnSubscribers.headerClickPopup)),def.headerDblClickPopup&&!this.columnSubscribers.headerDblClickPopup&&(this.columnSubscribers.headerDblClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerDblClickPopup"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickPopup)),def.headerPopup&&this.initializeColumnHeaderPopup(column),def.contextPopup&&!this.columnSubscribers.contextPopup&&(this.columnSubscribers.contextPopup=this.loadPopupTableCellEvent.bind(this,"contextPopup"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextPopup),this.table.on("cellTapHold",this.loadPopupTableCellEvent.bind(this,"contextPopup"))),def.clickPopup&&!this.columnSubscribers.clickPopup&&(this.columnSubscribers.clickPopup=this.loadPopupTableCellEvent.bind(this,"clickPopup"),this.subscribe("cell-click",this.columnSubscribers.clickPopup)),def.dblClickPopup&&!this.columnSubscribers.dblClickPopup&&(this.columnSubscribers.dblClickPopup=this.loadPopupTableCellEvent.bind(this,"dblClickPopup"),this.subscribe("cell-click",this.columnSubscribers.dblClickPopup))}initializeColumnHeaderPopup(column){var headerPopupEl,icon=column.definition.headerPopupIcon;(headerPopupEl=document.createElement("span")).classList.add("tabulator-header-popup-button"),icon?("function"==typeof icon&&(icon=icon(column.getComponent())),icon instanceof HTMLElement?headerPopupEl.appendChild(icon):headerPopupEl.innerHTML=icon):headerPopupEl.innerHTML="&vellip;",headerPopupEl.addEventListener("click",(e=>{e.stopPropagation(),e.preventDefault(),this.loadPopupEvent(column.definition.headerPopup,e,column)})),column.titleElement.insertBefore(headerPopupEl,column.titleElement.firstChild)}loadPopupTableCellEvent(option,e,cell){cell._cell&&(cell=cell._cell),cell.column.definition[option]&&this.loadPopupEvent(cell.column.definition[option],e,cell)}loadPopupTableColumnEvent(option,e,column){column._column&&(column=column._column),column.definition[option]&&this.loadPopupEvent(column.definition[option],e,column)}loadPopupEvent(contents,e,component,position){var renderedCallback;component._group?component=component._group:component._row&&(component=component._row),contents="function"==typeof contents?contents.call(this.table,e,component.getComponent(),(function(callback){renderedCallback=callback})):contents,this.loadPopup(e,component,contents,renderedCallback,position)}loadPopup(e,component,contents,renderedCallback,position){var contentsEl,popup,touch=!(e instanceof MouseEvent);contents instanceof HTMLElement?contentsEl=contents:(contentsEl=document.createElement("div")).innerHTML=contents,contentsEl.classList.add("tabulator-popup"),contentsEl.addEventListener("click",(e=>{e.stopPropagation()})),touch||e.preventDefault(),popup=this.popup(contentsEl),"function"==typeof renderedCallback&&popup.renderCallback(renderedCallback),e?popup.show(e):popup.show(component.getElement(),position||"center"),popup.hideOnBlur((()=>{this.dispatchExternal("popupClosed",component.getComponent())})),this.dispatchExternal("popupOpened",component.getComponent())}}_exports.PopupModule=Popup$1,Popup$1.moduleName="popup";class Print extends Module{constructor(table){super(table),this.element=!1,this.manualBlock=!1,this.registerTableOption("printAsHtml",!1),this.registerTableOption("printFormatter",!1),this.registerTableOption("printHeader",!1),this.registerTableOption("printFooter",!1),this.registerTableOption("printStyled",!0),this.registerTableOption("printRowRange","visible"),this.registerTableOption("printConfig",{}),this.registerColumnOption("print"),this.registerColumnOption("titlePrint")}initialize(){this.table.options.printAsHtml&&(window.addEventListener("beforeprint",this.replaceTable.bind(this)),window.addEventListener("afterprint",this.cleanup.bind(this))),this.registerTableFunction("print",this.printFullscreen.bind(this))}replaceTable(){this.manualBlock||(this.element=document.createElement("div"),this.element.classList.add("tabulator-print-table"),this.element.appendChild(this.table.modules.export.generateTable(this.table.options.printConfig,this.table.options.printStyled,this.table.options.printRowRange,"print")),this.table.element.style.display="none",this.table.element.parentNode.insertBefore(this.element,this.table.element))}cleanup(){document.body.classList.remove("tabulator-print-fullscreen-hide"),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.table.element.style.display="")}printFullscreen(visible,style,config){var headerContent,footerContent,scrollX=window.scrollX,scrollY=window.scrollY,headerEl=document.createElement("div"),footerEl=document.createElement("div"),tableEl=this.table.modules.export.generateTable(void 0!==config?config:this.table.options.printConfig,void 0!==style?style:this.table.options.printStyled,visible||this.table.options.printRowRange,"print");this.manualBlock=!0,this.element=document.createElement("div"),this.element.classList.add("tabulator-print-fullscreen"),this.table.options.printHeader&&(headerEl.classList.add("tabulator-print-header"),"string"==typeof(headerContent="function"==typeof this.table.options.printHeader?this.table.options.printHeader.call(this.table):this.table.options.printHeader)?headerEl.innerHTML=headerContent:headerEl.appendChild(headerContent),this.element.appendChild(headerEl)),this.element.appendChild(tableEl),this.table.options.printFooter&&(footerEl.classList.add("tabulator-print-footer"),"string"==typeof(footerContent="function"==typeof this.table.options.printFooter?this.table.options.printFooter.call(this.table):this.table.options.printFooter)?footerEl.innerHTML=footerContent:footerEl.appendChild(footerContent),this.element.appendChild(footerEl)),document.body.classList.add("tabulator-print-fullscreen-hide"),document.body.appendChild(this.element),this.table.options.printFormatter&&this.table.options.printFormatter(this.element,tableEl),window.print(),this.cleanup(),window.scrollTo(scrollX,scrollY),this.manualBlock=!1}}_exports.PrintModule=Print,Print.moduleName="print";class ReactiveData extends Module{constructor(table){super(table),this.data=!1,this.blocked=!1,this.origFuncs={},this.currentVersion=0,this.registerTableOption("reactiveData",!1)}initialize(){this.table.options.reactiveData&&(this.subscribe("cell-value-save-before",this.block.bind(this,"cellsave")),this.subscribe("cell-value-save-after",this.unblock.bind(this,"cellsave")),this.subscribe("row-data-save-before",this.block.bind(this,"rowsave")),this.subscribe("row-data-save-after",this.unblock.bind(this,"rowsave")),this.subscribe("row-data-init-after",this.watchRow.bind(this)),this.subscribe("data-processing",this.watchData.bind(this)),this.subscribe("table-destroy",this.unwatchData.bind(this)))}watchData(data){var version,self=this;this.currentVersion++,version=this.currentVersion,this.unwatchData(),this.data=data,this.origFuncs.push=data.push,Object.defineProperty(this.data,"push",{enumerable:!1,configurable:!0,value:function(){var result,args=Array.from(arguments);return self.blocked||version!==self.currentVersion||(self.block("data-push"),args.forEach((arg=>{self.table.rowManager.addRowActual(arg,!1)})),result=self.origFuncs.push.apply(data,arguments),self.unblock("data-push")),result}}),this.origFuncs.unshift=data.unshift,Object.defineProperty(this.data,"unshift",{enumerable:!1,configurable:!0,value:function(){var result,args=Array.from(arguments);return self.blocked||version!==self.currentVersion||(self.block("data-unshift"),args.forEach((arg=>{self.table.rowManager.addRowActual(arg,!0)})),result=self.origFuncs.unshift.apply(data,arguments),self.unblock("data-unshift")),result}}),this.origFuncs.shift=data.shift,Object.defineProperty(this.data,"shift",{enumerable:!1,configurable:!0,value:function(){var row,result;return self.blocked||version!==self.currentVersion||(self.block("data-shift"),self.data.length&&(row=self.table.rowManager.getRowFromDataObject(self.data[0]))&&row.deleteActual(),result=self.origFuncs.shift.call(data),self.unblock("data-shift")),result}}),this.origFuncs.pop=data.pop,Object.defineProperty(this.data,"pop",{enumerable:!1,configurable:!0,value:function(){var row,result;return self.blocked||version!==self.currentVersion||(self.block("data-pop"),self.data.length&&(row=self.table.rowManager.getRowFromDataObject(self.data[self.data.length-1]))&&row.deleteActual(),result=self.origFuncs.pop.call(data),self.unblock("data-pop")),result}}),this.origFuncs.splice=data.splice,Object.defineProperty(this.data,"splice",{enumerable:!1,configurable:!0,value:function(){var startRow,result,args=Array.from(arguments),start=args[0]<0?data.length+args[0]:args[0],end=args[1],newRows=!!args[2]&&args.slice(2);if(!self.blocked&&version===self.currentVersion){if(self.block("data-splice"),newRows&&((startRow=!!data[start]&&self.table.rowManager.getRowFromDataObject(data[start]))?newRows.forEach((rowData=>{self.table.rowManager.addRowActual(rowData,!0,startRow,!0)})):(newRows=newRows.slice().reverse()).forEach((rowData=>{self.table.rowManager.addRowActual(rowData,!0,!1,!0)}))),0!==end){var oldRows=data.slice(start,void 0===args[1]?args[1]:start+end);oldRows.forEach(((rowData,i)=>{var row=self.table.rowManager.getRowFromDataObject(rowData);row&&row.deleteActual(i!==oldRows.length-1)}))}(newRows||0!==end)&&self.table.rowManager.reRenderInPosition(),result=self.origFuncs.splice.apply(data,arguments),self.unblock("data-splice")}return result}})}unwatchData(){if(!1!==this.data)for(var key in this.origFuncs)Object.defineProperty(this.data,key,{enumerable:!0,configurable:!0,writable:!0,value:this.origFuncs.key})}watchRow(row){var data=row.getData();for(var key in data)this.watchKey(row,data,key);this.table.options.dataTree&&this.watchTreeChildren(row)}watchTreeChildren(row){var self=this,childField=row.getData()[this.table.options.dataTreeChildField],origFuncs={};childField&&(origFuncs.push=childField.push,Object.defineProperty(childField,"push",{enumerable:!1,configurable:!0,value:()=>{if(!self.blocked){self.block("tree-push");var result=origFuncs.push.apply(childField,arguments);this.rebuildTree(row),self.unblock("tree-push")}return result}}),origFuncs.unshift=childField.unshift,Object.defineProperty(childField,"unshift",{enumerable:!1,configurable:!0,value:()=>{if(!self.blocked){self.block("tree-unshift");var result=origFuncs.unshift.apply(childField,arguments);this.rebuildTree(row),self.unblock("tree-unshift")}return result}}),origFuncs.shift=childField.shift,Object.defineProperty(childField,"shift",{enumerable:!1,configurable:!0,value:()=>{if(!self.blocked){self.block("tree-shift");var result=origFuncs.shift.call(childField);this.rebuildTree(row),self.unblock("tree-shift")}return result}}),origFuncs.pop=childField.pop,Object.defineProperty(childField,"pop",{enumerable:!1,configurable:!0,value:()=>{if(!self.blocked){self.block("tree-pop");var result=origFuncs.pop.call(childField);this.rebuildTree(row),self.unblock("tree-pop")}return result}}),origFuncs.splice=childField.splice,Object.defineProperty(childField,"splice",{enumerable:!1,configurable:!0,value:()=>{if(!self.blocked){self.block("tree-splice");var result=origFuncs.splice.apply(childField,arguments);this.rebuildTree(row),self.unblock("tree-splice")}return result}}))}rebuildTree(row){this.table.modules.dataTree.initializeRow(row),this.table.modules.dataTree.layoutRow(row),this.table.rowManager.refreshActiveData("tree",!1,!0)}watchKey(row,data,key){var self=this,props=Object.getOwnPropertyDescriptor(data,key),value=data[key],version=this.currentVersion;Object.defineProperty(data,key,{set:newValue=>{if(value=newValue,!self.blocked&&version===self.currentVersion){self.block("key");var update={};update[key]=newValue,row.updateData(update),self.unblock("key")}props.set&&props.set(newValue)},get:()=>(props.get&&props.get(),value)})}unwatchRow(row){var data=row.getData();for(var key in data)Object.defineProperty(data,key,{value:data[key]})}block(key){this.blocked||(this.blocked=key)}unblock(key){this.blocked===key&&(this.blocked=!1)}}_exports.ReactiveDataModule=ReactiveData,ReactiveData.moduleName="reactiveData";class ResizeColumns extends Module{constructor(table){super(table),this.startColumn=!1,this.startX=!1,this.startWidth=!1,this.latestX=!1,this.handle=null,this.initialNextColumn=null,this.nextColumn=null,this.initialized=!1,this.registerColumnOption("resizable",!0),this.registerTableOption("resizableColumnFit",!1)}initialize(){this.subscribe("column-rendered",this.layoutColumnHeader.bind(this))}initializeEventWatchers(){this.initialized||(this.subscribe("cell-rendered",this.layoutCellHandles.bind(this)),this.subscribe("cell-delete",this.deInitializeComponent.bind(this)),this.subscribe("cell-height",this.resizeHandle.bind(this)),this.subscribe("column-moved",this.columnLayoutUpdated.bind(this)),this.subscribe("column-hide",this.deInitializeColumn.bind(this)),this.subscribe("column-show",this.columnLayoutUpdated.bind(this)),this.subscribe("column-width",this.columnWidthUpdated.bind(this)),this.subscribe("column-delete",this.deInitializeComponent.bind(this)),this.subscribe("column-height",this.resizeHandle.bind(this)),this.initialized=!0)}layoutCellHandles(cell){"row"===cell.row.type&&(this.deInitializeComponent(cell),this.initializeColumn("cell",cell,cell.column,cell.element))}layoutColumnHeader(column){column.definition.resizable&&(this.initializeEventWatchers(),this.deInitializeComponent(column),this.initializeColumn("header",column,column,column.element))}columnLayoutUpdated(column){var prev=column.prevColumn();this.reinitializeColumn(column),prev&&this.reinitializeColumn(prev)}columnWidthUpdated(column){column.modules.frozen&&(this.table.modules.frozenColumns.leftColumns.includes(column)?this.table.modules.frozenColumns.leftColumns.forEach((col=>{this.reinitializeColumn(col)})):this.table.modules.frozenColumns.rightColumns.includes(column)&&this.table.modules.frozenColumns.rightColumns.forEach((col=>{this.reinitializeColumn(col)})))}frozenColumnOffset(column){var offset=!1;return column.modules.frozen&&(offset=column.modules.frozen.marginValue,"left"===column.modules.frozen.position?offset+=column.getWidth()-3:offset&&(offset-=3)),!1!==offset&&offset+"px"}reinitializeColumn(column){var frozenOffset=this.frozenColumnOffset(column);column.cells.forEach((cell=>{cell.modules.resize&&cell.modules.resize.handleEl&&(frozenOffset&&(cell.modules.resize.handleEl.style[column.modules.frozen.position]=frozenOffset),cell.element.after(cell.modules.resize.handleEl))})),column.modules.resize&&column.modules.resize.handleEl&&(frozenOffset&&(column.modules.resize.handleEl.style[column.modules.frozen.position]=frozenOffset),column.element.after(column.modules.resize.handleEl))}initializeColumn(type,component,column,element){var self=this,mode=column.definition.resizable,config={},nearestColumn=column.getLastColumn();if("header"===type&&(config={variableHeight:"textarea"==column.definition.formatter||column.definition.variableHeight}),(!0===mode||mode==type)&&this._checkResizability(nearestColumn)){var handle=document.createElement("span");handle.className="tabulator-col-resize-handle",handle.addEventListener("click",(function(e){e.stopPropagation()}));var handleDown=function(e){self.startColumn=column,self.initialNextColumn=self.nextColumn=nearestColumn.nextColumn(),self._mouseDown(e,nearestColumn,handle)};handle.addEventListener("mousedown",handleDown),handle.addEventListener("touchstart",handleDown,{passive:!0}),handle.addEventListener("dblclick",(e=>{var oldWidth=nearestColumn.getWidth();e.stopPropagation(),nearestColumn.reinitializeWidth(!0),oldWidth!==nearestColumn.getWidth()&&(self.dispatch("column-resized",nearestColumn),self.table.externalEvents.dispatch("columnResized",nearestColumn.getComponent()))})),column.modules.frozen&&(handle.style.position="sticky",handle.style[column.modules.frozen.position]=this.frozenColumnOffset(column)),config.handleEl=handle,element.parentNode&&column.visible&&element.after(handle)}component.modules.resize=config}deInitializeColumn(column){this.deInitializeComponent(column),column.cells.forEach((cell=>{this.deInitializeComponent(cell)}))}deInitializeComponent(component){var handleEl;component.modules.resize&&(handleEl=component.modules.resize.handleEl)&&handleEl.parentElement&&handleEl.parentElement.removeChild(handleEl)}resizeHandle(component,height){component.modules.resize&&component.modules.resize.handleEl&&(component.modules.resize.handleEl.style.height=height)}_checkResizability(column){return column.definition.resizable}_mouseDown(e,column,handle){var self=this;function mouseMove(e){var blockedBefore,blockedAfter,x=void 0===e.screenX?e.touches[0].screenX:e.screenX,startDiff=x-self.startX,moveDiff=x-self.latestX;if(self.latestX=x,self.table.rtl&&(startDiff=-startDiff,moveDiff=-moveDiff),blockedBefore=column.width==column.minWidth||column.width==column.maxWidth,column.setWidth(self.startWidth+startDiff),blockedAfter=column.width==column.minWidth||column.width==column.maxWidth,moveDiff<0&&(self.nextColumn=self.initialNextColumn),self.table.options.resizableColumnFit&&self.nextColumn&&(!blockedBefore||!blockedAfter)){let colWidth=self.nextColumn.getWidth();moveDiff>0&&colWidth<=self.nextColumn.minWidth&&(self.nextColumn=self.nextColumn.nextColumn()),self.nextColumn&&self.nextColumn.setWidth(self.nextColumn.getWidth()-moveDiff)}self.table.columnManager.rerenderColumns(!0),!self.table.browserSlow&&column.modules.resize&&column.modules.resize.variableHeight&&column.checkCellHeights()}function mouseUp(e){self.startColumn.modules.edit&&(self.startColumn.modules.edit.blocked=!1),self.table.browserSlow&&column.modules.resize&&column.modules.resize.variableHeight&&column.checkCellHeights(),document.body.removeEventListener("mouseup",mouseUp),document.body.removeEventListener("mousemove",mouseMove),handle.removeEventListener("touchmove",mouseMove),handle.removeEventListener("touchend",mouseUp),self.table.element.classList.remove("tabulator-block-select"),self.startWidth!==column.getWidth()&&(self.table.columnManager.verticalAlignHeaders(),self.dispatch("column-resized",column),self.table.externalEvents.dispatch("columnResized",column.getComponent()))}self.table.element.classList.add("tabulator-block-select"),e.stopPropagation(),self.startColumn.modules.edit&&(self.startColumn.modules.edit.blocked=!0),self.startX=void 0===e.screenX?e.touches[0].screenX:e.screenX,self.latestX=self.startX,self.startWidth=column.getWidth(),document.body.addEventListener("mousemove",mouseMove),document.body.addEventListener("mouseup",mouseUp),handle.addEventListener("touchmove",mouseMove,{passive:!0}),handle.addEventListener("touchend",mouseUp)}}_exports.ResizeColumnsModule=ResizeColumns,ResizeColumns.moduleName="resizeColumns";class ResizeRows extends Module{constructor(table){super(table),this.startColumn=!1,this.startY=!1,this.startHeight=!1,this.handle=null,this.prevHandle=null,this.registerTableOption("resizableRows",!1)}initialize(){this.table.options.resizableRows&&this.subscribe("row-layout-after",this.initializeRow.bind(this))}initializeRow(row){var self=this,rowEl=row.getElement(),handle=document.createElement("div");handle.className="tabulator-row-resize-handle";var prevHandle=document.createElement("div");prevHandle.className="tabulator-row-resize-handle prev",handle.addEventListener("click",(function(e){e.stopPropagation()}));var handleDown=function(e){self.startRow=row,self._mouseDown(e,row,handle)};handle.addEventListener("mousedown",handleDown),handle.addEventListener("touchstart",handleDown,{passive:!0}),prevHandle.addEventListener("click",(function(e){e.stopPropagation()}));var prevHandleDown=function(e){var prevRow=self.table.rowManager.prevDisplayRow(row);prevRow&&(self.startRow=prevRow,self._mouseDown(e,prevRow,prevHandle))};prevHandle.addEventListener("mousedown",prevHandleDown),prevHandle.addEventListener("touchstart",prevHandleDown,{passive:!0}),rowEl.appendChild(handle),rowEl.appendChild(prevHandle)}_mouseDown(e,row,handle){var self=this;function mouseMove(e){row.setHeight(self.startHeight+((void 0===e.screenY?e.touches[0].screenY:e.screenY)-self.startY))}function mouseUp(e){document.body.removeEventListener("mouseup",mouseMove),document.body.removeEventListener("mousemove",mouseMove),handle.removeEventListener("touchmove",mouseMove),handle.removeEventListener("touchend",mouseUp),self.table.element.classList.remove("tabulator-block-select"),self.dispatchExternal("rowResized",row.getComponent())}self.table.element.classList.add("tabulator-block-select"),e.stopPropagation(),self.startY=void 0===e.screenY?e.touches[0].screenY:e.screenY,self.startHeight=row.getHeight(),document.body.addEventListener("mousemove",mouseMove),document.body.addEventListener("mouseup",mouseUp),handle.addEventListener("touchmove",mouseMove,{passive:!0}),handle.addEventListener("touchend",mouseUp)}}_exports.ResizeRowsModule=ResizeRows,ResizeRows.moduleName="resizeRows";class ResizeTable extends Module{constructor(table){super(table),this.binding=!1,this.visibilityObserver=!1,this.resizeObserver=!1,this.containerObserver=!1,this.tableHeight=0,this.tableWidth=0,this.containerHeight=0,this.containerWidth=0,this.autoResize=!1,this.visible=!1,this.initialized=!1,this.initialRedraw=!1,this.registerTableOption("autoResize",!0)}initialize(){if(this.table.options.autoResize){var tableStyle,table=this.table;this.tableHeight=table.element.clientHeight,this.tableWidth=table.element.clientWidth,table.element.parentNode&&(this.containerHeight=table.element.parentNode.clientHeight,this.containerWidth=table.element.parentNode.clientWidth),"undefined"!=typeof IntersectionObserver&&"undefined"!=typeof ResizeObserver&&"virtual"===table.rowManager.getRenderMode()?(this.initializeVisibilityObserver(),this.autoResize=!0,this.resizeObserver=new ResizeObserver((entry=>{if(!table.browserMobile||table.browserMobile&&!table.modules.edit.currentCell){var nodeHeight=Math.floor(entry[0].contentRect.height),nodeWidth=Math.floor(entry[0].contentRect.width);this.tableHeight==nodeHeight&&this.tableWidth==nodeWidth||(this.tableHeight=nodeHeight,this.tableWidth=nodeWidth,table.element.parentNode&&(this.containerHeight=table.element.parentNode.clientHeight,this.containerWidth=table.element.parentNode.clientWidth),this.redrawTable())}})),this.resizeObserver.observe(table.element),tableStyle=window.getComputedStyle(table.element),this.table.element.parentNode&&!this.table.rowManager.fixedHeight&&(tableStyle.getPropertyValue("max-height")||tableStyle.getPropertyValue("min-height"))&&(this.containerObserver=new ResizeObserver((entry=>{if(!table.browserMobile||table.browserMobile&&!table.modules.edit.currentCell){var nodeHeight=Math.floor(entry[0].contentRect.height),nodeWidth=Math.floor(entry[0].contentRect.width);this.containerHeight==nodeHeight&&this.containerWidth==nodeWidth||(this.containerHeight=nodeHeight,this.containerWidth=nodeWidth,this.tableHeight=table.element.clientHeight,this.tableWidth=table.element.clientWidth),this.redrawTable()}})),this.containerObserver.observe(this.table.element.parentNode)),this.subscribe("table-resize",this.tableResized.bind(this))):(this.binding=function(){(!table.browserMobile||table.browserMobile&&!table.modules.edit.currentCell)&&(table.columnManager.rerenderColumns(!0),table.redraw())},window.addEventListener("resize",this.binding)),this.subscribe("table-destroy",this.clearBindings.bind(this))}}initializeVisibilityObserver(){this.visibilityObserver=new IntersectionObserver((entries=>{this.visible=entries[0].isIntersecting,this.initialized?this.visible&&(this.redrawTable(this.initialRedraw),this.initialRedraw=!1):(this.initialized=!0,this.initialRedraw=!this.visible)})),this.visibilityObserver.observe(this.table.element)}redrawTable(force){this.initialized&&this.visible&&(this.table.columnManager.rerenderColumns(!0),this.table.redraw(force))}tableResized(){this.table.rowManager.redraw()}clearBindings(){this.binding&&window.removeEventListener("resize",this.binding),this.resizeObserver&&this.resizeObserver.unobserve(this.table.element),this.visibilityObserver&&this.visibilityObserver.unobserve(this.table.element),this.containerObserver&&this.containerObserver.unobserve(this.table.element.parentNode)}}_exports.ResizeTableModule=ResizeTable,ResizeTable.moduleName="resizeTable";class ResponsiveLayout extends Module{constructor(table){super(table),this.columns=[],this.hiddenColumns=[],this.mode="",this.index=0,this.collapseFormatter=[],this.collapseStartOpen=!0,this.collapseHandleColumn=!1,this.registerTableOption("responsiveLayout",!1),this.registerTableOption("responsiveLayoutCollapseStartOpen",!0),this.registerTableOption("responsiveLayoutCollapseUseFormatters",!0),this.registerTableOption("responsiveLayoutCollapseFormatter",!1),this.registerColumnOption("responsive")}initialize(){this.table.options.responsiveLayout&&(this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-show",this.updateColumnVisibility.bind(this)),this.subscribe("column-hide",this.updateColumnVisibility.bind(this)),this.subscribe("columns-loaded",this.initializeResponsivity.bind(this)),this.subscribe("column-moved",this.initializeResponsivity.bind(this)),this.subscribe("column-add",this.initializeResponsivity.bind(this)),this.subscribe("column-delete",this.initializeResponsivity.bind(this)),this.subscribe("table-redrawing",this.tableRedraw.bind(this)),"collapse"===this.table.options.responsiveLayout&&(this.subscribe("row-data-changed",this.generateCollapsedRowContent.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout",this.layoutRow.bind(this))))}tableRedraw(force){-1===["fitColumns","fitDataStretch"].indexOf(this.layoutMode())&&(force||this.update())}initializeResponsivity(){var columns=[];this.mode=this.table.options.responsiveLayout,this.collapseFormatter=this.table.options.responsiveLayoutCollapseFormatter||this.formatCollapsedData,this.collapseStartOpen=this.table.options.responsiveLayoutCollapseStartOpen,this.hiddenColumns=[],this.table.columnManager.columnsByIndex.forEach(((column,i)=>{column.modules.responsive&&column.modules.responsive.order&&column.modules.responsive.visible&&(column.modules.responsive.index=i,columns.push(column),column.visible||"collapse"!==this.mode||this.hiddenColumns.push(column))})),columns=(columns=columns.reverse()).sort(((a,b)=>b.modules.responsive.order-a.modules.responsive.order||b.modules.responsive.index-a.modules.responsive.index)),this.columns=columns,"collapse"===this.mode&&this.generateCollapsedContent();for(let col of this.table.columnManager.columnsByIndex)if("responsiveCollapse"==col.definition.formatter){this.collapseHandleColumn=col;break}this.collapseHandleColumn&&(this.hiddenColumns.length?this.collapseHandleColumn.show():this.collapseHandleColumn.hide())}initializeColumn(column){var def=column.getDefinition();column.modules.responsive={order:void 0===def.responsive?1:def.responsive,visible:!1!==def.visible}}initializeRow(row){var el;"calc"!==row.type&&((el=document.createElement("div")).classList.add("tabulator-responsive-collapse"),row.modules.responsiveLayout={element:el,open:this.collapseStartOpen},this.collapseStartOpen||(el.style.display="none"))}layoutRow(row){var rowEl=row.getElement();row.modules.responsiveLayout&&(rowEl.appendChild(row.modules.responsiveLayout.element),this.generateCollapsedRowContent(row))}updateColumnVisibility(column,responsiveToggle){!responsiveToggle&&column.modules.responsive&&(column.modules.responsive.visible=column.visible,this.initializeResponsivity())}hideColumn(column){var colCount=this.hiddenColumns.length;column.hide(!1,!0),"collapse"===this.mode&&(this.hiddenColumns.unshift(column),this.generateCollapsedContent(),this.collapseHandleColumn&&!colCount&&this.collapseHandleColumn.show())}showColumn(column){var index;column.show(!1,!0),column.setWidth(column.getWidth()),"collapse"===this.mode&&((index=this.hiddenColumns.indexOf(column))>-1&&this.hiddenColumns.splice(index,1),this.generateCollapsedContent(),this.collapseHandleColumn&&!this.hiddenColumns.length&&this.collapseHandleColumn.hide())}update(){for(var working=!0;working;){let width="fitColumns"==this.table.modules.layout.getMode()?this.table.columnManager.getFlexBaseWidth():this.table.columnManager.getWidth(),diff=(this.table.options.headerVisible?this.table.columnManager.element.clientWidth:this.table.element.clientWidth)-width;if(diff<0){let column=this.columns[this.index];column?(this.hideColumn(column),this.index++):working=!1}else{let column=this.columns[this.index-1];column&&diff>0&&diff>=column.getWidth()?(this.showColumn(column),this.index--):working=!1}this.table.rowManager.activeRowsCount||this.table.rowManager.renderEmptyScroll()}}generateCollapsedContent(){this.table.rowManager.getDisplayRows().forEach((row=>{this.generateCollapsedRowContent(row)}))}generateCollapsedRowContent(row){var el,contents;if(row.modules.responsiveLayout){for(el=row.modules.responsiveLayout.element;el.firstChild;)el.removeChild(el.firstChild);(contents=this.collapseFormatter(this.generateCollapsedRowData(row)))&&el.appendChild(contents)}}generateCollapsedRowData(row){var mockCellComponent,data=row.getData(),output=[];return this.hiddenColumns.forEach((column=>{var value=column.getFieldValue(data);if(column.definition.title&&column.field)if(column.modules.format&&this.table.options.responsiveLayoutCollapseUseFormatters){function onRendered(callback){callback()}mockCellComponent={value:!1,data:{},getValue:function(){return value},getData:function(){return data},getElement:function(){return document.createElement("div")},getRow:function(){return row.getComponent()},getColumn:function(){return column.getComponent()},getTable:()=>this.table},output.push({field:column.field,title:column.definition.title,value:column.modules.format.formatter.call(this.table.modules.format,mockCellComponent,column.modules.format.params,onRendered)})}else output.push({field:column.field,title:column.definition.title,value:value})})),output}formatCollapsedData(data){var list=document.createElement("table");return data.forEach((function(item){var node_content,row=document.createElement("tr"),titleData=document.createElement("td"),valueData=document.createElement("td"),titleHighlight=document.createElement("strong");titleData.appendChild(titleHighlight),this.langBind("columns|"+item.field,(function(text){titleHighlight.innerHTML=text||item.title})),item.value instanceof Node?((node_content=document.createElement("div")).appendChild(item.value),valueData.appendChild(node_content)):valueData.innerHTML=item.value,row.appendChild(titleData),row.appendChild(valueData),list.appendChild(row)}),this),Object.keys(data).length?list:""}}_exports.ResponsiveLayoutModule=ResponsiveLayout,ResponsiveLayout.moduleName="responsiveLayout";class SelectRow extends Module{constructor(table){super(table),this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],this.headerCheckboxElement=null,this.registerTableOption("selectable","highlight"),this.registerTableOption("selectableRangeMode","drag"),this.registerTableOption("selectableRollingSelection",!0),this.registerTableOption("selectablePersistence",!0),this.registerTableOption("selectableCheck",(function(data,row){return!0})),this.registerTableFunction("selectRow",this.selectRows.bind(this)),this.registerTableFunction("deselectRow",this.deselectRows.bind(this)),this.registerTableFunction("toggleSelectRow",this.toggleRow.bind(this)),this.registerTableFunction("getSelectedRows",this.getSelectedRows.bind(this)),this.registerTableFunction("getSelectedData",this.getSelectedData.bind(this)),this.registerComponentFunction("row","select",this.selectRows.bind(this)),this.registerComponentFunction("row","deselect",this.deselectRows.bind(this)),this.registerComponentFunction("row","toggleSelect",this.toggleRow.bind(this)),this.registerComponentFunction("row","isSelected",this.isRowSelected.bind(this))}initialize(){!1!==this.table.options.selectable&&(this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-deleting",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clearSelectionData.bind(this)),this.subscribe("rows-retrieve",this.rowRetrieve.bind(this)),this.table.options.selectable&&!this.table.options.selectablePersistence&&this.subscribe("data-refreshing",this.deselectRows.bind(this)))}rowRetrieve(type,prevValue){return"selected"===type?this.selectedRows:prevValue}rowDeleted(row){this._deselectRow(row,!0)}clearSelectionData(silent){this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],!0!==silent&&this._rowSelectionChanged()}initializeRow(row){var self=this,element=row.getElement(),endSelect=function(){setTimeout((function(){self.selecting=!1}),50),document.body.removeEventListener("mouseup",endSelect)};row.modules.select={selected:!1},self.table.options.selectableCheck.call(this.table,row.getComponent())?(element.classList.add("tabulator-selectable"),element.classList.remove("tabulator-unselectable"),self.table.options.selectable&&"highlight"!=self.table.options.selectable&&("click"===self.table.options.selectableRangeMode?element.addEventListener("click",this.handleComplexRowClick.bind(this,row)):(element.addEventListener("click",(function(e){self.table.modExists("edit")&&self.table.modules.edit.getCurrentCell()||self.table._clearSelection(),self.selecting||self.toggleRow(row)})),element.addEventListener("mousedown",(function(e){if(e.shiftKey)return self.table._clearSelection(),self.selecting=!0,self.selectPrev=[],document.body.addEventListener("mouseup",endSelect),document.body.addEventListener("keyup",endSelect),self.toggleRow(row),!1})),element.addEventListener("mouseenter",(function(e){self.selecting&&(self.table._clearSelection(),self.toggleRow(row),self.selectPrev[1]==row&&self.toggleRow(self.selectPrev[0]))})),element.addEventListener("mouseout",(function(e){self.selecting&&(self.table._clearSelection(),self.selectPrev.unshift(row))}))))):(element.classList.add("tabulator-unselectable"),element.classList.remove("tabulator-selectable"))}handleComplexRowClick(row,e){if(e.shiftKey){this.table._clearSelection(),this.lastClickedRow=this.lastClickedRow||row;var lastClickedRowIdx=this.table.rowManager.getDisplayRowIndex(this.lastClickedRow),rowIdx=this.table.rowManager.getDisplayRowIndex(row),fromRowIdx=lastClickedRowIdx<=rowIdx?lastClickedRowIdx:rowIdx,toRowIdx=lastClickedRowIdx>=rowIdx?lastClickedRowIdx:rowIdx,toggledRows=this.table.rowManager.getDisplayRows().slice(0).splice(fromRowIdx,toRowIdx-fromRowIdx+1);e.ctrlKey||e.metaKey?(toggledRows.forEach((toggledRow=>{toggledRow!==this.lastClickedRow&&(!0===this.table.options.selectable||this.isRowSelected(row)||this.selectedRows.length<this.table.options.selectable)&&this.toggleRow(toggledRow)})),this.lastClickedRow=row):(this.deselectRows(void 0,!0),!0!==this.table.options.selectable&&toggledRows.length>this.table.options.selectable&&(toggledRows=toggledRows.slice(0,this.table.options.selectable)),this.selectRows(toggledRows)),this.table._clearSelection()}else e.ctrlKey||e.metaKey?(this.toggleRow(row),this.lastClickedRow=row):(this.deselectRows(void 0,!0),this.selectRows(row),this.lastClickedRow=row)}toggleRow(row){this.table.options.selectableCheck.call(this.table,row.getComponent())&&(row.modules.select&&row.modules.select.selected?this._deselectRow(row):this._selectRow(row))}selectRows(rows){var rowMatch;switch(typeof rows){case"undefined":this.table.rowManager.rows.forEach((row=>{this._selectRow(row,!0,!0)})),this._rowSelectionChanged();break;case"string":(rowMatch=this.table.rowManager.findRow(rows))?(this._selectRow(rowMatch,!0,!0),this._rowSelectionChanged()):((rowMatch=this.table.rowManager.getRows(rows)).forEach((row=>{this._selectRow(row,!0,!0)})),rowMatch.length&&this._rowSelectionChanged());break;default:Array.isArray(rows)?(rows.forEach((row=>{this._selectRow(row,!0,!0)})),this._rowSelectionChanged()):this._selectRow(rows,!1,!0)}}_selectRow(rowInfo,silent,force){if(!isNaN(this.table.options.selectable)&&!0!==this.table.options.selectable&&!force&&this.selectedRows.length>=this.table.options.selectable){if(!this.table.options.selectableRollingSelection)return!1;this._deselectRow(this.selectedRows[0])}var row=this.table.rowManager.findRow(rowInfo);row?-1==this.selectedRows.indexOf(row)&&(row.getElement().classList.add("tabulator-selected"),row.modules.select||(row.modules.select={}),row.modules.select.selected=!0,row.modules.select.checkboxEl&&(row.modules.select.checkboxEl.checked=!0),this.selectedRows.push(row),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(row,!0),this.dispatchExternal("rowSelected",row.getComponent()),this._rowSelectionChanged(silent)):silent||console.warn("Selection Error - No such row found, ignoring selection:"+rowInfo)}isRowSelected(row){return-1!==this.selectedRows.indexOf(row)}deselectRows(rows,silent){var rowCount,self=this;if(void 0===rows){rowCount=self.selectedRows.length;for(let i=0;i<rowCount;i++)self._deselectRow(self.selectedRows[0],!0);rowCount&&self._rowSelectionChanged(silent)}else Array.isArray(rows)?(rows.forEach((function(row){self._deselectRow(row,!0)})),self._rowSelectionChanged(silent)):self._deselectRow(rows,silent)}_deselectRow(rowInfo,silent){var index,row=this.table.rowManager.findRow(rowInfo);row?(index=this.selectedRows.findIndex((function(selectedRow){return selectedRow==row})))>-1&&(row.getElement().classList.remove("tabulator-selected"),row.modules.select||(row.modules.select={}),row.modules.select.selected=!1,row.modules.select.checkboxEl&&(row.modules.select.checkboxEl.checked=!1),this.selectedRows.splice(index,1),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(row,!1),this.dispatchExternal("rowDeselected",row.getComponent()),this._rowSelectionChanged(silent)):silent||console.warn("Deselection Error - No such row found, ignoring selection:"+rowInfo)}getSelectedData(){var data=[];return this.selectedRows.forEach((function(row){data.push(row.getData())})),data}getSelectedRows(){var rows=[];return this.selectedRows.forEach((function(row){rows.push(row.getComponent())})),rows}_rowSelectionChanged(silent){this.headerCheckboxElement&&(0===this.selectedRows.length?(this.headerCheckboxElement.checked=!1,this.headerCheckboxElement.indeterminate=!1):this.table.rowManager.rows.length===this.selectedRows.length?(this.headerCheckboxElement.checked=!0,this.headerCheckboxElement.indeterminate=!1):(this.headerCheckboxElement.indeterminate=!0,this.headerCheckboxElement.checked=!1)),silent||this.dispatchExternal("rowSelectionChanged",this.getSelectedData(),this.getSelectedRows())}registerRowSelectCheckbox(row,element){row._row.modules.select||(row._row.modules.select={}),row._row.modules.select.checkboxEl=element}registerHeaderSelectCheckbox(element){this.headerCheckboxElement=element}childRowSelection(row,select){var children=this.table.modules.dataTree.getChildren(row,!0);if(select)for(let child of children)this._selectRow(child,!0);else for(let child of children)this._deselectRow(child,!0)}}function datetime$2(a,b,aRow,bRow,column,dir,params){var DT=window.DateTime||luxon.DateTime,format=params.format||"dd/MM/yyyy HH:mm:ss",alignEmptyValues=params.alignEmptyValues,emptyAlign=0;if(void 0!==DT){if(DT.isDateTime(a)||(a="iso"===format?DT.fromISO(String(a)):DT.fromFormat(String(a),format)),DT.isDateTime(b)||(b="iso"===format?DT.fromISO(String(b)):DT.fromFormat(String(b),format)),a.isValid){if(b.isValid)return a-b;emptyAlign=1}else emptyAlign=b.isValid?-1:0;return("top"===alignEmptyValues&&"desc"===dir||"bottom"===alignEmptyValues&&"asc"===dir)&&(emptyAlign*=-1),emptyAlign}console.error("Sort Error - 'datetime' sorter is dependant on luxon.js")}_exports.SelectRowModule=SelectRow,SelectRow.moduleName="selectRow";var defaultSorters={number:function(a,b,aRow,bRow,column,dir,params){var alignEmptyValues=params.alignEmptyValues,decimal=params.decimalSeparator,thousand=params.thousandSeparator,emptyAlign=0;if(a=String(a),b=String(b),thousand&&(a=a.split(thousand).join(""),b=b.split(thousand).join("")),decimal&&(a=a.split(decimal).join("."),b=b.split(decimal).join(".")),a=parseFloat(a),b=parseFloat(b),isNaN(a))emptyAlign=isNaN(b)?0:-1;else{if(!isNaN(b))return a-b;emptyAlign=1}return("top"===alignEmptyValues&&"desc"===dir||"bottom"===alignEmptyValues&&"asc"===dir)&&(emptyAlign*=-1),emptyAlign},string:function(a,b,aRow,bRow,column,dir,params){var locale,alignEmptyValues=params.alignEmptyValues,emptyAlign=0;if(a){if(b){switch(typeof params.locale){case"boolean":params.locale&&(locale=this.langLocale());break;case"string":locale=params.locale}return String(a).toLowerCase().localeCompare(String(b).toLowerCase(),locale)}emptyAlign=1}else emptyAlign=b?-1:0;return("top"===alignEmptyValues&&"desc"===dir||"bottom"===alignEmptyValues&&"asc"===dir)&&(emptyAlign*=-1),emptyAlign},date:function(a,b,aRow,bRow,column,dir,params){return params.format||(params.format="dd/MM/yyyy"),datetime$2.call(this,a,b,aRow,bRow,column,dir,params)},time:function(a,b,aRow,bRow,column,dir,params){return params.format||(params.format="HH:mm"),datetime$2.call(this,a,b,aRow,bRow,column,dir,params)},datetime:datetime$2,boolean:function(a,b,aRow,bRow,column,dir,params){return(!0===a||"true"===a||"True"===a||1===a?1:0)-(!0===b||"true"===b||"True"===b||1===b?1:0)},array:function(a,b,aRow,bRow,column,dir,params){var type=params.type||"length",alignEmptyValues=params.alignEmptyValues,emptyAlign=0;function calc(value){var result;switch(type){case"length":result=value.length;break;case"sum":result=value.reduce((function(c,d){return c+d}));break;case"max":result=Math.max.apply(null,value);break;case"min":result=Math.min.apply(null,value);break;case"avg":result=value.reduce((function(c,d){return c+d}))/value.length}return result}if(Array.isArray(a)){if(Array.isArray(b))return calc(b)-calc(a);emptyAlign=1}else emptyAlign=Array.isArray(b)?-1:0;return("top"===alignEmptyValues&&"desc"===dir||"bottom"===alignEmptyValues&&"asc"===dir)&&(emptyAlign*=-1),emptyAlign},exists:function(a,b,aRow,bRow,column,dir,params){return(void 0===a?0:1)-(void 0===b?0:1)},alphanum:function(as,bs,aRow,bRow,column,dir,params){var a,b,a1,b1,L,i=0,rx=/(\d+)|(\D+)/g,rd=/\d/,alignEmptyValues=params.alignEmptyValues,emptyAlign=0;if(as||0===as){if(bs||0===bs){if(isFinite(as)&&isFinite(bs))return as-bs;if((a=String(as).toLowerCase())===(b=String(bs).toLowerCase()))return 0;if(!rd.test(a)||!rd.test(b))return a>b?1:-1;for(a=a.match(rx),b=b.match(rx),L=a.length>b.length?b.length:a.length;i<L;)if((a1=a[i])!==(b1=b[i++]))return isFinite(a1)&&isFinite(b1)?("0"===a1.charAt(0)&&(a1="."+a1),"0"===b1.charAt(0)&&(b1="."+b1),a1-b1):a1>b1?1:-1;return a.length>b.length}emptyAlign=1}else emptyAlign=bs||0===bs?-1:0;return("top"===alignEmptyValues&&"desc"===dir||"bottom"===alignEmptyValues&&"asc"===dir)&&(emptyAlign*=-1),emptyAlign}};class Sort extends Module{constructor(table){super(table),this.sortList=[],this.changed=!1,this.registerTableOption("sortMode","local"),this.registerTableOption("initialSort",!1),this.registerTableOption("columnHeaderSortMulti",!0),this.registerTableOption("sortOrderReverse",!1),this.registerTableOption("headerSortElement","<div class='tabulator-arrow'></div>"),this.registerTableOption("headerSortClickElement","header"),this.registerColumnOption("sorter"),this.registerColumnOption("sorterParams"),this.registerColumnOption("headerSort",!0),this.registerColumnOption("headerSortStartingDir"),this.registerColumnOption("headerSortTristate")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.registerDataHandler(this.sort.bind(this),20),this.registerTableFunction("setSort",this.userSetSort.bind(this)),this.registerTableFunction("getSorters",this.getSort.bind(this)),this.registerTableFunction("clearSort",this.clearSort.bind(this)),"remote"===this.table.options.sortMode&&this.subscribe("data-params",this.remoteSortParams.bind(this))}tableBuilt(){this.table.options.initialSort&&this.setSort(this.table.options.initialSort)}remoteSortParams(data,config,silent,params){var sorters=this.getSort();return sorters.forEach((item=>{delete item.column})),params.sort=sorters,params}userSetSort(sortList,dir){this.setSort(sortList,dir),this.refreshSort()}clearSort(){this.clear(),this.refreshSort()}initializeColumn(column){var colEl,arrowEl,sorter=!1;switch(typeof column.definition.sorter){case"string":Sort.sorters[column.definition.sorter]?sorter=Sort.sorters[column.definition.sorter]:console.warn("Sort Error - No such sorter found: ",column.definition.sorter);break;case"function":sorter=column.definition.sorter}if(column.modules.sort={sorter:sorter,dir:"none",params:column.definition.sorterParams||{},startingDir:column.definition.headerSortStartingDir||"asc",tristate:column.definition.headerSortTristate},!1!==column.definition.headerSort){if((colEl=column.getElement()).classList.add("tabulator-sortable"),(arrowEl=document.createElement("div")).classList.add("tabulator-col-sorter"),"icon"===this.table.options.headerSortClickElement)arrowEl.classList.add("tabulator-col-sorter-element");else colEl.classList.add("tabulator-col-sorter-element");switch(this.table.options.headerSortElement){case"function":break;case"object":arrowEl.appendChild(this.table.options.headerSortElement);break;default:arrowEl.innerHTML=this.table.options.headerSortElement}column.titleHolderElement.appendChild(arrowEl),column.modules.sort.element=arrowEl,this.setColumnHeaderSortIcon(column,"none"),("icon"===this.table.options.headerSortClickElement?arrowEl:colEl).addEventListener("click",(e=>{var dir="",sorters=[],match=!1;if(column.modules.sort){if(column.modules.sort.tristate)dir="none"==column.modules.sort.dir?column.modules.sort.startingDir:column.modules.sort.dir==column.modules.sort.startingDir?"asc"==column.modules.sort.dir?"desc":"asc":"none";else switch(column.modules.sort.dir){case"asc":dir="desc";break;case"desc":dir="asc";break;default:dir=column.modules.sort.startingDir}this.table.options.columnHeaderSortMulti&&(e.shiftKey||e.ctrlKey)?(match=(sorters=this.getSort()).findIndex((sorter=>sorter.field===column.getField())),match>-1?(sorters[match].dir=dir,match=sorters.splice(match,1)[0],"none"!=dir&&sorters.push(match)):"none"!=dir&&sorters.push({column:column,dir:dir}),this.setSort(sorters)):"none"==dir?this.clear():this.setSort(column,dir),this.refreshSort()}}))}}refreshSort(){"remote"===this.table.options.sortMode?this.reloadData(null,!1,!1):this.refreshData(!0)}hasChanged(){var changed=this.changed;return this.changed=!1,changed}getSort(){var sorters=[];return this.sortList.forEach((function(item){item.column&&sorters.push({column:item.column.getComponent(),field:item.column.getField(),dir:item.dir})})),sorters}setSort(sortList,dir){var self=this,newSortList=[];Array.isArray(sortList)||(sortList=[{column:sortList,dir:dir}]),sortList.forEach((function(item){var column;(column=self.table.columnManager.findColumn(item.column))?(item.column=column,newSortList.push(item),self.changed=!0):console.warn("Sort Warning - Sort field does not exist and is being ignored: ",item.column)})),self.sortList=newSortList,this.dispatch("sort-changed")}clear(){this.setSort([])}findSorter(column){var value,row=this.table.rowManager.activeRows[0],sorter="string";if(row&&(row=row.getData(),column.getField()))switch(typeof(value=column.getFieldValue(row))){case"undefined":sorter="string";break;case"boolean":sorter="boolean";break;default:isNaN(value)||""===value?value.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)&&(sorter="alphanum"):sorter="number"}return Sort.sorters[sorter]}sort(data){var self=this,sortList=this.table.options.sortOrderReverse?self.sortList.slice().reverse():self.sortList,sortListActual=[],rowComponents=[];return this.subscribedExternal("dataSorting")&&this.dispatchExternal("dataSorting",self.getSort()),self.clearColumnHeaders(),"remote"!==this.table.options.sortMode?(sortList.forEach((function(item,i){var sortObj;item.column&&((sortObj=item.column.modules.sort)&&(sortObj.sorter||(sortObj.sorter=self.findSorter(item.column)),item.params="function"==typeof sortObj.params?sortObj.params(item.column.getComponent(),item.dir):sortObj.params,sortListActual.push(item)),self.setColumnHeader(item.column,item.dir))})),sortListActual.length&&self._sortItems(data,sortListActual)):sortList.forEach((function(item,i){self.setColumnHeader(item.column,item.dir)})),this.subscribedExternal("dataSorted")&&(data.forEach((row=>{rowComponents.push(row.getComponent())})),this.dispatchExternal("dataSorted",self.getSort(),rowComponents)),data}clearColumnHeaders(){this.table.columnManager.getRealColumns().forEach((column=>{column.modules.sort&&(column.modules.sort.dir="none",column.getElement().setAttribute("aria-sort","none"),this.setColumnHeaderSortIcon(column,"none"))}))}setColumnHeader(column,dir){column.modules.sort.dir=dir,column.getElement().setAttribute("aria-sort","asc"===dir?"ascending":"descending"),this.setColumnHeaderSortIcon(column,dir)}setColumnHeaderSortIcon(column,dir){var arrowEl,sortEl=column.modules.sort.element;if(column.definition.headerSort&&"function"==typeof this.table.options.headerSortElement){for(;sortEl.firstChild;)sortEl.removeChild(sortEl.firstChild);"object"==typeof(arrowEl=this.table.options.headerSortElement.call(this.table,column.getComponent(),dir))?sortEl.appendChild(arrowEl):sortEl.innerHTML=arrowEl}}_sortItems(data,sortList){var sorterCount=sortList.length-1;data.sort(((a,b)=>{for(var result,i=sorterCount;i>=0;i--){let sortItem=sortList[i];if(0!==(result=this._sortRow(a,b,sortItem.column,sortItem.dir,sortItem.params)))break}return result}))}_sortRow(a,b,column,dir,params){var el1Comp,el2Comp,el1="asc"==dir?a:b,el2="asc"==dir?b:a;return a=void 0!==(a=column.getFieldValue(el1.getData()))?a:"",b=void 0!==(b=column.getFieldValue(el2.getData()))?b:"",el1Comp=el1.getComponent(),el2Comp=el2.getComponent(),column.modules.sort.sorter.call(this,a,b,el1Comp,el2Comp,column.getComponent(),dir,params)}}_exports.SortModule=Sort,Sort.moduleName="sort",Sort.sorters=defaultSorters;class Tooltip extends Module{constructor(table){super(table),this.tooltipSubscriber=null,this.headerSubscriber=null,this.timeout=null,this.popupInstance=null,this.registerTableOption("tooltipGenerationMode",void 0),this.registerTableOption("tooltipDelay",300),this.registerColumnOption("tooltip"),this.registerColumnOption("headerTooltip")}initialize(){this.deprecatedOptionsCheck(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){this.deprecationCheckMsg("tooltipGenerationMode","This option is no longer needed as tooltips are always generated on hover now")}initializeColumn(column){column.definition.headerTooltip&&!this.headerSubscriber&&(this.headerSubscriber=!0,this.subscribe("column-mousemove",this.mousemoveCheck.bind(this,"headerTooltip")),this.subscribe("column-mouseout",this.mouseoutCheck.bind(this,"headerTooltip"))),column.definition.tooltip&&!this.tooltipSubscriber&&(this.tooltipSubscriber=!0,this.subscribe("cell-mousemove",this.mousemoveCheck.bind(this,"tooltip")),this.subscribe("cell-mouseout",this.mouseoutCheck.bind(this,"tooltip")))}mousemoveCheck(action,e,component){var tooltip="tooltip"===action?component.column.definition.tooltip:component.definition.headerTooltip;tooltip&&(this.clearPopup(),this.timeout=setTimeout(this.loadTooltip.bind(this,e,component,tooltip),this.table.options.tooltipDelay))}mouseoutCheck(action,e,component){this.popupInstance||this.clearPopup()}clearPopup(action,e,component){clearTimeout(this.timeout),this.timeout=null,this.popupInstance&&this.popupInstance.hide()}loadTooltip(e,component,tooltip){var contentsEl,renderedCallback,coords;"function"==typeof tooltip&&(tooltip=tooltip(e,component.getComponent(),(function(callback){renderedCallback=callback}))),tooltip instanceof HTMLElement?contentsEl=tooltip:(contentsEl=document.createElement("div"),!0===tooltip&&(component instanceof Cell?tooltip=component.value:component.definition.field?this.langBind("columns|"+component.definition.field,(value=>{contentsEl.innerHTML=tooltip=value||component.definition.title})):tooltip=component.definition.title),contentsEl.innerHTML=tooltip),(tooltip||0===tooltip||!1===tooltip)&&(contentsEl.classList.add("tabulator-tooltip"),contentsEl.addEventListener("mousemove",(e=>e.preventDefault())),this.popupInstance=this.popup(contentsEl),"function"==typeof renderedCallback&&this.popupInstance.renderCallback(renderedCallback),coords=this.popupInstance.containerEventCoords(e),this.popupInstance.show(coords.x+15,coords.y+15).hideOnBlur((()=>{this.dispatchExternal("TooltipClosed",component.getComponent()),this.popupInstance=null})),this.dispatchExternal("TooltipOpened",component.getComponent()))}}_exports.TooltipModule=Tooltip,Tooltip.moduleName="tooltip";var defaultValidators={integer:function(cell,value,parameters){return""===value||null==value||(value=Number(value),!isNaN(value)&&isFinite(value)&&Math.floor(value)===value)},float:function(cell,value,parameters){return""===value||null==value||(value=Number(value),!isNaN(value)&&isFinite(value)&&value%1!=0)},numeric:function(cell,value,parameters){return""===value||null==value||!isNaN(value)},string:function(cell,value,parameters){return""===value||null==value||isNaN(value)},max:function(cell,value,parameters){return""===value||null==value||parseFloat(value)<=parameters},min:function(cell,value,parameters){return""===value||null==value||parseFloat(value)>=parameters},starts:function(cell,value,parameters){return""===value||null==value||String(value).toLowerCase().startsWith(String(parameters).toLowerCase())},ends:function(cell,value,parameters){return""===value||null==value||String(value).toLowerCase().endsWith(String(parameters).toLowerCase())},minLength:function(cell,value,parameters){return""===value||null==value||String(value).length>=parameters},maxLength:function(cell,value,parameters){return""===value||null==value||String(value).length<=parameters},in:function(cell,value,parameters){return""===value||null==value||("string"==typeof parameters&&(parameters=parameters.split("|")),parameters.indexOf(value)>-1)},regex:function(cell,value,parameters){return""===value||null==value||new RegExp(parameters).test(value)},unique:function(cell,value,parameters){if(""===value||null==value)return!0;var unique=!0,cellData=cell.getData(),column=cell.getColumn()._getSelf();return this.table.rowManager.rows.forEach((function(row){var data=row.getData();data!==cellData&&value==column.getFieldValue(data)&&(unique=!1)})),unique},required:function(cell,value,parameters){return""!==value&&null!=value}};class Validate extends Module{constructor(table){super(table),this.invalidCells=[],this.registerTableOption("validationMode","blocking"),this.registerColumnOption("validator"),this.registerTableFunction("getInvalidCells",this.getInvalidCells.bind(this)),this.registerTableFunction("clearCellValidation",this.userClearCellValidation.bind(this)),this.registerTableFunction("validate",this.userValidate.bind(this)),this.registerComponentFunction("cell","isValid",this.cellIsValid.bind(this)),this.registerComponentFunction("cell","clearValidation",this.clearValidation.bind(this)),this.registerComponentFunction("cell","validate",this.cellValidate.bind(this)),this.registerComponentFunction("column","validate",this.columnValidate.bind(this)),this.registerComponentFunction("row","validate",this.rowValidate.bind(this))}initialize(){this.subscribe("cell-delete",this.clearValidation.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("edit-success",this.editValidate.bind(this)),this.subscribe("edit-editor-clear",this.editorClear.bind(this)),this.subscribe("edit-edited-clear",this.editedClear.bind(this))}editValidate(cell,value,previousValue){var valid="manual"===this.table.options.validationMode||this.validate(cell.column.modules.validate,cell,value);return!0!==valid&&setTimeout((()=>{cell.getElement().classList.add("tabulator-validation-fail"),this.dispatchExternal("validationFailed",cell.getComponent(),value,valid)})),valid}editorClear(cell,cancelled){cancelled&&cell.column.modules.validate&&this.cellValidate(cell),cell.getElement().classList.remove("tabulator-validation-fail")}editedClear(cell){cell.modules.validate&&(cell.modules.validate.invalid=!1)}cellIsValid(cell){return cell.modules.validate&&cell.modules.validate.invalid||!0}cellValidate(cell){return this.validate(cell.column.modules.validate,cell,cell.getValue())}columnValidate(column){var invalid=[];return column.cells.forEach((cell=>{!0!==this.cellValidate(cell)&&invalid.push(cell.getComponent())})),!invalid.length||invalid}rowValidate(row){var invalid=[];return row.cells.forEach((cell=>{!0!==this.cellValidate(cell)&&invalid.push(cell.getComponent())})),!invalid.length||invalid}userClearCellValidation(cells){cells||(cells=this.getInvalidCells()),Array.isArray(cells)||(cells=[cells]),cells.forEach((cell=>{this.clearValidation(cell._getSelf())}))}userValidate(cells){var output=[];return this.table.rowManager.rows.forEach((row=>{var valid=(row=row.getComponent()).validate();!0!==valid&&(output=output.concat(valid))})),!output.length||output}initializeColumnCheck(column){void 0!==column.definition.validator&&this.initializeColumn(column)}initializeColumn(column){var validator,self=this,config=[];column.definition.validator&&(Array.isArray(column.definition.validator)?column.definition.validator.forEach((item=>{(validator=self._extractValidator(item))&&config.push(validator)})):(validator=this._extractValidator(column.definition.validator))&&config.push(validator),column.modules.validate=!!config.length&&config)}_extractValidator(value){var type,params,pos;switch(typeof value){case"string":return(pos=value.indexOf(":"))>-1?(type=value.substring(0,pos),params=value.substring(pos+1)):type=value,this._buildValidator(type,params);case"function":return this._buildValidator(value);case"object":return this._buildValidator(value.type,value.parameters)}}_buildValidator(type,params){var func="function"==typeof type?type:Validate.validators[type];return func?{type:"function"==typeof type?"function":type,func:func,params:params}:(console.warn("Validator Setup Error - No matching validator found:",type),!1)}validate(validators,cell,value){var self=this,failedValidators=[],invalidIndex=this.invalidCells.indexOf(cell);return validators&&validators.forEach((item=>{item.func.call(self,cell.getComponent(),value,item.params)||failedValidators.push({type:item.type,parameters:item.params})})),cell.modules.validate||(cell.modules.validate={}),failedValidators.length?(cell.modules.validate.invalid=failedValidators,"manual"!==this.table.options.validationMode&&cell.getElement().classList.add("tabulator-validation-fail"),-1==invalidIndex&&this.invalidCells.push(cell)):(cell.modules.validate.invalid=!1,cell.getElement().classList.remove("tabulator-validation-fail"),invalidIndex>-1&&this.invalidCells.splice(invalidIndex,1)),!failedValidators.length||failedValidators}getInvalidCells(){var output=[];return this.invalidCells.forEach((cell=>{output.push(cell.getComponent())})),output}clearValidation(cell){var invalidIndex;cell.modules.validate&&cell.modules.validate.invalid&&(cell.getElement().classList.remove("tabulator-validation-fail"),cell.modules.validate.invalid=!1,(invalidIndex=this.invalidCells.indexOf(cell))>-1&&this.invalidCells.splice(invalidIndex,1))}}_exports.ValidateModule=Validate,Validate.moduleName="validate",Validate.validators=defaultValidators;var modules=Object.freeze({__proto__:null,AccessorModule:Accessor,AjaxModule:Ajax,ClipboardModule:Clipboard,ColumnCalcsModule:ColumnCalcs,DataTreeModule:DataTree,DownloadModule:Download,EditModule:Edit$1,ExportModule:Export,FilterModule:Filter,FormatModule:Format,FrozenColumnsModule:FrozenColumns,FrozenRowsModule:FrozenRows,GroupRowsModule:GroupRows,HistoryModule:History,HtmlTableImportModule:HtmlTableImport,ImportModule:Import,InteractionModule:Interaction,KeybindingsModule:Keybindings,MenuModule:Menu,MoveColumnsModule:MoveColumns,MoveRowsModule:MoveRows,MutatorModule:Mutator,PageModule:Page,PersistenceModule:Persistence,PopupModule:Popup$1,PrintModule:Print,ReactiveDataModule:ReactiveData,ResizeColumnsModule:ResizeColumns,ResizeRowsModule:ResizeRows,ResizeTableModule:ResizeTable,ResponsiveLayoutModule:ResponsiveLayout,SelectRowModule:SelectRow,SortModule:Sort,TooltipModule:Tooltip,ValidateModule:Validate});class OptionsList{constructor(table,msgType){let defaults=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.table=table,this.msgType=msgType,this.registeredDefaults=Object.assign({},defaults)}register(option,value){this.registeredDefaults[option]=value}generate(defaultOptions){let userOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var output=Object.assign({},this.registeredDefaults);if(Object.assign(output,defaultOptions),!1!==userOptions.debugInvalidOptions||this.table.options.debugInvalidOptions)for(let key in userOptions)output.hasOwnProperty(key)||console.warn("Invalid "+this.msgType+" option:",key);for(let key in output)key in userOptions?output[key]=userOptions[key]:Array.isArray(output[key])?output[key]=Object.assign([],output[key]):"object"==typeof output[key]&&null!==output[key]?output[key]=Object.assign({},output[key]):void 0===output[key]&&delete output[key];return output}}class Renderer extends CoreFeature{constructor(table){super(table),this.elementVertical=table.rowManager.element,this.elementHorizontal=table.columnManager.element,this.tableElement=table.rowManager.tableElement,this.verticalFillMode="fit"}initialize(){}clearRows(){}clearColumns(){}reinitializeColumnWidths(columns){}renderRows(){}renderColumns(){}rerenderRows(callback){callback&&callback()}rerenderColumns(update,blockRedraw){}renderRowCells(row){}rerenderRowCells(row,force){}scrollColumns(left,dir){}scrollRows(top,dir){}resize(){}scrollToRow(row){}scrollToRowNearestTop(row){}visibleRows(includingBuffer){return[]}rows(){return this.table.rowManager.getDisplayRows()}styleRow(row,index){var rowEl=row.getElement();index%2?(rowEl.classList.add("tabulator-row-even"),rowEl.classList.remove("tabulator-row-odd")):(rowEl.classList.add("tabulator-row-odd"),rowEl.classList.remove("tabulator-row-even"))}clear(){this.clearRows(),this.clearColumns()}render(){this.renderRows(),this.renderColumns()}rerender(callback){this.rerenderRows(),this.rerenderColumns()}scrollToRowPosition(row,position,ifVisible){var rowIndex=this.rows().indexOf(row),rowEl=row.getElement(),offset=0;return new Promise(((resolve,reject)=>{if(rowIndex>-1){if(void 0===ifVisible&&(ifVisible=this.table.options.scrollToRowIfVisible),!ifVisible&&Helpers.elVisible(rowEl)&&(offset=Helpers.elOffset(rowEl).top-Helpers.elOffset(this.elementVertical).top)>0&&offset<this.elementVertical.clientHeight-rowEl.offsetHeight)return resolve(),!1;switch(void 0===position&&(position=this.table.options.scrollToRowPosition),"nearest"===position&&(position=this.scrollToRowNearestTop(row)?"top":"bottom"),this.scrollToRow(row),position){case"middle":case"center":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop+(rowEl.offsetTop-this.elementVertical.scrollTop)-(this.elementVertical.scrollHeight-rowEl.offsetTop)/2:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight/2;break;case"bottom":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop-(this.elementVertical.scrollHeight-rowEl.offsetTop)+rowEl.offsetHeight:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight+rowEl.offsetHeight;break;case"top":this.elementVertical.scrollTop=rowEl.offsetTop}resolve()}else console.warn("Scroll Error - Row not visible"),reject("Scroll Error - Row not visible")}))}}_exports.Renderer=Renderer;class BasicHorizontal extends Renderer{constructor(table){super(table)}renderRowCells(row){row.cells.forEach((cell=>{row.element.appendChild(cell.getElement()),cell.cellRendered()}))}reinitializeColumnWidths(columns){columns.forEach((function(column){column.reinitializeWidth()}))}}class VirtualDomHorizontal extends Renderer{constructor(table){super(table),this.leftCol=0,this.rightCol=0,this.scrollLeft=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0,this.fitDataColAvg=0,this.windowBuffer=200,this.visibleRows=null,this.initialized=!1,this.isFitData=!1,this.columns=[]}initialize(){this.compatibilityCheck(),this.layoutCheck(),this.vertScrollListen()}compatibilityCheck(){"fitDataTable"==this.options("layout")&&console.warn("Horizontal Virtual DOM is not compatible with fitDataTable layout mode"),this.options("responsiveLayout")&&console.warn("Horizontal Virtual DOM is not compatible with responsive columns"),this.options("rtl")&&console.warn("Horizontal Virtual DOM is not currently compatible with RTL text direction")}layoutCheck(){this.isFitData=this.options("layout").startsWith("fitData")}vertScrollListen(){this.subscribe("scroll-vertical",this.clearVisRowCache.bind(this)),this.subscribe("data-refreshed",this.clearVisRowCache.bind(this))}clearVisRowCache(){this.visibleRows=null}renderColumns(row,force){this.dataChange()}scrollColumns(left,dir){this.scrollLeft!=left&&(this.scrollLeft=left,this.scroll(left-(this.vDomScrollPosLeft+this.windowBuffer)))}calcWindowBuffer(){var buffer=this.elementVertical.clientWidth;this.table.columnManager.columnsByIndex.forEach((column=>{if(column.visible){var width=column.getWidth();width>buffer&&(buffer=width)}})),this.windowBuffer=2*buffer}rerenderColumns(update,blockRedraw){var old={cols:this.columns,leftCol:this.leftCol,rightCol:this.rightCol},colPos=0;update&&!this.initialized||(this.clear(),this.calcWindowBuffer(),this.scrollLeft=this.elementVertical.scrollLeft,this.vDomScrollPosLeft=this.scrollLeft-this.windowBuffer,this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,this.table.columnManager.columnsByIndex.forEach((column=>{var width,config={};column.visible&&(column.modules.frozen||(width=column.getWidth(),config.leftPos=colPos,config.rightPos=colPos+width,config.width=width,this.isFitData&&(config.fitDataCheck=!column.modules.vdomHoz||column.modules.vdomHoz.fitDataCheck),colPos+width>this.vDomScrollPosLeft&&colPos<this.vDomScrollPosRight?(-1==this.leftCol&&(this.leftCol=this.columns.length,this.vDomPadLeft=colPos),this.rightCol=this.columns.length):-1!==this.leftCol&&(this.vDomPadRight+=width),this.columns.push(column),column.modules.vdomHoz=config,colPos+=width))})),this.tableElement.style.paddingLeft=this.vDomPadLeft+"px",this.tableElement.style.paddingRight=this.vDomPadRight+"px",this.initialized=!0,blockRedraw||update&&!this.reinitChanged(old)||this.reinitializeRows(),this.elementVertical.scrollLeft=this.scrollLeft)}renderRowCells(row){this.initialized?this.initializeRow(row):row.cells.forEach((cell=>{row.element.appendChild(cell.getElement()),cell.cellRendered()}))}rerenderRowCells(row,force){this.reinitializeRow(row,force)}reinitializeColumnWidths(columns){for(let i=this.leftCol;i<=this.rightCol;i++)this.columns[i].reinitializeWidth()}deinitialize(){this.initialized=!1}clear(){this.columns=[],this.leftCol=-1,this.rightCol=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0}dataChange(){var row,rowEl,change=!1;if(this.isFitData){if(this.table.columnManager.columnsByIndex.forEach((column=>{!column.definition.width&&column.visible&&(change=!0)})),change&&this.table.rowManager.getDisplayRows().length&&(this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,row=this.chain("rows-sample",[1],[],(()=>this.table.rowManager.getDisplayRows()))[0])){rowEl=row.getElement(),row.generateCells(),this.tableElement.appendChild(rowEl);for(let colEnd=0;colEnd<row.cells.length;colEnd++){let cell=row.cells[colEnd];rowEl.appendChild(cell.getElement()),cell.column.reinitializeWidth()}rowEl.parentNode.removeChild(rowEl),this.rerenderColumns(!1,!0)}}else"fitColumns"===this.options("layout")&&(this.layoutRefresh(),this.rerenderColumns(!1,!0))}reinitChanged(old){var match=!0;return old.cols.length!==this.columns.length||old.leftCol!==this.leftCol||old.rightCol!==this.rightCol||(old.cols.forEach(((col,i)=>{col!==this.columns[i]&&(match=!1)})),!match)}reinitializeRows(){var visibleRows=this.getVisibleRows(),otherRows=this.table.rowManager.getRows().filter((row=>!visibleRows.includes(row)));visibleRows.forEach((row=>{this.reinitializeRow(row,!0)})),otherRows.forEach((row=>{row.deinitialize()}))}getVisibleRows(){return this.visibleRows||(this.visibleRows=this.table.rowManager.getVisibleRows()),this.visibleRows}scroll(diff){this.vDomScrollPosLeft+=diff,this.vDomScrollPosRight+=diff,Math.abs(diff)>this.windowBuffer/2?this.rerenderColumns():diff>0?(this.addColRight(),this.removeColLeft()):(this.addColLeft(),this.removeColRight())}colPositionAdjust(start,end,diff){for(let i=start;i<end;i++){let column=this.columns[i];column.modules.vdomHoz.leftPos+=diff,column.modules.vdomHoz.rightPos+=diff}}addColRight(){for(var changes=!1,working=!0;working;){let column=this.columns[this.rightCol+1];column&&column.modules.vdomHoz.leftPos<=this.vDomScrollPosRight?(changes=!0,this.getVisibleRows().forEach((row=>{if("group"!==row.type){var cell=row.getCell(column);row.getElement().insertBefore(cell.getElement(),row.getCell(this.columns[this.rightCol]).getElement().nextSibling),cell.cellRendered()}})),this.fitDataColActualWidthCheck(column),this.rightCol++,this.getVisibleRows().forEach((row=>{"group"!==row.type&&(row.modules.vdomHoz.rightCol=this.rightCol)})),this.rightCol>=this.columns.length-1?this.vDomPadRight=0:this.vDomPadRight-=column.getWidth()):working=!1}changes&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}addColLeft(){for(var changes=!1,working=!0;working;){let column=this.columns[this.leftCol-1];if(column)if(column.modules.vdomHoz.rightPos>=this.vDomScrollPosLeft){changes=!0,this.getVisibleRows().forEach((row=>{if("group"!==row.type){var cell=row.getCell(column);row.getElement().insertBefore(cell.getElement(),row.getCell(this.columns[this.leftCol]).getElement()),cell.cellRendered()}})),this.leftCol--,this.getVisibleRows().forEach((row=>{"group"!==row.type&&(row.modules.vdomHoz.leftCol=this.leftCol)})),this.leftCol<=0?this.vDomPadLeft=0:this.vDomPadLeft-=column.getWidth();let diff=this.fitDataColActualWidthCheck(column);diff&&(this.scrollLeft=this.elementVertical.scrollLeft=this.elementVertical.scrollLeft+diff,this.vDomPadRight-=diff)}else working=!1;else working=!1}changes&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}removeColRight(){for(var changes=!1,working=!0;working;){let column=this.columns[this.rightCol];column&&column.modules.vdomHoz.leftPos>this.vDomScrollPosRight?(changes=!0,this.getVisibleRows().forEach((row=>{if("group"!==row.type){var cell=row.getCell(column);try{row.getElement().removeChild(cell.getElement())}catch(ex){console.warn("Could not removeColRight",ex.message)}}})),this.vDomPadRight+=column.getWidth(),this.rightCol--,this.getVisibleRows().forEach((row=>{"group"!==row.type&&(row.modules.vdomHoz.rightCol=this.rightCol)}))):working=!1}changes&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}removeColLeft(){for(var changes=!1,working=!0;working;){let column=this.columns[this.leftCol];column&&column.modules.vdomHoz.rightPos<this.vDomScrollPosLeft?(changes=!0,this.getVisibleRows().forEach((row=>{if("group"!==row.type){var cell=row.getCell(column);try{row.getElement().removeChild(cell.getElement())}catch(ex){console.warn("Could not removeColLeft",ex.message)}}})),this.vDomPadLeft+=column.getWidth(),this.leftCol++,this.getVisibleRows().forEach((row=>{"group"!==row.type&&(row.modules.vdomHoz.leftCol=this.leftCol)}))):working=!1}changes&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}fitDataColActualWidthCheck(column){var newWidth,widthDiff;return column.modules.vdomHoz.fitDataCheck&&(column.reinitializeWidth(),(widthDiff=(newWidth=column.getWidth())-column.modules.vdomHoz.width)&&(column.modules.vdomHoz.rightPos+=widthDiff,column.modules.vdomHoz.width=newWidth,this.colPositionAdjust(this.columns.indexOf(column)+1,this.columns.length,widthDiff)),column.modules.vdomHoz.fitDataCheck=!1),widthDiff}initializeRow(row){if("group"!==row.type){row.modules.vdomHoz={leftCol:this.leftCol,rightCol:this.rightCol},this.table.modules.frozenColumns&&this.table.modules.frozenColumns.leftColumns.forEach((column=>{this.appendCell(row,column)}));for(let i=this.leftCol;i<=this.rightCol;i++)this.appendCell(row,this.columns[i]);this.table.modules.frozenColumns&&this.table.modules.frozenColumns.rightColumns.forEach((column=>{this.appendCell(row,column)}))}}appendCell(row,column){if(column&&column.visible){let cell=row.getCell(column);row.getElement().appendChild(cell.getElement()),cell.cellRendered()}}reinitializeRow(row,force){if("group"!==row.type&&(force||!row.modules.vdomHoz||row.modules.vdomHoz.leftCol!==this.leftCol||row.modules.vdomHoz.rightCol!==this.rightCol)){for(var rowEl=row.getElement();rowEl.firstChild;)rowEl.removeChild(rowEl.firstChild);this.initializeRow(row)}}}class ColumnManager extends CoreFeature{constructor(table){super(table),this.blockHozScrollEvent=!1,this.headersElement=null,this.contentsElement=null,this.element=null,this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.scrollLeft=0,this.optionsList=new OptionsList(this.table,"column definition",defaultColumnOptions),this.redrawBlock=!1,this.redrawBlockUpdate=null,this.renderer=null}initialize(){this.initializeRenderer(),this.headersElement=this.createHeadersElement(),this.contentsElement=this.createHeaderContentsElement(),this.element=this.createHeaderElement(),this.contentsElement.insertBefore(this.headersElement,this.contentsElement.firstChild),this.element.insertBefore(this.contentsElement,this.element.firstChild),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("scrollbar-vertical",this.padVerticalScrollbar.bind(this))}padVerticalScrollbar(width){this.table.rtl?this.headersElement.style.marginLeft=width+"px":this.headersElement.style.marginRight=width+"px"}initializeRenderer(){var renderClass,renderers={virtual:VirtualDomHorizontal,basic:BasicHorizontal};(renderClass="string"==typeof this.table.options.renderHorizontal?renderers[this.table.options.renderHorizontal]:this.table.options.renderHorizontal)?(this.renderer=new renderClass(this.table,this.element,this.tableElement),this.renderer.initialize()):console.error("Unable to find matching renderer:",this.table.options.renderHorizontal)}createHeadersElement(){var el=document.createElement("div");return el.classList.add("tabulator-headers"),el.setAttribute("role","row"),el}createHeaderContentsElement(){var el=document.createElement("div");return el.classList.add("tabulator-header-contents"),el.setAttribute("role","rowgroup"),el}createHeaderElement(){var el=document.createElement("div");return el.classList.add("tabulator-header"),el.setAttribute("role","rowgroup"),this.table.options.headerVisible||el.classList.add("tabulator-header-hidden"),el}getElement(){return this.element}getContentsElement(){return this.contentsElement}getHeadersElement(){return this.headersElement}scrollHorizontal(left){this.contentsElement.scrollLeft=left,this.scrollLeft=left,this.renderer.scrollColumns(left)}generateColumnsFromRowData(data){var row,sorter,cols=[],definitions=this.table.options.autoColumnsDefinitions;if(data&&data.length){for(var key in row=data[0]){let col={field:key,title:key},value=row[key];switch(typeof value){case"undefined":sorter="string";break;case"boolean":sorter="boolean";break;case"object":sorter=Array.isArray(value)?"array":"string";break;default:sorter=isNaN(value)||""===value?value.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)?"alphanum":"string":"number"}col.sorter=sorter,cols.push(col)}if(definitions)switch(typeof definitions){case"function":this.table.options.columns=definitions.call(this.table,cols);break;case"object":Array.isArray(definitions)?cols.forEach((col=>{var match=definitions.find((def=>def.field===col.field));match&&Object.assign(col,match)})):cols.forEach((col=>{definitions[col.field]&&Object.assign(col,definitions[col.field])})),this.table.options.columns=cols}else this.table.options.columns=cols;this.setColumns(this.table.options.columns)}}setColumns(cols,row){for(;this.headersElement.firstChild;)this.headersElement.removeChild(this.headersElement.firstChild);this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.dispatch("columns-loading"),cols.forEach(((def,i)=>{this._addColumn(def)})),this._reIndexColumns(),this.dispatch("columns-loaded"),this.rerenderColumns(!1,!0),this.redraw(!0)}_addColumn(definition,before,nextToColumn){var column=new Column(definition,this),colEl=column.getElement(),index=nextToColumn?this.findColumnIndex(nextToColumn):nextToColumn;if(nextToColumn&&index>-1){var topColumn=nextToColumn.getTopColumn(),parentIndex=this.columns.indexOf(topColumn),nextEl=topColumn.getElement();before?(this.columns.splice(parentIndex,0,column),nextEl.parentNode.insertBefore(colEl,nextEl)):(this.columns.splice(parentIndex+1,0,column),nextEl.parentNode.insertBefore(colEl,nextEl.nextSibling))}else before?(this.columns.unshift(column),this.headersElement.insertBefore(column.getElement(),this.headersElement.firstChild)):(this.columns.push(column),this.headersElement.appendChild(column.getElement()));return column.columnRendered(),column}registerColumnField(col){col.definition.field&&(this.columnsByField[col.definition.field]=col)}registerColumnPosition(col){this.columnsByIndex.push(col)}_reIndexColumns(){this.columnsByIndex=[],this.columns.forEach((function(column){column.reRegisterPosition()}))}verticalAlignHeaders(){var minHeight=0;this.redrawBlock||(this.headersElement.style.height="",this.columns.forEach((column=>{column.clearVerticalAlign()})),this.columns.forEach((column=>{var height=column.getHeight();height>minHeight&&(minHeight=height)})),this.headersElement.style.height=minHeight+"px",this.columns.forEach((column=>{column.verticalAlign(this.table.options.columnHeaderVertAlign,minHeight)})),this.table.rowManager.adjustTableSize())}findColumn(subject){var columns;if("object"!=typeof subject)return this.columnsByField[subject]||!1;if(subject instanceof Column)return subject;if(subject instanceof ColumnComponent)return subject._getSelf()||!1;if("undefined"!=typeof HTMLElement&&subject instanceof HTMLElement){return columns=[],this.columns.forEach((column=>{columns.push(column),columns=columns.concat(column.getColumns(!0))})),columns.find((column=>column.element===subject))||!1}return!1}getColumnByField(field){return this.columnsByField[field]}getColumnsByFieldRoot(root){var matches=[];return Object.keys(this.columnsByField).forEach((field=>{field.split(".")[0]===root&&matches.push(this.columnsByField[field])})),matches}getColumnByIndex(index){return this.columnsByIndex[index]}getFirstVisibleColumn(){var index=this.columnsByIndex.findIndex((col=>col.visible));return index>-1&&this.columnsByIndex[index]}getColumns(){return this.columns}findColumnIndex(column){return this.columnsByIndex.findIndex((col=>column===col))}getRealColumns(){return this.columnsByIndex}traverse(callback){this.columnsByIndex.forEach(((column,i)=>{callback(column,i)}))}getDefinitions(active){var output=[];return this.columnsByIndex.forEach((column=>{(!active||active&&column.visible)&&output.push(column.getDefinition())})),output}getDefinitionTree(){var output=[];return this.columns.forEach((column=>{output.push(column.getDefinition(!0))})),output}getComponents(structured){var output=[];return(structured?this.columns:this.columnsByIndex).forEach((column=>{output.push(column.getComponent())})),output}getWidth(){var width=0;return this.columnsByIndex.forEach((column=>{column.visible&&(width+=column.getWidth())})),width}moveColumn(from,to,after){to.element.parentNode.insertBefore(from.element,to.element),after&&to.element.parentNode.insertBefore(to.element,from.element),this.moveColumnActual(from,to,after),this.verticalAlignHeaders(),this.table.rowManager.reinitialize()}moveColumnActual(from,to,after){from.parent.isGroup?this._moveColumnInArray(from.parent.columns,from,to,after):this._moveColumnInArray(this.columns,from,to,after),this._moveColumnInArray(this.columnsByIndex,from,to,after,!0),this.rerenderColumns(!0),this.dispatch("column-moved",from,to,after),this.subscribedExternal("columnMoved")&&this.dispatchExternal("columnMoved",from.getComponent(),this.table.columnManager.getComponents())}_moveColumnInArray(columns,from,to,after,updateRows){var toIndex,fromIndex=columns.indexOf(from);fromIndex>-1&&(columns.splice(fromIndex,1),(toIndex=columns.indexOf(to))>-1?after&&(toIndex+=1):toIndex=fromIndex,columns.splice(toIndex,0,from),updateRows&&(this.chain("column-moving-rows",[from,to,after],null,[])||[]).concat(this.table.rowManager.rows).forEach((function(row){if(row.cells.length){var cell=row.cells.splice(fromIndex,1)[0];row.cells.splice(toIndex,0,cell)}})))}scrollToColumn(column,position,ifVisible){var left=0,offset=column.getLeftOffset(),adjust=0,colEl=column.getElement();return new Promise(((resolve,reject)=>{if(void 0===position&&(position=this.table.options.scrollToColumnPosition),void 0===ifVisible&&(ifVisible=this.table.options.scrollToColumnIfVisible),column.visible){switch(position){case"middle":case"center":adjust=-this.element.clientWidth/2;break;case"right":adjust=colEl.clientWidth-this.headersElement.clientWidth}if(!ifVisible&&offset>0&&offset+colEl.offsetWidth<this.element.clientWidth)return!1;left=offset+adjust,left=Math.max(Math.min(left,this.table.rowManager.element.scrollWidth-this.table.rowManager.element.clientWidth),0),this.table.rowManager.scrollHorizontal(left),this.scrollHorizontal(left),resolve()}else console.warn("Scroll Error - Column not visible"),reject("Scroll Error - Column not visible")}))}generateCells(row){var cells=[];return this.columnsByIndex.forEach((column=>{cells.push(column.generateCell(row))})),cells}getFlexBaseWidth(){var totalWidth=this.table.element.clientWidth,fixedWidth=0;return this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(totalWidth-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),this.columnsByIndex.forEach((function(column){var width,minWidth,colWidth;column.visible&&(width=column.definition.width||0,minWidth=parseInt(column.minWidth),colWidth="string"==typeof width?width.indexOf("%")>-1?totalWidth/100*parseInt(width):parseInt(width):width,fixedWidth+=colWidth>minWidth?colWidth:minWidth)})),fixedWidth}addColumn(definition,before,nextToColumn){return new Promise(((resolve,reject)=>{var column=this._addColumn(definition,before,nextToColumn);this._reIndexColumns(),this.dispatch("column-add",definition,before,nextToColumn),"fitColumns"!=this.layoutMode()&&column.reinitializeWidth(),this.redraw(!0),this.table.rowManager.reinitialize(),this.rerenderColumns(),resolve(column)}))}deregisterColumn(column){var index,field=column.getField();field&&delete this.columnsByField[field],(index=this.columnsByIndex.indexOf(column))>-1&&this.columnsByIndex.splice(index,1),(index=this.columns.indexOf(column))>-1&&this.columns.splice(index,1),this.verticalAlignHeaders(),this.redraw()}rerenderColumns(update,silent){this.redrawBlock?(!1===update||!0===update&&null===this.redrawBlockUpdate)&&(this.redrawBlockUpdate=update):this.renderer.rerenderColumns(update,silent)}blockRedraw(){this.redrawBlock=!0,this.redrawBlockUpdate=null}restoreRedraw(){this.redrawBlock=!1,this.verticalAlignHeaders(),this.renderer.rerenderColumns(this.redrawBlockUpdate)}redraw(force){Helpers.elVisible(this.element)&&this.verticalAlignHeaders(),force&&(this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),this.confirm("table-redrawing",force)||this.layoutRefresh(force),this.dispatch("table-redraw",force),this.table.footerManager.redraw()}}class BasicVertical extends Renderer{constructor(table){super(table),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0}clearRows(){for(var element=this.tableElement;element.firstChild;)element.removeChild(element.firstChild);element.scrollTop=0,element.scrollLeft=0,element.style.minWidth="",element.style.minHeight="",element.style.display="",element.style.visibility=""}renderRows(){var element=this.tableElement,onlyGroupHeaders=!0;this.rows().forEach(((row,index)=>{this.styleRow(row,index),element.appendChild(row.getElement()),row.initialize(!0),"group"!==row.type&&(onlyGroupHeaders=!1)})),element.style.minWidth=onlyGroupHeaders?this.table.columnManager.getWidth()+"px":""}rerenderRows(callback){this.clearRows(),this.renderRows(),callback&&callback()}scrollToRowNearestTop(row){var rowTop=Helpers.elOffset(row.getElement()).top;return!(Math.abs(this.elementVertical.scrollTop-rowTop)>Math.abs(this.elementVertical.scrollTop+this.elementVertical.clientHeight-rowTop))}scrollToRow(row){var rowEl=row.getElement();this.elementVertical.scrollTop=Helpers.elOffset(rowEl).top-Helpers.elOffset(this.elementVertical).top+this.elementVertical.scrollTop}visibleRows(includingBuffer){return this.rows()}}class VirtualDomVertical extends Renderer{constructor(table){super(table),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.vDomRowHeight=20,this.vDomTop=0,this.vDomBottom=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomMaxRenderChain=90,this.vDomWindowBuffer=0,this.vDomWindowMinTotalRows=20,this.vDomWindowMinMarginRows=5,this.vDomTopNewRows=[],this.vDomBottomNewRows=[]}clearRows(){for(var element=this.tableElement;element.firstChild;)element.removeChild(element.firstChild);element.style.paddingTop="",element.style.paddingBottom="",element.style.minHeight="",element.style.display="",element.style.visibility="",this.elementVertical.scrollTop=0,this.elementVertical.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0,this.vDomTop=0,this.vDomBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0}renderRows(){this._virtualRenderFill()}rerenderRows(callback){for(var scrollTop=this.elementVertical.scrollTop,topRow=!1,topOffset=!1,left=this.table.rowManager.scrollLeft,rows=this.rows(),i=this.vDomTop;i<=this.vDomBottom;i++)if(rows[i]){var diff=scrollTop-rows[i].getElement().offsetTop;if(!(!1===topOffset||Math.abs(diff)<topOffset))break;topOffset=diff,topRow=i}rows.forEach((row=>{row.deinitializeHeight()})),callback&&callback(),this.rows().length?this._virtualRenderFill(!1===topRow?this.rows.length-1:topRow,!0,topOffset||0):(this.clear(),this.table.rowManager._showPlaceholder()),this.scrollColumns(left)}scrollColumns(left){this.table.rowManager.scrollHorizontal(left)}scrollRows(top,dir){var topDiff=top-this.vDomScrollPosTop,bottomDiff=top-this.vDomScrollPosBottom,margin=2*this.vDomWindowBuffer,rows=this.rows();if(this.scrollTop=top,-topDiff>margin||bottomDiff>margin){var left=this.table.rowManager.scrollLeft;this._virtualRenderFill(Math.floor(this.elementVertical.scrollTop/this.elementVertical.scrollHeight*rows.length)),this.scrollColumns(left)}else dir?(topDiff<0&&this._addTopRow(rows,-topDiff),bottomDiff<0&&(this.vDomScrollHeight-this.scrollTop>this.vDomWindowBuffer?this._removeBottomRow(rows,-bottomDiff):this.vDomScrollPosBottom=this.scrollTop)):(bottomDiff>=0&&this._addBottomRow(rows,bottomDiff),topDiff>=0&&(this.scrollTop>this.vDomWindowBuffer?this._removeTopRow(rows,topDiff):this.vDomScrollPosTop=this.scrollTop))}resize(){this.vDomWindowBuffer=this.table.options.renderVerticalBuffer||this.elementVertical.clientHeight}scrollToRowNearestTop(row){var rowIndex=this.rows().indexOf(row);return!(Math.abs(this.vDomTop-rowIndex)>Math.abs(this.vDomBottom-rowIndex))}scrollToRow(row){var index=this.rows().indexOf(row);index>-1&&this._virtualRenderFill(index,!0)}visibleRows(includingBuffer){var topEdge=this.elementVertical.scrollTop,bottomEdge=this.elementVertical.clientHeight+topEdge,topFound=!1,topRow=0,bottomRow=0,rows=this.rows();if(includingBuffer)topRow=this.vDomTop,bottomRow=this.vDomBottom;else for(var i=this.vDomTop;i<=this.vDomBottom;i++)if(rows[i])if(topFound){if(!(bottomEdge-rows[i].getElement().offsetTop>=0))break;bottomRow=i}else if(topEdge-rows[i].getElement().offsetTop>=0)topRow=i;else{if(topFound=!0,!(bottomEdge-rows[i].getElement().offsetTop>=0))break;bottomRow=i}return rows.slice(topRow,bottomRow+1)}_virtualRenderFill(position,forceMove,offset){var element=this.tableElement,holder=this.elementVertical,topPad=0,rowsHeight=0,heightOccupied=0,topPadHeight=0,i=0,rows=this.rows(),rowsCount=rows.length,containerHeight=this.elementVertical.clientHeight;if(offset=offset||0,position=position||0){for(;element.firstChild;)element.removeChild(element.firstChild);(heightOccupied=(rowsCount-position+1)*this.vDomRowHeight)<containerHeight&&(position-=Math.ceil((containerHeight-heightOccupied)/this.vDomRowHeight))<0&&(position=0),position-=topPad=Math.min(Math.max(Math.floor(this.vDomWindowBuffer/this.vDomRowHeight),this.vDomWindowMinMarginRows),position)}else this.clear();if(rowsCount&&Helpers.elVisible(this.elementVertical)){for(this.vDomTop=position,this.vDomBottom=position-1;(rowsHeight<=containerHeight+this.vDomWindowBuffer||i<this.vDomWindowMinTotalRows)&&this.vDomBottom<rowsCount-1;){var rowHeight,index=this.vDomBottom+1,row=rows[index];this.styleRow(row,index),element.appendChild(row.getElement()),row.initialize(),row.heightInitialized||row.normalizeHeight(!0),rowHeight=row.getHeight(),i<topPad?topPadHeight+=rowHeight:rowsHeight+=rowHeight,rowHeight>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*rowHeight),this.vDomBottom++,i++}position?(this.vDomTopPad=forceMove?this.vDomRowHeight*this.vDomTop+offset:this.scrollTop-topPadHeight,this.vDomBottomPad=this.vDomBottom==rowsCount-1?0:Math.max(this.vDomScrollHeight-this.vDomTopPad-rowsHeight-topPadHeight,0)):(this.vDomTopPad=0,this.vDomRowHeight=Math.floor((rowsHeight+topPadHeight)/i),this.vDomBottomPad=this.vDomRowHeight*(rowsCount-this.vDomBottom-1),this.vDomScrollHeight=topPadHeight+rowsHeight+this.vDomBottomPad-containerHeight),element.style.paddingTop=this.vDomTopPad+"px",element.style.paddingBottom=this.vDomBottomPad+"px",forceMove&&(this.scrollTop=this.vDomTopPad+topPadHeight+offset-(this.elementVertical.scrollWidth>this.elementVertical.clientWidth?this.elementVertical.offsetHeight-containerHeight:0)),this.scrollTop=Math.min(this.scrollTop,this.elementVertical.scrollHeight-containerHeight),this.elementVertical.scrollWidth>this.elementVertical.offsetWidth&&forceMove&&(this.scrollTop+=this.elementVertical.offsetHeight-containerHeight),this.vDomScrollPosTop=this.scrollTop,this.vDomScrollPosBottom=this.scrollTop,holder.scrollTop=this.scrollTop,this.dispatch("render-virtual-fill")}}_addTopRow(rows,fillableSpace){for(var table=this.tableElement,addedRows=[],paddingAdjust=0,index=this.vDomTop-1,i=0,working=!0;working;)if(this.vDomTop){let rowHeight,initialized,row=rows[index];row&&i<this.vDomMaxRenderChain?(rowHeight=row.getHeight()||this.vDomRowHeight,initialized=row.initialized,fillableSpace>=rowHeight?(this.styleRow(row,index),table.insertBefore(row.getElement(),table.firstChild),row.initialized&&row.heightInitialized||addedRows.push(row),row.initialize(),initialized||(rowHeight=row.getElement().offsetHeight,rowHeight>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*rowHeight)),fillableSpace-=rowHeight,paddingAdjust+=rowHeight,this.vDomTop--,index--,i++):working=!1):working=!1}else working=!1;for(let row of addedRows)row.clearCellHeight();this._quickNormalizeRowHeight(addedRows),paddingAdjust&&(this.vDomTopPad-=paddingAdjust,this.vDomTopPad<0&&(this.vDomTopPad=index*this.vDomRowHeight),index<1&&(this.vDomTopPad=0),table.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop-=paddingAdjust)}_removeTopRow(rows,fillableSpace){for(var removableRows=[],paddingAdjust=0,i=0,working=!0;working;){let rowHeight,row=rows[this.vDomTop];row&&i<this.vDomMaxRenderChain?(rowHeight=row.getHeight()||this.vDomRowHeight,fillableSpace>=rowHeight?(this.vDomTop++,fillableSpace-=rowHeight,paddingAdjust+=rowHeight,removableRows.push(row),i++):working=!1):working=!1}for(let row of removableRows){let rowEl=row.getElement();rowEl.parentNode&&rowEl.parentNode.removeChild(rowEl)}paddingAdjust&&(this.vDomTopPad+=paddingAdjust,this.tableElement.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop+=this.vDomTop?paddingAdjust:paddingAdjust+this.vDomWindowBuffer)}_addBottomRow(rows,fillableSpace){for(var table=this.tableElement,addedRows=[],paddingAdjust=0,index=this.vDomBottom+1,i=0,working=!0;working;){let rowHeight,initialized,row=rows[index];row&&i<this.vDomMaxRenderChain?(rowHeight=row.getHeight()||this.vDomRowHeight,initialized=row.initialized,fillableSpace>=rowHeight?(this.styleRow(row,index),table.appendChild(row.getElement()),row.initialized&&row.heightInitialized||addedRows.push(row),row.initialize(),initialized||(rowHeight=row.getElement().offsetHeight,rowHeight>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*rowHeight)),fillableSpace-=rowHeight,paddingAdjust+=rowHeight,this.vDomBottom++,index++,i++):working=!1):working=!1}for(let row of addedRows)row.clearCellHeight();this._quickNormalizeRowHeight(addedRows),paddingAdjust&&(this.vDomBottomPad-=paddingAdjust,(this.vDomBottomPad<0||index==rows.length-1)&&(this.vDomBottomPad=0),table.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom+=paddingAdjust)}_removeBottomRow(rows,fillableSpace){for(var removableRows=[],paddingAdjust=0,i=0,working=!0;working;){let rowHeight,row=rows[this.vDomBottom];row&&i<this.vDomMaxRenderChain?(rowHeight=row.getHeight()||this.vDomRowHeight,fillableSpace>=rowHeight?(this.vDomBottom--,fillableSpace-=rowHeight,paddingAdjust+=rowHeight,removableRows.push(row),i++):working=!1):working=!1}for(let row of removableRows){let rowEl=row.getElement();rowEl.parentNode&&rowEl.parentNode.removeChild(rowEl)}paddingAdjust&&(this.vDomBottomPad+=paddingAdjust,this.vDomBottomPad<0&&(this.vDomBottomPad=0),this.tableElement.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom-=paddingAdjust)}_quickNormalizeRowHeight(rows){for(let row of rows)row.calcHeight();for(let row of rows)row.setCellHeight()}}class RowManager extends CoreFeature{constructor(table){super(table),this.element=this.createHolderElement(),this.tableElement=this.createTableElement(),this.heightFixer=this.createTableElement(),this.placeholder=null,this.placeholderContents=null,this.firstRender=!1,this.renderMode="virtual",this.fixedHeight=!1,this.rows=[],this.activeRowsPipeline=[],this.activeRows=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.scrollTop=0,this.scrollLeft=0,this.redrawBlock=!1,this.redrawBlockRestoreConfig=!1,this.redrawBlockRenderInPosition=!1,this.dataPipeline=[],this.displayPipeline=[],this.scrollbarWidth=0,this.renderer=null}createHolderElement(){var el=document.createElement("div");return el.classList.add("tabulator-tableholder"),el.setAttribute("tabindex",0),el}createTableElement(){var el=document.createElement("div");return el.classList.add("tabulator-table"),el.setAttribute("role","rowgroup"),el}initializePlaceholder(){if("string"==typeof this.table.options.placeholder){let el=document.createElement("div");el.classList.add("tabulator-placeholder");let contents=document.createElement("div");contents.classList.add("tabulator-placeholder-contents"),contents.innerHTML=this.table.options.placeholder,el.appendChild(contents),this.placeholderContents=contents,this.placeholder=el}}getElement(){return this.element}getTableElement(){return this.tableElement}initialize(){this.initializePlaceholder(),this.initializeRenderer(),this.element.appendChild(this.tableElement),this.firstRender=!0,this.element.addEventListener("scroll",(()=>{var left=this.element.scrollLeft,leftDir=this.scrollLeft>left,top=this.element.scrollTop,topDir=this.scrollTop>top;this.scrollLeft!=left&&(this.scrollLeft=left,this.dispatch("scroll-horizontal",left,leftDir),this.dispatchExternal("scrollHorizontal",left,leftDir),this._positionPlaceholder()),this.scrollTop!=top&&(this.scrollTop=top,this.renderer.scrollRows(top,topDir),this.dispatch("scroll-vertical",top,topDir),this.dispatchExternal("scrollVertical",top,topDir))}))}findRow(subject){if("object"!=typeof subject){if(void 0===subject)return!1;return this.rows.find((row=>row.data[this.table.options.index]==subject))||!1}if(subject instanceof Row)return subject;if(subject instanceof RowComponent)return subject._getSelf()||!1;if("undefined"!=typeof HTMLElement&&subject instanceof HTMLElement){return this.rows.find((row=>row.getElement()===subject))||!1}return!1}getRowFromDataObject(data){return this.rows.find((row=>row.data===data))||!1}getRowFromPosition(position){return this.getDisplayRows().find((row=>row.getPosition()===position&&row.isDisplayed()))}scrollToRow(row,position,ifVisible){return this.renderer.scrollToRowPosition(row,position,ifVisible)}setData(data,renderInPosition,columnsChanged){return new Promise(((resolve,reject)=>{renderInPosition&&this.getDisplayRows().length?this.table.options.pagination?this._setDataActual(data,!0):this.reRenderInPosition((()=>{this._setDataActual(data)})):(this.table.options.autoColumns&&columnsChanged&&this.table.initialized&&this.table.columnManager.generateColumnsFromRowData(data),this.resetScroll(),this._setDataActual(data)),resolve()}))}_setDataActual(data,renderInPosition){this.dispatchExternal("dataProcessing",data),this._wipeElements(),Array.isArray(data)?(this.dispatch("data-processing",data),data.forEach(((def,i)=>{if(def&&"object"==typeof def){var row=new Row(def,this);this.rows.push(row)}else console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:",def)})),this.refreshActiveData(!1,!1,renderInPosition),this.dispatch("data-processed",data),this.dispatchExternal("dataProcessed",data)):console.error("Data Loading Error - Unable to process data due to invalid data type \nExpecting: array \nReceived: ",typeof data,"\nData:     ",data)}_wipeElements(){this.dispatch("rows-wipe"),this.rows.forEach((row=>{row.wipe()})),this.rows=[],this.activeRows=[],this.activeRowsPipeline=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.adjustTableSize()}deleteRow(row,blockRedraw){var allIndex=this.rows.indexOf(row),activeIndex=this.activeRows.indexOf(row);activeIndex>-1&&this.activeRows.splice(activeIndex,1),allIndex>-1&&this.rows.splice(allIndex,1),this.setActiveRows(this.activeRows),this.displayRowIterator((rows=>{var displayIndex=rows.indexOf(row);displayIndex>-1&&rows.splice(displayIndex,1)})),blockRedraw||this.reRenderInPosition(),this.regenerateRowPositions(),this.dispatchExternal("rowDeleted",row.getComponent()),this.displayRowsCount||this._showPlaceholder(),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.getData())}addRow(data,pos,index,blockRedraw){return this.addRowActual(data,pos,index,blockRedraw)}addRows(data,pos,index){var rows=[];return new Promise(((resolve,reject)=>{pos=this.findAddRowPos(pos),Array.isArray(data)||(data=[data]),(void 0===index&&pos||void 0!==index&&!pos)&&data.reverse(),data.forEach(((item,i)=>{var row=this.addRow(item,pos,index,!0);rows.push(row),this.dispatch("row-added",row,data,pos,index)})),this.refreshActiveData(!1,!1,!0),this.regenerateRowPositions(),rows.length&&this._clearPlaceholder(),resolve(rows)}))}findAddRowPos(pos){return void 0===pos&&(pos=this.table.options.addRowPos),"pos"===pos&&(pos=!0),"bottom"===pos&&(pos=!1),pos}addRowActual(data,pos,index,blockRedraw){var activeIndex,chainResult,row=data instanceof Row?data:new Row(data||{},this),top=this.findAddRowPos(pos),allIndex=-1;return index||(chainResult=this.chain("row-adding-position",[row,top],null,{index:index,top:top}),index=chainResult.index,top=chainResult.top),void 0!==index&&(index=this.findRow(index)),(index=this.chain("row-adding-index",[row,index,top],null,index))&&(allIndex=this.rows.indexOf(index)),index&&allIndex>-1?(activeIndex=this.activeRows.indexOf(index),this.displayRowIterator((function(rows){var displayIndex=rows.indexOf(index);displayIndex>-1&&rows.splice(top?displayIndex:displayIndex+1,0,row)})),activeIndex>-1&&this.activeRows.splice(top?activeIndex:activeIndex+1,0,row),this.rows.splice(top?allIndex:allIndex+1,0,row)):top?(this.displayRowIterator((function(rows){rows.unshift(row)})),this.activeRows.unshift(row),this.rows.unshift(row)):(this.displayRowIterator((function(rows){rows.push(row)})),this.activeRows.push(row),this.rows.push(row)),this.setActiveRows(this.activeRows),this.dispatchExternal("rowAdded",row.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),blockRedraw||this.reRenderInPosition(),row}moveRow(from,to,after){this.dispatch("row-move",from,to,after),this.moveRowActual(from,to,after),this.regenerateRowPositions(),this.dispatch("row-moved",from,to,after),this.dispatchExternal("rowMoved",from.getComponent())}moveRowActual(from,to,after){this.moveRowInArray(this.rows,from,to,after),this.moveRowInArray(this.activeRows,from,to,after),this.displayRowIterator((rows=>{this.moveRowInArray(rows,from,to,after)})),this.dispatch("row-moving",from,to,after)}moveRowInArray(rows,from,to,after){var fromIndex,toIndex,end;if(from!==to&&((fromIndex=rows.indexOf(from))>-1&&(rows.splice(fromIndex,1),(toIndex=rows.indexOf(to))>-1?after?rows.splice(toIndex+1,0,from):rows.splice(toIndex,0,from):rows.splice(fromIndex,0,from)),rows===this.getDisplayRows())){end=toIndex>fromIndex?toIndex:fromIndex+1;for(let i=fromIndex<toIndex?fromIndex:toIndex;i<=end;i++)rows[i]&&this.styleRow(rows[i],i)}}clearData(){this.setData([])}getRowIndex(row){return this.findRowIndex(row,this.rows)}getDisplayRowIndex(row){var index=this.getDisplayRows().indexOf(row);return index>-1&&index}nextDisplayRow(row,rowOnly){var index=this.getDisplayRowIndex(row),nextRow=!1;return!1!==index&&index<this.displayRowsCount-1&&(nextRow=this.getDisplayRows()[index+1]),!nextRow||nextRow instanceof Row&&"row"==nextRow.type?nextRow:this.nextDisplayRow(nextRow,rowOnly)}prevDisplayRow(row,rowOnly){var index=this.getDisplayRowIndex(row),prevRow=!1;return index&&(prevRow=this.getDisplayRows()[index-1]),!rowOnly||!prevRow||prevRow instanceof Row&&"row"==prevRow.type?prevRow:this.prevDisplayRow(prevRow,rowOnly)}findRowIndex(row,list){var rowIndex;return!!((row=this.findRow(row))&&(rowIndex=list.indexOf(row))>-1)&&rowIndex}getData(active,transform){var output=[];return this.getRows(active).forEach((function(row){"row"==row.type&&output.push(row.getData(transform||"data"))})),output}getComponents(active){var output=[];return this.getRows(active).forEach((function(row){output.push(row.getComponent())})),output}getDataCount(active){return this.getRows(active).length}scrollHorizontal(left){this.scrollLeft=left,this.element.scrollLeft=left,this.dispatch("scroll-horizontal",left)}registerDataPipelineHandler(handler,priority){void 0!==priority?(this.dataPipeline.push({handler:handler,priority:priority}),this.dataPipeline.sort(((a,b)=>a.priority-b.priority))):console.error("Data pipeline handlers must have a priority in order to be registered")}registerDisplayPipelineHandler(handler,priority){void 0!==priority?(this.displayPipeline.push({handler:handler,priority:priority}),this.displayPipeline.sort(((a,b)=>a.priority-b.priority))):console.error("Display pipeline handlers must have a priority in order to be registered")}refreshActiveData(handler,skipStage,renderInPosition){var table=this.table,stage="",index=0,cascadeOrder=["all","dataPipeline","display","displayPipeline","end"];if(!this.table.destroyed){if("function"==typeof handler)if((index=this.dataPipeline.findIndex((item=>item.handler===handler)))>-1)stage="dataPipeline",skipStage&&(index==this.dataPipeline.length-1?stage="display":index++);else{if(!((index=this.displayPipeline.findIndex((item=>item.handler===handler)))>-1))return void console.error("Unable to refresh data, invalid handler provided",handler);stage="displayPipeline",skipStage&&(index==this.displayPipeline.length-1?stage="end":index++)}else stage=handler||"all",index=0;if(this.redrawBlock)return void((!this.redrawBlockRestoreConfig||this.redrawBlockRestoreConfig&&(this.redrawBlockRestoreConfig.stage===stage&&index<this.redrawBlockRestoreConfig.index||cascadeOrder.indexOf(stage)<cascadeOrder.indexOf(this.redrawBlockRestoreConfig.stage)))&&(this.redrawBlockRestoreConfig={handler:handler,skipStage:skipStage,renderInPosition:renderInPosition,stage:stage,index:index}));Helpers.elVisible(this.element)?renderInPosition?this.reRenderInPosition(this.refreshPipelines.bind(this,handler,stage,index,renderInPosition)):(this.refreshPipelines(handler,stage,index,renderInPosition),handler||this.table.columnManager.renderer.renderColumns(),this.renderTable(),table.options.layoutColumnsOnNewData&&this.table.columnManager.redraw(!0)):this.refreshPipelines(handler,stage,index,renderInPosition),this.dispatch("data-refreshed")}}refreshPipelines(handler,stage,index,renderInPosition){switch(this.dispatch("data-refreshing"),handler||(this.activeRowsPipeline[0]=this.rows.slice(0)),stage){case"all":case"dataPipeline":for(let i=index;i<this.dataPipeline.length;i++){let result=this.dataPipeline[i].handler(this.activeRowsPipeline[i].slice(0));this.activeRowsPipeline[i+1]=result||this.activeRowsPipeline[i].slice(0)}this.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]);case"display":index=0,this.resetDisplayRows();case"displayPipeline":for(let i=index;i<this.displayPipeline.length;i++){let result=this.displayPipeline[i].handler((i?this.getDisplayRows(i-1):this.activeRows).slice(0),renderInPosition);this.setDisplayRows(result||this.getDisplayRows(i-1).slice(0),i)}case"end":this.regenerateRowPositions()}this.getDisplayRows().length&&this._clearPlaceholder()}regenerateRowPositions(){var rows=this.getDisplayRows(),index=1;rows.forEach((row=>{"row"===row.type&&(row.setPosition(index),index++)}))}setActiveRows(activeRows){this.activeRows=activeRows,this.activeRowsCount=this.activeRows.length}resetDisplayRows(){this.displayRows=[],this.displayRows.push(this.activeRows.slice(0)),this.displayRowsCount=this.displayRows[0].length}setDisplayRows(displayRows,index){this.displayRows[index]=displayRows,index==this.displayRows.length-1&&(this.displayRowsCount=this.displayRows[this.displayRows.length-1].length)}getDisplayRows(index){return void 0===index?this.displayRows.length?this.displayRows[this.displayRows.length-1]:[]:this.displayRows[index]||[]}getVisibleRows(chain,viewable){var rows=Object.assign([],this.renderer.visibleRows(!viewable));return chain&&(rows=this.chain("rows-visible",[viewable],rows,rows)),rows}displayRowIterator(callback){this.activeRowsPipeline.forEach(callback),this.displayRows.forEach(callback),this.displayRowsCount=this.displayRows[this.displayRows.length-1].length}getRows(type){var rows=[];if(type&&!0!==type)switch(type){case"active":rows=this.activeRows;break;case"display":rows=this.table.rowManager.getDisplayRows();break;case"visible":rows=this.getVisibleRows(!1,!0)}else rows=this.chain("rows-retrieve",type,null,this.rows)||this.rows;return rows}reRenderInPosition(callback){this.redrawBlock?callback?callback():this.redrawBlockRenderInPosition=!0:(this.dispatchExternal("renderStarted"),this.renderer.rerenderRows(callback),this.fixedHeight||this.adjustTableSize(),this.scrollBarCheck(),this.dispatchExternal("renderComplete"))}scrollBarCheck(){var scrollbarWidth=0;this.element.scrollHeight>this.element.clientHeight&&(scrollbarWidth=this.element.offsetWidth-this.element.clientWidth),scrollbarWidth!==this.scrollbarWidth&&(this.scrollbarWidth=scrollbarWidth,this.dispatch("scrollbar-vertical",scrollbarWidth))}initializeRenderer(){var renderClass,renderers={virtual:VirtualDomVertical,basic:BasicVertical};(renderClass="string"==typeof this.table.options.renderVertical?renderers[this.table.options.renderVertical]:this.table.options.renderVertical)?(this.renderMode=this.table.options.renderVertical,this.renderer=new renderClass(this.table,this.element,this.tableElement),this.renderer.initialize(),this.table.element.clientHeight||this.table.options.height?this.fixedHeight=!0:this.fixedHeight=!1):console.error("Unable to find matching renderer:",this.table.options.renderVertical)}getRenderMode(){return this.renderMode}renderTable(){this.dispatchExternal("renderStarted"),this.element.scrollTop=0,this._clearTable(),this.displayRowsCount?(this.renderer.renderRows(),this.firstRender&&(this.firstRender=!1,this.layoutRefresh(!0))):this.renderEmptyScroll(),this.fixedHeight||this.adjustTableSize(),this.dispatch("table-layout"),this.displayRowsCount||this._showPlaceholder(),this.scrollBarCheck(),this.dispatchExternal("renderComplete")}renderEmptyScroll(){this.placeholder?this.tableElement.style.display="none":this.tableElement.style.minWidth=this.table.columnManager.getWidth()+"px"}_clearTable(){this._clearPlaceholder(),this.scrollTop=0,this.scrollLeft=0,this.renderer.clearRows()}_showPlaceholder(){this.placeholder&&(this.placeholder.setAttribute("tabulator-render-mode",this.renderMode),this.getElement().appendChild(this.placeholder),this._positionPlaceholder())}_clearPlaceholder(){this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.tableElement.style.minWidth=""}_positionPlaceholder(){this.placeholder&&this.placeholder.parentNode&&(this.placeholder.style.width=this.table.columnManager.getWidth()+"px",this.placeholderContents.style.width=this.table.rowManager.element.clientWidth+"px",this.placeholderContents.style.marginLeft=this.scrollLeft+"px")}styleRow(row,index){var rowEl=row.getElement();index%2?(rowEl.classList.add("tabulator-row-even"),rowEl.classList.remove("tabulator-row-odd")):(rowEl.classList.add("tabulator-row-odd"),rowEl.classList.remove("tabulator-row-even"))}normalizeHeight(){this.activeRows.forEach((function(row){row.normalizeHeight()}))}adjustTableSize(){var minHeight,initialHeight=this.element.clientHeight;if("fill"===this.renderer.verticalFillMode){let otherHeight=Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height+(this.table.footerManager&&this.table.footerManager.active&&!this.table.footerManager.external?this.table.footerManager.getElement().getBoundingClientRect().height:0));this.fixedHeight?(minHeight=isNaN(this.table.options.minHeight)?this.table.options.minHeight:this.table.options.minHeight+"px",this.element.style.minHeight=minHeight||"calc(100% - "+otherHeight+"px)",this.element.style.height="calc(100% - "+otherHeight+"px)",this.element.style.maxHeight="calc(100% - "+otherHeight+"px)"):(this.element.style.height="",this.element.style.height=this.table.element.clientHeight-otherHeight+"px",this.element.scrollTop=this.scrollTop),this.renderer.resize(),this.fixedHeight||initialHeight==this.element.clientHeight||(this.subscribed("table-resize")?this.dispatch("table-resize"):this.redraw()),this.scrollBarCheck()}this._positionPlaceholder()}reinitialize(){this.rows.forEach((function(row){row.reinitialize(!0)}))}blockRedraw(){this.redrawBlock=!0,this.redrawBlockRestoreConfig=!1}restoreRedraw(){this.redrawBlock=!1,this.redrawBlockRestoreConfig?(this.refreshActiveData(this.redrawBlockRestoreConfig.handler,this.redrawBlockRestoreConfig.skipStage,this.redrawBlockRestoreConfig.renderInPosition),this.redrawBlockRestoreConfig=!1):this.redrawBlockRenderInPosition&&this.reRenderInPosition(),this.redrawBlockRenderInPosition=!1}redraw(force){var left=this.scrollLeft;this.adjustTableSize(),this.table.tableWidth=this.table.element.clientWidth,force?this.renderTable():(this.reRenderInPosition(),this.scrollHorizontal(left))}resetScroll(){if(this.element.scrollLeft=0,this.element.scrollTop=0,"ie"===this.table.browser){var event=document.createEvent("Event");event.initEvent("scroll",!1,!0),this.element.dispatchEvent(event)}else this.element.dispatchEvent(new Event("scroll"))}}class FooterManager extends CoreFeature{constructor(table){super(table),this.active=!1,this.element=this.createElement(),this.containerElement=this.createContainerElement(),this.external=!1}initialize(){this.initializeElement()}createElement(){var el=document.createElement("div");return el.classList.add("tabulator-footer"),el}createContainerElement(){var el=document.createElement("div");return el.classList.add("tabulator-footer-contents"),this.element.appendChild(el),el}initializeElement(){if(this.table.options.footerElement)if("string"==typeof this.table.options.footerElement)"<"===this.table.options.footerElement[0]?this.containerElement.innerHTML=this.table.options.footerElement:(this.external=!0,this.containerElement=document.querySelector(this.table.options.footerElement));else this.element=this.table.options.footerElement}getElement(){return this.element}append(element){this.activate(),this.containerElement.appendChild(element),this.table.rowManager.adjustTableSize()}prepend(element){this.activate(),this.element.insertBefore(element,this.element.firstChild),this.table.rowManager.adjustTableSize()}remove(element){element.parentNode.removeChild(element),this.deactivate()}deactivate(force){this.element.firstChild&&!force||(this.external||this.element.parentNode.removeChild(this.element),this.active=!1)}activate(){this.active||(this.active=!0,this.external||(this.table.element.appendChild(this.getElement()),this.table.element.style.display=""))}redraw(){this.dispatch("footer-redraw")}}class InteractionManager extends CoreFeature{constructor(table){super(table),this.el=null,this.abortClasses=["tabulator-headers","tabulator-table"],this.previousTargets={},this.listeners=["click","dblclick","contextmenu","mouseenter","mouseleave","mouseover","mouseout","mousemove","mouseup","mousedown","touchstart","touchend"],this.componentMap={"tabulator-cell":"cell","tabulator-row":"row","tabulator-group":"group","tabulator-col":"column"},this.pseudoTrackers={row:{subscriber:null,target:null},cell:{subscriber:null,target:null},group:{subscriber:null,target:null},column:{subscriber:null,target:null}},this.pseudoTracking=!1}initialize(){this.el=this.table.element,this.buildListenerMap(),this.bindSubscriptionWatchers()}buildListenerMap(){var listenerMap={};this.listeners.forEach((listener=>{listenerMap[listener]={handler:null,components:[]}})),this.listeners=listenerMap}bindPseudoEvents(){Object.keys(this.pseudoTrackers).forEach((key=>{this.pseudoTrackers[key].subscriber=this.pseudoMouseEnter.bind(this,key),this.subscribe(key+"-mouseover",this.pseudoTrackers[key].subscriber)})),this.pseudoTracking=!0}pseudoMouseEnter(key,e,target){this.pseudoTrackers[key].target!==target&&(this.pseudoTrackers[key].target&&this.dispatch(key+"-mouseleave",e,this.pseudoTrackers[key].target),this.pseudoMouseLeave(key,e),this.pseudoTrackers[key].target=target,this.dispatch(key+"-mouseenter",e,target))}pseudoMouseLeave(key,e){var leaveList=Object.keys(this.pseudoTrackers),linkedKeys={row:["cell"],cell:["row"]};(leaveList=leaveList.filter((item=>{var links=linkedKeys[key];return item!==key&&(!links||links&&!links.includes(item))}))).forEach((key=>{var target=this.pseudoTrackers[key].target;this.pseudoTrackers[key].target&&(this.dispatch(key+"-mouseleave",e,target),this.pseudoTrackers[key].target=null)}))}bindSubscriptionWatchers(){var listeners=Object.keys(this.listeners),components=Object.values(this.componentMap);for(let comp of components)for(let listener of listeners){let key=comp+"-"+listener;this.subscriptionChange(key,this.subscriptionChanged.bind(this,comp,listener))}this.subscribe("table-destroy",this.clearWatchers.bind(this))}subscriptionChanged(component,key,added){var listener=this.listeners[key].components,index=listener.indexOf(component),changed=!1;added?-1===index&&(listener.push(component),changed=!0):this.subscribed(component+"-"+key)||index>-1&&(listener.splice(index,1),changed=!0),"mouseenter"!==key&&"mouseleave"!==key||this.pseudoTracking||this.bindPseudoEvents(),changed&&this.updateEventListeners()}updateEventListeners(){for(let key in this.listeners){let listener=this.listeners[key];listener.components.length?listener.handler||(listener.handler=this.track.bind(this,key),this.el.addEventListener(key,listener.handler)):listener.handler&&(this.el.removeEventListener(key,listener.handler),listener.handler=null)}}track(type,e){var path=e.composedPath&&e.composedPath()||e.path,targets=this.findTargets(path);targets=this.bindComponents(type,targets),this.triggerEvents(type,e,targets),!this.pseudoTracking||"mouseover"!=type&&"mouseleave"!=type||Object.keys(targets).length||this.pseudoMouseLeave("none",e)}findTargets(path){var targets={};let componentMap=Object.keys(this.componentMap);for(let el of path){let classList=el.classList?[...el.classList]:[];if(classList.filter((item=>this.abortClasses.includes(item))).length)break;let elTargets=classList.filter((item=>componentMap.includes(item)));for(let target of elTargets)targets[this.componentMap[target]]||(targets[this.componentMap[target]]=el)}return targets.group&&targets.group===targets.row&&delete targets.row,targets}bindComponents(type,targets){var keys=Object.keys(targets).reverse(),listener=this.listeners[type],matches={},targetMatches={};for(let key of keys){let component,target=targets[key],previousTarget=this.previousTargets[key];if(previousTarget&&previousTarget.target===target)component=previousTarget.component;else switch(key){case"row":case"group":if(listener.components.includes("row")||listener.components.includes("cell")||listener.components.includes("group")){component=this.table.rowManager.getVisibleRows(!0).find((row=>row.getElement()===target)),targets.row&&targets.row.parentNode&&targets.row.parentNode.closest(".tabulator-row")&&(targets[key]=!1)}break;case"column":listener.components.includes("column")&&(component=this.table.columnManager.findColumn(target));break;case"cell":listener.components.includes("cell")&&(matches.row instanceof Row?component=matches.row.findCell(target):targets.row&&console.warn("Event Target Lookup Error - The row this cell is attached to cannot be found, has the table been reinitialized without being destroyed first?"))}component&&(matches[key]=component,targetMatches[key]={target:target,component:component})}return this.previousTargets=targetMatches,matches}triggerEvents(type,e,targets){var listener=this.listeners[type];for(let key in targets)targets[key]&&listener.components.includes(key)&&this.dispatch(key+"-"+type,e,targets[key])}clearWatchers(){for(let key in this.listeners){let listener=this.listeners[key];listener.handler&&(this.el.removeEventListener(key,listener.handler),listener.handler=null)}}}class ComponentFunctionBinder{constructor(table){this.table=table,this.bindings={}}bind(type,funcName,handler){this.bindings[type]||(this.bindings[type]={}),this.bindings[type][funcName]?console.warn("Unable to bind component handler, a matching function name is already bound",type,funcName,handler):this.bindings[type][funcName]=handler}handle(type,component,name){if(this.bindings[type]&&this.bindings[type][name]&&"function"==typeof this.bindings[type][name].bind)return this.bindings[type][name].bind(null,component);"then"===name||"string"!=typeof name||name.startsWith("_")||this.table.options.debugInvalidComponentFuncs&&console.error("The "+type+" component does not have a "+name+" function, have you checked that you have the correct Tabulator module installed?")}}class DataLoader extends CoreFeature{constructor(table){super(table),this.requestOrder=0,this.loading=!1}initialize(){}load(data,params,config,replace,silent,columnsChanged){var requestNo=++this.requestOrder;return this.dispatchExternal("dataLoading",data),!data||0!=data.indexOf("{")&&0!=data.indexOf("[")||(data=JSON.parse(data)),this.confirm("data-loading",[data,params,config,silent])?(this.loading=!0,silent||this.alertLoader(),params=this.chain("data-params",[data,config,silent],params||{},params||{}),params=this.mapParams(params,this.table.options.dataSendParams),this.chain("data-load",[data,params,config,silent],!1,Promise.resolve([])).then((response=>{Array.isArray(response)||"object"!=typeof response||(response=this.mapParams(response,this.objectInvert(this.table.options.dataReceiveParams)));var rowData=this.chain("data-loaded",response,null,response);requestNo==this.requestOrder?(this.clearAlert(),!1!==rowData&&(this.dispatchExternal("dataLoaded",rowData),this.table.rowManager.setData(rowData,replace,void 0===columnsChanged?!replace:columnsChanged))):console.warn("Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made")})).catch((error=>{console.error("Data Load Error: ",error),this.dispatchExternal("dataLoadError",error),silent||this.alertError(),setTimeout((()=>{this.clearAlert()}),this.table.options.dataLoaderErrorTimeout)})).finally((()=>{this.loading=!1}))):(this.dispatchExternal("dataLoaded",data),data||(data=[]),this.table.rowManager.setData(data,replace,void 0===columnsChanged?!replace:columnsChanged),Promise.resolve())}mapParams(params,map){var output={};for(let key in params)output[map.hasOwnProperty(key)?map[key]:key]=params[key];return output}objectInvert(obj){var output={};for(let key in obj)output[obj[key]]=key;return output}blockActiveLoad(){this.requestOrder++}alertLoader(){("function"==typeof this.table.options.dataLoader?this.table.options.dataLoader():this.table.options.dataLoader)&&this.table.alertManager.alert(this.table.options.dataLoaderLoading||this.langText("data|loading"))}alertError(){this.table.alertManager.alert(this.table.options.dataLoaderError||this.langText("data|error"),"error")}clearAlert(){this.table.alertManager.clear()}}class ExternalEventBus{constructor(table,optionsList,debug){this.table=table,this.events={},this.optionsList=optionsList||{},this.subscriptionNotifiers={},this.dispatch=debug?this._debugDispatch.bind(this):this._dispatch.bind(this),this.debug=debug}subscriptionChange(key,callback){this.subscriptionNotifiers[key]||(this.subscriptionNotifiers[key]=[]),this.subscriptionNotifiers[key].push(callback),this.subscribed(key)&&this._notifySubscriptionChange(key,!0)}subscribe(key,callback){this.events[key]||(this.events[key]=[]),this.events[key].push(callback),this._notifySubscriptionChange(key,!0)}unsubscribe(key,callback){var index;if(this.events[key]){if(callback){if(!((index=this.events[key].findIndex((item=>item===callback)))>-1))return void console.warn("Cannot remove event, no matching event found:",key,callback);this.events[key].splice(index,1)}else delete this.events[key];this._notifySubscriptionChange(key,!1)}else console.warn("Cannot remove event, no events set on:",key)}subscribed(key){return this.events[key]&&this.events[key].length}_notifySubscriptionChange(key,subscribed){var notifiers=this.subscriptionNotifiers[key];notifiers&&notifiers.forEach((callback=>{callback(subscribed)}))}_dispatch(){var result,args=Array.from(arguments),key=args.shift();return this.events[key]&&this.events[key].forEach(((callback,i)=>{let callResult=callback.apply(this.table,args);i||(result=callResult)})),result}_debugDispatch(){var args=Array.from(arguments),key=args[0];return args[0]="ExternalEvent:"+args[0],(!0===this.debug||this.debug.includes(key))&&console.log(...args),this._dispatch(...arguments)}}class InternalEventBus{constructor(debug){this.events={},this.subscriptionNotifiers={},this.dispatch=debug?this._debugDispatch.bind(this):this._dispatch.bind(this),this.chain=debug?this._debugChain.bind(this):this._chain.bind(this),this.confirm=debug?this._debugConfirm.bind(this):this._confirm.bind(this),this.debug=debug}subscriptionChange(key,callback){this.subscriptionNotifiers[key]||(this.subscriptionNotifiers[key]=[]),this.subscriptionNotifiers[key].push(callback),this.subscribed(key)&&this._notifySubscriptionChange(key,!0)}subscribe(key,callback){let priority=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;this.events[key]||(this.events[key]=[]),this.events[key].push({callback:callback,priority:priority}),this.events[key].sort(((a,b)=>a.priority-b.priority)),this._notifySubscriptionChange(key,!0)}unsubscribe(key,callback){var index;if(this.events[key]){if(callback){if(!((index=this.events[key].findIndex((item=>item.callback===callback)))>-1))return void console.warn("Cannot remove event, no matching event found:",key,callback);this.events[key].splice(index,1)}this._notifySubscriptionChange(key,!1)}else console.warn("Cannot remove event, no events set on:",key)}subscribed(key){return this.events[key]&&this.events[key].length}_chain(key,args,initialValue,fallback){var value=initialValue;return Array.isArray(args)||(args=[args]),this.subscribed(key)?(this.events[key].forEach(((subscriber,i)=>{value=subscriber.callback.apply(this,args.concat([value]))})),value):"function"==typeof fallback?fallback():fallback}_confirm(key,args){var confirmed=!1;return Array.isArray(args)||(args=[args]),this.subscribed(key)&&this.events[key].forEach(((subscriber,i)=>{subscriber.callback.apply(this,args)&&(confirmed=!0)})),confirmed}_notifySubscriptionChange(key,subscribed){var notifiers=this.subscriptionNotifiers[key];notifiers&&notifiers.forEach((callback=>{callback(subscribed)}))}_dispatch(){var args=Array.from(arguments),key=args.shift();this.events[key]&&this.events[key].forEach((subscriber=>{subscriber.callback.apply(this,args)}))}_debugDispatch(){var args=Array.from(arguments),key=args[0];return args[0]="InternalEvent:"+key,(!0===this.debug||this.debug.includes(key))&&console.log(...args),this._dispatch(...arguments)}_debugChain(){var args=Array.from(arguments),key=args[0];return args[0]="InternalEvent:"+key,(!0===this.debug||this.debug.includes(key))&&console.log(...args),this._chain(...arguments)}_debugConfirm(){var args=Array.from(arguments),key=args[0];return args[0]="InternalEvent:"+key,(!0===this.debug||this.debug.includes(key))&&console.log(...args),this._confirm(...arguments)}}class DeprecationAdvisor extends CoreFeature{constructor(table){super(table)}_warnUser(){this.options("debugDeprecation")&&console.warn(...arguments)}check(oldOption,newOption){var msg="";return void 0===this.options(oldOption)||(msg="Deprecated Setup Option - Use of the %c"+oldOption+"%c option is now deprecated",newOption?(msg=msg+", Please use the %c"+newOption+"%c option instead",this._warnUser(msg,"font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;")):this._warnUser(msg,"font-weight: bold;","font-weight: normal;"),!1)}checkMsg(oldOption,msg){return void 0===this.options(oldOption)||(this._warnUser("%cDeprecated Setup Option - Use of the %c"+oldOption+" %c option is now deprecated, "+msg,"font-weight: normal;","font-weight: bold;","font-weight: normal;"),!1)}msg(msg){this._warnUser(msg)}}class TableRegistry{static register(table){TableRegistry.tables.push(table)}static deregister(table){var index=TableRegistry.tables.indexOf(table);index>-1&&TableRegistry.tables.splice(index,1)}static lookupTable(query,silent){var matches,match,results=[];if("string"==typeof query){if((matches=document.querySelectorAll(query)).length)for(var i=0;i<matches.length;i++)(match=TableRegistry.matchElement(matches[i]))&&results.push(match)}else"undefined"!=typeof HTMLElement&&query instanceof HTMLElement||query instanceof Tabulator?(match=TableRegistry.matchElement(query))&&results.push(match):Array.isArray(query)?query.forEach((function(item){results=results.concat(TableRegistry.lookupTable(item))})):silent||console.warn("Table Connection Error - Invalid Selector",query);return results}static matchElement(element){return TableRegistry.tables.find((function(table){return element instanceof Tabulator?table===element:table.element===element}))}}function fitDataGeneral(columns,forced){columns.forEach((function(column){column.reinitializeWidth()})),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}TableRegistry.tables=[];var defaultModes={fitData:function(columns,forced){forced&&this.table.columnManager.renderer.reinitializeColumnWidths(columns),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitDataFill:fitDataGeneral,fitDataTable:fitDataGeneral,fitDataStretch:function(columns,forced){var colsWidth=0,tableWidth=this.table.rowManager.element.clientWidth,gap=0,lastCol=!1;columns.forEach(((column,i)=>{column.widthFixed||column.reinitializeWidth(),(this.table.options.responsiveLayout?column.modules.responsive.visible:column.visible)&&(lastCol=column),column.visible&&(colsWidth+=column.getWidth())})),lastCol?(gap=tableWidth-colsWidth+lastCol.getWidth(),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&(lastCol.setWidth(0),this.table.modules.responsiveLayout.update()),gap>0?lastCol.setWidth(gap):lastCol.reinitializeWidth()):this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitColumns:function(columns,forced){var flexColWidth,overflowWidth,totalWidth=this.table.rowManager.element.getBoundingClientRect().width,fixedWidth=0,flexWidth=0,flexGrowUnits=0,flexColumns=[],fixedShrinkColumns=[],flexShrinkUnits=0,gapFill=0;function calcWidth(width){return"string"==typeof width?width.indexOf("%")>-1?totalWidth/100*parseInt(width):parseInt(width):width}function scaleColumns(columns,freeSpace,colWidth,shrinkCols){var oversizeCols=[],oversizeSpace=0,remainingSpace=0,nextColWidth=0,remainingFlexGrowUnits=flexGrowUnits,gap=0,changeUnits=0,undersizeCols=[];function calcGrow(col){return colWidth*(col.column.definition.widthGrow||1)}function calcShrink(col){return calcWidth(col.width)-colWidth*(col.column.definition.widthShrink||0)}return columns.forEach((function(col,i){var width=shrinkCols?calcShrink(col):calcGrow(col);col.column.minWidth>=width?oversizeCols.push(col):col.column.maxWidth&&col.column.maxWidth<width?(col.width=col.column.maxWidth,freeSpace-=col.column.maxWidth,(remainingFlexGrowUnits-=shrinkCols?col.column.definition.widthShrink||1:col.column.definition.widthGrow||1)&&(colWidth=Math.floor(freeSpace/remainingFlexGrowUnits))):(undersizeCols.push(col),changeUnits+=shrinkCols?col.column.definition.widthShrink||1:col.column.definition.widthGrow||1)})),oversizeCols.length?(oversizeCols.forEach((function(col){oversizeSpace+=shrinkCols?col.width-col.column.minWidth:col.column.minWidth,col.width=col.column.minWidth})),remainingSpace=freeSpace-oversizeSpace,nextColWidth=changeUnits?Math.floor(remainingSpace/changeUnits):remainingSpace,gap=scaleColumns(undersizeCols,remainingSpace,nextColWidth,shrinkCols)):(gap=changeUnits?freeSpace-Math.floor(freeSpace/changeUnits)*changeUnits:freeSpace,undersizeCols.forEach((function(column){column.width=shrinkCols?calcShrink(column):calcGrow(column)}))),gap}this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(totalWidth-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),columns.forEach((function(column){var width,minWidth,colWidth;column.visible&&(width=column.definition.width,minWidth=parseInt(column.minWidth),width?(colWidth=calcWidth(width),fixedWidth+=colWidth>minWidth?colWidth:minWidth,column.definition.widthShrink&&(fixedShrinkColumns.push({column:column,width:colWidth>minWidth?colWidth:minWidth}),flexShrinkUnits+=column.definition.widthShrink)):(flexColumns.push({column:column,width:0}),flexGrowUnits+=column.definition.widthGrow||1))})),flexWidth=totalWidth-fixedWidth,flexColWidth=Math.floor(flexWidth/flexGrowUnits),gapFill=scaleColumns(flexColumns,flexWidth,flexColWidth,!1),flexColumns.length&&gapFill>0&&(flexColumns[flexColumns.length-1].width+=gapFill),flexColumns.forEach((function(col){flexWidth-=col.width})),(overflowWidth=Math.abs(gapFill)+flexWidth)>0&&flexShrinkUnits&&(gapFill=scaleColumns(fixedShrinkColumns,overflowWidth,Math.floor(overflowWidth/flexShrinkUnits),!0)),gapFill&&fixedShrinkColumns.length&&(fixedShrinkColumns[fixedShrinkColumns.length-1].width-=gapFill),flexColumns.forEach((function(col){col.column.setWidth(col.width)})),fixedShrinkColumns.forEach((function(col){col.column.setWidth(col.width)}))}};class Layout extends Module{constructor(table){super(table,"layout"),this.mode=null,this.registerTableOption("layout","fitData"),this.registerTableOption("layoutColumnsOnNewData",!1),this.registerColumnOption("widthGrow"),this.registerColumnOption("widthShrink")}initialize(){var layout=this.table.options.layout;Layout.modes[layout]?this.mode=layout:(console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : "+layout),this.mode="fitData"),this.table.element.setAttribute("tabulator-layout",this.mode)}getMode(){return this.mode}layout(dataChanged){this.dispatch("layout-refreshing"),Layout.modes[this.mode].call(this,this.table.columnManager.columnsByIndex,dataChanged),this.dispatch("layout-refreshed")}}Layout.moduleName="layout",Layout.modes=defaultModes;class Localize extends Module{constructor(table){super(table),this.locale="default",this.lang=!1,this.bindings={},this.langList={},this.registerTableOption("locale",!1),this.registerTableOption("langs",{})}initialize(){this.langList=Helpers.deepClone(Localize.langs),!1!==this.table.options.columnDefaults.headerFilterPlaceholder&&this.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder);for(let locale in this.table.options.langs)this.installLang(locale,this.table.options.langs[locale]);this.setLocale(this.table.options.locale),this.registerTableFunction("setLocale",this.setLocale.bind(this)),this.registerTableFunction("getLocale",this.getLocale.bind(this)),this.registerTableFunction("getLang",this.getLang.bind(this))}setHeaderFilterPlaceholder(placeholder){this.langList.default.headerFilters.default=placeholder}setHeaderFilterColumnPlaceholder(column,placeholder){this.langList.default.headerFilters.columns[column]=placeholder,this.lang&&!this.lang.headerFilters.columns[column]&&(this.lang.headerFilters.columns[column]=placeholder)}installLang(locale,lang){this.langList[locale]?this._setLangProp(this.langList[locale],lang):this.langList[locale]=lang}_setLangProp(lang,values){for(let key in values)lang[key]&&"object"==typeof lang[key]?this._setLangProp(lang[key],values[key]):lang[key]=values[key]}setLocale(desiredLocale){if(!0===(desiredLocale=desiredLocale||"default")&&navigator.language&&(desiredLocale=navigator.language.toLowerCase()),desiredLocale&&!this.langList[desiredLocale]){let prefix=desiredLocale.split("-")[0];this.langList[prefix]?(console.warn("Localization Error - Exact matching locale not found, using closest match: ",desiredLocale,prefix),desiredLocale=prefix):(console.warn("Localization Error - Matching locale not found, using default: ",desiredLocale),desiredLocale="default")}this.locale=desiredLocale,this.lang=Helpers.deepClone(this.langList.default||{}),"default"!=desiredLocale&&function traverseLang(trans,path){for(var prop in trans)"object"==typeof trans[prop]?(path[prop]||(path[prop]={}),traverseLang(trans[prop],path[prop])):path[prop]=trans[prop]}(this.langList[desiredLocale],this.lang),this.dispatchExternal("localized",this.locale,this.lang),this._executeBindings()}getLocale(locale){return this.locale}getLang(locale){return locale?this.langList[locale]:this.lang}getText(path,value){var pathArray=(value?path+"|"+value:path).split("|");return this._getLangElement(pathArray,this.locale)||""}_getLangElement(path,locale){var root=this.lang;return path.forEach((function(level){var rootPath;root&&(rootPath=root[level],root=void 0!==rootPath&&rootPath)})),root}bind(path,callback){this.bindings[path]||(this.bindings[path]=[]),this.bindings[path].push(callback),callback(this.getText(path),this.lang)}_executeBindings(){for(let path in this.bindings)this.bindings[path].forEach((binding=>{binding(this.getText(path),this.lang)}))}}Localize.moduleName="localize",Localize.langs={default:{groups:{item:"item",items:"items"},columns:{},data:{loading:"Loading",error:"Error"},pagination:{page_size:"Page Size",page_title:"Show Page",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page",all:"All",counter:{showing:"Showing",of:"of",rows:"rows",pages:"pages"}},headerFilters:{default:"filter column...",columns:{}}}};class Comms extends Module{constructor(table){super(table)}initialize(){this.registerTableFunction("tableComms",this.receive.bind(this))}getConnections(selectors){var connections=[];return TableRegistry.lookupTable(selectors).forEach((con=>{this.table!==con&&connections.push(con)})),connections}send(selectors,module,action,data){var connections=this.getConnections(selectors);connections.forEach((connection=>{connection.tableComms(this.table.element,module,action,data)})),!connections.length&&selectors&&console.warn("Table Connection Error - No tables matching selector found",selectors)}receive(table,module,action,data){if(this.table.modExists(module))return this.table.modules[module].commsReceived(table,action,data);console.warn("Inter-table Comms Error - no such module:",module)}}Comms.moduleName="comms";var coreModules=Object.freeze({__proto__:null,LayoutModule:Layout,LocalizeModule:Localize,CommsModule:Comms});class ModuleBinder{constructor(tabulator,modules){this.bindStaticFunctionality(tabulator),this.bindModules(tabulator,coreModules,!0),modules&&this.bindModules(tabulator,modules)}bindStaticFunctionality(tabulator){tabulator.moduleBindings={},tabulator.extendModule=function(name,property,values){if(tabulator.moduleBindings[name]){var source=tabulator.moduleBindings[name][property];if(source)if("object"==typeof values)for(let key in values)source[key]=values[key];else console.warn("Module Error - Invalid value type, it must be an object");else console.warn("Module Error - property does not exist:",property)}else console.warn("Module Error - module does not exist:",name)},tabulator.registerModule=function(modules){Array.isArray(modules)||(modules=[modules]),modules.forEach((mod=>{tabulator.registerModuleBinding(mod)}))},tabulator.registerModuleBinding=function(mod){tabulator.moduleBindings[mod.moduleName]=mod},tabulator.findTable=function(query){var results=TableRegistry.lookupTable(query,!0);return!(Array.isArray(results)&&!results.length)&&results},tabulator.prototype.bindModules=function(){var orderedStartMods=[],orderedEndMods=[],unOrderedMods=[];for(var name in this.modules={},tabulator.moduleBindings){let mod=tabulator.moduleBindings[name],module=new mod(this);this.modules[name]=module,mod.prototype.moduleCore?this.modulesCore.push(module):mod.moduleInitOrder?mod.moduleInitOrder<0?orderedStartMods.push(module):orderedEndMods.push(module):unOrderedMods.push(module)}orderedStartMods.sort(((a,b)=>a.moduleInitOrder>b.moduleInitOrder?1:-1)),orderedEndMods.sort(((a,b)=>a.moduleInitOrder>b.moduleInitOrder?1:-1)),this.modulesRegular=orderedStartMods.concat(unOrderedMods.concat(orderedEndMods))}}bindModules(tabulator,modules,core){var mods=Object.values(modules);core&&mods.forEach((mod=>{mod.prototype.moduleCore=!0})),tabulator.registerModule(mods)}}class Alert extends CoreFeature{constructor(table){super(table),this.element=this._createAlertElement(),this.msgElement=this._createMsgElement(),this.type=null,this.element.appendChild(this.msgElement)}_createAlertElement(){var el=document.createElement("div");return el.classList.add("tabulator-alert"),el}_createMsgElement(){var el=document.createElement("div");return el.classList.add("tabulator-alert-msg"),el.setAttribute("role","alert"),el}_typeClass(){return"tabulator-alert-state-"+this.type}alert(content){let type=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"msg";if(content){for(this.clear(),this.type=type;this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.add(this._typeClass()),"function"==typeof content&&(content=content()),content instanceof HTMLElement?this.msgElement.appendChild(content):this.msgElement.innerHTML=content,this.table.element.appendChild(this.element)}}clear(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.msgElement.classList.remove(this._typeClass())}}class Tabulator{constructor(element,options){this.options={},this.columnManager=null,this.rowManager=null,this.footerManager=null,this.alertManager=null,this.vdomHoz=null,this.externalEvents=null,this.eventBus=null,this.interactionMonitor=!1,this.browser="",this.browserSlow=!1,this.browserMobile=!1,this.rtl=!1,this.originalElement=null,this.componentFunctionBinder=new ComponentFunctionBinder(this),this.dataLoader=!1,this.modules={},this.modulesCore=[],this.modulesRegular=[],this.deprecationAdvisor=new DeprecationAdvisor(this),this.optionsList=new OptionsList(this,"table constructor"),this.initialized=!1,this.destroyed=!1,this.initializeElement(element)&&(this.initializeCoreSystems(options),setTimeout((()=>{this._create()}))),TableRegistry.register(this)}initializeElement(element){return"undefined"!=typeof HTMLElement&&element instanceof HTMLElement?(this.element=element,!0):"string"==typeof element?(this.element=document.querySelector(element),!!this.element||(console.error("Tabulator Creation Error - no element found matching selector: ",element),!1)):(console.error("Tabulator Creation Error - Invalid element provided:",element),!1)}initializeCoreSystems(options){this.columnManager=new ColumnManager(this),this.rowManager=new RowManager(this),this.footerManager=new FooterManager(this),this.dataLoader=new DataLoader(this),this.alertManager=new Alert(this),this.bindModules(),this.options=this.optionsList.generate(Tabulator.defaultOptions,options),this._clearObjectPointers(),this._mapDeprecatedFunctionality(),this.externalEvents=new ExternalEventBus(this,this.options,this.options.debugEventsExternal),this.eventBus=new InternalEventBus(this.options.debugEventsInternal),this.interactionMonitor=new InteractionManager(this),this.dataLoader.initialize(),this.footerManager.initialize()}_mapDeprecatedFunctionality(){}_clearSelection(){this.element.classList.add("tabulator-block-select"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this.element.classList.remove("tabulator-block-select")}_create(){this.externalEvents.dispatch("tableBuilding"),this.eventBus.dispatch("table-building"),this._rtlCheck(),this._buildElement(),this._initializeTable(),this._loadInitialData(),this.initialized=!0,this.externalEvents.dispatch("tableBuilt")}_rtlCheck(){var style=window.getComputedStyle(this.element);switch(this.options.textDirection){case"auto":if("rtl"!==style.direction)break;case"rtl":this.element.classList.add("tabulator-rtl"),this.rtl=!0;break;case"ltr":this.element.classList.add("tabulator-ltr");default:this.rtl=!1}}_clearObjectPointers(){this.options.columns=this.options.columns.slice(0),Array.isArray(this.options.data)&&!this.options.reactiveData&&(this.options.data=this.options.data.slice(0))}_buildElement(){var newElement,element=this.element,options=this.options;if("TABLE"===element.tagName){this.originalElement=this.element,newElement=document.createElement("div");var attributes=element.attributes;for(var i in attributes)"object"==typeof attributes[i]&&newElement.setAttribute(attributes[i].name,attributes[i].value);element.parentNode.replaceChild(newElement,element),this.element=element=newElement}for(element.classList.add("tabulator"),element.setAttribute("role","grid");element.firstChild;)element.removeChild(element.firstChild);options.height&&(options.height=isNaN(options.height)?options.height:options.height+"px",element.style.height=options.height),!1!==options.minHeight&&(options.minHeight=isNaN(options.minHeight)?options.minHeight:options.minHeight+"px",element.style.minHeight=options.minHeight),!1!==options.maxHeight&&(options.maxHeight=isNaN(options.maxHeight)?options.maxHeight:options.maxHeight+"px",element.style.maxHeight=options.maxHeight)}_initializeTable(){var element=this.element,options=this.options;this.interactionMonitor.initialize(),this.columnManager.initialize(),this.rowManager.initialize(),this._detectBrowser(),this.modulesCore.forEach((mod=>{mod.initialize()})),element.appendChild(this.columnManager.getElement()),element.appendChild(this.rowManager.getElement()),options.footerElement&&this.footerManager.activate(),options.autoColumns&&options.data&&this.columnManager.generateColumnsFromRowData(this.options.data),this.modulesRegular.forEach((mod=>{mod.initialize()})),this.columnManager.setColumns(options.columns),this.eventBus.dispatch("table-built")}_loadInitialData(){this.dataLoader.load(this.options.data)}destroy(){var element=this.element;for(this.destroyed=!0,TableRegistry.deregister(this),this.eventBus.dispatch("table-destroy"),this.rowManager.rows.forEach((function(row){row.wipe()})),this.rowManager.rows=[],this.rowManager.activeRows=[],this.rowManager.displayRows=[];element.firstChild;)element.removeChild(element.firstChild);element.classList.remove("tabulator"),this.externalEvents.dispatch("tableDestroyed")}_detectBrowser(){var ua=navigator.userAgent||navigator.vendor||window.opera;ua.indexOf("Trident")>-1?(this.browser="ie",this.browserSlow=!0):ua.indexOf("Edge")>-1?(this.browser="edge",this.browserSlow=!0):ua.indexOf("Firefox")>-1?(this.browser="firefox",this.browserSlow=!1):(this.browser="other",this.browserSlow=!1),this.browserMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(ua)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(ua.slice(0,4))}initGuard(func,msg){var stack,line;return this.options.debugInitialization&&!this.initialized&&(func||(func=" "==(line="Error"==(stack=(new Error).stack.split("\n"))[0]?stack[2]:stack[1])[0]?line.trim().split(" ")[1].split(".")[1]:line.trim().split("@")[0]),console.warn("Table Not Initialized - Calling the "+func+" function before the table is initialized may result in inconsistent behavior, Please wait for the `tableBuilt` event before calling this function."+(msg?" "+msg:""))),this.initialized}blockRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-blocking"),this.rowManager.blockRedraw(),this.columnManager.blockRedraw(),this.eventBus.dispatch("redraw-blocked")}restoreRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-restoring"),this.rowManager.restoreRedraw(),this.columnManager.restoreRedraw(),this.eventBus.dispatch("redraw-restored")}setData(data,params,config){return this.initGuard(!1,"To set initial data please use the 'data' property in the table constructor."),this.dataLoader.load(data,params,config,!1)}clearData(){this.initGuard(),this.dataLoader.blockActiveLoad(),this.rowManager.clearData()}getData(active){return this.rowManager.getData(active)}getDataCount(active){return this.rowManager.getDataCount(active)}replaceData(data,params,config){return this.initGuard(),this.dataLoader.load(data,params,config,!0,!0)}updateData(data){var responses=0;return this.initGuard(),new Promise(((resolve,reject)=>{this.dataLoader.blockActiveLoad(),"string"==typeof data&&(data=JSON.parse(data)),data&&data.length>0?data.forEach((item=>{var row=this.rowManager.findRow(item[this.options.index]);row&&(responses++,row.updateData(item).then((()=>{--responses||resolve()})))})):(console.warn("Update Error - No data provided"),reject("Update Error - No data provided"))}))}addData(data,pos,index){return this.initGuard(),new Promise(((resolve,reject)=>{this.dataLoader.blockActiveLoad(),"string"==typeof data&&(data=JSON.parse(data)),data?this.rowManager.addRows(data,pos,index).then((rows=>{var output=[];rows.forEach((function(row){output.push(row.getComponent())})),resolve(output)})):(console.warn("Update Error - No data provided"),reject("Update Error - No data provided"))}))}updateOrAddData(data){var rows=[],responses=0;return this.initGuard(),new Promise(((resolve,reject)=>{this.dataLoader.blockActiveLoad(),"string"==typeof data&&(data=JSON.parse(data)),data&&data.length>0?data.forEach((item=>{var row=this.rowManager.findRow(item[this.options.index]);responses++,row?row.updateData(item).then((()=>{responses--,rows.push(row.getComponent()),responses||resolve(rows)})):this.rowManager.addRows(item).then((newRows=>{responses--,rows.push(newRows[0].getComponent()),responses||resolve(rows)}))})):(console.warn("Update Error - No data provided"),reject("Update Error - No data provided"))}))}getRow(index){var row=this.rowManager.findRow(index);return row?row.getComponent():(console.warn("Find Error - No matching row found:",index),!1)}getRowFromPosition(position){var row=this.rowManager.getRowFromPosition(position);return row?row.getComponent():(console.warn("Find Error - No matching row found:",position),!1)}deleteRow(index){var foundRows=[];this.initGuard(),Array.isArray(index)||(index=[index]);for(let item of index){let row=this.rowManager.findRow(item,!0);if(!row)return console.error("Delete Error - No matching row found:",item),Promise.reject("Delete Error - No matching row found");foundRows.push(row)}return foundRows.sort(((a,b)=>this.rowManager.rows.indexOf(a)>this.rowManager.rows.indexOf(b)?1:-1)),foundRows.forEach((row=>{row.delete()})),this.rowManager.reRenderInPosition(),Promise.resolve()}addRow(data,pos,index){return this.initGuard(),"string"==typeof data&&(data=JSON.parse(data)),this.rowManager.addRows(data,pos,index).then((rows=>rows[0].getComponent()))}updateOrAddRow(index,data){var row=this.rowManager.findRow(index);return this.initGuard(),"string"==typeof data&&(data=JSON.parse(data)),row?row.updateData(data).then((()=>row.getComponent())):this.rowManager.addRows(data).then((rows=>rows[0].getComponent()))}updateRow(index,data){var row=this.rowManager.findRow(index);return this.initGuard(),"string"==typeof data&&(data=JSON.parse(data)),row?row.updateData(data).then((()=>Promise.resolve(row.getComponent()))):(console.warn("Update Error - No matching row found:",index),Promise.reject("Update Error - No matching row found"))}scrollToRow(index,position,ifVisible){var row=this.rowManager.findRow(index);return row?this.rowManager.scrollToRow(row,position,ifVisible):(console.warn("Scroll Error - No matching row found:",index),Promise.reject("Scroll Error - No matching row found"))}moveRow(from,to,after){var fromRow=this.rowManager.findRow(from);this.initGuard(),fromRow?fromRow.moveToRow(to,after):console.warn("Move Error - No matching row found:",from)}getRows(active){return this.rowManager.getComponents(active)}getRowPosition(index){var row=this.rowManager.findRow(index);return row?row.getPosition():(console.warn("Position Error - No matching row found:",index),!1)}setColumns(definition){this.initGuard(!1,"To set initial columns please use the 'columns' property in the table constructor"),this.columnManager.setColumns(definition)}getColumns(structured){return this.columnManager.getComponents(structured)}getColumn(field){var column=this.columnManager.findColumn(field);return column?column.getComponent():(console.warn("Find Error - No matching column found:",field),!1)}getColumnDefinitions(){return this.columnManager.getDefinitionTree()}showColumn(field){var column=this.columnManager.findColumn(field);if(this.initGuard(),!column)return console.warn("Column Show Error - No matching column found:",field),!1;column.show()}hideColumn(field){var column=this.columnManager.findColumn(field);if(this.initGuard(),!column)return console.warn("Column Hide Error - No matching column found:",field),!1;column.hide()}toggleColumn(field){var column=this.columnManager.findColumn(field);if(this.initGuard(),!column)return console.warn("Column Visibility Toggle Error - No matching column found:",field),!1;column.visible?column.hide():column.show()}addColumn(definition,before,field){var column=this.columnManager.findColumn(field);return this.initGuard(),this.columnManager.addColumn(definition,before,column).then((column=>column.getComponent()))}deleteColumn(field){var column=this.columnManager.findColumn(field);return this.initGuard(),column?column.delete():(console.warn("Column Delete Error - No matching column found:",field),Promise.reject())}updateColumnDefinition(field,definition){var column=this.columnManager.findColumn(field);return this.initGuard(),column?column.updateDefinition(definition):(console.warn("Column Update Error - No matching column found:",field),Promise.reject())}moveColumn(from,to,after){var fromColumn=this.columnManager.findColumn(from),toColumn=this.columnManager.findColumn(to);this.initGuard(),fromColumn?toColumn?this.columnManager.moveColumn(fromColumn,toColumn,after):console.warn("Move Error - No matching column found:",toColumn):console.warn("Move Error - No matching column found:",from)}scrollToColumn(field,position,ifVisible){return new Promise(((resolve,reject)=>{var column=this.columnManager.findColumn(field);return column?this.columnManager.scrollToColumn(column,position,ifVisible):(console.warn("Scroll Error - No matching column found:",field),Promise.reject("Scroll Error - No matching column found"))}))}redraw(force){this.initGuard(),this.columnManager.redraw(force),this.rowManager.redraw(force)}setHeight(height){this.options.height=isNaN(height)?height:height+"px",this.element.style.height=this.options.height,this.rowManager.initializeRenderer(),this.rowManager.redraw()}on(key,callback){this.externalEvents.subscribe(key,callback)}off(key,callback){this.externalEvents.unsubscribe(key,callback)}dispatchEvent(){Array.from(arguments).shift(),this.externalEvents.dispatch(...arguments)}alert(contents,type){this.initGuard(),this.alertManager.alert(contents,type)}clearAlert(){this.initGuard(),this.alertManager.clear()}modExists(plugin,required){return!!this.modules[plugin]||(required&&console.error("Tabulator Module Not Installed: "+plugin),!1)}module(key){var mod=this.modules[key];return mod||console.error("Tabulator module not installed: "+key),mod}}_exports.Tabulator=Tabulator,Tabulator.defaultOptions={debugEventsExternal:!1,debugEventsInternal:!1,debugInvalidOptions:!0,debugInvalidComponentFuncs:!0,debugInitialization:!0,debugDeprecation:!0,height:!1,minHeight:!1,maxHeight:!1,columnHeaderVertAlign:"top",popupContainer:!1,columns:[],columnDefaults:{},data:!1,autoColumns:!1,autoColumnsDefinitions:!1,nestedFieldSeparator:".",footerElement:!1,index:"id",textDirection:"auto",addRowPos:"bottom",headerVisible:!0,renderVertical:"virtual",renderHorizontal:"basic",renderVerticalBuffer:0,scrollToRowPosition:"top",scrollToRowIfVisible:!0,scrollToColumnPosition:"left",scrollToColumnIfVisible:!0,rowFormatter:!1,rowFormatterPrint:null,rowFormatterClipboard:null,rowFormatterHtmlOutput:null,rowHeight:null,placeholder:!1,dataLoader:!0,dataLoaderLoading:!1,dataLoaderError:!1,dataLoaderErrorTimeout:3e3,dataSendParams:{},dataReceiveParams:{}},new ModuleBinder(Tabulator);class TabulatorFull extends Tabulator{}_exports.TabulatorFull=TabulatorFull,new ModuleBinder(TabulatorFull,modules);_exports.PseudoRow=class{constructor(type){this.type=type,this.element=this._createElement()}_createElement(){var el=document.createElement("div");return el.classList.add("tabulator-row"),el}getElement(){return this.element}getComponent(){return!1}getData(){return{}}getHeight(){return this.element.outerHeight}initialize(){}reinitialize(){}normalizeHeight(){}generateCells(){}reinitializeHeight(){}calcHeight(){}setCellHeight(){}clearCellHeight(){}}}));

//# sourceMappingURL=tabulator.min.js.map